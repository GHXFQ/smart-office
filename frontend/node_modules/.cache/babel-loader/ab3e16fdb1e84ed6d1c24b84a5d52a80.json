{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\knowledge\\Index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\knowledge\\Index.vue","mtime":1747457225194},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1746431728000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5kZWxldGUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuaGFzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLnNpemUuanMiOwppbXBvcnQgeyByZWYsIHJlYWN0aXZlLCBjb21wdXRlZCwgb25Nb3VudGVkLCBvbkJlZm9yZVVubW91bnQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCB9IGZyb20gJ2VsZW1lbnQtcGx1cyc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IFNlYXJjaCwgVXBsb2FkLCBGb2xkZXJBZGQsIFZpZXcsIERvd25sb2FkLCBNb3JlLCBTaGFyZSwgRWRpdCwgRWRpdFBlbiwgRm9sZGVyT3BlbmVkLCBTdGFyLCBEZWxldGUsIERvY3VtZW50LCBGaWxlcywgVGlja2V0cywgRGF0YUFuYWx5c2lzLCBQaWN0dXJlRmlsbGVkLCBVcGxvYWRGaWxsZWQsIExvYWRpbmcsIExpc3QsIEdyaWQsIENyb3AsIFBsdXMgfSBmcm9tICdAZWxlbWVudC1wbHVzL2ljb25zLXZ1ZSc7CmltcG9ydCB7IGdldENhdGVnb3JpZXMsIGdldERvY3VtZW50cywgZ2V0RG9jdW1lbnRDaHVua3MsIHVwbG9hZERvY3VtZW50LCBkZWxldGVEb2N1bWVudCBhcyBhcGlEZWxldGVEb2N1bWVudCwgZGVsZXRlQ2F0ZWdvcnksIHVwZGF0ZUNhdGVnb3J5LCBhZGRDYXRlZ29yeSB9IGZyb20gJ0AvYXBpL2tub3dsZWRnZSc7CmltcG9ydCBLbm93bGVkZ2VCdWlsZGVyIGZyb20gJ0AvY29tcG9uZW50cy9Lbm93bGVkZ2VCdWlsZGVyLnZ1ZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnS25vd2xlZGdlJywKICBjb21wb25lbnRzOiB7CiAgICBLbm93bGVkZ2VCdWlsZGVyCiAgfSwKICBzZXR1cCgpIHsKICAgIGNvbnN0IEFQSV9VUkwgPSAnL2FwaS9rbm93bGVkZ2UnOwoKICAgIC8vIOeKtuaAgeWPmOmHjwogICAgY29uc3Qgc2VhcmNoUXVlcnkgPSByZWYoJycpOwogICAgY29uc3Qgc2VsZWN0ZWRDYXRlZ29yeSA9IHJlZignYWxsJyk7CiAgICBjb25zdCBjdXJyZW50UGFnZSA9IHJlZigxKTsKICAgIGNvbnN0IHBhZ2VTaXplID0gcmVmKDEwKTsKICAgIGNvbnN0IHVwbG9hZFZpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2hvd0NhdGVnb3J5RGlhbG9nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNob3dBZGRDYXRlZ29yeUZvcm0gPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2hvd0NodW5rc0RpYWxvZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBlZGl0aW5nQ2F0ZWdvcnkgPSByZWYobnVsbCk7CiAgICBjb25zdCB2aWV3TW9kZSA9IHJlZignbGlzdCcpOwogICAgY29uc3Qgc29ydE9yZGVyID0gcmVmKCctY3JlYXRlZF9hdCcpOwogICAgY29uc3QgY2F0ZWdvcnlMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgdXBsb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGNodW5rc0xvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgaXNBZG1pbiA9IHJlZih0cnVlKTsgLy8g5a6e6ZmF5bqU55So5Lit5LuO55So5oi35Lya6K+d6I635Y+WCiAgICBjb25zdCBzZWxlY3RlZERvY3VtZW50ID0gcmVmKG51bGwpOwogICAgY29uc3QgZG9jdW1lbnRDaHVua3MgPSByZWYoW10pOwogICAgY29uc3QgdXBsb2FkRm9ybVJlZiA9IHJlZihudWxsKTsKICAgIGNvbnN0IHVwbG9hZFJlZiA9IHJlZihudWxsKTsKICAgIGNvbnN0IHRvdGFsRG9jcyA9IHJlZigwKTsKCiAgICAvLyDkuIrkvKDooajljZUKICAgIGNvbnN0IHVwbG9hZEZvcm0gPSByZWFjdGl2ZSh7CiAgICAgIHRpdGxlOiAnJywKICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICBmaWxlOiBudWxsLAogICAgICBjYXRlZ29yeTogbnVsbCwKICAgICAgdGFnczogJycsCiAgICAgIGNodW5rX3NpemU6IDUwMCwKICAgICAgY2h1bmtfb3ZlcmxhcDogNTAsCiAgICAgIGlzX3B1YmxpYzogdHJ1ZQogICAgfSk7CgogICAgLy8g5LiK5Lyg6KGo5Y2V6aqM6K+B6KeE5YiZCiAgICBjb25zdCB1cGxvYWRSdWxlcyA9IHsKICAgICAgdGl0bGU6IFt7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+aho+agh+mimCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBmaWxlOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fkuIrkvKDmlofku7YnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH1dCiAgICB9OwoKICAgIC8vIOWIhuexu+ihqOWNlQogICAgY29uc3QgY2F0ZWdvcnlGb3JtID0gcmVhY3RpdmUoewogICAgICBpZDogbnVsbCwKICAgICAgbmFtZTogJycsCiAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgaWNvbjogJ0RvY3VtZW50JywKICAgICAgY29sb3I6ICcjNDA5RUZGJwogICAgfSk7CgogICAgLy8g562b6YCJ5p2h5Lu2CiAgICBjb25zdCBmaWx0ZXJzID0gcmVhY3RpdmUoewogICAgICB0eXBlczogewogICAgICAgIHBkZjogZmFsc2UsCiAgICAgICAgZG9jOiBmYWxzZSwKICAgICAgICB4bHM6IGZhbHNlLAogICAgICAgIHBwdDogZmFsc2UsCiAgICAgICAgaW1nOiBmYWxzZSwKICAgICAgICB0eHQ6IGZhbHNlCiAgICAgIH0sCiAgICAgIHN0YXR1czogJ2FsbCcsCiAgICAgIGRhdGU6ICdhbGwnLAogICAgICBkYXRlUmFuZ2U6IFtdCiAgICB9KTsKCiAgICAvLyDnn6Xor4bliIbnsbsKICAgIGNvbnN0IGNhdGVnb3JpZXMgPSByZWYoW3sKICAgICAgaWQ6ICdhbGwnLAogICAgICBuYW1lOiAn5YWo6YOo5paH5qGjJywKICAgICAgaWNvbjogJ0ZpbGVzJywKICAgICAgY29sb3I6ICcjMDA3YmZmJywKICAgICAgZG9jdW1lbnRfY291bnQ6IDAKICAgIH1dKTsKCiAgICAvLyDmlofmoaPliJfooagKICAgIGNvbnN0IGRvY3VtZW50cyA9IHJlZihbXSk7CgogICAgLy8g6K6h566X5bGe5oCnCiAgICBjb25zdCBjdXJyZW50Q2F0ZWdvcnlOYW1lID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBjb25zdCBjYXRlZ29yeSA9IGNhdGVnb3JpZXMudmFsdWUuZmluZChjYXQgPT4gY2F0LmlkID09PSBzZWxlY3RlZENhdGVnb3J5LnZhbHVlKTsKICAgICAgcmV0dXJuIGNhdGVnb3J5ID8gY2F0ZWdvcnkubmFtZSA6ICflhajpg6jmlofmoaMnOwogICAgfSk7CiAgICBjb25zdCBwcm9jZXNzaW5nQ291bnQgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIHJldHVybiBkb2N1bWVudHMudmFsdWUuZmlsdGVyKGRvYyA9PiBkb2Muc3RhdHVzID09PSAncHJvY2Vzc2luZycpLmxlbmd0aDsKICAgIH0pOwoKICAgIC8vIOefpeivhuW6k+aehOW7uuebuOWFs+eKtuaAgQogICAgY29uc3QgYnVpbGRpbmdWaXNpYmxlID0gcmVmKGZhbHNlKTsKCiAgICAvLyDmlrnms5UKICAgIGNvbnN0IGZldGNoQ2F0ZWdvcmllcyA9IGFzeW5jICgpID0+IHsKICAgICAgY2F0ZWdvcnlMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgY29uc29sZS5sb2coJ+W8gOWni+iOt+WPluefpeivhuW6k+WIhuexuy4uLicpOwogICAgICB0cnkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKCfor7fmsYJVUkw6JywgYCR7QVBJX1VSTH0vY2F0ZWdvcmllcy9gKSAvLyDlt7Looqvlrp7pmYVBUEnosIPnlKjlj5bku6MKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldENhdGVnb3JpZXMoKTsgLy8gQVBJIGNhbGwgZm9yIHNwZWNpZmljIGNhdGVnb3JpZXMKICAgICAgICBjb25zb2xlLmxvZygn6I635Y+W5YiG57G75ZON5bqUOicsIHJlc3BvbnNlKTsKICAgICAgICBsZXQgY2F0ZWdvcnlMaXN0ID0gW107CgogICAgICAgIC8vIOWkhOeQhuS4jeWQjOagvOW8j+eahOWTjeW6lCAoZm9yIHNwZWNpZmljIGNhdGVnb3JpZXMpCiAgICAgICAgaWYgKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLnJlc3VsdHMpKSB7CiAgICAgICAgICAgIGNhdGVnb3J5TGlzdCA9IHJlc3BvbnNlLnJlc3VsdHM7CiAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UpKSB7CiAgICAgICAgICAgIGNhdGVnb3J5TGlzdCA9IHJlc3BvbnNlOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcmVzcG9uc2UgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgIGNvbnN0IHBvc3NpYmxlQXJyYXlGaWVsZHMgPSBbJ2RhdGEnLCAnY2F0ZWdvcmllcycsICdpdGVtcyddOwogICAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIHBvc3NpYmxlQXJyYXlGaWVsZHMpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2VbZmllbGRdICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2VbZmllbGRdKSkgewogICAgICAgICAgICAgICAgY2F0ZWdvcnlMaXN0ID0gcmVzcG9uc2VbZmllbGRdOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBGZXRjaCB0aGUgZ3JhbmQgdG90YWwgb2YgYWxsIGRvY3VtZW50cwogICAgICAgIGxldCBncmFuZFRvdGFsQWxsRG9jdW1lbnRzID0gMDsKICAgICAgICB0cnkgewogICAgICAgICAgLy8gTGlnaHR3ZWlnaHQgcmVxdWVzdCB0byBnZXQgdGhlIHRvdGFsIGNvdW50IG9mIGFsbCBkb2N1bWVudHMKICAgICAgICAgIGNvbnN0IGFsbERvY3NSZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50cyh7CiAgICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgICAgIHBhZ2Vfc2l6ZTogMQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYWxsRG9jc1Jlc3BvbnNlICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhbGxEb2NzUmVzcG9uc2UsICdjb3VudCcpKSB7CiAgICAgICAgICAgIGdyYW5kVG90YWxBbGxEb2N1bWVudHMgPSBhbGxEb2NzUmVzcG9uc2UuY291bnQ7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfojrflj5bliLDlhajpg6jmlofmoaPmgLvmlbA6JywgZ3JhbmRUb3RhbEFsbERvY3VtZW50cyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLndhcm4oJ+acquiDveS7jiBnZXREb2N1bWVudHMg5ZON5bqU5Lit6I635Y+W5oC75pWwIGNvdW50OicsIGFsbERvY3NSZXNwb25zZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZG9jRXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluWFqOmDqOaWh+aho+aAu+aVsOWksei0pTonLCBkb2NFcnJvcik7CiAgICAgICAgICAvLyDkv53nlZkgZ3JhbmRUb3RhbEFsbERvY3VtZW50cyA9IDAg5oiW5qC55o2u6ZyA6KaB5aSE55CG6ZSZ6K+vCiAgICAgICAgfQoKICAgICAgICAvLyDliJvlu7ogIuWFqOmDqOaWh+ahoyIg5YiG57G7CiAgICAgICAgY29uc3QgYWxsQ2F0ZWdvcnkgPSB7CiAgICAgICAgICBpZDogJ2FsbCcsCiAgICAgICAgICBuYW1lOiAn5YWo6YOo5paH5qGjJywKICAgICAgICAgIGljb246ICdGaWxlcycsCiAgICAgICAgICBjb2xvcjogJyMwMDdiZmYnLAogICAgICAgICAgZG9jdW1lbnRfY291bnQ6IGdyYW5kVG90YWxBbGxEb2N1bWVudHMgLy8g5L2/55So6I635Y+W5Yiw55qE55yf5a6e5oC75pWwCiAgICAgICAgfTsKICAgICAgICBpZiAoY2F0ZWdvcnlMaXN0ICYmIGNhdGVnb3J5TGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5om+5Yiw5YiG57G75pWw5o2u77yM5pWw6YePOicsIGNhdGVnb3J5TGlzdC5sZW5ndGgpOwogICAgICAgICAgLy8g5LiN5YaN6YCa6L+H57Sv5Yqg5YW25LuW5YiG57G75p2l6K6h566XIGFsbENhdGVnb3J5LmRvY3VtZW50X2NvdW50CiAgICAgICAgICBjYXRlZ29yaWVzLnZhbHVlID0gW2FsbENhdGVnb3J5LCAuLi5jYXRlZ29yeUxpc3RdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfmnKrmib7liLDmnInmlYjnmoTliIbnsbvmlbDmja4nKTsKICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5tZXNzYWdlKSB7CiAgICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKHJlc3BvbnNlLm1lc3NhZ2UpOwogICAgICAgICAgfSBlbHNlIGlmICghcmVzcG9uc2UgJiYgIWNhdGVnb3J5TGlzdC5sZW5ndGgpIHsvLyBPbmx5IHNob3cgaWYgcmVzcG9uc2Ugd2FzIHRydWx5IGVtcHR5IGFuZCBubyBsaXN0IHdhcyBwYXJzZWQKICAgICAgICAgICAgLy8g5Yig6Zmk6K2m5ZGK5raI5oGvCiAgICAgICAgICB9CiAgICAgICAgICBjYXRlZ29yaWVzLnZhbHVlID0gW2FsbENhdGVnb3J5XTsgLy8g6Iez5bCR5pi+56S6IuWFqOmDqOaWh+ahoyLliIbnsbsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5YiG57G75aSx6LSlOicsIGVycm9yKTsKICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+mUmeivr+WTjeW6lOeKtuaAgTonLCBlcnJvci5yZXNwb25zZS5zdGF0dXMpOwogICAgICAgICAgY29uc29sZS5lcnJvcign6ZSZ6K+v5ZON5bqU5pWw5o2uOicsIGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aXoOazleWKoOi9veefpeivhuW6k+WIhuexu++8jOivt+ajgOafpee9kee7nOi/nuaOpeaIluiBlOezu+euoeeQhuWRmCcpOwogICAgICAgIC8vIOehruS/neiHs+WwkeaciSLlhajpg6gi5YiG57G75Y+v5pi+56S6CiAgICAgICAgY2F0ZWdvcmllcy52YWx1ZSA9IFt7CiAgICAgICAgICBpZDogJ2FsbCcsCiAgICAgICAgICBuYW1lOiAn5YWo6YOo5paH5qGjJywKICAgICAgICAgIGljb246ICdGaWxlcycsCiAgICAgICAgICBjb2xvcjogJyMwMDdiZmYnLAogICAgICAgICAgZG9jdW1lbnRfY291bnQ6IDAKICAgICAgICB9XTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBjYXRlZ29yeUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGZldGNoRG9jdW1lbnRzID0gYXN5bmMgKCkgPT4gewogICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICAvLyDmnoTlu7rlj4LmlbDlr7nosaEKICAgICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgICBwYWdlOiBjdXJyZW50UGFnZS52YWx1ZSwKICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZVNpemUudmFsdWUsCiAgICAgICAgICBvcmRlcmluZzogc29ydE9yZGVyLnZhbHVlCiAgICAgICAgfTsKCiAgICAgICAgLy8g5re75Yqg562b6YCJ5p2h5Lu2CiAgICAgICAgaWYgKHNlbGVjdGVkQ2F0ZWdvcnkudmFsdWUgJiYgc2VsZWN0ZWRDYXRlZ29yeS52YWx1ZSAhPT0gJ2FsbCcpIHsKICAgICAgICAgIHBhcmFtcy5jYXRlZ29yeSA9IHNlbGVjdGVkQ2F0ZWdvcnkudmFsdWU7CiAgICAgICAgfQoKICAgICAgICAvLyDmt7vliqDmkJzntKLmn6Xor6IKICAgICAgICBpZiAoc2VhcmNoUXVlcnkudmFsdWUpIHsKICAgICAgICAgIHBhcmFtcy5zZWFyY2ggPSBzZWFyY2hRdWVyeS52YWx1ZTsKICAgICAgICB9CgogICAgICAgIC8vIOa3u+WKoOaWh+S7tuexu+Wei+etm+mAiQogICAgICAgIGNvbnN0IHNlbGVjdGVkVHlwZXMgPSBbXTsKICAgICAgICBmb3IgKGNvbnN0IFt0eXBlLCBzZWxlY3RlZF0gb2YgT2JqZWN0LmVudHJpZXMoZmlsdGVycy50eXBlcykpIHsKICAgICAgICAgIGlmIChzZWxlY3RlZCkgc2VsZWN0ZWRUeXBlcy5wdXNoKHR5cGUpOwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZWN0ZWRUeXBlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBwYXJhbXMuZmlsZV90eXBlID0gc2VsZWN0ZWRUeXBlcy5qb2luKCcsJyk7CiAgICAgICAgfQoKICAgICAgICAvLyDmt7vliqDnirbmgIHnrZvpgIkKICAgICAgICBpZiAoZmlsdGVycy5zdGF0dXMgIT09ICdhbGwnKSB7CiAgICAgICAgICBwYXJhbXMuc3RhdHVzID0gZmlsdGVycy5zdGF0dXM7CiAgICAgICAgfQoKICAgICAgICAvLyDmt7vliqDml6XmnJ/nrZvpgIkKICAgICAgICBpZiAoZmlsdGVycy5kYXRlICE9PSAnYWxsJykgewogICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICAgIGxldCBzdGFydERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgaWYgKGZpbHRlcnMuZGF0ZSA9PT0gJ3RvZGF5JykgewogICAgICAgICAgICBzdGFydERhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGZpbHRlcnMuZGF0ZSA9PT0gJ3dlZWsnKSB7CiAgICAgICAgICAgIHN0YXJ0RGF0ZS5zZXREYXRlKG5vdy5nZXREYXRlKCkgLSBub3cuZ2V0RGF5KCkpOwogICAgICAgICAgICBzdGFydERhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGZpbHRlcnMuZGF0ZSA9PT0gJ21vbnRoJykgewogICAgICAgICAgICBzdGFydERhdGUuc2V0RGF0ZSgxKTsKICAgICAgICAgICAgc3RhcnREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApOwogICAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXJzLmRhdGUgPT09ICdjdXN0b20nICYmIGZpbHRlcnMuZGF0ZVJhbmdlLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICBzdGFydERhdGUgPSBmaWx0ZXJzLmRhdGVSYW5nZVswXTsKICAgICAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGZpbHRlcnMuZGF0ZVJhbmdlWzFdOwogICAgICAgICAgICBwYXJhbXMuY3JlYXRlZF9hZnRlciA9IGZvcm1hdERhdGVGb3JBUEkoc3RhcnREYXRlKTsKICAgICAgICAgICAgcGFyYW1zLmNyZWF0ZWRfYmVmb3JlID0gZm9ybWF0RGF0ZUZvckFQSShlbmREYXRlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBhcmFtcy5jcmVhdGVkX2FmdGVyID0gZm9ybWF0RGF0ZUZvckFQSShzdGFydERhdGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50cyhwYXJhbXMpOwogICAgICAgIGlmIChyZXNwb25zZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ+iOt+WPluaWh+aho+WTjeW6lDonLCByZXNwb25zZSk7CgogICAgICAgICAgLy8g5aSE55CG5LiN5ZCM5qC85byP55qE5ZON5bqUCiAgICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLnJlc3VsdHMpKSB7CiAgICAgICAgICAgIC8vIOWIhumhteagvOW8j+eahOWTjeW6lAogICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSByZXNwb25zZS5yZXN1bHRzOwogICAgICAgICAgICB0b3RhbERvY3MudmFsdWUgPSByZXNwb25zZS5jb3VudCB8fCByZXNwb25zZS50b3RhbCB8fCBkb2N1bWVudHMudmFsdWUubGVuZ3RoOwogICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHJlc3BvbnNlKSkgewogICAgICAgICAgICAvLyDmlbDnu4TmoLzlvI/nmoTlk43lupQKICAgICAgICAgICAgZG9jdW1lbnRzLnZhbHVlID0gcmVzcG9uc2U7CiAgICAgICAgICAgIHRvdGFsRG9jcy52YWx1ZSA9IHJlc3BvbnNlLmxlbmd0aDsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEpKSB7CiAgICAgICAgICAgIC8vIOWPpuS4gOenjeW4uOingeeahOWvueixoeWMheijheagvOW8jwogICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICB0b3RhbERvY3MudmFsdWUgPSByZXNwb25zZS50b3RhbCB8fCByZXNwb25zZS5jb3VudCB8fCBkb2N1bWVudHMudmFsdWUubGVuZ3RoOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcmVzcG9uc2UgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgIC8vIOWwneivleaPkOWPluWPr+iDveeahOaWh+aho+WIl+ihqAogICAgICAgICAgICBjb25zdCBwb3NzaWJsZURvY3VtZW50cyA9IE9iamVjdC52YWx1ZXMocmVzcG9uc2UpLmZpbHRlcihpdGVtID0+IGl0ZW0gJiYgdHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmICgndGl0bGUnIGluIGl0ZW0gfHwgJ2ZpbGUnIGluIGl0ZW0pKTsKICAgICAgICAgICAgaWYgKHBvc3NpYmxlRG9jdW1lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBwb3NzaWJsZURvY3VtZW50czsKICAgICAgICAgICAgICB0b3RhbERvY3MudmFsdWUgPSBwb3NzaWJsZURvY3VtZW50cy5sZW5ndGg7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign5peg5rOV5LuO5ZON5bqU5Lit5o+Q5Y+W5paH5qGj5YiX6KGoOicsIHJlc3BvbnNlKTsKICAgICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICAgICAgICB0b3RhbERvY3MudmFsdWUgPSAwOwogICAgICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfojrflj5bmlofmoaPliJfooajmoLzlvI/lvILluLgnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign5paH5qGj5ZON5bqU5qC85byP5LiN5pSv5oyBOicsIHR5cGVvZiByZXNwb25zZSwgcmVzcG9uc2UpOwogICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICAgICAgdG90YWxEb2NzLnZhbHVlID0gMDsKICAgICAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+iOt+WPluaWh+aho+WIl+ihqOagvOW8j+S4jeaUr+aMgScpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICAgIHRvdGFsRG9jcy52YWx1ZSA9IDA7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluaWh+aho+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfml6Dms5XliqDovb3nn6Xor4blupPmlofmoaMnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBmZXRjaERvY3VtZW50Q2h1bmtzID0gYXN5bmMgZG9jdW1lbnRJZCA9PiB7CiAgICAgIGNodW5rc0xvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0RG9jdW1lbnRDaHVua3MoZG9jdW1lbnRJZCk7CiAgICAgICAgZG9jdW1lbnRDaHVua3MudmFsdWUgPSByZXNwb25zZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bmlofmoaPliIblnZflpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5rOV5Yqg6L295paH5qGj5YiG5Z2X5pWw5o2uJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgY2h1bmtzTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgaGFuZGxlUGFnZUNoYW5nZSA9IHBhZ2UgPT4gewogICAgICBjdXJyZW50UGFnZS52YWx1ZSA9IHBhZ2U7CiAgICAgIGZldGNoRG9jdW1lbnRzKCk7CiAgICB9OwogICAgY29uc3QgaGFuZGxlU2l6ZUNoYW5nZSA9IHNpemUgPT4gewogICAgICBwYWdlU2l6ZS52YWx1ZSA9IHNpemU7CiAgICAgIGN1cnJlbnRQYWdlLnZhbHVlID0gMTsKICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgIH07CiAgICBjb25zdCBzZWxlY3RDYXRlZ29yeSA9IGNhdGVnb3J5SWQgPT4gewogICAgICBzZWxlY3RlZENhdGVnb3J5LnZhbHVlID0gY2F0ZWdvcnlJZDsKICAgICAgY3VycmVudFBhZ2UudmFsdWUgPSAxOwogICAgICBmZXRjaERvY3VtZW50cygpOwogICAgfTsKICAgIGNvbnN0IGhhbmRsZVNlYXJjaCA9ICgpID0+IHsKICAgICAgY3VycmVudFBhZ2UudmFsdWUgPSAxOwogICAgICBmZXRjaERvY3VtZW50cygpOwogICAgfTsKICAgIGNvbnN0IGFwcGx5RmlsdGVycyA9ICgpID0+IHsKICAgICAgY3VycmVudFBhZ2UudmFsdWUgPSAxOwogICAgICBmZXRjaERvY3VtZW50cygpOwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSBmaWxlID0+IHsKICAgICAgY29uc29sZS5sb2coIj4+PiBoYW5kbGVGaWxlQ2hhbmdlOiBSZWNlaXZlZCBmaWxlIG9iamVjdCBmcm9tIGVsLXVwbG9hZDoiLCBmaWxlKTsKICAgICAgaWYgKGZpbGUgJiYgZmlsZS5yYXcpIHsKICAgICAgICBjb25zb2xlLmxvZygiPj4+IGhhbmRsZUZpbGVDaGFuZ2U6IGZpbGUucmF3ICh0aGUgYWN0dWFsIEZpbGUgb2JqZWN0KToiLCBmaWxlLnJhdyk7CgogICAgICAgIC8vIOajgOafpeaWh+S7tuWkp+Wwj+aYr+WQpuS4ujDvvIzov5nkvJrlr7zoh7TkuIrkvKDlpLHotKUKICAgICAgICBpZiAoZmlsZS5yYXcuc2l6ZSA9PT0gMCkgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmlofku7blpKflsI/kuLow77yM6K+36YCJ5oup5pyJ5pWI5paH5Lu2Jyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyDmo4Dmn6Xmlofku7bmmK/lkKbov4flpKfvvIjkvovlpoLotoXov4cxME1C77yJCiAgICAgICAgY29uc3QgbWF4U2l6ZUluQnl0ZXMgPSAxMCAqIDEwMjQgKiAxMDI0OyAvLyAxME1CCiAgICAgICAgaWYgKGZpbGUucmF3LnNpemUgPiBtYXhTaXplSW5CeXRlcykgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDmlofku7bov4flpKfvvIzmnIDlpKfmlK/mjIEke21heFNpemVJbkJ5dGVzIC8gKDEwMjQgKiAxMDI0KX1NQmApOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8g5Lil5qC85qOA5p+l5paH5Lu25omp5bGV5ZCN5piv5ZCm5pSv5oyBCiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLnJhdy5uYW1lOwogICAgICAgIGNvbnN0IGV4dCA9IGZpbGVOYW1lLnNsaWNlKGZpbGVOYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IGFsbG93ZWRGaWxlVHlwZXMgPSBbJ3R4dCcsICdwZGYnLCAnZG9jJywgJ2RvY3gnLCAnbWQnLCAncHB0JywgJ3BwdHgnLCAneGxzJywgJ3hsc3gnXTsKICAgICAgICBpZiAoIWFsbG93ZWRGaWxlVHlwZXMuaW5jbHVkZXMoZXh0KSkgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDkuI3mlK/mjIHnmoTmlofku7bnsbvlnos6ICR7ZXh0feOAguS7heaUr+aMgSAke2FsbG93ZWRGaWxlVHlwZXMuam9pbignLCAnKX0g5qC85byP44CCYCk7CiAgICAgICAgICAvLyDkuI3mlK/mjIHnmoTmlofku7bnsbvlnovkuI3lupTor6Xmm7TmlrB1cGxvYWRGb3JtLmZpbGUKICAgICAgICAgIHVwbG9hZEZvcm0uZmlsZSA9IG51bGw7CiAgICAgICAgICAvLyDmuIXpmaTkuIrkvKDnu4Tku7bkuK3mmL7npLrnmoTmlofku7YKICAgICAgICAgIGlmICh1cGxvYWRSZWYudmFsdWUpIHsKICAgICAgICAgICAgdXBsb2FkUmVmLnZhbHVlLmNsZWFyRmlsZXMoKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8vIOS7heWcqOmqjOivgemAmui/h+WQjuiuvue9ruaWh+S7tgogICAgICAgIHVwbG9hZEZvcm0uZmlsZSA9IGZpbGUucmF3OwogICAgICAgIGNvbnNvbGUubG9nKCI+Pj4gaGFuZGxlRmlsZUNoYW5nZTogdXBsb2FkRm9ybS5maWxlIGFmdGVyIGFzc2lnbm1lbnQ6IiwgdXBsb2FkRm9ybS5maWxlLCB1cGxvYWRGb3JtLmZpbGUgPyBgTmFtZTogJHt1cGxvYWRGb3JtLmZpbGUubmFtZX0sIFNpemU6ICR7dXBsb2FkRm9ybS5maWxlLnNpemV9IGJ5dGVzLCBUeXBlOiAke3VwbG9hZEZvcm0uZmlsZS50eXBlfWAgOiAnTm8gZmlsZScpOwogICAgICAgIHVwbG9hZEZvcm0udGl0bGUgPSB1cGxvYWRGb3JtLnRpdGxlIHx8IGZpbGUubmFtZS5zcGxpdCgnLicpWzBdOwoKICAgICAgICAvLyDov5Tlm550cnVl6KGo56S66aqM6K+B6YCa6L+HCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS53YXJuKCI+Pj4gaGFuZGxlRmlsZUNoYW5nZTogZmlsZS5yYXcgaXMgbm90IGF2YWlsYWJsZS4gRmlsZToiLCBmaWxlKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBoYW5kbGVSZW1vdmUgPSAoKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCI+Pj4gaGFuZGxlUmVtb3ZlOiBGaWxlIHJlbW92ZWQgYnkgdXNlci4gU2V0dGluZyB1cGxvYWRGb3JtLmZpbGUgdG8gbnVsbC4iKTsKICAgICAgdXBsb2FkRm9ybS5maWxlID0gbnVsbDsKCiAgICAgIC8vIOWmguaenOagh+mimOaYr+iHquWKqOS7juaWh+S7tuWQjeeUn+aIkOeahO+8jOS5n+a4hemZpOagh+mimAogICAgICBpZiAodXBsb2FkRm9ybS50aXRsZSAmJiB1cGxvYWRGb3JtLnRpdGxlLmluY2x1ZGVzKCcuJykpIHsKICAgICAgICB2YXIgX3VwbG9hZEZvcm0kZmlsZSwgX3VwbG9hZEZvcm0kZmlsZSRuYW1lOwogICAgICAgIGNvbnN0IGZpbGVOYW1lV2l0aG91dEV4dCA9IChfdXBsb2FkRm9ybSRmaWxlID0gdXBsb2FkRm9ybS5maWxlKSA9PT0gbnVsbCB8fCBfdXBsb2FkRm9ybSRmaWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3VwbG9hZEZvcm0kZmlsZSRuYW1lID0gX3VwbG9hZEZvcm0kZmlsZS5uYW1lKSA9PT0gbnVsbCB8fCBfdXBsb2FkRm9ybSRmaWxlJG5hbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF91cGxvYWRGb3JtJGZpbGUkbmFtZS5zcGxpdCgnLicpWzBdOwogICAgICAgIGlmICh1cGxvYWRGb3JtLnRpdGxlID09PSBmaWxlTmFtZVdpdGhvdXRFeHQpIHsKICAgICAgICAgIHVwbG9hZEZvcm0udGl0bGUgPSAnJzsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBiZWZvcmVVcGxvYWQgPSBmaWxlID0+IHsKICAgICAgLy8g6I635Y+W5paH5Lu25omp5bGV5ZCNCiAgICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5uYW1lOwogICAgICBjb25zdCBleHQgPSBmaWxlTmFtZS5zbGljZShmaWxlTmFtZS5sYXN0SW5kZXhPZignLicpICsgMSkudG9Mb3dlckNhc2UoKTsKCiAgICAgIC8vIOWFgeiuuOeahOaWh+S7tuexu+Wei+WIl+ihqAogICAgICBjb25zdCBhbGxvd2VkRmlsZVR5cGVzID0gWyd0eHQnLCAncGRmJywgJ2RvYycsICdkb2N4JywgJ21kJywgJ3BwdCcsICdwcHR4JywgJ3hscycsICd4bHN4J107CgogICAgICAvLyDkuKXmoLzmo4Dmn6Xmlofku7bnsbvlnosKICAgICAgaWYgKCFhbGxvd2VkRmlsZVR5cGVzLmluY2x1ZGVzKGV4dCkpIHsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoYOS4jeaUr+aMgeeahOaWh+S7tuexu+WeizogJHtleHR944CC5LuF5pSv5oyBICR7YWxsb3dlZEZpbGVUeXBlcy5qb2luKCcsICcpfSDmoLzlvI/jgIJgKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIC8vIOajgOafpeaWh+S7tuWkp+WwjwogICAgICBjb25zdCBtYXhTaXplSW5CeXRlcyA9IDEwICogMTAyNCAqIDEwMjQ7IC8vIDEwTUIKICAgICAgaWYgKGZpbGUuc2l6ZSA+IG1heFNpemVJbkJ5dGVzKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDmlofku7blpKflsI/otoXov4fpmZDliLbvvIzmnIDlpKfmlK/mjIEgJHttYXhTaXplSW5CeXRlcyAvICgxMDI0ICogMTAyNCl9TUJgKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIC8vIOajgOafpeaWh+S7tuaYr+WQpuS4uuepugogICAgICBpZiAoZmlsZS5zaXplID09PSAwKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmlofku7bkuLrnqbrvvIzor7fpgInmi6nmnInmlYjmlofku7YnKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgaGFuZGxlVXBsb2FkRXJyb3IgPSBlcnJvciA9PiB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4iuS8oOmUmeivrzonLCBlcnJvcik7CiAgICAgIEVsTWVzc2FnZS5lcnJvcign5LiK5Lyg6ZSZ6K+v77yM6K+35qOA5p+l5paH5Lu25qC85byP5oiW572R57uc6L+e5o6lJyk7CiAgICAgIC8vIOenu+mZpOmUmeivr+aWh+S7tgogICAgICB1cGxvYWRGb3JtLmZpbGUgPSBudWxsOwogICAgfTsKICAgIGNvbnN0IHN1Ym1pdFVwbG9hZCA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCF1cGxvYWRGb3JtUmVmLnZhbHVlKSByZXR1cm47CiAgICAgIGF3YWl0IHVwbG9hZEZvcm1SZWYudmFsdWUudmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdXBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgIGNvbnNvbGUubG9nKCI+Pj4gc3VibWl0VXBsb2FkOiBDdXJyZW50IHVwbG9hZEZvcm0uZmlsZSBiZWZvcmUgYXBwZW5kaW5nIHRvIEZvcm1EYXRhOiIsIHVwbG9hZEZvcm0uZmlsZSk7CiAgICAgICAgICBpZiAoIXVwbG9hZEZvcm0uZmlsZSkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIj4+PiBzdWJtaXRVcGxvYWQ6IHVwbG9hZEZvcm0uZmlsZSBpcyBudWxsIG9yIHVuZGVmaW5lZCBiZWZvcmUgYXBwZW5kaW5nLiIpOwogICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoIuivt+WFiOmAieaLqeaWh+S7tuWGjeS4iuS8oCIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgLy8g5YaN5qyh5qOA5p+l5paH5Lu25aSn5bCP77yM56Gu5L+d5LiN5piv56m65paH5Lu25oiW5o2f5Z2P5paH5Lu2CiAgICAgICAgICBpZiAodXBsb2FkRm9ybS5maWxlLnNpemUgPT09IDApIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiPj4+IHN1Ym1pdFVwbG9hZDog5paH5Lu25aSn5bCP5Li6MO+8jOaXoOazleS4iuS8oCIpOwogICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCLmlofku7blpKflsI/kuLow77yM6K+36YCJ5oup5pyJ5pWI5paH5Lu2Iik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKGA+Pj4gc3VibWl0VXBsb2FkOiB1cGxvYWRGb3JtLmZpbGUgZGV0YWlscyAtIE5hbWU6ICR7dXBsb2FkRm9ybS5maWxlLm5hbWV9LCBTaXplOiAke3VwbG9hZEZvcm0uZmlsZS5zaXplfSBieXRlcywgVHlwZTogJHt1cGxvYWRGb3JtLmZpbGUudHlwZX1gKTsKCiAgICAgICAgICAvLyDliJvlu7pmb3JtRGF0YeWvueixoe+8jOW5tua3u+WKoOaWh+S7tuWSjOWFtuS7luWPguaVsAogICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGl0bGUnLCB1cGxvYWRGb3JtLnRpdGxlKTsKICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZGVzY3JpcHRpb24nLCB1cGxvYWRGb3JtLmRlc2NyaXB0aW9uKTsKICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHVwbG9hZEZvcm0uZmlsZSk7IC8vIEFwcGVuZGluZyB0aGUgZmlsZQoKICAgICAgICAgIGlmICh1cGxvYWRGb3JtLmNhdGVnb3J5KSB7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY2F0ZWdvcnknLCB1cGxvYWRGb3JtLmNhdGVnb3J5KTsKICAgICAgICAgICAgY29uc29sZS5sb2coYD4+PiBzdWJtaXRVcGxvYWQ6IEF0dGFjaGluZyBjYXRlZ29yeSB0byBGb3JtRGF0YTogJHt1cGxvYWRGb3JtLmNhdGVnb3J5fWApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIj4+PiBzdWJtaXRVcGxvYWQ6IE5vIGNhdGVnb3J5IHNlbGVjdGVkICh1cGxvYWRGb3JtLmNhdGVnb3J5IGlzIG51bGwvZW1wdHkpLiBOb3QgYXR0YWNoaW5nIHRvIEZvcm1EYXRhLiIpOwogICAgICAgICAgfQogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd0YWdzJywgSlNPTi5zdHJpbmdpZnkodXBsb2FkRm9ybS50YWdzKSk7CiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NodW5rX3NpemUnLCB1cGxvYWRGb3JtLmNodW5rX3NpemUudG9TdHJpbmcoKSk7CiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NodW5rX292ZXJsYXAnLCB1cGxvYWRGb3JtLmNodW5rX292ZXJsYXAudG9TdHJpbmcoKSk7CiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2lzX3B1YmxpYycsIHVwbG9hZEZvcm0uaXNfcHVibGljLnRvU3RyaW5nKCkpOwoKICAgICAgICAgIC8vIOWGjeasoeajgOafpWZvcm1EYXRh5Lit55qE5paH5Lu25piv5ZCm5q2j56GuCiAgICAgICAgICBjb25zdCBmaWxlSW5Gb3JtRGF0YSA9IGZvcm1EYXRhLmdldCgnZmlsZScpOwogICAgICAgICAgaWYgKCFmaWxlSW5Gb3JtRGF0YSB8fCBmaWxlSW5Gb3JtRGF0YS5zaXplID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIj4+PiBzdWJtaXRVcGxvYWQ6IEZvcm1EYXRh5Lit55qE5paH5Lu25peg5pWI5oiW5aSn5bCP5Li6MCIpOwogICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCJGb3JtRGF0YeWkhOeQhuaWh+S7tuWksei0pe+8jOivt+mHjeivlSIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVwbG9hZERvY3VtZW50KGZvcm1EYXRhKTsgLy8gQXNzdW1pbmcgdXBsb2FkRG9jdW1lbnQgcmV0dXJucyB0aGUgbmV3IGRvY3VtZW50IG9iamVjdCBvciBpdHMgSUQKICAgICAgICAgICAgY29uc29sZS5sb2coIj4+PiBzdWJtaXRVcGxvYWQ6IEFQSSBSZXNwb25zZSBmcm9tIHVwbG9hZERvY3VtZW50OiIsIHJlc3BvbnNlKTsKICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+S4iuS8oOivt+axguW3suWPkemAge+8jOWQjuWPsOato+WcqOWkhOeQhi4uLicpOwogICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsgLy8g56Gu5L+d5LiK5Lyg54q25oCB6KKr6YeN572uCiAgICAgICAgICAgIHVwbG9hZFZpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgY29uc3QgdXBsb2FkZWRGaWxlVGl0bGUgPSB1cGxvYWRGb3JtLnRpdGxlOyAvLyBTdG9yZSB0aXRsZSBmb3IgcG9sbGluZyBjaGVjawogICAgICAgICAgICByZXNldFVwbG9hZEZvcm0oKTsKCiAgICAgICAgICAgIC8vIFN0YXJ0IHBvbGxpbmcgZm9yIGRvY3VtZW50IHN0YXR1cyBpZiByZXNwb25zZSBjb250YWlucyBhbiBJRCBvciBlbm91Z2ggaW5mbwogICAgICAgICAgICAvLyBGb3Igc2ltcGxpY2l0eSwgd2UnbGwgcG9sbCBmZXRjaERvY3VtZW50cyBhbmQgbG9vayBmb3IgdGhlIHRpdGxlLCBhc3N1bWluZyB0aXRsZXMgYXJlIHJlYXNvbmFibHkgdW5pcXVlIGZvciByZWNlbnQgdXBsb2Fkcy4KICAgICAgICAgICAgLy8gQSBtb3JlIHJvYnVzdCB3YXkgaXMgaWYgYmFja2VuZCByZXR1cm5zIHRoZSBuZXcgZG9jdW1lbnQgSUQsIGFuZCB3ZSBwb2xsIGEgZ2V0RG9jdW1lbnRCeUlkKGlkKSBlbmRwb2ludC4KICAgICAgICAgICAgLy8gT3IgaWYgdGhlIGRvY3VtZW50IG9iamVjdCBpbiBmZXRjaERvY3VtZW50cyBoYXMgYSBjbGVhciAnc3RhdHVzJyBmaWVsZCAoZS5nLiwgJ3Byb2Nlc3NpbmcnLCAnY29tcGxldGVkJykuCgogICAgICAgICAgICBsZXQgYXR0ZW1wdHMgPSAwOwogICAgICAgICAgICBjb25zdCBtYXhBdHRlbXB0cyA9IDEwOyAvLyBQb2xsIGZvciBtYXggMzAgc2Vjb25kcyAoMTAgYXR0ZW1wdHMgKiAzcyBpbnRlcnZhbCkKICAgICAgICAgICAgY29uc3QgcG9sbEludGVydmFsID0gMzAwMDsgLy8gMyBzZWNvbmRzCgogICAgICAgICAgICBjb25zdCBwb2xsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgIGF0dGVtcHRzKys7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYD4+PiBQb2xsaW5nIGZvciBkb2N1bWVudCBzdGF0dXMgKGF0dGVtcHQgJHthdHRlbXB0c30vJHttYXhBdHRlbXB0c30pLi4uYCk7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIEZldGNoIHRoZSBsaXN0IG9mIGRvY3VtZW50cywgdXN1YWxseSBzb3J0ZWQgYnkgY3JlYXRpb24gZGF0ZSBkZXNjZW5kaW5nCiAgICAgICAgICAgICAgICBjb25zdCBkb2N1bWVudHNSZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50cyh7CiAgICAgICAgICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogMTAsCiAgICAgICAgICAgICAgICAgIC8vIENoZWNrIHJlY2VudCBkb2N1bWVudHMKICAgICAgICAgICAgICAgICAgb3JkZXJpbmc6ICctY3JlYXRlZF9hdCcsCiAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBzZWxlY3RlZENhdGVnb3J5LnZhbHVlIHx8IHVuZGVmaW5lZCAvLyBVc2UgY3VycmVudCBjYXRlZ29yeSBvciBhbGwgaWYgJ2FsbCcKICAgICAgICAgICAgICAgICAgLy8gc2VhcmNoOiB1cGxvYWRlZEZpbGVUaXRsZSAvLyBPcHRpb25hbGx5LCBpZiBiYWNrZW5kIHN1cHBvcnRzIHNlYXJjaCBieSB0aXRsZSBmb3IgcmVjZW50IGl0ZW1zCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGxldCBmb3VuZERvYyA9IG51bGw7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRzUmVzcG9uc2UgJiYgZG9jdW1lbnRzUmVzcG9uc2UucmVzdWx0cyAmJiBkb2N1bWVudHNSZXNwb25zZS5yZXN1bHRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB0byBmaW5kIHRoZSBkb2N1bWVudCBieSB0aXRsZS4gVGhpcyBpcyBhIHNpbXBsaWZpY2F0aW9uLgogICAgICAgICAgICAgICAgICAvLyBJZGVhbGx5LCBiYWNrZW5kIHJldHVybnMgSUQgYW5kIHdlIHBvbGwgZm9yIHRoYXQgSUQsIG9yIGEgc3RhdHVzIGZpZWxkIGRpcmVjdGx5LgogICAgICAgICAgICAgICAgICBmb3VuZERvYyA9IGRvY3VtZW50c1Jlc3BvbnNlLnJlc3VsdHMuZmluZChkb2MgPT4gZG9jLnRpdGxlID09PSB1cGxvYWRlZEZpbGVUaXRsZSk7CgogICAgICAgICAgICAgICAgICAvLyBNT1JFIFJPQlVTVCBDSEVDSzogQXNzdW1lIGRvYyBvYmplY3QgaGFzIGEgJ3N0YXR1cycgZmllbGQgZnJvbSBiYWNrZW5kCiAgICAgICAgICAgICAgICAgIC8vIEV4YW1wbGU6IGlmIChkb2Muc3RhdHVzID09PSAnY29tcGxldGVkJykgeyAuLi4gfQogICAgICAgICAgICAgICAgICAvLyBGb3Igbm93LCBpZiB3ZSBmaW5kIGl0IGJ5IHRpdGxlIHJlY2VudGx5LCB3ZSBhc3N1bWUgaXQgbWlnaHQgYmUgcHJvY2Vzc2VkIG9yIHNvb24uCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZm91bmREb2MpIHsKICAgICAgICAgICAgICAgICAgLy8gTGV0J3MgYXNzdW1lIGlmIGZvdW5kIGJ5IHRpdGxlLCBpdCdzIHByb2Nlc3NlZCBlbm91Z2ggZm9yIGEgcmVmcmVzaC4KICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGlzIHdpdGggYWN0dWFsIHN0YXR1cyBjaGVjayBpZiBiYWNrZW5kIHByb3ZpZGVzICdzdGF0dXMnIGZpZWxkLgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgPj4+IFBvbGxpbmc6IERvY3VtZW50ICIke3VwbG9hZGVkRmlsZVRpdGxlfSIgZm91bmQgKG9yIGFzc3VtZWQgcHJvY2Vzc2VkKS4gUmVmcmVzaGluZyBsaXN0cy5gKTsKICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwb2xsKTsKICAgICAgICAgICAgICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgICAgICAgZmV0Y2hDYXRlZ29yaWVzKCk7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKGDmlofmoaMgIiR7dXBsb2FkZWRGaWxlVGl0bGV9IiDlpITnkIblrozmr5Xlubblt7LliLfmlrDliJfooaghYCk7CiAgICAgICAgICAgICAgICAgIC8vIOehruS/neaJgOacieeKtuaAgeato+ehrumHjee9rgogICAgICAgICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXR0ZW1wdHMgPj0gbWF4QXR0ZW1wdHMpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIj4+PiBQb2xsaW5nOiBNYXggYXR0ZW1wdHMgcmVhY2hlZC4gUmVmcmVzaGluZyBsaXN0cyBhbnl3YXkuIik7CiAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocG9sbCk7CiAgICAgICAgICAgICAgICAgIGZldGNoRG9jdW1lbnRzKCk7CiAgICAgICAgICAgICAgICAgIGZldGNoQ2F0ZWdvcmllcygpOwogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuaW5mbyhg5paH5qGjICIke3VwbG9hZGVkRmlsZVRpdGxlfSIg5Y+v6IO95LuN5Zyo5ZCO5Y+w5aSE55CG5Lit77yM5YiX6KGo5bey5Yi35paw44CCYCk7CiAgICAgICAgICAgICAgICAgIC8vIOehruS/neaJgOacieeKtuaAgeato+ehrumHjee9rgogICAgICAgICAgICAgICAgICB1cGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChwb2xsRXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIj4+PiBQb2xsaW5nIGVycm9yOiIsIHBvbGxFcnJvcik7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHBvbGwpOwogICAgICAgICAgICAgICAgLy8gU3RpbGwgcmVmcmVzaCwgYXMgdGhlIGRvY3VtZW50IG1pZ2h0IGJlIHRoZXJlIGRlc3BpdGUgcG9sbGluZyBlcnJvcgogICAgICAgICAgICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgICAgIGZldGNoQ2F0ZWdvcmllcygpOwogICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmo4Dmn6XmlofmoaPnirbmgIHml7blh7rplJnvvIzliJfooajlt7LliLfmlrDjgIInKTsKICAgICAgICAgICAgICAgIC8vIOehruS/neaJgOacieeKtuaAgeato+ehrumHjee9rgogICAgICAgICAgICAgICAgdXBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBwb2xsSW50ZXJ2YWwpOwogICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign5LiK5Lyg5paH5qGj5aSx6LSlOicsIGVycm9yKTsKICAgICAgICAgICAgdXBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgIC8vIOWcqOS4iuS8oOWksei0peaXtua4hemZpOaWh+S7tumAieaLqeeKtuaAgQogICAgICAgICAgICBpZiAodXBsb2FkUmVmLnZhbHVlKSB7CiAgICAgICAgICAgICAgdXBsb2FkUmVmLnZhbHVlLmNsZWFyRmlsZXMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgZXJyb3JNc2cgPSAn5paH5qGj5LiK5Lyg5aSx6LSlJzsKICAgICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZXJyb3IucmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSBlcnJvck1zZyArPSAnOiAnICsgZGF0YTtlbHNlIGlmIChkYXRhLmRldGFpbCkgZXJyb3JNc2cgKz0gJzogJyArIGRhdGEuZGV0YWlsO2Vsc2UgaWYgKGRhdGEubWVzc2FnZSkgZXJyb3JNc2cgKz0gJzogJyArIGRhdGEubWVzc2FnZTtlbHNlIGlmIChkYXRhLmZpbGUgJiYgQXJyYXkuaXNBcnJheShkYXRhLmZpbGUpKSBlcnJvck1zZyArPSAnOiAnICsgZGF0YS5maWxlLmpvaW4oJywgJyk7CiAgICAgICAgICAgICAgLy8g5aSE55CG54m55a6a55qE5paH5Lu257G75Z6L6ZSZ6K+vCiAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5zdGF0dXMgPT09ICdlcnJvcicgJiYgZGF0YS5tZXNzYWdlICYmIGRhdGEubWVzc2FnZS5pbmNsdWRlcygn5LiN5pSv5oyB55qE5paH5Lu257G75Z6LJykpIHsKICAgICAgICAgICAgICAgIGVycm9yTXNnID0gZGF0YS5tZXNzYWdlOyAvLyDnm7TmjqXkvb/nlKjlkI7nq6/nmoTplJnor6/mtojmga8KICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JykgZXJyb3JNc2cgKz0gJzogJyArIEpTT04uc3RyaW5naWZ5KGRhdGEpLnN1YnN0cmluZygwLCAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihlcnJvck1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBzdWJtaXQhISBGb3JtIHZhbGlkYXRpb24gZmFpbGVkLicpOwogICAgICAgICAgdXBsb2FkaW5nLnZhbHVlID0gZmFsc2U7IC8vIEVuc3VyZSB1cGxvYWRpbmcgaXMgcmVzZXQgaWYgdmFsaWRhdGlvbiBmYWlscwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3Qgc2hvd0RvY3VtZW50Q2h1bmtzID0gYXN5bmMgZG9jID0+IHsKICAgICAgc2VsZWN0ZWREb2N1bWVudC52YWx1ZSA9IGRvYzsKICAgICAgc2hvd0NodW5rc0RpYWxvZy52YWx1ZSA9IHRydWU7CiAgICAgIGF3YWl0IGZldGNoRG9jdW1lbnRDaHVua3MoZG9jLmlkKTsKICAgIH07CiAgICBjb25zdCBlZGl0Q2F0ZWdvcnkgPSBjYXRlZ29yeSA9PiB7CiAgICAgIGVkaXRpbmdDYXRlZ29yeS52YWx1ZSA9IGNhdGVnb3J5OwogICAgICBjYXRlZ29yeUZvcm0uaWQgPSBjYXRlZ29yeS5pZDsKICAgICAgY2F0ZWdvcnlGb3JtLm5hbWUgPSBjYXRlZ29yeS5uYW1lOwogICAgICBjYXRlZ29yeUZvcm0uZGVzY3JpcHRpb24gPSBjYXRlZ29yeS5kZXNjcmlwdGlvbiB8fCAnJzsKICAgICAgY2F0ZWdvcnlGb3JtLmljb24gPSBjYXRlZ29yeS5pY29uIHx8ICdEb2N1bWVudCc7CiAgICAgIGNhdGVnb3J5Rm9ybS5jb2xvciA9IGNhdGVnb3J5LmNvbG9yIHx8ICcjNDA5RUZGJzsKICAgICAgc2hvd0FkZENhdGVnb3J5Rm9ybS52YWx1ZSA9IHRydWU7IC8vIOaYvuekuue8lui+keihqOWNlQogICAgfTsKICAgIGNvbnN0IGhhbmRsZURlbGV0ZUNhdGVnb3J5ID0gYXN5bmMgY2F0ZWdvcnkgPT4gewogICAgICB0cnkgewogICAgICAgIGF3YWl0IEVsTWVzc2FnZUJveC5jb25maXJtKGDnoa7lrpropoHliKDpmaTliIbnsbsgIiR7Y2F0ZWdvcnkubmFtZX0iIOWQl++8n2AsICfliKDpmaTnoa7orqQnLCB7CiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgIH0pOwogICAgICAgIGF3YWl0IGRlbGV0ZUNhdGVnb3J5KGNhdGVnb3J5LmlkKTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5YiG57G75Yig6Zmk5oiQ5YqfJyk7CiAgICAgICAgZmV0Y2hDYXRlZ29yaWVzKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgaWYgKGVycm9yICE9PSAnY2FuY2VsJykgewogICAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZSwgX2Vycm9yJHJlc3BvbnNlJGRhdGE7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfliKDpmaTliIbnsbvlpLHotKU6JywgZXJyb3IpOwogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliKDpmaTliIbnsbvlpLHotKU6ICcgKyAoKChfZXJyb3IkcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2Vycm9yJHJlc3BvbnNlJGRhdGEgPSBfZXJyb3IkcmVzcG9uc2UuZGF0YSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZSRkYXRhLmRldGFpbCkgfHwgZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJykpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIGNvbnN0IHNhdmVDYXRlZ29yeUZvcm0gPSBhc3luYyAoKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCfkv53lrZjliIbnsbvooajljZXooqvosIPnlKjvvIzmqKHlvI86JywgZWRpdGluZ0NhdGVnb3J5LnZhbHVlID8gJ2VkaXQnIDogJ2FkZCcpOwogICAgICBzaG93QWRkQ2F0ZWdvcnlGb3JtLnZhbHVlID0gZmFsc2U7CiAgICAgIGlmIChlZGl0aW5nQ2F0ZWdvcnkudmFsdWUpIHsKICAgICAgICBjb25zb2xlLmxvZygn5bCd6K+V5pu05paw5YiG57G7OicsIGNhdGVnb3J5Rm9ybSk7CiAgICAgICAgaWYgKCFlZGl0aW5nQ2F0ZWdvcnkudmFsdWUuaWQpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5rOV5pu05paw5YiG57G777yM5pyq5om+5Yiw5b2T5YmN57yW6L6R55qE5YiG57G7SUQnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXBkYXRlQ2F0ZWdvcnkoZWRpdGluZ0NhdGVnb3J5LnZhbHVlLmlkLCBjYXRlZ29yeUZvcm0pOwogICAgICAgICAgY29uc29sZS5sb2coJ+abtOaWsOWIhuexu+WTjeW6lDonLCByZXNwb25zZSk7CiAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgKHJlc3BvbnNlLmlkIHx8IHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5pZCkpIHsKICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+WIhuexu+abtOaWsOaIkOWKnycpOwogICAgICAgICAgICBhd2FpdCBmZXRjaENhdGVnb3JpZXMoKTsgLy8g5Yi35paw5YiG57G75YiX6KGoCiAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjee8lui+keeahOWIhuexu+WwseaYr+mAieS4reeahOWIhuexu++8jOWPr+iDvemcgOimgeWIt+aWsOaWh+aho+WIl+ihqAogICAgICAgICAgICBpZiAoc2VsZWN0ZWRDYXRlZ29yeS52YWx1ZSA9PT0gKHJlc3BvbnNlLmlkIHx8IHJlc3BvbnNlLmRhdGEuaWQpKSB7CiAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5lcnJvcikgewogICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoYOabtOaWsOWIhuexu+Wksei0pTogJHtyZXNwb25zZS5lcnJvci5tZXNzYWdlIHx8ICfmnKrnn6XplJnor68nfWApOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5kZXRhaWwpIHsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDmm7TmlrDliIbnsbvlpLHotKU6ICR7cmVzcG9uc2UuZGV0YWlsfWApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmm7TmlrDliIbnsbvlpLHotKXvvIzlk43lupTmoLzlvI/kuI3nrKblkIjpooTmnJ/miJbml6BJROi/lOWbnicpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfmm7TmlrDliIbnsbvlpLHotKU6JywgZXJyb3IpOwogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmm7TmlrDliIbnsbvlpLHotKXvvIzor7fmo4Dmn6XnvZHnu5zmiJbogZTns7vnrqHnkIblkZgnKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ+Wwneivlea3u+WKoOaWsOWIhuexuzonLCBjYXRlZ29yeUZvcm0pOwogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFkZENhdGVnb3J5KGNhdGVnb3J5Rm9ybSk7CiAgICAgICAgICBjb25zb2xlLmxvZygn5re75Yqg5YiG57G75ZON5bqUOicsIHJlc3BvbnNlKTsKICAgICAgICAgIGlmIChyZXNwb25zZSAmJiAocmVzcG9uc2UuaWQgfHwgcmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmlkKSkgewogICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5YiG57G75re75Yqg5oiQ5YqfJyk7CiAgICAgICAgICAgIGF3YWl0IGZldGNoQ2F0ZWdvcmllcygpOyAvLyDliLfmlrDliIbnsbvliJfooagKICAgICAgICAgICAgLy8g6Ieq5Yqo6YCJ5Lit5paw5Yib5bu655qE5YiG57G75bm25Yi35paw5paH5qGj5YiX6KGoCiAgICAgICAgICAgIGNvbnN0IG5ld0NhdGVnb3J5SWQgPSByZXNwb25zZS5pZCB8fCByZXNwb25zZS5kYXRhLmlkOwogICAgICAgICAgICBpZiAobmV3Q2F0ZWdvcnlJZCkgewogICAgICAgICAgICAgIHNlbGVjdGVkQ2F0ZWdvcnkudmFsdWUgPSBuZXdDYXRlZ29yeUlkOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDmlrDliIbnsbvliJvlu7rmiJDlip/vvIzoh6rliqjpgInkuK3mlrDliIbnsbsgSUQ6ICR7bmV3Q2F0ZWdvcnlJZH1gKTsKICAgICAgICAgICAgICBhd2FpdCBmZXRjaERvY3VtZW50cygpOyAvLyDliLfmlrDmlofmoaPliJfooajku6XmmL7npLrmlrDpgInkuK3nmoTliIbnsbvvvIjliJ3lp4vkuLrnqbrvvIkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIuaWsOWIm+W7uueahOWIhuexu0lE5pyq5om+5Yiw77yM5peg5rOV6Ieq5Yqo6YCJ5Lit44CCIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZXJyb3IpIHsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDmt7vliqDliIbnsbvlpLHotKU6ICR7cmVzcG9uc2UuZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJ31gKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGV0YWlsKSB7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihg5re75Yqg5YiG57G75aSx6LSlOiAke3Jlc3BvbnNlLmRldGFpbH1gKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5re75Yqg5YiG57G75aSx6LSl77yM5ZON5bqU5qC85byP5LiN56ym5ZCI6aKE5pyf5oiW5pegSUTov5Tlm54nKTsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigi5re75Yqg5YiG57G75aSx6LSl77yM5ZON5bqUOiIsIHJlc3BvbnNlKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcign5re75Yqg5YiG57G75aSx6LSlOicsIGVycm9yKTsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5re75Yqg5YiG57G75aSx6LSl77yM6K+35qOA5p+l572R57uc5oiW6IGU57O7566h55CG5ZGYJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJlc2V0Q2F0ZWdvcnlGb3JtKCk7CiAgICB9OwogICAgY29uc3QgY2FuY2VsQ2F0ZWdvcnlGb3JtID0gKCkgPT4gewogICAgICBzaG93QWRkQ2F0ZWdvcnlGb3JtLnZhbHVlID0gZmFsc2U7CiAgICAgIGVkaXRpbmdDYXRlZ29yeS52YWx1ZSA9IG51bGw7CiAgICAgIGNhdGVnb3J5Rm9ybS5pZCA9IG51bGw7CiAgICAgIGNhdGVnb3J5Rm9ybS5uYW1lID0gJyc7CiAgICAgIGNhdGVnb3J5Rm9ybS5kZXNjcmlwdGlvbiA9ICcnOwogICAgICBjYXRlZ29yeUZvcm0uaWNvbiA9ICdEb2N1bWVudCc7CiAgICAgIGNhdGVnb3J5Rm9ybS5jb2xvciA9ICcjNDA5RUZGJzsKICAgIH07CiAgICBjb25zdCByZXNldENhdGVnb3J5Rm9ybSA9ICgpID0+IHsKICAgICAgZWRpdGluZ0NhdGVnb3J5LnZhbHVlID0gbnVsbDsKICAgICAgY2F0ZWdvcnlGb3JtLmlkID0gbnVsbDsKICAgICAgY2F0ZWdvcnlGb3JtLm5hbWUgPSAnJzsKICAgICAgY2F0ZWdvcnlGb3JtLmRlc2NyaXB0aW9uID0gJyc7CiAgICAgIGNhdGVnb3J5Rm9ybS5pY29uID0gJ0RvY3VtZW50JzsKICAgICAgY2F0ZWdvcnlGb3JtLmNvbG9yID0gJyM0MDlFRkYnOwogICAgICBzaG93QWRkQ2F0ZWdvcnlGb3JtLnZhbHVlID0gdHJ1ZTsKICAgIH07CiAgICBjb25zdCByZXNldFVwbG9hZEZvcm0gPSAoKSA9PiB7CiAgICAgIGlmICh1cGxvYWRGb3JtUmVmLnZhbHVlKSB7CiAgICAgICAgLy8g5L2/55SoZWwtZm9ybeeahHJlc2V0RmllbGRz5pa55rOV6YeN572u6KGo5Y2VCiAgICAgICAgdXBsb2FkRm9ybVJlZi52YWx1ZS5yZXNldEZpZWxkcygpOwogICAgICB9CgogICAgICAvLyDmiYvliqjph43nva7miYDmnIl1cGxvYWRGb3Jt5a2X5q6177yM56Gu5L+d5YWo6YOo5riF56m6CiAgICAgIHVwbG9hZEZvcm0udGl0bGUgPSAnJzsKICAgICAgdXBsb2FkRm9ybS5kZXNjcmlwdGlvbiA9ICcnOwogICAgICB1cGxvYWRGb3JtLmZpbGUgPSBudWxsOwogICAgICB1cGxvYWRGb3JtLmNhdGVnb3J5ID0gbnVsbDsgLy8gRXhwbGljaXRseSByZXNldCBjYXRlZ29yeQogICAgICB1cGxvYWRGb3JtLnRhZ3MgPSAnJzsKICAgICAgdXBsb2FkRm9ybS5pc19wdWJsaWMgPSB0cnVlOwogICAgICB1cGxvYWRGb3JtLmNodW5rX3NpemUgPSA1MDA7IC8vIOmHjee9ruS4uuWIneWni+m7mOiupOWAvAogICAgICB1cGxvYWRGb3JtLmNodW5rX292ZXJsYXAgPSA1MDsgLy8g6YeN572u5Li65Yid5aeL6buY6K6k5YC8CgogICAgICAvLyDmuIXpmaTkuIrkvKDnu4Tku7bkuK3nmoTmlofku7YKICAgICAgaWYgKHVwbG9hZFJlZi52YWx1ZSkgewogICAgICAgIHVwbG9hZFJlZi52YWx1ZS5jbGVhckZpbGVzKCk7CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coIj4+PiByZXNldFVwbG9hZEZvcm06IHVwbG9hZEZvcm3lkozkuIrkvKDnu4Tku7blt7Llrozlhajph43nva4iKTsKICAgIH07CiAgICBjb25zdCBoYW5kbGVDYW5jZWxVcGxvYWQgPSAoKSA9PiB7CiAgICAgIC8vIOWmguaenOato+WcqOS4iuS8oO+8jOS4jeWFgeiuuOWFs+mXrQogICAgICBpZiAodXBsb2FkaW5nLnZhbHVlKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+aWh+S7tuato+WcqOS4iuS8oOS4re+8jOivt+etieW+heS4iuS8oOWujOaIkCcpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICByZXNldFVwbG9hZEZvcm0oKTsKICAgICAgdXBsb2FkVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUNsb3NlVXBsb2FkRGlhbG9nID0gZG9uZSA9PiB7CiAgICAgIGhhbmRsZUNhbmNlbFVwbG9hZCgpOwogICAgICBkb25lKCk7IC8vIOWFgeiuuOWFs+mXreWvueivneahhgogICAgfTsKICAgIGNvbnN0IG9wZW5VcGxvYWREaWFsb2cgPSAoKSA9PiB7CiAgICAgIHJlc2V0VXBsb2FkRm9ybSgpOyAvLyBSZXNldCBmb3JtIGZpcnN0IGZvciBhIGNsZWFuIHN0YXRlCiAgICAgIGlmIChzZWxlY3RlZENhdGVnb3J5LnZhbHVlICYmIHNlbGVjdGVkQ2F0ZWdvcnkudmFsdWUgIT09ICdhbGwnKSB7CiAgICAgICAgdXBsb2FkRm9ybS5jYXRlZ29yeSA9IHNlbGVjdGVkQ2F0ZWdvcnkudmFsdWU7CiAgICAgICAgY29uc29sZS5sb2coYD4+PiBvcGVuVXBsb2FkRGlhbG9nOiBBdXRvLXNlbGVjdGluZyBjdXJyZW50IGNhdGVnb3J5OiAke3NlbGVjdGVkQ2F0ZWdvcnkudmFsdWV9YCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXBsb2FkRm9ybS5jYXRlZ29yeSA9IG51bGw7IC8vIElmICdhbGwnIG9yIG5vIGNhdGVnb3J5IGlzIHNlbGVjdGVkLCBsZXQgdXNlciBjaG9vc2UgaW4gZGlhbG9nCiAgICAgICAgY29uc29sZS5sb2coIj4+PiBvcGVuVXBsb2FkRGlhbG9nOiBObyBjYXRlZ29yeSBhdXRvLXNlbGVjdGVkIChjdXJyZW50IGlzICdhbGwnIG9yIG5vbmUpLiIpOwogICAgICB9CiAgICAgIHVwbG9hZFZpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKCiAgICAvLyDmlofku7bmk43kvZzlh73mlbAKICAgIGNvbnN0IHByZXZpZXdEb2N1bWVudCA9IGRvYyA9PiB7CiAgICAgIGlmIChkb2Muc3RhdHVzICE9PSAnY29tcGxldGVkJykgewogICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfmlofmoaPmraPlnKjlpITnkIbkuK3vvIzmmoLml7bml6Dms5XpooTop4gnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOWinuWKoOafpeeci+iuoeaVsAogICAgICBheGlvcy5nZXQoYCR7QVBJX1VSTH0vZG9jdW1lbnRzLyR7ZG9jLmlkfS9gKS5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcign5pu05paw5p+l55yL6K6h5pWw5aSx6LSlOicsIGVycikpOwoKICAgICAgLy8g6L+Z6YeM5bqU6K+l5a6e546w5paH5qGj6aKE6KeI5Yqf6IO9CiAgICAgIHdpbmRvdy5vcGVuKGRvYy5maWxlX3VybCwgJ19ibGFuaycpOwogICAgfTsKICAgIGNvbnN0IGRvd25sb2FkRG9jdW1lbnQgPSBhc3luYyBkb2MgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KGAke0FQSV9VUkx9L2RvY3VtZW50cy8ke2RvYy5pZH0vZG93bmxvYWQvYCwgewogICAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicKICAgICAgICB9KTsKCiAgICAgICAgLy8g5Yib5bu65Li05pe25LiL6L296ZO+5o6lCiAgICAgICAgY29uc3QgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKSk7CiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICBsaW5rLmhyZWYgPSB1cmw7CiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZG9jLnRpdGxlKTsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPkuIvovb3miJDlip8nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfkuIvovb3mlofmoaPlpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5LiL6L295paH5qGj5aSx6LSlJyk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBzaGFyZURvY3VtZW50ID0gZG9jID0+IHsKICAgICAgLy8g5a6e546w5paH5qGj5YiG5Lqr5Yqf6IO9CiAgICAgIGNvbnNvbGUubG9nKCflh4blpIfliIbkuqvmlofmoaM6JywgZG9jLnRpdGxlKTsKICAgICAgRWxNZXNzYWdlLmluZm8oYOaWh+ahoyIke2RvYy50aXRsZX0i55qE5YiG5Lqr5Yqf6IO95Y2z5bCG5LiK57q/YCk7CiAgICB9OwogICAgY29uc3QgZWRpdERvY3VtZW50ID0gZG9jID0+IHsKICAgICAgLy8g5a6e546w5paH5qGj57yW6L6R5Yqf6IO9CiAgICAgIGNvbnNvbGUubG9nKCflh4blpIfnvJbovpHmlofmoaM6JywgZG9jLnRpdGxlKTsKICAgICAgRWxNZXNzYWdlLmluZm8oYOaWh+ahoyIke2RvYy50aXRsZX0i55qE57yW6L6R5Yqf6IO95Y2z5bCG5LiK57q/YCk7CiAgICB9OwogICAgY29uc3QgZGVsZXRlRG9jdW1lbnQgPSBhc3luYyBkb2MgPT4gewogICAgICBjb25zb2xlLmxvZygnPj4+IFZ1ZSBjb21wb25lbnQ6IEF0dGVtcHRpbmcgdG8gZGVsZXRlIGRvY3VtZW50IChsb2NhbCBtZXRob2QpOicsIGRvYyk7IC8vIExvZyBlbnRyeQogICAgICB0cnkgewogICAgICAgIGF3YWl0IEVsTWVzc2FnZUJveC5jb25maXJtKGDnoa7lrpropoHliKDpmaTmlofmoaMgIiR7ZG9jLnRpdGxlfSIg5ZCX77yf5q2k5pON5L2c5LiN5Y+v5pKk6ZSA44CCYCwgJ+WIoOmZpOehruiupCcsIHsKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2coJz4+PiBWdWUgY29tcG9uZW50OiBDYWxsaW5nIGFwaURlbGV0ZURvY3VtZW50IGZvciBJRDonLCBkb2MuaWQpOyAvLyBMb2cgYmVmb3JlIEFQSSBjYWxsCiAgICAgICAgYXdhaXQgYXBpRGVsZXRlRG9jdW1lbnQoZG9jLmlkKTsgLy8gTU9ESUZJRUQ6IFVzZSBpbXBvcnRlZCBhbmQgcmVuYW1lZCBhcGlEZWxldGVEb2N1bWVudAoKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5qGj5Yig6Zmk5oiQ5YqfJyk7CiAgICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICBmZXRjaENhdGVnb3JpZXMoKTsgLy8g5pu05paw5YiG57G75paH5qGj6K6h5pWwCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgaWYgKGVycm9yICE9PSAnY2FuY2VsJykgewogICAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZTIsIF9lcnJvciRyZXNwb25zZTIkZGF0YTsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOaWh+aho+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgICAvLyDkvb/nlKjmm7TlronlhajnmoTplJnor6/mtojmga/mj5Dlj5YKICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IChlcnJvciA9PT0gbnVsbCB8fCBlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lcnJvciRyZXNwb25zZTIgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lcnJvciRyZXNwb25zZTIkZGF0YSA9IF9lcnJvciRyZXNwb25zZTIuZGF0YSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMiRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZXJyb3IkcmVzcG9uc2UyJGRhdGEuZGV0YWlsKSB8fCAoZXJyb3IgPT09IG51bGwgfHwgZXJyb3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVycm9yLm1lc3NhZ2UpIHx8ICfmnKrnn6XplJnor68nOwogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliKDpmaTmlofmoaPlpLHotKU6ICcgKyBlcnJvck1lc3NhZ2UpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyDojrflj5bmlofku7blm77moIcKICAgIGNvbnN0IGdldEZpbGVJY29uID0gdHlwZSA9PiB7CiAgICAgIGNvbnN0IGljb25NYXAgPSB7CiAgICAgICAgcGRmOiBEb2N1bWVudCwKICAgICAgICBkb2M6IERvY3VtZW50LAogICAgICAgIHhsczogRGF0YUFuYWx5c2lzLAogICAgICAgIHBwdDogVGlja2V0cywKICAgICAgICBpbWc6IFBpY3R1cmVGaWxsZWQsCiAgICAgICAgdHh0OiBGaWxlcywKICAgICAgICBvdGhlcjogRmlsZXMKICAgICAgfTsKICAgICAgcmV0dXJuIGljb25NYXBbdHlwZV0gfHwgRG9jdW1lbnQ7CiAgICB9OwoKICAgIC8vIOagvOW8j+WMluaXpeacnwogICAgY29uc3QgZm9ybWF0RGF0ZSA9IGRhdGVTdHJpbmcgPT4gewogICAgICBpZiAoIWRhdGVTdHJpbmcpIHJldHVybiAnJzsKICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpOwogICAgICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3poLUNOJywgewogICAgICAgIHllYXI6ICdudW1lcmljJywKICAgICAgICBtb250aDogJzItZGlnaXQnLAogICAgICAgIGRheTogJzItZGlnaXQnCiAgICAgIH0pOwogICAgfTsKCiAgICAvLyDmoLzlvI/ljJbml6XmnJ/kuLpBUEnmoLzlvI8KICAgIGNvbnN0IGZvcm1hdERhdGVGb3JBUEkgPSBkYXRlID0+IHsKICAgICAgaWYgKCFkYXRlKSByZXR1cm4gJyc7CiAgICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTsKICAgIH07CgogICAgLy8g5qC85byP5YyW5paH5Lu25aSn5bCPCiAgICBjb25zdCBmb3JtYXRGaWxlU2l6ZSA9IHNpemVJbktCID0+IHsKICAgICAgaWYgKCFzaXplSW5LQikgcmV0dXJuICcwIEtCJzsKICAgICAgaWYgKHNpemVJbktCIDwgMTAyNCkgewogICAgICAgIHJldHVybiBgJHtzaXplSW5LQn0gS0JgOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgJHsoc2l6ZUluS0IgLyAxMDI0KS50b0ZpeGVkKDIpfSBNQmA7CiAgICAgIH0KICAgIH07CgogICAgLy8g6I635Y+W5qCH562+5YiX6KGoCiAgICBjb25zdCBnZXRUYWdzTGlzdCA9IHRhZ3MgPT4gewogICAgICBpZiAoIXRhZ3MpIHJldHVybiBbXTsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFncykpIHJldHVybiB0YWdzOwogICAgICByZXR1cm4gdGFncy5zcGxpdCgnLCcpLm1hcCh0YWcgPT4gdGFnLnRyaW0oKSkuZmlsdGVyKHRhZyA9PiB0YWcpOwogICAgfTsKCiAgICAvLyDlpITnkIbmnoTlu7rlrozmiJAKICAgIGNvbnN0IGhhbmRsZUJ1aWxkQ29tcGxldGVkID0gKCkgPT4gewogICAgICAvLyDliLfmlrDmlofmoaPliJfooagKICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgZmV0Y2hDYXRlZ29yaWVzKCk7CiAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfnn6Xor4blupPmnoTlu7rlrozmiJDvvIznjrDlnKjlj6/ku6Xkvb/nlKjmmbrog73pl67nrZTlip/og73kuobvvIEnKTsKICAgIH07CgogICAgLy8g5aSE55CG5p6E5bu65aSx6LSlCiAgICBjb25zdCBoYW5kbGVCdWlsZEZhaWxlZCA9IGVycm9yID0+IHsKICAgICAgY29uc29sZS5lcnJvcign55+l6K+G5bqT5p6E5bu65aSx6LSlOicsIGVycm9yKTsKICAgICAgRWxNZXNzYWdlLmVycm9yKCfnn6Xor4blupPmnoTlu7rlpLHotKXvvIzor7fmo4Dmn6Xml6Xlv5fmiJbogZTns7vnrqHnkIblkZgnKTsKICAgIH07CgogICAgLy8g55Sf5ZG95ZGo5pyf6ZKp5a2QCiAgICBvbk1vdW50ZWQoKCkgPT4gewogICAgICAvLyDmt7vliqDliqDovb3nirbmgIHlkozplJnor6/lpITnkIYKICAgICAgUHJvbWlzZS5hbGwoW2ZldGNoQ2F0ZWdvcmllcygpLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yid5aeL5YyW5Yqg6L295YiG57G75aSx6LSlOicsIGVycik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3nn6Xor4blupPliIbnsbvlpLHotKXvvIzor7fnqI3lkI7ph43or5UnKTsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0pLCBmZXRjaERvY3VtZW50cygpLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yid5aeL5YyW5Yqg6L295paH5qGj5aSx6LSlOicsIGVycik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3nn6Xor4blupPmlofmoaPlpLHotKXvvIzor7fnqI3lkI7ph43or5UnKTsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0pXSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgLy8g5Yid5aeL5YyW5a6M5oiQ77yM5LiN6ZyA6KaB6L2u6K+iCiAgICAgICAgLy8gcG9sbEJ1aWxkU3RhdHVzKCk7CiAgICAgIH0pOwogICAgfSk7CiAgICBvbkJlZm9yZVVubW91bnQoKCkgPT4gewogICAgICAvLyDml6DpnIDmuIXpmaTvvIzlm6DkuLrmsqHmnInorr7nva7ova7or6IKICAgICAgLy8gaWYgKHBvbGxpbmdJbnRlcnZhbCkgewogICAgICAvLyAgIGNsZWFySW50ZXJ2YWwocG9sbGluZ0ludGVydmFsKQogICAgICAvLyB9CiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIHNlYXJjaFF1ZXJ5LAogICAgICBzZWxlY3RlZENhdGVnb3J5LAogICAgICBjYXRlZ29yaWVzLAogICAgICBkb2N1bWVudHMsCiAgICAgIGZpbHRlcnMsCiAgICAgIGN1cnJlbnRQYWdlLAogICAgICBwYWdlU2l6ZSwKICAgICAgdG90YWxEb2NzLAogICAgICB1cGxvYWRWaXNpYmxlLAogICAgICB1cGxvYWRGb3JtLAogICAgICB1cGxvYWRGb3JtUmVmLAogICAgICB1cGxvYWRSZWYsCiAgICAgIHVwbG9hZFJ1bGVzLAogICAgICB1cGxvYWRpbmcsCiAgICAgIGxvYWRpbmcsCiAgICAgIHZpZXdNb2RlLAogICAgICBzb3J0T3JkZXIsCiAgICAgIHNob3dDYXRlZ29yeURpYWxvZywKICAgICAgc2hvd0FkZENhdGVnb3J5Rm9ybSwKICAgICAgZWRpdGluZ0NhdGVnb3J5LAogICAgICBjYXRlZ29yeUZvcm0sCiAgICAgIGNhdGVnb3J5TG9hZGluZywKICAgICAgc2hvd0NodW5rc0RpYWxvZywKICAgICAgc2VsZWN0ZWREb2N1bWVudCwKICAgICAgZG9jdW1lbnRDaHVua3MsCiAgICAgIGNodW5rc0xvYWRpbmcsCiAgICAgIGlzQWRtaW4sCiAgICAgIGN1cnJlbnRDYXRlZ29yeU5hbWUsCiAgICAgIHByb2Nlc3NpbmdDb3VudCwKICAgICAgLy8g5Zu+5qCHCiAgICAgIFNlYXJjaCwKICAgICAgVXBsb2FkLAogICAgICBGb2xkZXJBZGQsCiAgICAgIFZpZXcsCiAgICAgIERvd25sb2FkLAogICAgICBNb3JlLAogICAgICBTaGFyZSwKICAgICAgRWRpdCwKICAgICAgRWRpdFBlbiwKICAgICAgRm9sZGVyT3BlbmVkLAogICAgICBTdGFyLAogICAgICBEZWxldGUsCiAgICAgIERvY3VtZW50LAogICAgICBGaWxlcywKICAgICAgVGlja2V0cywKICAgICAgRGF0YUFuYWx5c2lzLAogICAgICBQaWN0dXJlRmlsbGVkLAogICAgICBVcGxvYWRGaWxsZWQsCiAgICAgIExvYWRpbmcsCiAgICAgIExpc3QsCiAgICAgIEdyaWQsCiAgICAgIENyb3AsCiAgICAgIFBsdXMsCiAgICAgIC8vIOaWueazlQogICAgICBzZWxlY3RDYXRlZ29yeSwKICAgICAgaGFuZGxlU2VhcmNoLAogICAgICBhcHBseUZpbHRlcnMsCiAgICAgIGdldEZpbGVJY29uLAogICAgICBmb3JtYXREYXRlLAogICAgICBmb3JtYXRGaWxlU2l6ZSwKICAgICAgZ2V0VGFnc0xpc3QsCiAgICAgIHByZXZpZXdEb2N1bWVudCwKICAgICAgZG93bmxvYWREb2N1bWVudCwKICAgICAgc2hhcmVEb2N1bWVudCwKICAgICAgZWRpdERvY3VtZW50LAogICAgICBkZWxldGVEb2N1bWVudCwKICAgICAgaGFuZGxlRmlsZUNoYW5nZSwKICAgICAgaGFuZGxlUmVtb3ZlLAogICAgICBiZWZvcmVVcGxvYWQsCiAgICAgIGhhbmRsZVVwbG9hZEVycm9yLAogICAgICBzdWJtaXRVcGxvYWQsCiAgICAgIGhhbmRsZVBhZ2VDaGFuZ2UsCiAgICAgIGhhbmRsZVNpemVDaGFuZ2UsCiAgICAgIHNob3dEb2N1bWVudENodW5rcywKICAgICAgZWRpdENhdGVnb3J5LAogICAgICBoYW5kbGVEZWxldGVDYXRlZ29yeSwKICAgICAgc2F2ZUNhdGVnb3J5Rm9ybSwKICAgICAgY2FuY2VsQ2F0ZWdvcnlGb3JtLAogICAgICByZXNldENhdGVnb3J5Rm9ybSwKICAgICAgYnVpbGRpbmdWaXNpYmxlLAogICAgICBoYW5kbGVCdWlsZENvbXBsZXRlZCwKICAgICAgaGFuZGxlQnVpbGRGYWlsZWQsCiAgICAgIHJlc2V0VXBsb2FkRm9ybSwKICAgICAgaGFuZGxlQ2xvc2VVcGxvYWREaWFsb2csCiAgICAgIG9wZW5VcGxvYWREaWFsb2csCiAgICAgIGhhbmRsZUNhbmNlbFVwbG9hZAogICAgfTsKICB9Cn07"},{"version":3,"names":["ref","reactive","computed","onMounted","onBeforeUnmount","ElMessage","ElMessageBox","axios","Search","Upload","FolderAdd","View","Download","More","Share","Edit","EditPen","FolderOpened","Star","Delete","Document","Files","Tickets","DataAnalysis","PictureFilled","UploadFilled","Loading","List","Grid","Crop","Plus","getCategories","getDocuments","getDocumentChunks","uploadDocument","deleteDocument","apiDeleteDocument","deleteCategory","updateCategory","addCategory","KnowledgeBuilder","name","components","setup","API_URL","searchQuery","selectedCategory","currentPage","pageSize","uploadVisible","showCategoryDialog","showAddCategoryForm","showChunksDialog","editingCategory","viewMode","sortOrder","categoryLoading","loading","uploading","chunksLoading","isAdmin","selectedDocument","documentChunks","uploadFormRef","uploadRef","totalDocs","uploadForm","title","description","file","category","tags","chunk_size","chunk_overlap","is_public","uploadRules","required","message","trigger","categoryForm","id","icon","color","filters","types","pdf","doc","xls","ppt","img","txt","status","date","dateRange","categories","document_count","documents","currentCategoryName","value","find","cat","processingCount","filter","length","buildingVisible","fetchCategories","console","log","response","categoryList","results","Array","isArray","possibleArrayFields","field","grandTotalAllDocuments","allDocsResponse","page","page_size","Object","prototype","hasOwnProperty","call","count","warn","docError","error","allCategory","warning","data","fetchDocuments","params","ordering","search","selectedTypes","type","selected","entries","push","file_type","join","now","Date","startDate","setHours","setDate","getDate","getDay","endDate","created_after","formatDateForAPI","created_before","total","possibleDocuments","values","item","fetchDocumentChunks","documentId","handlePageChange","handleSizeChange","size","selectCategory","categoryId","handleSearch","applyFilters","handleFileChange","raw","maxSizeInBytes","fileName","ext","slice","lastIndexOf","toLowerCase","allowedFileTypes","includes","clearFiles","split","handleRemove","_uploadForm$file","_uploadForm$file$name","fileNameWithoutExt","beforeUpload","handleUploadError","submitUpload","validate","valid","formData","FormData","append","JSON","stringify","toString","fileInFormData","get","success","uploadedFileTitle","resetUploadForm","attempts","maxAttempts","pollInterval","poll","setInterval","documentsResponse","undefined","foundDoc","clearInterval","info","pollError","errorMsg","detail","substring","showDocumentChunks","editCategory","handleDeleteCategory","confirm","confirmButtonText","cancelButtonText","_error$response","_error$response$data","saveCategoryForm","newCategoryId","resetCategoryForm","cancelCategoryForm","resetFields","handleCancelUpload","handleCloseUploadDialog","done","openUploadDialog","previewDocument","catch","err","window","open","file_url","downloadDocument","responseType","url","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","removeChild","shareDocument","editDocument","_error$response2","_error$response2$data","errorMessage","getFileIcon","iconMap","other","formatDate","dateString","toLocaleDateString","year","month","day","toISOString","formatFileSize","sizeInKB","toFixed","getTagsList","map","tag","trim","handleBuildCompleted","handleBuildFailed","Promise","all","finally"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\knowledge\\Index.vue"],"sourcesContent":["<template>\n  <div class=\"knowledge-container\">\n    <div class=\"row\">\n      <!-- 左侧导航 -->\n      <div class=\"col-lg-3\">\n        <el-card class=\"category-card\">\n          <div class=\"search-box\">\n            <el-input \n              v-model=\"searchQuery\" \n              placeholder=\"搜索文档...\"\n              clearable\n              :prefix-icon=\"Search\"\n              @input=\"handleSearch\"\n            ></el-input>\n          </div>\n          \n          <div class=\"category-list\">\n            <div v-for=\"(category, index) in categories\" :key=\"category.id || index\" \n                 class=\"category-item\" \n                 :class=\"{'active': selectedCategory === (category.id || index)}\"\n                 @click=\"selectCategory(category.id || index)\">\n              <div class=\"category-icon\" :style=\"{'background-color': category.color}\">\n                <el-icon :size=\"20\" color=\"white\">\n                  <component :is=\"category.icon\"></component>\n                </el-icon>\n              </div>\n              <span class=\"category-name\">{{ category.name }}</span>\n              <span class=\"category-count\">{{ category.document_count || 0 }}</span>\n            </div>\n            \n            <el-button \n              v-if=\"isAdmin\"\n              type=\"primary\" \n              size=\"small\" \n              class=\"add-category-btn\"\n              @click=\"showCategoryDialog = true\">\n              <el-icon><Plus /></el-icon> 添加分类\n            </el-button>\n          </div>\n          \n          <div class=\"filter-section\">\n            <h6>筛选条件</h6>\n            <div class=\"filter-group\">\n              <h6>文件类型</h6>\n              <div class=\"filter-options\">\n                <el-checkbox v-model=\"filters.types.pdf\" @change=\"applyFilters\">PDF文档</el-checkbox>\n                <el-checkbox v-model=\"filters.types.doc\" @change=\"applyFilters\">Word文档</el-checkbox>\n                <el-checkbox v-model=\"filters.types.xls\" @change=\"applyFilters\">Excel表格</el-checkbox>\n                <el-checkbox v-model=\"filters.types.ppt\" @change=\"applyFilters\">PPT演示文稿</el-checkbox>\n                <el-checkbox v-model=\"filters.types.img\" @change=\"applyFilters\">图片</el-checkbox>\n                <el-checkbox v-model=\"filters.types.txt\" @change=\"applyFilters\">文本文件</el-checkbox>\n              </div>\n            </div>\n            \n            <div class=\"filter-group mt-3\">\n              <h6>文档状态</h6>\n              <div class=\"filter-options\">\n                <el-radio-group v-model=\"filters.status\" @change=\"applyFilters\">\n                  <el-radio :value=\"'all'\">全部状态</el-radio>\n                  <el-radio :value=\"'completed'\">处理完成</el-radio>\n                  <el-radio :value=\"'processing'\">处理中</el-radio>\n                  <el-radio :value=\"'pending'\">待处理</el-radio>\n                  <el-radio :value=\"'failed'\">处理失败</el-radio>\n                </el-radio-group>\n              </div>\n            </div>\n            \n            <div class=\"filter-group mt-3\">\n              <h6>创建日期</h6>\n              <div class=\"filter-options\">\n                <el-radio-group v-model=\"filters.date\" @change=\"applyFilters\">\n                  <el-radio :value=\"'all'\">全部时间</el-radio>\n                  <el-radio :value=\"'today'\">今天</el-radio>\n                  <el-radio :value=\"'week'\">本周</el-radio>\n                  <el-radio :value=\"'month'\">本月</el-radio>\n                  <el-radio :value=\"'custom'\">自定义</el-radio>\n                </el-radio-group>\n                <div v-if=\"filters.date === 'custom'\" class=\"mt-2\">\n                  <el-date-picker\n                    v-model=\"filters.dateRange\"\n                    type=\"daterange\"\n                    range-separator=\"至\"\n                    start-placeholder=\"开始日期\"\n                    end-placeholder=\"结束日期\"\n                    format=\"YYYY/MM/DD\"\n                    style=\"width: 100%\"\n                    @change=\"applyFilters\"\n                  ></el-date-picker>\n                </div>\n              </div>\n            </div>\n          </div>\n        </el-card>\n      </div>\n      \n      <!-- 右侧内容区 -->\n      <div class=\"col-lg-9\">\n        <el-card class=\"mb-3\">\n          <div class=\"card-header-flex\">\n            <div class=\"header-title\">\n              <span>{{ currentCategoryName }}</span>\n              <el-tag v-if=\"totalDocs > 0\" class=\"ml-2\">{{ totalDocs }}个文档</el-tag>\n            </div>\n            <div class=\"header-actions\">\n              <el-button type=\"primary\" @click=\"openUploadDialog\">\n                <el-icon><Upload /></el-icon> 上传文档\n              </el-button>\n              <el-button type=\"success\" @click=\"buildingVisible = true\">\n                <el-icon><Crop /></el-icon> 构建知识库\n              </el-button>\n              <el-button v-if=\"isAdmin\" @click=\"showCategoryDialog = true\">\n                <el-icon><FolderAdd /></el-icon> 管理分类\n              </el-button>\n            </div>\n          </div>\n          \n          <div class=\"upload-zone\" @click=\"openUploadDialog\" v-if=\"documents.length === 0\">\n            <el-icon class=\"upload-icon\"><Upload /></el-icon>\n            <div class=\"upload-text\">点击或拖拽文件到此处上传</div>\n            <div class=\"upload-hint\">支持单个或批量上传，最大支持10MB</div>\n          </div>\n          \n          <div v-else class=\"document-list\">\n            <div v-for=\"(doc, index) in documents\" :key=\"index\" class=\"document-card\">\n              <div class=\"document-icon\" :class=\"'icon-' + doc.type\">\n                <component :is=\"getFileIcon(doc.type)\"></component>\n              </div>\n              <div class=\"document-content\">\n                <div class=\"document-title\">{{ doc.title }}</div>\n                <div class=\"document-info\">\n                  <span>{{ doc.creator }} · {{ doc.date }}</span>\n                  <div class=\"document-tags\">\n                    <span v-for=\"(tag, i) in doc.tags\" :key=\"i\" class=\"tag\">{{ tag }}</span>\n                  </div>\n                </div>\n              </div>\n              <div class=\"document-actions\">\n                <el-button circle size=\"small\" @click.stop=\"previewDocument(doc)\">\n                  <el-icon><View /></el-icon>\n                </el-button>\n                <el-button circle size=\"small\" @click.stop=\"downloadDocument(doc)\">\n                  <el-icon><Download /></el-icon>\n                </el-button>\n                <el-dropdown trigger=\"click\" :teleported=\"true\">\n                  <el-button circle size=\"small\">\n                    <el-icon><More /></el-icon>\n                  </el-button>\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                      <el-dropdown-item @click=\"shareDocument(doc)\">\n                        <el-icon><Share /></el-icon> 分享\n                      </el-dropdown-item>\n                      <el-dropdown-item @click=\"editDocument(doc)\">\n                        <el-icon><Edit /></el-icon> 编辑\n                      </el-dropdown-item>\n                      <el-dropdown-item @click=\"renameDocument(doc)\">\n                        <el-icon><EditPen /></el-icon> 重命名\n                      </el-dropdown-item>\n                      <el-dropdown-item @click=\"moveDocument(doc)\">\n                        <el-icon><FolderOpened /></el-icon> 移动到\n                      </el-dropdown-item>\n                      <el-dropdown-item @click=\"starDocument(doc)\">\n                        <el-icon><Star /></el-icon> 收藏\n                      </el-dropdown-item>\n                      <el-dropdown-item divided @click=\"deleteDocument(doc)\">\n                        <el-icon><Delete /></el-icon> 删除\n                      </el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"pagination-container\">\n            <el-pagination\n              v-if=\"documents.length > 0\"\n              background\n              layout=\"sizes, prev, pager, next, total\"\n              :total=\"totalDocs\"\n              :page-size=\"pageSize\"\n              :page-sizes=\"[10, 20, 50, 100]\"\n              :current-page=\"currentPage\"\n              @current-change=\"handlePageChange\"\n              @size-change=\"handleSizeChange\"\n            ></el-pagination>\n          </div>\n        </el-card>\n      </div>\n    </div>\n    \n    <!-- 文件上传对话框 -->\n    <el-dialog\n      v-model=\"uploadVisible\"\n      title=\"上传文档\"\n      width=\"500px\"\n      :before-close=\"handleCloseUploadDialog\"\n    >\n      <el-form ref=\"uploadFormRef\" :model=\"uploadForm\" :rules=\"uploadRules\">\n        <el-form-item label=\"文档标题\" prop=\"title\">\n          <el-input v-model=\"uploadForm.title\" placeholder=\"请输入文档标题\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"文档描述\">\n          <el-input v-model=\"uploadForm.description\" type=\"textarea\" :rows=\"3\" placeholder=\"请输入文档描述\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"选择分类\">\n          <el-select v-model=\"uploadForm.category\" placeholder=\"请选择分类\" style=\"width: 100%\">\n            <el-option\n              v-for=\"(cat, idx) in categories.filter(c => c.id !== 'all')\"\n              :key=\"idx\"\n              :label=\"cat.name\"\n              :value=\"cat.id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"文档文件\" prop=\"file\">\n          <el-upload\n            class=\"upload-demo\"\n            drag\n            action=\"javascript:void(0);\"\n            :auto-upload=\"false\"\n            :on-change=\"handleFileChange\"\n            :on-remove=\"handleRemove\"\n            :limit=\"1\"\n            :before-upload=\"beforeUpload\"\n            :on-error=\"handleUploadError\"\n            ref=\"uploadRef\"\n          >\n            <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\n            <div class=\"el-upload__text\">\n              拖拽文件到此处或<em>点击上传</em>\n            </div>\n            <template #tip>\n              <div class=\"el-upload__tip\">\n                <strong>仅支持</strong>上传 txt, pdf, doc, docx, md, ppt, pptx, xls, xlsx 格式文件，单个文件不超过10MB\n              </div>\n            </template>\n          </el-upload>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"handleCancelUpload\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitUpload\" :loading=\"uploading\">上传</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 分类管理对话框 -->\n    <el-dialog\n      v-model=\"showCategoryDialog\"\n      title=\"分类管理\"\n      width=\"650px\"\n    >\n      <div class=\"category-dialog-content\">\n        <div class=\"category-list-section\">\n          <div class=\"section-header\">\n            <h5>已有分类</h5>\n            <el-button \n              type=\"primary\" \n              size=\"small\" \n              @click=\"resetCategoryForm\">\n              <el-icon><Plus /></el-icon> 新增分类\n            </el-button>\n          </div>\n          \n          <div v-if=\"categoryLoading\" class=\"text-center p-4\">\n            <el-icon class=\"is-loading\"><Loading /></el-icon> 加载中...\n          </div>\n          \n          <div v-else-if=\"categories.length <= 1\" class=\"empty-categories\">\n            <el-empty description=\"\" />\n          </div>\n          \n          <div v-else class=\"category-items\">\n            <div v-for=\"(category, index) in categories.filter(c => c.id !== 'all')\" :key=\"index\" class=\"category-list-item\">\n              <div class=\"category-info\">\n                <div class=\"category-color\" :style=\"{ backgroundColor: category.color }\"></div>\n                <div class=\"category-name-section\">\n                  <span class=\"category-name\">{{ category.name }}</span>\n                  <span class=\"category-desc\">{{ category.description }}</span>\n                </div>\n                <span class=\"category-count\">{{ category.document_count || 0 }}个文档</span>\n              </div>\n              \n              <div class=\"category-actions\">\n                <el-button type=\"primary\" size=\"small\" plain @click=\"editCategory(category)\">\n                  <el-icon><Edit /></el-icon>\n                </el-button>\n                <el-button type=\"danger\" size=\"small\" plain @click=\"handleDeleteCategory(category)\">\n                  <el-icon><Delete /></el-icon>\n                </el-button>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div v-if=\"showAddCategoryForm\" class=\"category-form-section\">\n          <div class=\"section-header\">\n            <h5>{{ editingCategory ? '编辑分类' : '新增分类' }}</h5>\n            <el-button size=\"small\" @click=\"cancelCategoryForm\">\n              取消\n            </el-button>\n          </div>\n          \n          <el-form :model=\"categoryForm\" label-width=\"80px\">\n            <el-form-item label=\"分类名称\" required>\n              <el-input v-model=\"categoryForm.name\" placeholder=\"请输入分类名称\"></el-input>\n            </el-form-item>\n            \n            <el-form-item label=\"分类描述\">\n              <el-input type=\"textarea\" v-model=\"categoryForm.description\" :rows=\"2\" placeholder=\"请输入分类描述\"></el-input>\n            </el-form-item>\n            \n            <el-form-item label=\"图标\">\n              <el-select v-model=\"categoryForm.icon\" placeholder=\"选择图标\" style=\"width: 100%\">\n                <el-option value=\"Document\" label=\"文档\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Document /></el-icon> <span class=\"ml-2\">文档</span>\n                  </div>\n                </el-option>\n                <el-option value=\"Files\" label=\"文件夹\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Files /></el-icon> <span class=\"ml-2\">文件夹</span>\n                  </div>\n                </el-option>\n                <el-option value=\"Tickets\" label=\"票据\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Tickets /></el-icon> <span class=\"ml-2\">票据</span>\n                  </div>\n                </el-option>\n                <el-option value=\"DataAnalysis\" label=\"数据分析\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><DataAnalysis /></el-icon> <span class=\"ml-2\">数据分析</span>\n                  </div>\n                </el-option>\n                <el-option value=\"PictureFilled\" label=\"图片\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><PictureFilled /></el-icon> <span class=\"ml-2\">图片</span>\n                  </div>\n                </el-option>\n              </el-select>\n            </el-form-item>\n            \n            <el-form-item label=\"颜色\">\n              <el-color-picker v-model=\"categoryForm.color\" show-alpha></el-color-picker>\n              <span class=\"ml-2\">{{ categoryForm.color }}</span>\n            </el-form-item>\n            \n            <el-form-item>\n              <el-button type=\"primary\" @click=\"saveCategoryForm\">保存</el-button>\n              <el-button @click=\"cancelCategoryForm\">取消</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!-- 知识库构建对话框组件 -->\n    <KnowledgeBuilder \n      v-model=\"buildingVisible\"\n      @build-completed=\"handleBuildCompleted\"\n      @build-failed=\"handleBuildFailed\"\n    />\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, onMounted, onBeforeUnmount } from 'vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport axios from 'axios'\nimport { \n  Search, Upload, FolderAdd, View, Download, More, Share, \n  Edit, EditPen, FolderOpened, Star, Delete, Document, \n  Files, Tickets, DataAnalysis, PictureFilled, UploadFilled,\n  Loading, List, Grid, Crop, Plus\n} from '@element-plus/icons-vue'\nimport { getCategories, getDocuments, getDocumentChunks, uploadDocument, deleteDocument as apiDeleteDocument, deleteCategory, updateCategory, addCategory } from '@/api/knowledge'\nimport KnowledgeBuilder from '@/components/KnowledgeBuilder.vue'\n\nexport default {\n  name: 'Knowledge',\n  components: {\n    KnowledgeBuilder\n  },\n  setup() {\n    const API_URL = '/api/knowledge'\n    \n    // 状态变量\n    const searchQuery = ref('')\n    const selectedCategory = ref('all')\n    const currentPage = ref(1)\n    const pageSize = ref(10)\n    const uploadVisible = ref(false)\n    const showCategoryDialog = ref(false)\n    const showAddCategoryForm = ref(false)\n    const showChunksDialog = ref(false)\n    const editingCategory = ref(null)\n    const viewMode = ref('list')\n    const sortOrder = ref('-created_at')\n    const categoryLoading = ref(false)\n    const loading = ref(false)\n    const uploading = ref(false)\n    const chunksLoading = ref(false)\n    const isAdmin = ref(true) // 实际应用中从用户会话获取\n    const selectedDocument = ref(null)\n    const documentChunks = ref([])\n    const uploadFormRef = ref(null)\n    const uploadRef = ref(null)\n    const totalDocs = ref(0)\n    \n    // 上传表单\n    const uploadForm = reactive({\n      title: '',\n      description: '',\n      file: null,\n      category: null,\n      tags: '',\n      chunk_size: 500,\n      chunk_overlap: 50,\n      is_public: true\n    })\n    \n    // 上传表单验证规则\n    const uploadRules = {\n      title: [\n        { required: true, message: '请输入文档标题', trigger: 'blur' }\n      ],\n      file: [\n        { required: true, message: '请上传文件', trigger: 'change' }\n      ]\n    }\n    \n    // 分类表单\n    const categoryForm = reactive({\n      id: null,\n      name: '',\n      description: '',\n      icon: 'Document',\n      color: '#409EFF'\n    })\n    \n    // 筛选条件\n    const filters = reactive({\n      types: {\n        pdf: false,\n        doc: false,\n        xls: false,\n        ppt: false,\n        img: false,\n        txt: false\n      },\n      status: 'all',\n      date: 'all',\n      dateRange: []\n    })\n    \n    // 知识分类\n    const categories = ref([\n      { id: 'all', name: '全部文档', icon: 'Files', color: '#007bff', document_count: 0 }\n    ])\n    \n    // 文档列表\n    const documents = ref([])\n    \n    // 计算属性\n    const currentCategoryName = computed(() => {\n      const category = categories.value.find(cat => cat.id === selectedCategory.value)\n      return category ? category.name : '全部文档'\n    })\n    \n    const processingCount = computed(() => {\n      return documents.value.filter(doc => doc.status === 'processing').length\n    })\n    \n    // 知识库构建相关状态\n    const buildingVisible = ref(false)\n    \n    // 方法\n    const fetchCategories = async () => {\n      categoryLoading.value = true\n      console.log('开始获取知识库分类...')\n      try {\n        // console.log('请求URL:', `${API_URL}/categories/`) // 已被实际API调用取代\n        const response = await getCategories() // API call for specific categories\n        console.log('获取分类响应:', response)\n        \n        let categoryList = []\n        \n        // 处理不同格式的响应 (for specific categories)\n        if (response) {\n          if (response.results && Array.isArray(response.results)) {\n            categoryList = response.results\n          } \n          else if (Array.isArray(response)) {\n            categoryList = response\n          } \n          else if (typeof response === 'object') {\n            const possibleArrayFields = ['data', 'categories', 'items'];\n            for (const field of possibleArrayFields) {\n              if (response[field] && Array.isArray(response[field])) {\n                categoryList = response[field];\n                break;\n              }\n            }\n          }\n        }\n\n        // Fetch the grand total of all documents\n        let grandTotalAllDocuments = 0;\n        try {\n          // Lightweight request to get the total count of all documents\n          const allDocsResponse = await getDocuments({ page: 1, page_size: 1 }); \n          if (allDocsResponse && Object.prototype.hasOwnProperty.call(allDocsResponse, 'count')) {\n            grandTotalAllDocuments = allDocsResponse.count;\n            console.log('获取到全部文档总数:', grandTotalAllDocuments);\n          } else {\n            console.warn('未能从 getDocuments 响应中获取总数 count:', allDocsResponse);\n          }\n        } catch (docError) {\n          console.error('获取全部文档总数失败:', docError);\n          // 保留 grandTotalAllDocuments = 0 或根据需要处理错误\n        }\n        \n        // 创建 \"全部文档\" 分类\n        const allCategory = { \n          id: 'all', \n          name: '全部文档', \n          icon: 'Files', \n          color: '#007bff', \n          document_count: grandTotalAllDocuments // 使用获取到的真实总数\n        }\n        \n        if (categoryList && categoryList.length > 0) {\n          console.log('找到分类数据，数量:', categoryList.length);\n          // 不再通过累加其他分类来计算 allCategory.document_count\n          categories.value = [allCategory, ...categoryList]\n        } else {\n          console.error('未找到有效的分类数据');\n          if (response && response.message) {\n            ElMessage.warning(response.message);\n          } else if (!response && !categoryList.length) { // Only show if response was truly empty and no list was parsed\n             // 删除警告消息\n          }\n          categories.value = [allCategory]; // 至少显示\"全部文档\"分类\n        }\n      } catch (error) {\n        console.error('获取分类失败:', error)\n        if (error.response) {\n          console.error('错误响应状态:', error.response.status)\n          console.error('错误响应数据:', error.response.data)\n        }\n        ElMessage.error('无法加载知识库分类，请检查网络连接或联系管理员')\n        // 确保至少有\"全部\"分类可显示\n        categories.value = [{ \n          id: 'all', \n          name: '全部文档', \n          icon: 'Files', \n          color: '#007bff', \n          document_count: 0 \n        }];\n      } finally {\n        categoryLoading.value = false\n      }\n    }\n    \n    const fetchDocuments = async () => {\n      loading.value = true\n      try {\n        // 构建参数对象\n        const params = {\n          page: currentPage.value,\n          page_size: pageSize.value,\n          ordering: sortOrder.value\n        }\n        \n        // 添加筛选条件\n        if (selectedCategory.value && selectedCategory.value !== 'all') {\n          params.category = selectedCategory.value\n        }\n        \n        // 添加搜索查询\n        if (searchQuery.value) {\n          params.search = searchQuery.value\n        }\n        \n        // 添加文件类型筛选\n        const selectedTypes = []\n        for (const [type, selected] of Object.entries(filters.types)) {\n          if (selected) selectedTypes.push(type)\n        }\n        if (selectedTypes.length > 0) {\n          params.file_type = selectedTypes.join(',')\n        }\n        \n        // 添加状态筛选\n        if (filters.status !== 'all') {\n          params.status = filters.status\n        }\n        \n        // 添加日期筛选\n        if (filters.date !== 'all') {\n          const now = new Date()\n          let startDate = new Date()\n          \n          if (filters.date === 'today') {\n            startDate.setHours(0, 0, 0, 0)\n          } else if (filters.date === 'week') {\n            startDate.setDate(now.getDate() - now.getDay())\n            startDate.setHours(0, 0, 0, 0)\n          } else if (filters.date === 'month') {\n            startDate.setDate(1)\n            startDate.setHours(0, 0, 0, 0)\n          } else if (filters.date === 'custom' && filters.dateRange.length === 2) {\n            startDate = filters.dateRange[0]\n            const endDate = filters.dateRange[1]\n            params.created_after = formatDateForAPI(startDate)\n            params.created_before = formatDateForAPI(endDate)\n          } else {\n            params.created_after = formatDateForAPI(startDate)\n          }\n        }\n        \n        const response = await getDocuments(params)\n        if (response) {\n          console.log('获取文档响应:', response)\n          \n          // 处理不同格式的响应\n          if (response.results && Array.isArray(response.results)) {\n            // 分页格式的响应\n            documents.value = response.results\n            totalDocs.value = response.count || response.total || documents.value.length\n          } else if (Array.isArray(response)) {\n            // 数组格式的响应\n            documents.value = response\n            totalDocs.value = response.length\n          } else if (response.data && Array.isArray(response.data)) {\n            // 另一种常见的对象包装格式\n            documents.value = response.data\n            totalDocs.value = response.total || response.count || documents.value.length\n          } else if (typeof response === 'object') {\n            // 尝试提取可能的文档列表\n            const possibleDocuments = Object.values(response).filter(item => \n              item && typeof item === 'object' && ('title' in item || 'file' in item)\n            )\n            if (possibleDocuments.length > 0) {\n              documents.value = possibleDocuments\n              totalDocs.value = possibleDocuments.length\n            } else {\n              console.error('无法从响应中提取文档列表:', response)\n              documents.value = []\n              totalDocs.value = 0\n              ElMessage.warning('获取文档列表格式异常')\n            }\n          } else {\n            console.error('文档响应格式不支持:', typeof response, response)\n            documents.value = []\n            totalDocs.value = 0\n            ElMessage.warning('获取文档列表格式不支持')\n          }\n        } else {\n          documents.value = []\n          totalDocs.value = 0\n        }\n      } catch (error) {\n        console.error('获取文档失败:', error)\n        ElMessage.error('无法加载知识库文档')\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    const fetchDocumentChunks = async (documentId) => {\n      chunksLoading.value = true\n      try {\n        const response = await getDocumentChunks(documentId)\n        documentChunks.value = response\n      } catch (error) {\n        console.error('获取文档分块失败:', error)\n        ElMessage.error('无法加载文档分块数据')\n      } finally {\n        chunksLoading.value = false\n      }\n    }\n    \n    const handlePageChange = (page) => {\n      currentPage.value = page\n      fetchDocuments()\n    }\n    \n    const handleSizeChange = (size) => {\n      pageSize.value = size\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const selectCategory = (categoryId) => {\n      selectedCategory.value = categoryId\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const handleSearch = () => {\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const applyFilters = () => {\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const handleFileChange = (file) => {\n      console.log(\">>> handleFileChange: Received file object from el-upload:\", file);\n      if (file && file.raw) {\n        console.log(\">>> handleFileChange: file.raw (the actual File object):\", file.raw);\n        \n        // 检查文件大小是否为0，这会导致上传失败\n        if (file.raw.size === 0) {\n          ElMessage.error('文件大小为0，请选择有效文件');\n          return false;\n        }\n        \n        // 检查文件是否过大（例如超过10MB）\n        const maxSizeInBytes = 10 * 1024 * 1024; // 10MB\n        if (file.raw.size > maxSizeInBytes) {\n          ElMessage.error(`文件过大，最大支持${maxSizeInBytes / (1024 * 1024)}MB`);\n          return false;\n        }\n        \n        // 严格检查文件扩展名是否支持\n        const fileName = file.raw.name;\n        const ext = fileName.slice(fileName.lastIndexOf('.') + 1).toLowerCase();\n        const allowedFileTypes = ['txt', 'pdf', 'doc', 'docx', 'md', 'ppt', 'pptx', 'xls', 'xlsx'];\n        \n        if (!allowedFileTypes.includes(ext)) {\n          ElMessage.error(`不支持的文件类型: ${ext}。仅支持 ${allowedFileTypes.join(', ')} 格式。`);\n          // 不支持的文件类型不应该更新uploadForm.file\n          uploadForm.file = null;\n          // 清除上传组件中显示的文件\n          if (uploadRef.value) {\n            uploadRef.value.clearFiles();\n          }\n          return false;\n        }\n        \n        // 仅在验证通过后设置文件\n        uploadForm.file = file.raw\n        console.log(\">>> handleFileChange: uploadForm.file after assignment:\", uploadForm.file, uploadForm.file ? `Name: ${uploadForm.file.name}, Size: ${uploadForm.file.size} bytes, Type: ${uploadForm.file.type}` : 'No file');\n        uploadForm.title = uploadForm.title || file.name.split('.')[0];\n        \n        // 返回true表示验证通过\n        return true;\n      } else {\n        console.warn(\">>> handleFileChange: file.raw is not available. File:\", file);\n        return false;\n      }\n    }\n    \n    const handleRemove = () => {\n      console.log(\">>> handleRemove: File removed by user. Setting uploadForm.file to null.\");\n      uploadForm.file = null;\n      \n      // 如果标题是自动从文件名生成的，也清除标题\n      if (uploadForm.title && uploadForm.title.includes('.')) {\n        const fileNameWithoutExt = uploadForm.file?.name?.split('.')[0];\n        if (uploadForm.title === fileNameWithoutExt) {\n          uploadForm.title = '';\n        }\n      }\n    }\n    \n    const beforeUpload = (file) => {\n      // 获取文件扩展名\n      const fileName = file.name;\n      const ext = fileName.slice(fileName.lastIndexOf('.') + 1).toLowerCase();\n      \n      // 允许的文件类型列表\n      const allowedFileTypes = ['txt', 'pdf', 'doc', 'docx', 'md', 'ppt', 'pptx', 'xls', 'xlsx'];\n      \n      // 严格检查文件类型\n      if (!allowedFileTypes.includes(ext)) {\n        ElMessage.error(`不支持的文件类型: ${ext}。仅支持 ${allowedFileTypes.join(', ')} 格式。`);\n        return false;\n      }\n      \n      // 检查文件大小\n      const maxSizeInBytes = 10 * 1024 * 1024; // 10MB\n      if (file.size > maxSizeInBytes) {\n        ElMessage.error(`文件大小超过限制，最大支持 ${maxSizeInBytes / (1024 * 1024)}MB`);\n        return false;\n      }\n      \n      // 检查文件是否为空\n      if (file.size === 0) {\n        ElMessage.error('文件为空，请选择有效文件');\n        return false;\n      }\n      \n      return true;\n    }\n    \n    const handleUploadError = (error) => {\n      console.error('上传错误:', error);\n      ElMessage.error('上传错误，请检查文件格式或网络连接');\n      // 移除错误文件\n      uploadForm.file = null;\n    }\n    \n    const submitUpload = async () => {\n      if (!uploadFormRef.value) return\n      \n      await uploadFormRef.value.validate(async (valid) => {\n        if (valid) {\n          uploading.value = true\n          \n          console.log(\">>> submitUpload: Current uploadForm.file before appending to FormData:\", uploadForm.file);\n          if (!uploadForm.file) {\n            console.warn(\">>> submitUpload: uploadForm.file is null or undefined before appending.\");\n            uploading.value = false;\n            ElMessage.warning(\"请先选择文件再上传\");\n            return;\n          }\n          \n          // 再次检查文件大小，确保不是空文件或损坏文件\n          if (uploadForm.file.size === 0) {\n            console.error(\">>> submitUpload: 文件大小为0，无法上传\");\n            uploading.value = false;\n            ElMessage.error(\"文件大小为0，请选择有效文件\");\n            return;\n          }\n          \n          console.log(`>>> submitUpload: uploadForm.file details - Name: ${uploadForm.file.name}, Size: ${uploadForm.file.size} bytes, Type: ${uploadForm.file.type}`);\n          \n          // 创建formData对象，并添加文件和其他参数\n          const formData = new FormData()\n          formData.append('title', uploadForm.title)\n          formData.append('description', uploadForm.description)\n          formData.append('file', uploadForm.file) // Appending the file\n          \n          if (uploadForm.category) {\n            formData.append('category', uploadForm.category)\n            console.log(`>>> submitUpload: Attaching category to FormData: ${uploadForm.category}`)\n          } else {\n            console.log(\">>> submitUpload: No category selected (uploadForm.category is null/empty). Not attaching to FormData.\")\n          }\n          \n          formData.append('tags', JSON.stringify(uploadForm.tags))\n          formData.append('chunk_size', uploadForm.chunk_size.toString())\n          formData.append('chunk_overlap', uploadForm.chunk_overlap.toString())\n          formData.append('is_public', uploadForm.is_public.toString())\n          \n          // 再次检查formData中的文件是否正确\n          const fileInFormData = formData.get('file');\n          if (!fileInFormData || fileInFormData.size === 0) {\n            console.error(\">>> submitUpload: FormData中的文件无效或大小为0\");\n            uploading.value = false;\n            ElMessage.error(\"FormData处理文件失败，请重试\");\n            return;\n          }\n\n          try {\n            const response = await uploadDocument(formData) // Assuming uploadDocument returns the new document object or its ID\n            console.log(\">>> submitUpload: API Response from uploadDocument:\", response);\n\n            ElMessage.success('文档上传请求已发送，后台正在处理...')\n            uploading.value = false // 确保上传状态被重置\n            uploadVisible.value = false\n            const uploadedFileTitle = uploadForm.title; // Store title for polling check\n            resetUploadForm()\n\n            // Start polling for document status if response contains an ID or enough info\n            // For simplicity, we'll poll fetchDocuments and look for the title, assuming titles are reasonably unique for recent uploads.\n            // A more robust way is if backend returns the new document ID, and we poll a getDocumentById(id) endpoint.\n            // Or if the document object in fetchDocuments has a clear 'status' field (e.g., 'processing', 'completed').\n            \n            let attempts = 0;\n            const maxAttempts = 10; // Poll for max 30 seconds (10 attempts * 3s interval)\n            const pollInterval = 3000; // 3 seconds\n\n            const poll = setInterval(async () => {\n              attempts++;\n              console.log(`>>> Polling for document status (attempt ${attempts}/${maxAttempts})...`);\n              try {\n                // Fetch the list of documents, usually sorted by creation date descending\n                const documentsResponse = await getDocuments({ \n                  page: 1, \n                  page_size: 10, // Check recent documents\n                  ordering: '-created_at', \n                  category: selectedCategory.value || undefined, // Use current category or all if 'all'\n                  // search: uploadedFileTitle // Optionally, if backend supports search by title for recent items\n                });\n\n                let foundDoc = null;\n                if (documentsResponse && documentsResponse.results && documentsResponse.results.length > 0) {\n                  // Attempt to find the document by title. This is a simplification.\n                  // Ideally, backend returns ID and we poll for that ID, or a status field directly.\n                  foundDoc = documentsResponse.results.find(doc => doc.title === uploadedFileTitle);\n                  \n                  // MORE ROBUST CHECK: Assume doc object has a 'status' field from backend\n                  // Example: if (doc.status === 'completed') { ... }\n                  // For now, if we find it by title recently, we assume it might be processed or soon.\n                }\n\n                if (foundDoc) {\n                  // Let's assume if found by title, it's processed enough for a refresh.\n                  // Replace this with actual status check if backend provides 'status' field.\n                  console.log(`>>> Polling: Document \"${uploadedFileTitle}\" found (or assumed processed). Refreshing lists.`);\n                  clearInterval(poll);\n                  fetchDocuments();\n                  fetchCategories();\n                  ElMessage.success(`文档 \"${uploadedFileTitle}\" 处理完毕并已刷新列表!`);\n                  // 确保所有状态正确重置\n                  uploading.value = false;\n                } else if (attempts >= maxAttempts) {\n                  console.log(\">>> Polling: Max attempts reached. Refreshing lists anyway.\");\n                  clearInterval(poll);\n                  fetchDocuments();\n                  fetchCategories();\n                  ElMessage.info(`文档 \"${uploadedFileTitle}\" 可能仍在后台处理中，列表已刷新。`);\n                  // 确保所有状态正确重置\n                  uploading.value = false;\n                }\n              } catch (pollError) {\n                console.error(\">>> Polling error:\", pollError);\n                clearInterval(poll);\n                // Still refresh, as the document might be there despite polling error\n                fetchDocuments();\n                fetchCategories();\n                ElMessage.error('检查文档状态时出错，列表已刷新。');\n                // 确保所有状态正确重置\n                uploading.value = false;\n              }\n            }, pollInterval);\n\n          } catch (error) {\n            console.error('上传文档失败:', error)\n            uploading.value = false;\n            // 在上传失败时清除文件选择状态\n            if (uploadRef.value) {\n              uploadRef.value.clearFiles();\n            }\n            let errorMsg = '文档上传失败'\n            if (error.response && error.response.data) {\n              const data = error.response.data;\n              if (typeof data === 'string') errorMsg += ': ' + data;\n              else if (data.detail) errorMsg += ': ' + data.detail;\n              else if (data.message) errorMsg += ': ' + data.message;\n              else if (data.file && Array.isArray(data.file)) errorMsg += ': ' + data.file.join(', ');\n              // 处理特定的文件类型错误\n              else if (data.status === 'error' && data.message && data.message.includes('不支持的文件类型')) {\n                errorMsg = data.message; // 直接使用后端的错误消息\n              }\n              else if (typeof data === 'object') errorMsg += ': ' + JSON.stringify(data).substring(0, 100);\n            }\n            ElMessage.error(errorMsg);\n          }\n        } else {\n          console.log('error submit!! Form validation failed.');\n          uploading.value = false; // Ensure uploading is reset if validation fails\n          return false;\n        }\n      })\n    }\n    \n    const showDocumentChunks = async (doc) => {\n      selectedDocument.value = doc\n      showChunksDialog.value = true\n      await fetchDocumentChunks(doc.id)\n    }\n    \n    const editCategory = (category) => {\n      editingCategory.value = category\n      categoryForm.id = category.id\n      categoryForm.name = category.name\n      categoryForm.description = category.description || ''\n      categoryForm.icon = category.icon || 'Document'\n      categoryForm.color = category.color || '#409EFF'\n      showAddCategoryForm.value = true // 显示编辑表单\n    }\n    \n    const handleDeleteCategory = async (category) => {\n      try {\n        await ElMessageBox.confirm(`确定要删除分类 \"${category.name}\" 吗？`, '删除确认', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n        \n        await deleteCategory(category.id)\n        ElMessage.success('分类删除成功')\n        fetchCategories()\n      } catch (error) {\n        if (error !== 'cancel') {\n          console.error('删除分类失败:', error)\n          ElMessage.error('删除分类失败: ' + (error.response?.data?.detail || error.message || '未知错误'))\n        }\n      }\n    }\n    \n    const saveCategoryForm = async () => {\n      console.log('保存分类表单被调用，模式:', editingCategory.value ? 'edit' : 'add')\n      showAddCategoryForm.value = false\n      if (editingCategory.value) {\n        console.log('尝试更新分类:', categoryForm)\n        if (!editingCategory.value.id) {\n            ElMessage.error('无法更新分类，未找到当前编辑的分类ID');\n            return;\n        }\n        try {\n          const response = await updateCategory(editingCategory.value.id, categoryForm)\n          console.log('更新分类响应:', response)\n          if (response && (response.id || (response.data && response.data.id))) {\n            ElMessage.success('分类更新成功')\n            await fetchCategories() // 刷新分类列表\n            // 如果当前编辑的分类就是选中的分类，可能需要刷新文档列表\n            if (selectedCategory.value === (response.id || response.data.id)) {\n              await fetchDocuments();\n            }\n          } else if (response && response.error) {\n            ElMessage.error(`更新分类失败: ${response.error.message || '未知错误'}`)\n          } else if (response && response.detail) {\n             ElMessage.error(`更新分类失败: ${response.detail}`)\n          }\n          else {\n            ElMessage.error('更新分类失败，响应格式不符合预期或无ID返回')\n          }\n        } catch (error) {\n          console.error('更新分类失败:', error)\n          ElMessage.error('更新分类失败，请检查网络或联系管理员')\n        }\n      } else {\n        console.log('尝试添加新分类:', categoryForm)\n        try {\n          const response = await addCategory(categoryForm)\n          console.log('添加分类响应:', response)\n          if (response && (response.id || (response.data && response.data.id))) {\n            ElMessage.success('分类添加成功')\n            await fetchCategories() // 刷新分类列表\n            // 自动选中新创建的分类并刷新文档列表\n            const newCategoryId = response.id || response.data.id;\n            if (newCategoryId) {\n              selectedCategory.value = newCategoryId;\n              console.log(`新分类创建成功，自动选中新分类 ID: ${newCategoryId}`);\n              await fetchDocuments(); // 刷新文档列表以显示新选中的分类（初始为空）\n            } else {\n              console.warn(\"新创建的分类ID未找到，无法自动选中。\");\n            }\n          } else if (response && response.error) {\n            ElMessage.error(`添加分类失败: ${response.error.message || '未知错误'}`)\n          } else if (response && response.detail) {\n             ElMessage.error(`添加分类失败: ${response.detail}`)\n          }\n           else {\n            ElMessage.error('添加分类失败，响应格式不符合预期或无ID返回')\n            console.error(\"添加分类失败，响应:\", response);\n          }\n        } catch (error) {\n          console.error('添加分类失败:', error)\n          ElMessage.error('添加分类失败，请检查网络或联系管理员')\n        }\n      }\n      resetCategoryForm()\n    }\n    \n    const cancelCategoryForm = () => {\n      showAddCategoryForm.value = false\n      editingCategory.value = null\n      categoryForm.id = null\n      categoryForm.name = ''\n      categoryForm.description = ''\n      categoryForm.icon = 'Document'\n      categoryForm.color = '#409EFF'\n    }\n    \n    const resetCategoryForm = () => {\n      editingCategory.value = null\n      categoryForm.id = null\n      categoryForm.name = ''\n      categoryForm.description = ''\n      categoryForm.icon = 'Document'\n      categoryForm.color = '#409EFF'\n      showAddCategoryForm.value = true\n    }\n    \n    const resetUploadForm = () => {\n      if (uploadFormRef.value) {\n        // 使用el-form的resetFields方法重置表单\n        uploadFormRef.value.resetFields(); \n      }\n      \n      // 手动重置所有uploadForm字段，确保全部清空\n      uploadForm.title = ''\n      uploadForm.description = ''\n      uploadForm.file = null\n      uploadForm.category = null // Explicitly reset category\n      uploadForm.tags = ''\n      uploadForm.is_public = true\n      uploadForm.chunk_size = 500 // 重置为初始默认值\n      uploadForm.chunk_overlap = 50 // 重置为初始默认值\n      \n      // 清除上传组件中的文件\n      if (uploadRef.value) {\n        uploadRef.value.clearFiles();\n      }\n      \n      console.log(\">>> resetUploadForm: uploadForm和上传组件已完全重置\");\n    }\n    \n    const handleCancelUpload = () => {\n      // 如果正在上传，不允许关闭\n      if (uploading.value) {\n        ElMessage.warning('文件正在上传中，请等待上传完成');\n        return;\n      }\n      resetUploadForm();\n      uploadVisible.value = false;\n    }\n    \n    const handleCloseUploadDialog = (done) => {\n      handleCancelUpload();\n      done(); // 允许关闭对话框\n    }\n    \n    const openUploadDialog = () => {\n      resetUploadForm(); // Reset form first for a clean state\n      if (selectedCategory.value && selectedCategory.value !== 'all') {\n        uploadForm.category = selectedCategory.value;\n        console.log(`>>> openUploadDialog: Auto-selecting current category: ${selectedCategory.value}`);\n      } else {\n        uploadForm.category = null; // If 'all' or no category is selected, let user choose in dialog\n        console.log(\">>> openUploadDialog: No category auto-selected (current is 'all' or none).\");\n      }\n      uploadVisible.value = true;\n    };\n    \n    // 文件操作函数\n    const previewDocument = (doc) => {\n      if (doc.status !== 'completed') {\n        ElMessage.warning('文档正在处理中，暂时无法预览')\n        return\n      }\n      \n      // 增加查看计数\n      axios.get(`${API_URL}/documents/${doc.id}/`)\n        .catch(err => console.error('更新查看计数失败:', err))\n      \n      // 这里应该实现文档预览功能\n      window.open(doc.file_url, '_blank')\n    }\n    \n    const downloadDocument = async (doc) => {\n      try {\n        const response = await axios.get(`${API_URL}/documents/${doc.id}/download/`, {\n          responseType: 'blob'\n        })\n        \n        // 创建临时下载链接\n        const url = window.URL.createObjectURL(new Blob([response.data]))\n        const link = document.createElement('a')\n        link.href = url\n        link.setAttribute('download', doc.title)\n        document.body.appendChild(link)\n        link.click()\n        document.body.removeChild(link)\n        \n        ElMessage.success('文档下载成功')\n      } catch (error) {\n        console.error('下载文档失败:', error)\n        ElMessage.error('下载文档失败')\n      }\n    }\n    \n    const shareDocument = (doc) => {\n      // 实现文档分享功能\n      console.log('准备分享文档:', doc.title)\n      ElMessage.info(`文档\"${doc.title}\"的分享功能即将上线`)\n    }\n    \n    const editDocument = (doc) => {\n      // 实现文档编辑功能\n      console.log('准备编辑文档:', doc.title)\n      ElMessage.info(`文档\"${doc.title}\"的编辑功能即将上线`)\n    }\n    \n    const deleteDocument = async (doc) => {\n      console.log('>>> Vue component: Attempting to delete document (local method):', doc); // Log entry\n      try {\n        await ElMessageBox.confirm(`确定要删除文档 \"${doc.title}\" 吗？此操作不可撤销。`, '删除确认', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n        \n        console.log('>>> Vue component: Calling apiDeleteDocument for ID:', doc.id); // Log before API call\n        await apiDeleteDocument(doc.id) // MODIFIED: Use imported and renamed apiDeleteDocument\n        \n        ElMessage.success('文档删除成功')\n        fetchDocuments()\n        fetchCategories() // 更新分类文档计数\n      } catch (error) {\n        if (error !== 'cancel') {\n          console.error('删除文档失败:', error)\n          // 使用更安全的错误消息提取\n          const errorMessage = error?.response?.data?.detail || error?.message || '未知错误';\n          ElMessage.error('删除文档失败: ' + errorMessage);\n        }\n      }\n    }\n    \n    // 获取文件图标\n    const getFileIcon = (type) => {\n      const iconMap = {\n        pdf: Document,\n        doc: Document,\n        xls: DataAnalysis,\n        ppt: Tickets,\n        img: PictureFilled,\n        txt: Files,\n        other: Files\n      }\n      return iconMap[type] || Document\n    }\n    \n    // 格式化日期\n    const formatDate = (dateString) => {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      })\n    }\n    \n    // 格式化日期为API格式\n    const formatDateForAPI = (date) => {\n      if (!date) return ''\n      return date.toISOString().split('T')[0]\n    }\n    \n    // 格式化文件大小\n    const formatFileSize = (sizeInKB) => {\n      if (!sizeInKB) return '0 KB'\n      \n      if (sizeInKB < 1024) {\n        return `${sizeInKB} KB`\n      } else {\n        return `${(sizeInKB / 1024).toFixed(2)} MB`\n      }\n    }\n    \n    // 获取标签列表\n    const getTagsList = (tags) => {\n      if (!tags) return []\n      if (Array.isArray(tags)) return tags\n      return tags.split(',').map(tag => tag.trim()).filter(tag => tag)\n    }\n    \n    // 处理构建完成\n    const handleBuildCompleted = () => {\n      // 刷新文档列表\n      fetchDocuments()\n      fetchCategories()\n      ElMessage.success('知识库构建完成，现在可以使用智能问答功能了！')\n    }\n\n    // 处理构建失败\n    const handleBuildFailed = (error) => {\n      console.error('知识库构建失败:', error)\n      ElMessage.error('知识库构建失败，请检查日志或联系管理员')\n    }\n    \n    // 生命周期钩子\n    onMounted(() => {\n      // 添加加载状态和错误处理\n      Promise.all([\n        fetchCategories().catch(err => {\n          console.error('初始化加载分类失败:', err);\n          ElMessage.error('加载知识库分类失败，请稍后重试');\n          return [];\n        }),\n        fetchDocuments().catch(err => {\n          console.error('初始化加载文档失败:', err);\n          ElMessage.error('加载知识库文档失败，请稍后重试');\n          return [];\n        })\n      ]).finally(() => {\n        // 初始化完成，不需要轮询\n        // pollBuildStatus();\n      });\n    })\n    \n    onBeforeUnmount(() => {\n      // 无需清除，因为没有设置轮询\n      // if (pollingInterval) {\n      //   clearInterval(pollingInterval)\n      // }\n    })\n    \n    return {\n      searchQuery,\n      selectedCategory,\n      categories,\n      documents,\n      filters,\n      currentPage,\n      pageSize,\n      totalDocs,\n      uploadVisible,\n      uploadForm,\n      uploadFormRef,\n      uploadRef,\n      uploadRules,\n      uploading,\n      loading,\n      viewMode,\n      sortOrder,\n      showCategoryDialog,\n      showAddCategoryForm,\n      editingCategory,\n      categoryForm,\n      categoryLoading,\n      showChunksDialog,\n      selectedDocument,\n      documentChunks,\n      chunksLoading,\n      isAdmin,\n      currentCategoryName,\n      processingCount,\n      \n      // 图标\n      Search,\n      Upload,\n      FolderAdd,\n      View,\n      Download,\n      More,\n      Share,\n      Edit,\n      EditPen,\n      FolderOpened,\n      Star,\n      Delete,\n      Document,\n      Files,\n      Tickets,\n      DataAnalysis,\n      PictureFilled,\n      UploadFilled,\n      Loading,\n      List,\n      Grid,\n      Crop,\n      Plus,\n      \n      // 方法\n      selectCategory,\n      handleSearch,\n      applyFilters,\n      getFileIcon,\n      formatDate,\n      formatFileSize,\n      getTagsList,\n      previewDocument,\n      downloadDocument,\n      shareDocument,\n      editDocument,\n      deleteDocument,\n      handleFileChange,\n      handleRemove,\n      beforeUpload,\n      handleUploadError,\n      submitUpload,\n      handlePageChange,\n      handleSizeChange,\n      showDocumentChunks,\n      editCategory,\n      handleDeleteCategory,\n      saveCategoryForm,\n      cancelCategoryForm,\n      resetCategoryForm,\n      buildingVisible,\n      handleBuildCompleted,\n      handleBuildFailed,\n      resetUploadForm,\n      handleCloseUploadDialog,\n      openUploadDialog,\n      handleCancelUpload\n    }\n  }\n}\n</script>\n\n<style scoped>\n.knowledge-container {\n  padding: 20px;\n}\n\n.category-card {\n  height: calc(100vh - 150px);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.search-box {\n  margin-bottom: 20px;\n}\n\n.category-list {\n  flex: 1;\n  overflow-y: auto;\n  padding-right: 5px;\n  margin-bottom: 15px;\n}\n\n.card-header-flex {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-bottom: 15px;\n  margin-bottom: 15px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.header-title {\n  font-weight: 600;\n  font-size: 18px;\n  display: flex;\n  align-items: center;\n}\n\n.header-title .el-tag {\n  margin-left: 10px;\n}\n\n.category-item {\n  display: flex;\n  align-items: center;\n  padding: 12px 15px;\n  border-radius: 8px;\n  margin-bottom: 10px;\n  transition: all 0.2s;\n  color: #495057;\n  cursor: pointer;\n  background-color: #f8f9fa;\n}\n\n.category-item:hover {\n  background-color: #e9ecef;\n  transform: translateY(-2px);\n}\n\n.category-item.active {\n  background-color: #e9f4ff;\n  color: #007bff;\n  font-weight: 500;\n  box-shadow: 0 2px 6px rgba(0, 123, 255, 0.15);\n}\n\n.category-icon {\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 15px;\n}\n\n.category-name {\n  font-weight: 500;\n  flex: 1;\n}\n\n.category-count {\n  background-color: #e9ecef;\n  border-radius: 15px;\n  padding: 2px 10px;\n  font-size: 12px;\n  color: #6c757d;\n}\n\n.add-category-btn {\n  width: 100%;\n  margin-top: 10px;\n}\n\n.filter-section {\n  margin-top: 20px;\n  padding-top: 20px;\n  border-top: 1px solid #f0f0f0;\n  overflow-y: auto;\n}\n\n.filter-section h6 {\n  margin-bottom: 10px;\n  font-weight: 600;\n  color: #495057;\n}\n\n.filter-group {\n  margin-bottom: 15px;\n}\n\n.filter-options {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.document-list {\n  margin-top: 20px;\n}\n\n.view-controls {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 15px;\n}\n\n.list-view {\n  margin-bottom: 20px;\n}\n\n.grid-view {\n  margin-bottom: 20px;\n}\n\n.document-card {\n  display: flex;\n  padding: 15px;\n  border-radius: 8px;\n  background-color: #fff;\n  margin-bottom: 15px;\n  transition: all 0.2s;\n  border: 1px solid #f0f0f0;\n  align-items: center;\n}\n\n.document-card:hover {\n  box-shadow: 0 5px 15px rgba(0,0,0,0.08);\n  transform: translateY(-2px);\n}\n\n.document-card.processing {\n  background-color: #fff9e6;\n  border-color: #ffd04b;\n}\n\n.document-icon {\n  width: 45px;\n  height: 45px;\n  border-radius: 5px;\n  margin-right: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 22px;\n  color: white;\n}\n\n.document-content {\n  flex: 1;\n}\n\n.document-title {\n  font-weight: 500;\n  margin-bottom: 5px;\n  display: flex;\n  align-items: center;\n}\n\n.document-title .el-tag {\n  margin-left: 10px;\n  font-weight: normal;\n}\n\n.document-info {\n  color: #6c757d;\n  font-size: 13px;\n}\n\n.document-meta {\n  display: flex;\n  gap: 15px;\n  margin-top: 5px;\n  color: #909399;\n}\n\n.meta-item {\n  display: flex;\n  align-items: center;\n  gap: 5px;\n}\n\n.document-tags {\n  margin-top: 5px;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 5px;\n}\n\n.document-progress {\n  margin-top: 10px;\n  padding: 8px;\n  background-color: #f8f9fa;\n  border-radius: 4px;\n}\n\n.progress-info {\n  margin-top: 5px;\n  font-size: 12px;\n  color: #606266;\n}\n\n.document-actions {\n  display: flex;\n  gap: 5px;\n}\n\n.icon-pdf {\n  background-color: #dc3545;\n}\n\n.icon-doc {\n  background-color: #007bff;\n}\n\n.icon-xls {\n  background-color: #28a745;\n}\n\n.icon-ppt {\n  background-color: #fd7e14;\n}\n\n.icon-img {\n  background-color: #6f42c1;\n}\n\n.icon-txt {\n  background-color: #17a2b8;\n}\n\n.icon-other {\n  background-color: #6c757d;\n}\n\n.grid-card {\n  height: 220px;\n  border-radius: 8px;\n  margin-bottom: 20px;\n  border: 1px solid #f0f0f0;\n  overflow: hidden;\n  transition: all 0.2s;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n}\n\n.grid-card:hover {\n  box-shadow: 0 5px 15px rgba(0,0,0,0.08);\n  transform: translateY(-5px);\n}\n\n.grid-card-icon {\n  height: 120px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 42px;\n}\n\n.grid-card-content {\n  padding: 12px;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n}\n\n.grid-card-title {\n  font-weight: 500;\n  margin-bottom: 8px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.grid-card-meta {\n  display: flex;\n  justify-content: space-between;\n  color: #909399;\n  font-size: 12px;\n  margin-bottom: 8px;\n}\n\n.grid-card-status {\n  margin-bottom: 8px;\n}\n\n.grid-card-actions {\n  margin-top: auto;\n  display: flex;\n  justify-content: flex-end;\n  gap: 5px;\n}\n\n.upload-zone {\n  border: 2px dashed #ced4da;\n  border-radius: 10px;\n  padding: 40px 30px;\n  text-align: center;\n  cursor: pointer;\n  transition: all 0.2s;\n  margin-top: 20px;\n}\n\n.upload-zone:hover {\n  border-color: #007bff;\n  background-color: #f8f9fa;\n}\n\n.upload-icon {\n  font-size: 48px;\n  color: #6c757d;\n  margin-bottom: 15px;\n}\n\n.upload-text {\n  font-size: 18px;\n  color: #495057;\n  margin-bottom: 10px;\n}\n\n.upload-hint {\n  font-size: 14px;\n  color: #6c757d;\n  margin-bottom: 20px;\n}\n\n.upload-features {\n  display: flex;\n  justify-content: center;\n  margin-top: 30px;\n  gap: 30px;\n}\n\n.feature-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  color: #495057;\n}\n\n.feature-item .el-icon {\n  font-size: 32px;\n  margin-bottom: 8px;\n  color: #007bff;\n}\n\n.tag {\n  display: inline-block;\n  padding: 2px 10px;\n  background-color: #e9ecef;\n  border-radius: 15px;\n  font-size: 12px;\n  color: #495057;\n}\n\n.pagination-container {\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n}\n\n.knowledge-status-bar {\n  margin-bottom: 15px;\n}\n\n.processing-info {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  font-size: 14px;\n  color: #e6a23c;\n}\n\n.form-help-text {\n  font-size: 12px;\n  color: #909399;\n  margin-top: 5px;\n}\n\n.category-row {\n  display: flex;\n  align-items: center;\n}\n\n.category-color {\n  width: 20px;\n  height: 20px;\n  border-radius: 4px;\n  margin-right: 10px;\n}\n\n.dialog-add-section {\n  margin-top: 20px;\n  text-align: center;\n}\n\n.category-form {\n  margin-top: 20px;\n}\n\n.chunks-container {\n  max-height: 500px;\n  overflow-y: auto;\n}\n\n.chunk-item {\n  margin-bottom: 15px;\n  border: 1px solid #f0f0f0;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.chunk-header {\n  display: flex;\n  justify-content: space-between;\n  background-color: #f8f9fa;\n  padding: 10px 15px;\n}\n\n.chunk-index {\n  font-weight: 500;\n}\n\n.chunk-meta {\n  color: #909399;\n  font-size: 13px;\n}\n\n.chunk-content {\n  padding: 15px;\n  white-space: pre-wrap;\n  line-height: 1.6;\n}\n\n.category-dialog-content {\n  display: flex;\n  flex-direction: column;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 15px;\n}\n\n.section-header h5 {\n  margin: 0;\n  font-weight: 600;\n}\n\n.category-list-section {\n  margin-bottom: 20px;\n}\n\n.category-items {\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.category-list-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 15px;\n  border-radius: 6px;\n  margin-bottom: 10px;\n  background-color: #f8f9fa;\n  transition: all 0.2s;\n}\n\n.category-list-item:hover {\n  background-color: #f0f2f5;\n  transform: translateY(-2px);\n}\n\n.category-info {\n  display: flex;\n  align-items: center;\n  flex: 1;\n}\n\n.category-color {\n  width: 16px;\n  height: 16px;\n  border-radius: 3px;\n  margin-right: 12px;\n}\n\n.category-name-section {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n}\n\n.category-name {\n  font-weight: 500;\n}\n\n.category-desc {\n  font-size: 12px;\n  color: #909399;\n  margin-top: 2px;\n}\n\n.category-count {\n  font-size: 13px;\n  color: #606266;\n  margin-left: 10px;\n}\n\n.category-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.category-form-section {\n  padding: 15px;\n  border-radius: 6px;\n  background-color: #f8f9fa;\n  margin-top: 20px;\n}\n\n.empty-categories {\n  padding: 40px 0;\n  text-align: center;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}