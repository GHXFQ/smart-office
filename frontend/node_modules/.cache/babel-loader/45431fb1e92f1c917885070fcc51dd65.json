{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\admin\\UserManagement.vue?vue&type=script&setup=true&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\admin\\UserManagement.vue","mtime":1750382437623},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVmLCByZWFjdGl2ZSwgb25Nb3VudGVkIH0gZnJvbSAndnVlJzsKaW1wb3J0IGFkbWluQXBpIGZyb20gJ0AvYXBpL2FkbWluJzsKaW1wb3J0IHsgRWxNZXNzYWdlLCBFbE1lc3NhZ2VCb3gsIEVsQ2FyZCwgRWxJY29uLCBFbElucHV0LCBFbEJ1dHRvbiwgRWxUYWJsZSwgRWxUYWJsZUNvbHVtbiwgRWxUYWcsIEVsUGFnaW5hdGlvbiwgRWxEaWFsb2csIEVsRm9ybSwgRWxGb3JtSXRlbSwgRWxTZWxlY3QsIEVsT3B0aW9uIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IHsgVXNlciwgU2VhcmNoLCBQbHVzIH0gZnJvbSAnQGVsZW1lbnQtcGx1cy9pY29ucy12dWUnOwpleHBvcnQgZGVmYXVsdCB7CiAgX19uYW1lOiAnVXNlck1hbmFnZW1lbnQnLAogIHNldHVwKF9fcHJvcHMsIHsKICAgIGV4cG9zZTogX19leHBvc2UKICB9KSB7CiAgICBfX2V4cG9zZSgpOwogICAgY29uc3QgdXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgY29tcGFuaWVzID0gcmVmKFtdKTsKICAgIGNvbnN0IGNvbXBhbnlEZXBhcnRtZW50cyA9IHJlZihbXSk7CiAgICBjb25zdCBzZWFyY2hRdWVyeSA9IHJlZignJyk7CiAgICBjb25zdCB0b3RhbCA9IHJlZigwKTsKICAgIGNvbnN0IHBhZ2luYXRpb24gPSByZWFjdGl2ZSh7CiAgICAgIHBhZ2U6IDEsCiAgICAgIHBhZ2VTaXplOiAxMAogICAgfSk7CiAgICBjb25zdCBpc01vZGFsT3BlbiA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBjdXJyZW50VXNlciA9IHJlZih7fSk7CiAgICBjb25zdCB1c2VyRm9ybSA9IHJlZihudWxsKTsgLy8gRm9ybSByZWZlcmVuY2UKICAgIGxldCBzZWFyY2hUaW1lb3V0ID0gbnVsbDsKICAgIGNvbnN0IGxvYWRpbmcgPSByZWYodHJ1ZSk7CiAgICBjb25zdCBmZXRjaFVzZXJzID0gYXN5bmMgKCkgPT4gewogICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgICBzZWFyY2g6IHNlYXJjaFF1ZXJ5LnZhbHVlLAogICAgICAgICAgcGFnZTogcGFnaW5hdGlvbi5wYWdlLAogICAgICAgICAgcGFnZV9zaXplOiBwYWdpbmF0aW9uLnBhZ2VTaXplCiAgICAgICAgfTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFkbWluQXBpLmdldFVzZXJzKHBhcmFtcyk7CiAgICAgICAgdXNlcnMudmFsdWUgPSByZXNwb25zZS5kYXRhLnJlc3VsdHM7CiAgICAgICAgdG90YWwudmFsdWUgPSByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIuiOt+WPlueUqOaIt+WIl+ihqOWksei0pToiLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfojrflj5bnlKjmiLfliJfooajlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBkZWJvdW5jZWRGZXRjaFVzZXJzID0gKCkgPT4gewogICAgICBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7CiAgICAgIHNlYXJjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBwYWdpbmF0aW9uLnBhZ2UgPSAxOyAvLyBSZXNldCB0byBmaXJzdCBwYWdlIG9uIHNlYXJjaAogICAgICAgIGZldGNoVXNlcnMoKTsKICAgICAgfSwgMzAwKTsKICAgIH07CiAgICBjb25zdCBmZXRjaENvbXBhbmllcyA9IGFzeW5jICgpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFkbWluQXBpLmdldENvbXBhbmllcyh7CiAgICAgICAgICBhbGw6ICd0cnVlJwogICAgICAgIH0pOwogICAgICAgIGNvbXBhbmllcy52YWx1ZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigi6I635Y+W5YWs5Y+45YiX6KGo5aSx6LSlOiIsIGVycm9yKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGZldGNoRGVwYXJ0bWVudHNGb3JDb21wYW55ID0gYXN5bmMgY29tcGFueUlkID0+IHsKICAgICAgaWYgKCFjb21wYW55SWQpIHsKICAgICAgICBjb21wYW55RGVwYXJ0bWVudHMudmFsdWUgPSBbXTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgICBhbGw6ICd0cnVlJywKICAgICAgICAgIGNvbXBhbnk6IGNvbXBhbnlJZAogICAgICAgIH07CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhZG1pbkFwaS5nZXREZXBhcnRtZW50cyhwYXJhbXMpOwogICAgICAgIGNvbXBhbnlEZXBhcnRtZW50cy52YWx1ZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihg6I635Y+W5YWs5Y+4ICR7Y29tcGFueUlkfSDnmoTpg6jpl6jliJfooajlpLHotKU6YCwgZXJyb3IpOwogICAgICAgIGNvbXBhbnlEZXBhcnRtZW50cy52YWx1ZSA9IFtdOwogICAgICB9CiAgICB9OwogICAgY29uc3Qgb25Db21wYW55Q2hhbmdlID0gYXN5bmMgY29tcGFueUlkID0+IHsKICAgICAgY3VycmVudFVzZXIudmFsdWUuZGVwYXJ0bWVudCA9IG51bGw7CiAgICAgIGF3YWl0IGZldGNoRGVwYXJ0bWVudHNGb3JDb21wYW55KGNvbXBhbnlJZCk7CiAgICB9OwogICAgY29uc3Qgb3BlblVzZXJNb2RhbCA9IGFzeW5jICh1c2VyID0ge30pID0+IHsKICAgICAgYXdhaXQgZmV0Y2hDb21wYW5pZXMoKTsKICAgICAgaWYgKHVzZXIgJiYgdXNlci5pZCkgewogICAgICAgIGN1cnJlbnRVc2VyLnZhbHVlID0gewogICAgICAgICAgLi4udXNlcgogICAgICAgIH07CiAgICAgICAgaWYgKHVzZXIuY29tcGFueSkgewogICAgICAgICAgYXdhaXQgZmV0Y2hEZXBhcnRtZW50c0ZvckNvbXBhbnkodXNlci5jb21wYW55KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudFVzZXIudmFsdWUgPSB7CiAgICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgICBuYW1lOiAnJywKICAgICAgICAgIGVtYWlsOiAnJywKICAgICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICAgIHBvc2l0aW9uOiAnJywKICAgICAgICAgIGNvbXBhbnk6IG51bGwsCiAgICAgICAgICBkZXBhcnRtZW50OiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgICBpc01vZGFsT3Blbi52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3QgY2xvc2VVc2VyTW9kYWwgPSAoKSA9PiB7CiAgICAgIHZhciBfdXNlckZvcm0kdmFsdWU7CiAgICAgIGlzTW9kYWxPcGVuLnZhbHVlID0gZmFsc2U7CiAgICAgIChfdXNlckZvcm0kdmFsdWUgPSB1c2VyRm9ybS52YWx1ZSkgPT09IG51bGwgfHwgX3VzZXJGb3JtJHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdXNlckZvcm0kdmFsdWUucmVzZXRGaWVsZHMoKTsKICAgIH07CiAgICBjb25zdCBzYXZlVXNlciA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCF1c2VyRm9ybS52YWx1ZSkgcmV0dXJuOwogICAgICBhd2FpdCB1c2VyRm9ybS52YWx1ZS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB1c2VyRGF0YSA9IHsKICAgICAgICAgICAgICAuLi5jdXJyZW50VXNlci52YWx1ZQogICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoIXVzZXJEYXRhLnBhc3N3b3JkKSB7CiAgICAgICAgICAgICAgZGVsZXRlIHVzZXJEYXRhLnBhc3N3b3JkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh1c2VyRGF0YS5kZXBhcnRtZW50ID09PSBudWxsKSB7CiAgICAgICAgICAgICAgZGVsZXRlIHVzZXJEYXRhLmRlcGFydG1lbnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmlkKSB7CiAgICAgICAgICAgICAgYXdhaXQgYWRtaW5BcGkudXBkYXRlVXNlcih1c2VyRGF0YS5pZCwgdXNlckRhdGEpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGF3YWl0IGFkbWluQXBpLmNyZWF0ZVVzZXIodXNlckRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsb3NlVXNlck1vZGFsKCk7CiAgICAgICAgICAgIGZldGNoVXNlcnMoKTsKICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+eUqOaIt+S/neWtmOaIkOWKn++8gScpOwogICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZSwgX2Vycm9yJHJlc3BvbnNlMjsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigi5L+d5a2Y55So5oi35aSx6LSlOiIsICgoX2Vycm9yJHJlc3BvbnNlID0gZXJyb3IucmVzcG9uc2UpID09PSBudWxsIHx8IF9lcnJvciRyZXNwb25zZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vycm9yJHJlc3BvbnNlLmRhdGEpIHx8IGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IChfZXJyb3IkcmVzcG9uc2UyID0gZXJyb3IucmVzcG9uc2UpICE9PSBudWxsICYmIF9lcnJvciRyZXNwb25zZTIgIT09IHZvaWQgMCAmJiBfZXJyb3IkcmVzcG9uc2UyLmRhdGEgPyBKU09OLnN0cmluZ2lmeShlcnJvci5yZXNwb25zZS5kYXRhKSA6ICfor7fmo4Dmn6XnvZHnu5zmiJbogZTns7vmioDmnK/mlK/mjIEnOwogICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoYOS/neWtmOeUqOaIt+Wksei0pTogJHtlcnJvck1zZ31gKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IGNvbmZpcm1EZWxldGVVc2VyID0gdXNlciA9PiB7CiAgICAgIEVsTWVzc2FnZUJveC5jb25maXJtKGDnoa7lrpropoHliKDpmaTnlKjmiLfjgJAke3VzZXIubmFtZSB8fCB1c2VyLnVzZXJuYW1lfeOAkeWQl++8n+atpOaTjeS9nOaXoOazleaSpOmUgOOAgmAsICforablkYonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrprliKDpmaQnLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgYXdhaXQgYWRtaW5BcGkuZGVsZXRlVXNlcih1c2VyLmlkKTsKICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfnlKjmiLfliKDpmaTmiJDlip8nKTsKICAgICAgICAgIGZldGNoVXNlcnMoKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliKDpmaTnlKjmiLflpLHotKUnKTsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuWIoOmZpOeUqOaIt+Wksei0pToiLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+W3suWPlua2iOWIoOmZpCcpOwogICAgICB9KTsKICAgIH07CiAgICBjb25zdCBoYW5kbGVTaXplQ2hhbmdlID0gdmFsID0+IHsKICAgICAgcGFnaW5hdGlvbi5wYWdlU2l6ZSA9IHZhbDsKICAgICAgZmV0Y2hVc2VycygpOwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUN1cnJlbnRDaGFuZ2UgPSB2YWwgPT4gewogICAgICBwYWdpbmF0aW9uLnBhZ2UgPSB2YWw7CiAgICAgIGZldGNoVXNlcnMoKTsKICAgIH07CiAgICBvbk1vdW50ZWQoKCkgPT4gewogICAgICBmZXRjaFVzZXJzKCk7CiAgICB9KTsKICAgIGNvbnN0IF9fcmV0dXJuZWRfXyA9IHsKICAgICAgdXNlcnMsCiAgICAgIGNvbXBhbmllcywKICAgICAgY29tcGFueURlcGFydG1lbnRzLAogICAgICBzZWFyY2hRdWVyeSwKICAgICAgdG90YWwsCiAgICAgIHBhZ2luYXRpb24sCiAgICAgIGlzTW9kYWxPcGVuLAogICAgICBjdXJyZW50VXNlciwKICAgICAgdXNlckZvcm0sCiAgICAgIGdldCBzZWFyY2hUaW1lb3V0KCkgewogICAgICAgIHJldHVybiBzZWFyY2hUaW1lb3V0OwogICAgICB9LAogICAgICBzZXQgc2VhcmNoVGltZW91dCh2KSB7CiAgICAgICAgc2VhcmNoVGltZW91dCA9IHY7CiAgICAgIH0sCiAgICAgIGxvYWRpbmcsCiAgICAgIGZldGNoVXNlcnMsCiAgICAgIGRlYm91bmNlZEZldGNoVXNlcnMsCiAgICAgIGZldGNoQ29tcGFuaWVzLAogICAgICBmZXRjaERlcGFydG1lbnRzRm9yQ29tcGFueSwKICAgICAgb25Db21wYW55Q2hhbmdlLAogICAgICBvcGVuVXNlck1vZGFsLAogICAgICBjbG9zZVVzZXJNb2RhbCwKICAgICAgc2F2ZVVzZXIsCiAgICAgIGNvbmZpcm1EZWxldGVVc2VyLAogICAgICBoYW5kbGVTaXplQ2hhbmdlLAogICAgICBoYW5kbGVDdXJyZW50Q2hhbmdlLAogICAgICByZWYsCiAgICAgIHJlYWN0aXZlLAogICAgICBvbk1vdW50ZWQsCiAgICAgIGdldCBhZG1pbkFwaSgpIHsKICAgICAgICByZXR1cm4gYWRtaW5BcGk7CiAgICAgIH0sCiAgICAgIGdldCBFbE1lc3NhZ2UoKSB7CiAgICAgICAgcmV0dXJuIEVsTWVzc2FnZTsKICAgICAgfSwKICAgICAgZ2V0IEVsTWVzc2FnZUJveCgpIHsKICAgICAgICByZXR1cm4gRWxNZXNzYWdlQm94OwogICAgICB9LAogICAgICBnZXQgRWxDYXJkKCkgewogICAgICAgIHJldHVybiBFbENhcmQ7CiAgICAgIH0sCiAgICAgIGdldCBFbEljb24oKSB7CiAgICAgICAgcmV0dXJuIEVsSWNvbjsKICAgICAgfSwKICAgICAgZ2V0IEVsSW5wdXQoKSB7CiAgICAgICAgcmV0dXJuIEVsSW5wdXQ7CiAgICAgIH0sCiAgICAgIGdldCBFbEJ1dHRvbigpIHsKICAgICAgICByZXR1cm4gRWxCdXR0b247CiAgICAgIH0sCiAgICAgIGdldCBFbFRhYmxlKCkgewogICAgICAgIHJldHVybiBFbFRhYmxlOwogICAgICB9LAogICAgICBnZXQgRWxUYWJsZUNvbHVtbigpIHsKICAgICAgICByZXR1cm4gRWxUYWJsZUNvbHVtbjsKICAgICAgfSwKICAgICAgZ2V0IEVsVGFnKCkgewogICAgICAgIHJldHVybiBFbFRhZzsKICAgICAgfSwKICAgICAgZ2V0IEVsUGFnaW5hdGlvbigpIHsKICAgICAgICByZXR1cm4gRWxQYWdpbmF0aW9uOwogICAgICB9LAogICAgICBnZXQgRWxEaWFsb2coKSB7CiAgICAgICAgcmV0dXJuIEVsRGlhbG9nOwogICAgICB9LAogICAgICBnZXQgRWxGb3JtKCkgewogICAgICAgIHJldHVybiBFbEZvcm07CiAgICAgIH0sCiAgICAgIGdldCBFbEZvcm1JdGVtKCkgewogICAgICAgIHJldHVybiBFbEZvcm1JdGVtOwogICAgICB9LAogICAgICBnZXQgRWxTZWxlY3QoKSB7CiAgICAgICAgcmV0dXJuIEVsU2VsZWN0OwogICAgICB9LAogICAgICBnZXQgRWxPcHRpb24oKSB7CiAgICAgICAgcmV0dXJuIEVsT3B0aW9uOwogICAgICB9LAogICAgICBnZXQgVXNlcigpIHsKICAgICAgICByZXR1cm4gVXNlcjsKICAgICAgfSwKICAgICAgZ2V0IFNlYXJjaCgpIHsKICAgICAgICByZXR1cm4gU2VhcmNoOwogICAgICB9LAogICAgICBnZXQgUGx1cygpIHsKICAgICAgICByZXR1cm4gUGx1czsKICAgICAgfQogICAgfTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3JldHVybmVkX18sICdfX2lzU2NyaXB0U2V0dXAnLCB7CiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB2YWx1ZTogdHJ1ZQogICAgfSk7CiAgICByZXR1cm4gX19yZXR1cm5lZF9fOwogIH0KfTs="},{"version":3,"names":["ref","reactive","onMounted","adminApi","ElMessage","ElMessageBox","ElCard","ElIcon","ElInput","ElButton","ElTable","ElTableColumn","ElTag","ElPagination","ElDialog","ElForm","ElFormItem","ElSelect","ElOption","User","Search","Plus","users","companies","companyDepartments","searchQuery","total","pagination","page","pageSize","isModalOpen","currentUser","userForm","searchTimeout","loading","fetchUsers","value","params","search","page_size","response","getUsers","data","results","count","error","console","debouncedFetchUsers","clearTimeout","setTimeout","fetchCompanies","getCompanies","all","fetchDepartmentsForCompany","companyId","company","getDepartments","onCompanyChange","department","openUserModal","user","id","username","name","email","password","position","closeUserModal","_userForm$value","resetFields","saveUser","validate","valid","userData","updateUser","createUser","success","_error$response","_error$response2","message","errorMsg","JSON","stringify","confirmDeleteUser","confirm","confirmButtonText","cancelButtonText","type","then","deleteUser","catch","info","handleSizeChange","val","handleCurrentChange"],"sources":["C:/Users/18083/Desktop/CCIT/office/o/smart-office/frontend/src/views/admin/UserManagement.vue"],"sourcesContent":["<template>\n  <div class=\"management-container\">\n    <el-card class=\"box-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <div class=\"header-left\">\n            <el-icon class=\"header-icon\"><User /></el-icon>\n            <span>用户管理</span>\n          </div>\n          <div class=\"header-right\">\n            <el-input\n              v-model=\"searchQuery\"\n              placeholder=\"搜索用户...\"\n              clearable\n              @clear=\"fetchUsers\"\n              @input=\"debouncedFetchUsers\"\n              class=\"search-input\"\n            >\n              <template #append>\n                <el-button :icon=\"Search\" />\n              </template>\n            </el-input>\n            <el-button type=\"primary\" :icon=\"Plus\" @click=\"openUserModal()\">添加用户</el-button>\n          </div>\n        </div>\n      </template>\n      <div class=\"table-container\">\n        <el-table :data=\"users\" v-loading=\"loading\" style=\"width: 100%\">\n          <el-table-column type=\"index\" :index=\"index => (pagination.page - 1) * pagination.pageSize + index + 1\" label=\"序号\" width=\"80\" />\n          <el-table-column prop=\"name\" label=\"用户名\" sortable>\n            <template #default=\"scope\">{{ scope.row.name || scope.row.username }}</template>\n          </el-table-column>\n          <el-table-column prop=\"email\" label=\"邮箱\" sortable />\n          <el-table-column prop=\"company_name\" label=\"公司\" sortable>\n            <template #default=\"scope\">{{ scope.row.company_name || '未分配' }}</template>\n          </el-table-column>\n          <el-table-column prop=\"department_name\" label=\"部门\" sortable>\n            <template #default=\"scope\">{{ scope.row.department_name || '未分配' }}</template>\n          </el-table-column>\n          <el-table-column prop=\"position\" label=\"职位\">\n            <template #default=\"scope\">{{ scope.row.position || '未指定' }}</template>\n          </el-table-column>\n          <el-table-column label=\"角色\" width=\"120\">\n            <template #default=\"scope\">\n              <el-tag v-if=\"scope.row.is_staff\" type=\"danger\" size=\"small\">管理员</el-tag>\n              <el-tag v-else-if=\"scope.row.is_department_manager\" type=\"primary\" size=\"small\">部门主管</el-tag>\n              <el-tag v-else type=\"success\" size=\"small\">员工</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" width=\"120\">\n            <template #default=\"scope\">\n              <el-button text type=\"primary\" size=\"small\" @click=\"openUserModal(scope.row)\">编辑</el-button>\n              <el-button text type=\"danger\" size=\"small\" @click=\"confirmDeleteUser(scope.row)\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </div>\n\n       <!-- 分页 -->\n      <div class=\"pagination-container\">\n        <el-pagination\n          v-model:current-page=\"pagination.page\"\n          v-model:page-size=\"pagination.pageSize\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n\n      <!-- 添加/编辑用户模态框 -->\n      <el-dialog v-model=\"isModalOpen\" :title=\"currentUser.id ? '编辑用户' : '添加用户'\" width=\"500px\">\n        <el-form :model=\"currentUser\" ref=\"userForm\" label-width=\"80px\">\n          <el-form-item label=\"用户名\" prop=\"username\" :rules=\"[{ required: true, message: '请输入用户名' }]\">\n            <el-input v-model=\"currentUser.username\" />\n          </el-form-item>\n          <el-form-item label=\"姓名\" prop=\"name\">\n            <el-input v-model=\"currentUser.name\" />\n          </el-form-item>\n          <el-form-item label=\"邮箱\" prop=\"email\" :rules=\"[{ required: true, message: '请输入邮箱' }, { type: 'email', message: '请输入有效的邮箱地址' }]\">\n            <el-input v-model=\"currentUser.email\" />\n          </el-form-item>\n          <el-form-item label=\"密码\" prop=\"password\" :rules=\"currentUser.id ? [] : [{ required: true, message: '请输入密码' }]\">\n            <el-input v-model=\"currentUser.password\" type=\"password\" :placeholder=\"currentUser.id ? '留空则不修改' : ''\" />\n          </el-form-item>\n          <el-form-item label=\"职位\" prop=\"position\">\n            <el-input v-model=\"currentUser.position\" />\n          </el-form-item>\n          <el-form-item label=\"所属公司\" prop=\"company\" :rules=\"[{ required: true, message: '请选择公司' }]\">\n            <el-select v-model=\"currentUser.company\" placeholder=\"请选择\" @change=\"onCompanyChange\">\n              <el-option v-for=\"company in companies\" :key=\"company.id\" :label=\"company.name\" :value=\"company.id\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item v-if=\"currentUser.company\" label=\"所属部门\" prop=\"department\">\n            <el-select v-model=\"currentUser.department\" placeholder=\"请选择\">\n              <el-option label=\"-- 未分配 --\" :value=\"null\" />\n              <el-option v-for=\"dept in companyDepartments\" :key=\"dept.id\" :label=\"dept.name\" :value=\"dept.id\" />\n            </el-select>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <span class=\"dialog-footer\">\n            <el-button @click=\"closeUserModal\">取消</el-button>\n            <el-button type=\"primary\" @click=\"saveUser\">保存</el-button>\n          </span>\n        </template>\n      </el-dialog>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport adminApi from '@/api/admin';\nimport { ElMessage, ElMessageBox, ElCard, ElIcon, ElInput, ElButton, ElTable, ElTableColumn, ElTag, ElPagination, ElDialog, ElForm, ElFormItem, ElSelect, ElOption } from 'element-plus';\nimport { User, Search, Plus } from '@element-plus/icons-vue';\n\nconst users = ref([]);\nconst companies = ref([]);\nconst companyDepartments = ref([]);\nconst searchQuery = ref('');\nconst total = ref(0);\nconst pagination = reactive({\n  page: 1,\n  pageSize: 10,\n});\nconst isModalOpen = ref(false);\nconst currentUser = ref({});\nconst userForm = ref(null); // Form reference\nlet searchTimeout = null;\nconst loading = ref(true);\n\nconst fetchUsers = async () => {\n  loading.value = true;\n  try {\n    const params = { \n      search: searchQuery.value,\n      page: pagination.page,\n      page_size: pagination.pageSize,\n    };\n    const response = await adminApi.getUsers(params);\n    users.value = response.data.results;\n    total.value = response.data.count;\n  } catch (error) {\n    console.error(\"获取用户列表失败:\", error);\n    ElMessage.error('获取用户列表失败');\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst debouncedFetchUsers = () => {\n  clearTimeout(searchTimeout);\n  searchTimeout = setTimeout(() => {\n    pagination.page = 1; // Reset to first page on search\n    fetchUsers();\n  }, 300);\n};\n\nconst fetchCompanies = async () => {\n    try {\n        const response = await adminApi.getCompanies({ all: 'true' });\n        companies.value = response.data;\n    } catch (error) {\n        console.error(\"获取公司列表失败:\", error);\n    }\n};\n\nconst fetchDepartmentsForCompany = async (companyId) => {\n  if (!companyId) {\n    companyDepartments.value = [];\n    return;\n  }\n  try {\n    const params = { all: 'true', company: companyId };\n    const response = await adminApi.getDepartments(params);\n    companyDepartments.value = response.data;\n  } catch (error) {\n    console.error(`获取公司 ${companyId} 的部门列表失败:`, error);\n    companyDepartments.value = [];\n  }\n};\n\nconst onCompanyChange = async (companyId) => {\n  currentUser.value.department = null;\n  await fetchDepartmentsForCompany(companyId);\n};\n    \nconst openUserModal = async (user = {}) => {\n  await fetchCompanies();\n  if (user && user.id) {\n    currentUser.value = { ...user };\n    if (user.company) {\n      await fetchDepartmentsForCompany(user.company);\n    }\n  } else {\n    currentUser.value = {\n      username: '',\n      name: '',\n      email: '',\n      password: '',\n      position: '',\n      company: null,\n      department: null\n    };\n  }\n  isModalOpen.value = true;\n};\n\nconst closeUserModal = () => {\n  isModalOpen.value = false;\n  userForm.value?.resetFields();\n};\n\nconst saveUser = async () => {\n  if (!userForm.value) return;\n  await userForm.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        const userData = { ...currentUser.value };\n        \n        if (!userData.password) {\n          delete userData.password;\n        }\n\n        if (userData.department === null) {\n          delete userData.department;\n        }\n\n        if (userData.id) {\n          await adminApi.updateUser(userData.id, userData);\n        } else {\n          await adminApi.createUser(userData);\n        }\n        closeUserModal();\n        fetchUsers();\n        ElMessage.success('用户保存成功！');\n      } catch (error) {\n        console.error(\"保存用户失败:\", error.response?.data || error.message);\n        const errorMsg = error.response?.data ? JSON.stringify(error.response.data) : '请检查网络或联系技术支持';\n        ElMessage.error(`保存用户失败: ${errorMsg}`);\n      }\n    }\n  });\n};\n\nconst confirmDeleteUser = (user) => {\n  ElMessageBox.confirm(\n    `确定要删除用户【${user.name || user.username}】吗？此操作无法撤销。`,\n    '警告',\n    {\n      confirmButtonText: '确定删除',\n      cancelButtonText: '取消',\n      type: 'warning',\n    }\n  ).then(async () => {\n    try {\n      await adminApi.deleteUser(user.id);\n      ElMessage.success('用户删除成功');\n      fetchUsers();\n    } catch (error) {\n      ElMessage.error('删除用户失败');\n      console.error(\"删除用户失败:\", error);\n    }\n  }).catch(() => {\n    ElMessage.info('已取消删除');\n  });\n};\n\nconst handleSizeChange = (val) => {\n  pagination.pageSize = val;\n  fetchUsers();\n};\n\nconst handleCurrentChange = (val) => {\n  pagination.page = val;\n  fetchUsers();\n};\n\nonMounted(() => {\n    fetchUsers();\n});\n</script>\n\n<style scoped>\n@import './shared-styles.css';\n</style> "],"mappings":"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","ignoreList":[]}]}