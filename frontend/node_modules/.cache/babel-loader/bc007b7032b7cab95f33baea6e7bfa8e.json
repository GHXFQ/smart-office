{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\settings\\SettingsDialog.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\settings\\SettingsDialog.vue","mtime":1747979699147},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCB7IHJlZiwgb25Nb3VudGVkLCBvblVubW91bnRlZCwgbmV4dFRpY2ssIHdhdGNoIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCBUaGVtZVNldHRpbmdzIGZyb20gJy4vVGhlbWVTZXR0aW5ncy52dWUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NldHRpbmdzRGlhbG9nJywKICBjb21wb25lbnRzOiB7CiAgICBUaGVtZVNldHRpbmdzCiAgfSwKICBwcm9wczogewogICAgdmlzaWJsZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCiAgZW1pdHM6IFsndXBkYXRlOnZpc2libGUnXSwKICBzZXR1cChwcm9wcywgewogICAgZW1pdAogIH0pIHsKICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUoKTsKICAgIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpOwogICAgY29uc3QgcmVuZGVyRGlhbG9nID0gcmVmKHRydWUpOwoKICAgIC8vIOebkeWQrOi3r+eUseWPmOWMlgogICAgd2F0Y2goKCkgPT4gcm91dGVyLmN1cnJlbnRSb3V0ZS52YWx1ZS5wYXRoLCAobmV3UGF0aCwgb2xkUGF0aCkgPT4gewogICAgICBpZiAocHJvcHMudmlzaWJsZSAmJiBvbGRQYXRoICE9PSBuZXdQYXRoKSB7CiAgICAgICAgLy8g6Lev55Sx5bey5Y+Y5YyW77yM5YWz6Zet5by556qXCiAgICAgICAgaGFuZGxlQ2xvc2UoKTsKICAgICAgfQogICAgfSk7CgogICAgLy8g55uR5ZCs5Y+v6KeB5oCn5Y+Y5YyWCiAgICB3YXRjaCgoKSA9PiBwcm9wcy52aXNpYmxlLCBhc3luYyBpc1Zpc2libGUgPT4gewogICAgICBpZiAoaXNWaXNpYmxlKSB7CiAgICAgICAgLy8g5by556qX5omT5byACiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdzZXR0aW5ncy1kaWFsb2ctb3BlbicpOwoKICAgICAgICAvLyDlvZPlvLnnqpfmiZPlvIDml7bvvIznrYnlvoXkuIvkuIDkuKpET03lvqrnjq/vvIznoa7kv53lvLnnqpflt7LmuLLmn5MKICAgICAgICBhd2FpdCBuZXh0VGljaygpOwogICAgICAgIGZvY3VzVHJhcCgpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOW8ueeql+WFs+mXrQogICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnc2V0dGluZ3MtZGlhbG9nLW9wZW4nKTsKICAgICAgfQogICAgfSk7CgogICAgLy8g6ZSu55uY5LqL5Lu25aSE55CGCiAgICBjb25zdCBoYW5kbGVLZXlEb3duID0gZSA9PiB7CiAgICAgIGlmIChwcm9wcy52aXNpYmxlICYmIGUua2V5ID09PSAnRXNjYXBlJykgewogICAgICAgIGhhbmRsZUNsb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgLy8g54K55Ye76YGu572p5YWz6ZetCiAgICBjb25zdCBoYW5kbGVPdmVybGF5Q2xpY2sgPSAoKSA9PiB7CiAgICAgIGhhbmRsZUNsb3NlKCk7CiAgICB9OwoKICAgIC8vIOWFs+mXreW8ueeqlwogICAgY29uc3QgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7CiAgICAgIGVtaXQoJ3VwZGF0ZTp2aXNpYmxlJywgZmFsc2UpOwoKICAgICAgLy8g5L2/55SoVnVleOWQjOatpeeKtuaAgQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBzdG9yZS5jb21taXQoJ1NFVF9TRVRUSU5HU19WSVNJQkxFJywgZmFsc2UpOwoKICAgICAgICAvLyDmuIXnkIZET00KICAgICAgICBjbGVhbnVwKCk7CiAgICAgIH0sIDEwMCk7CiAgICB9OwoKICAgIC8vIOWwhueEpueCuemZkOWItuWcqOW8ueeql+WGhQogICAgY29uc3QgZm9jdXNUcmFwID0gKCkgPT4gewogICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtZGlhbG9nJyk7CiAgICAgIGlmIChkaWFsb2cpIHsKICAgICAgICBkaWFsb2cuZm9jdXMoKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDmuIXnkIblh73mlbAKICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7CiAgICAgIC8vIOa4heeQhuWPr+iDveWtmOWcqOeahOmBrue9qeWxggogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWwtb3ZlcmxheSwgLmVsLXBvcHVwLXBhcmVudC0taGlkZGVuLCAudi1tb2RhbCcpLmZvckVhY2goZWwgPT4gewogICAgICAgIGlmIChlbCAmJiBlbC5wYXJlbnROb2RlKSB7CiAgICAgICAgICBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g5oGi5aSNYm9keeagt+W8jwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7CiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZWwtcG9wdXAtcGFyZW50LS1oaWRkZW4nKTsKICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdzZXR0aW5ncy1kaWFsb2ctb3BlbicpOwogICAgfTsKCiAgICAvLyDnu4Tku7bmjILovb0KICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7CgogICAgICAvLyDmuIXnkIbnjrDmnInpga7nvanlsYIKICAgICAgY2xlYW51cCgpOwogICAgfSk7CgogICAgLy8g57uE5Lu25Y246L29CiAgICBvblVubW91bnRlZCgoKSA9PiB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7CiAgICAgIGNsZWFudXAoKTsKICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgcmVuZGVyRGlhbG9nLAogICAgICBoYW5kbGVDbG9zZSwKICAgICAgaGFuZGxlT3ZlcmxheUNsaWNrCiAgICB9OwogIH0KfTs="},{"version":3,"names":["ref","onMounted","onUnmounted","nextTick","watch","useStore","useRouter","ThemeSettings","name","components","props","visible","type","Boolean","default","emits","setup","emit","store","router","renderDialog","currentRoute","value","path","newPath","oldPath","handleClose","isVisible","document","body","classList","add","focusTrap","remove","handleKeyDown","e","key","handleOverlayClick","setTimeout","commit","cleanup","dialog","querySelector","focus","querySelectorAll","forEach","el","parentNode","removeChild","style","overflow","window","addEventListener","removeEventListener"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\settings\\SettingsDialog.vue"],"sourcesContent":["<template>\n  <div v-if=\"renderDialog\" class=\"settings-dialog-wrapper\">\n    <teleport to=\"body\">\n      <transition name=\"settings-fade\">\n        <div v-if=\"visible\" class=\"settings-dialog-container\">\n          <div class=\"settings-dialog-overlay\" @click=\"handleOverlayClick\"></div>\n          <div class=\"settings-dialog\">\n            <div class=\"settings-content\">\n              <theme-settings @close=\"handleClose\"></theme-settings>\n            </div>\n          </div>\n        </div>\n      </transition>\n    </teleport>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, nextTick, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport ThemeSettings from './ThemeSettings.vue';\n\nexport default {\n  name: 'SettingsDialog',\n  components: {\n    ThemeSettings\n  },\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update:visible'],\n  setup(props, { emit }) {\n    const store = useStore();\n    const router = useRouter();\n    const renderDialog = ref(true);\n    \n    // 监听路由变化\n    watch(() => router.currentRoute.value.path, (newPath, oldPath) => {\n      if (props.visible && oldPath !== newPath) {\n        // 路由已变化，关闭弹窗\n        handleClose();\n      }\n    });\n    \n    // 监听可见性变化\n    watch(() => props.visible, async (isVisible) => {\n      if (isVisible) {\n        // 弹窗打开\n        document.body.classList.add('settings-dialog-open');\n        \n        // 当弹窗打开时，等待下一个DOM循环，确保弹窗已渲染\n        await nextTick();\n        focusTrap();\n      } else {\n        // 弹窗关闭\n        document.body.classList.remove('settings-dialog-open');\n      }\n    });\n    \n    // 键盘事件处理\n    const handleKeyDown = (e) => {\n      if (props.visible && e.key === 'Escape') {\n        handleClose();\n      }\n    };\n    \n    // 点击遮罩关闭\n    const handleOverlayClick = () => {\n      handleClose();\n    };\n    \n    // 关闭弹窗\n    const handleClose = () => {\n      emit('update:visible', false);\n      \n      // 使用Vuex同步状态\n      setTimeout(() => {\n        store.commit('SET_SETTINGS_VISIBLE', false);\n        \n        // 清理DOM\n        cleanup();\n      }, 100);\n    };\n    \n    // 将焦点限制在弹窗内\n    const focusTrap = () => {\n      const dialog = document.querySelector('.settings-dialog');\n      if (dialog) {\n        dialog.focus();\n      }\n    };\n    \n    // 清理函数\n    const cleanup = () => {\n      // 清理可能存在的遮罩层\n      document.querySelectorAll('.el-overlay, .el-popup-parent--hidden, .v-modal').forEach(el => {\n        if (el && el.parentNode) {\n          el.parentNode.removeChild(el);\n        }\n      });\n      \n      // 恢复body样式\n      document.body.style.overflow = '';\n      document.body.classList.remove('el-popup-parent--hidden');\n      document.body.classList.remove('settings-dialog-open');\n    };\n    \n    // 组件挂载\n    onMounted(() => {\n      window.addEventListener('keydown', handleKeyDown);\n      \n      // 清理现有遮罩层\n      cleanup();\n    });\n    \n    // 组件卸载\n    onUnmounted(() => {\n      window.removeEventListener('keydown', handleKeyDown);\n      cleanup();\n    });\n    \n    return {\n      renderDialog,\n      handleClose,\n      handleOverlayClick\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\">\n// 全局样式，确保不被scoped限制\nbody.settings-dialog-open {\n  overflow: hidden;\n}\n\n.settings-dialog-wrapper {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 0;\n  pointer-events: none;\n}\n\n.settings-dialog-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 10000;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.settings-dialog-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(1px);\n  z-index: 10001;\n  cursor: pointer;\n}\n\n.settings-dialog {\n  position: relative;\n  width: 800px;\n  max-width: 90vw;\n  max-height: 90vh;\n  background-color: var(--bg-color);\n  border-radius: 8px;\n  box-shadow: 0 4px 12px var(--shadow-color);\n  z-index: 10002;\n  overflow: hidden;\n}\n\n.settings-content {\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n}\n\n// 淡入淡出动画\n.settings-fade-enter-active,\n.settings-fade-leave-active {\n  transition: all 0.3s ease;\n}\n\n.settings-fade-enter-from,\n.settings-fade-leave-to {\n  opacity: 0;\n}\n\n.settings-fade-enter-from .settings-dialog {\n  transform: scale(0.9);\n}\n\n.settings-fade-leave-to .settings-dialog {\n  transform: scale(0.9);\n}\n</style> "],"mappings":"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","ignoreList":[]}]}