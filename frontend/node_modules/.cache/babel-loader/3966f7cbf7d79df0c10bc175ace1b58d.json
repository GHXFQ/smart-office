{"remainingRequest":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\src\\utils\\api.js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\src\\utils\\api.js","mtime":1746510133922},{"path":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\babel.config.js","mtime":1746431728272},{"path":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218359},{"path":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202324},{"path":"C:\\Users\\18083\\Desktop\\新建文件夹 (3)\\smart-office\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1746431218362}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCB7IEVsTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtcGx1cyc7CgovLyDliJvlu7pheGlvc+WunuS+iwpjb25zdCBhcGkgPSBheGlvcy5jcmVhdGUoewogIGJhc2VVUkw6ICcvYXBpJywKICB0aW1lb3V0OiAxNTAwMAp9KTsKCi8vIOivt+axguaLpuaIquWZqAphcGkuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGNvbmZpZyA9PiB7CiAgLy8g5LuOVnVleOiOt+WPlnRva2VuCiAgY29uc3QgdG9rZW4gPSBzdG9yZS5nZXR0ZXJzLnRva2VuOwogIC8vIOWmguaenOaciXRva2Vu77yM5YiZ5re75Yqg5Yiw6K+35rGC5aS0CiAgaWYgKHRva2VuKSB7CiAgICBjb25maWcuaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gYEJlYXJlciAke3Rva2VufWA7CiAgfQogIHJldHVybiBjb25maWc7Cn0sIGVycm9yID0+IHsKICBjb25zb2xlLmVycm9yKCfor7fmsYLplJnor686JywgZXJyb3IpOwogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwoKLy8g5ZON5bqU5oum5oiq5ZmoCmFwaS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKHJlc3BvbnNlID0+IHsKICBjb25zdCByZXMgPSByZXNwb25zZS5kYXRhOwogIC8vIOWmguaenOWTjeW6lOaIkOWKn+S9huS4muWKoeeKtuaAgeeggeihqOekuuWksei0pQogIGlmIChyZXMuc3VjY2VzcyA9PT0gZmFsc2UpIHsKICAgIEVsTWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSB8fCAn5pON5L2c5aSx6LSlJyk7CiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKHJlcy5tZXNzYWdlIHx8ICfmk43kvZzlpLHotKUnKSk7CiAgfQogIHJldHVybiByZXM7Cn0sIGVycm9yID0+IHsKICAvLyDlpITnkIZIVFRQ6ZSZ6K+vCiAgaWYgKGVycm9yLnJlc3BvbnNlKSB7CiAgICBjb25zdCB7CiAgICAgIHN0YXR1cywKICAgICAgZGF0YQogICAgfSA9IGVycm9yLnJlc3BvbnNlOwoKICAgIC8vIOWkhOeQhjQwMeacquaOiOadg+mUmeivrwogICAgaWYgKHN0YXR1cyA9PT0gNDAxKSB7CiAgICAgIHN0b3JlLmRpc3BhdGNoKCdsb2dvdXQnKS50aGVuKCgpID0+IHsKICAgICAgICAvLyDph43lrprlkJHliLDnmbvlvZXpobUKICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbG9naW4nOwogICAgICB9KTsKICAgICAgRWxNZXNzYWdlLmVycm9yKGRhdGEubWVzc2FnZSB8fCAn55So5oi35pyq55m75b2V5oiW5Lya6K+d5bey6L+H5pyf77yM6K+36YeN5paw55m75b2VJyk7CiAgICB9CiAgICAvLyDlpITnkIblhbbku5ZIVFRQ6ZSZ6K+vCiAgICBlbHNlIHsKICAgICAgRWxNZXNzYWdlLmVycm9yKGRhdGEubWVzc2FnZSB8fCBg6K+35rGC5aSx6LSlKCR7c3RhdHVzfSlgKTsKICAgIH0KICB9IGVsc2UgewogICAgRWxNZXNzYWdlLmVycm9yKCfnvZHnu5zplJnor6/vvIzor7fmo4Dmn6XmgqjnmoTnvZHnu5zov57mjqUnKTsKICB9CiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7CgovLyDnlKjmiLfnm7jlhbPmjqXlj6MKZXhwb3J0IGNvbnN0IHVzZXJBcGkgPSB7CiAgLy8g55So5oi355m75b2VCiAgbG9naW4oZGF0YSkgewogICAgcmV0dXJuIGFwaS5wb3N0KCcvYXV0aC9sb2dpbi8nLCBkYXRhKTsKICB9LAogIC8vIOeUqOaIt+azqOWGjAogIHJlZ2lzdGVyKGRhdGEpIHsKICAgIHJldHVybiBhcGkucG9zdCgnL3JlZ2lzdGVyLycsIGRhdGEpOwogIH0sCiAgLy8g6I635Y+W5b2T5YmN55So5oi35L+h5oGvCiAgZ2V0Q3VycmVudFVzZXIoKSB7CiAgICByZXR1cm4gYXBpLmdldCgnL3VzZXJzL21lLycpOwogIH0sCiAgLy8g5pu05paw55So5oi35L+h5oGvCiAgdXBkYXRlUHJvZmlsZShkYXRhKSB7CiAgICByZXR1cm4gYXBpLnB1dCgnL3VzZXJzL21lLycsIGRhdGEpOwogIH0sCiAgLy8g5L+u5pS55a+G56CBCiAgY2hhbmdlUGFzc3dvcmQoZGF0YSkgewogICAgcmV0dXJuIGFwaS5wdXQoJy91c2Vycy9jaGFuZ2VfcGFzc3dvcmQvJywgZGF0YSk7CiAgfSwKICAvLyDpgIDlh7rnmbvlvZUKICBsb2dvdXQoKSB7CiAgICAvLyDliY3nq6/lj6rpnIDopoHmuIXpmaR0b2tlbuWNs+WPr++8jOWQjuerr+aXoOmcgOWkhOeQhgogICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgYXBpOw=="},{"version":3,"names":["axios","store","ElMessage","api","create","baseURL","timeout","interceptors","request","use","config","token","getters","headers","error","console","Promise","reject","response","res","data","success","message","Error","status","dispatch","then","window","location","href","userApi","login","post","register","getCurrentUser","get","updateProfile","put","changePassword","logout","resolve"],"sources":["C:/Users/18083/Desktop/新建文件夹 (3)/smart-office/frontend/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport store from '@/store';\r\nimport { ElMessage } from 'element-plus';\r\n\r\n// 创建axios实例\r\nconst api = axios.create({\r\n  baseURL: '/api',\r\n  timeout: 15000\r\n});\r\n\r\n// 请求拦截器\r\napi.interceptors.request.use(\r\n  config => {\r\n    // 从Vuex获取token\r\n    const token = store.getters.token;\r\n    // 如果有token，则添加到请求头\r\n    if (token) {\r\n      config.headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  error => {\r\n    console.error('请求错误:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// 响应拦截器\r\napi.interceptors.response.use(\r\n  response => {\r\n    const res = response.data;\r\n    // 如果响应成功但业务状态码表示失败\r\n    if (res.success === false) {\r\n      ElMessage.error(res.message || '操作失败');\r\n      return Promise.reject(new Error(res.message || '操作失败'));\r\n    }\r\n    return res;\r\n  },\r\n  error => {\r\n    // 处理HTTP错误\r\n    if (error.response) {\r\n      const { status, data } = error.response;\r\n      \r\n      // 处理401未授权错误\r\n      if (status === 401) {\r\n        store.dispatch('logout').then(() => {\r\n          // 重定向到登录页\r\n          window.location.href = '/login';\r\n        });\r\n        ElMessage.error(data.message || '用户未登录或会话已过期，请重新登录');\r\n      } \r\n      // 处理其他HTTP错误\r\n      else {\r\n        ElMessage.error(data.message || `请求失败(${status})`);\r\n      }\r\n    } else {\r\n      ElMessage.error('网络错误，请检查您的网络连接');\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// 用户相关接口\r\nexport const userApi = {\r\n  // 用户登录\r\n  login(data) {\r\n    return api.post('/auth/login/', data);\r\n  },\r\n  \r\n  // 用户注册\r\n  register(data) {\r\n    return api.post('/register/', data);\r\n  },\r\n  \r\n  // 获取当前用户信息\r\n  getCurrentUser() {\r\n    return api.get('/users/me/');\r\n  },\r\n  \r\n  // 更新用户信息\r\n  updateProfile(data) {\r\n    return api.put('/users/me/', data);\r\n  },\r\n  \r\n  // 修改密码\r\n  changePassword(data) {\r\n    return api.put('/users/change_password/', data);\r\n  },\r\n  \r\n  // 退出登录\r\n  logout() {\r\n    // 前端只需要清除token即可，后端无需处理\r\n    return Promise.resolve();\r\n  }\r\n};\r\n\r\nexport default api; "],"mappings":"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","ignoreList":[]}]}