{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\ChatCalendarEvent.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\ChatCalendarEvent.vue","mtime":1747654111156},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1746431728000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVmLCByZWFjdGl2ZSwgY29tcHV0ZWQsIHRvUmVmcywgZGVmaW5lUHJvcHMsIGRlZmluZUVtaXRzLCBvbk1vdW50ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyBFbE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXBsdXMnOwppbXBvcnQgeyBDYWxlbmRhciwgQ2xvY2ssIExvY2F0aW9uLCBJbmZvRmlsbGVkIH0gZnJvbSAnQGVsZW1lbnQtcGx1cy9pY29ucy12dWUnOwppbXBvcnQgeyBhZGRDYWxlbmRhckV2ZW50IH0gZnJvbSAnQC9hcGkvY2hhdCc7CmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICdAL3V0aWxzL2RhdGUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NoYXRDYWxlbmRhckV2ZW50JywKICBjb21wb25lbnRzOiB7CiAgICBDYWxlbmRhciwKICAgIENsb2NrLAogICAgTG9jYXRpb24sCiAgICBJbmZvRmlsbGVkCiAgfSwKICBwcm9wczogewogICAgbWVzc2FnZUlkOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBldmVudERhdGE6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgZW1pdHM6IFsnY2FsZW5kYXItZXZlbnQtYWRkZWQnLCAnY2FsZW5kYXItZXZlbnQtaGlkZGVuJ10sCiAgc2V0dXAocHJvcHMsIHsKICAgIGVtaXQKICB9KSB7CiAgICBjb25zdCBjYWxlbmRhckV2ZW50QWRkZWQgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZGV0YWlsc1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgewogICAgICBldmVudERhdGEKICAgIH0gPSB0b1JlZnMocHJvcHMpOwoKICAgIC8vIOWIm+W7uuWPr+e8lui+keeahOS6i+S7tuWvueixoQogICAgY29uc3QgZWRpdGFibGVFdmVudCA9IHJlYWN0aXZlKHsKICAgICAgdGl0bGU6ICcnLAogICAgICBzdGFydDogJycsCiAgICAgIGVuZDogJycsCiAgICAgIGxvY2F0aW9uOiAnJywKICAgICAgdHlwZTogJ2JsdWUnLAogICAgICByZW1pbmRlcjogJzMwbWluJywKICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICBpc19hbGxfZGF5OiBmYWxzZQogICAgfSk7CgogICAgLy8g5b2T5omT5byA6K+m5oOF5a+56K+d5qGG5pe277yM5Yid5aeL5YyW5Y+v57yW6L6R5LqL5Lu2CiAgICBjb25zdCBpbml0RWRpdGFibGVFdmVudCA9ICgpID0+IHsKICAgICAgaWYgKGV2ZW50RGF0YS52YWx1ZSkgewogICAgICAgIGVkaXRhYmxlRXZlbnQudGl0bGUgPSBldmVudERhdGEudmFsdWUudGl0bGUgfHwgJyc7CiAgICAgICAgZWRpdGFibGVFdmVudC5zdGFydCA9IGZvcm1hdERhdGVGb3JQaWNrZXIoZXZlbnREYXRhLnZhbHVlLnN0YXJ0KTsKICAgICAgICBlZGl0YWJsZUV2ZW50LmVuZCA9IGZvcm1hdERhdGVGb3JQaWNrZXIoZXZlbnREYXRhLnZhbHVlLmVuZCk7CiAgICAgICAgZWRpdGFibGVFdmVudC5sb2NhdGlvbiA9IGV2ZW50RGF0YS52YWx1ZS5sb2NhdGlvbiB8fCAnJzsKICAgICAgICBlZGl0YWJsZUV2ZW50LnR5cGUgPSBldmVudERhdGEudmFsdWUudHlwZSB8fCAnYmx1ZSc7CiAgICAgICAgZWRpdGFibGVFdmVudC5yZW1pbmRlciA9IGV2ZW50RGF0YS52YWx1ZS5yZW1pbmRlciB8fCAnMzBtaW4nOwogICAgICAgIGVkaXRhYmxlRXZlbnQuZGVzY3JpcHRpb24gPSBldmVudERhdGEudmFsdWUuZGVzY3JpcHRpb24gfHwgJyc7CiAgICAgICAgZWRpdGFibGVFdmVudC5pc19hbGxfZGF5ID0gZXZlbnREYXRhLnZhbHVlLmlzX2FsbF9kYXkgfHwgZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgLy8g5qC85byP5YyW5pel5pyf5Li65pel5pyf6YCJ5oup5Zmo5omA6ZyA5qC85byPCiAgICBjb25zdCBmb3JtYXREYXRlRm9yUGlja2VyID0gZGF0ZVN0cmluZyA9PiB7CiAgICAgIGlmICghZGF0ZVN0cmluZykgcmV0dXJuICcnOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTsKICAgICAgICByZXR1cm4gZm9ybWF0RGF0ZShkYXRlLCAnWVlZWS1NTS1ERCBISDptbTpzcycpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CiAgICB9OwoKICAgIC8vIOaYvuekuuivpuaDheWvueivneahhgogICAgY29uc3Qgc2hvd0RldGFpbHMgPSAoKSA9PiB7CiAgICAgIGluaXRFZGl0YWJsZUV2ZW50KCk7CiAgICAgIGRldGFpbHNWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgIH07CgogICAgLy8g5re75Yqg5Yiw5pel5Y6GCiAgICBjb25zdCBhZGRUb0NhbGVuZGFyID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFkZENhbGVuZGFyRXZlbnQocHJvcHMubWVzc2FnZUlkKTsKICAgICAgICBjYWxlbmRhckV2ZW50QWRkZWQudmFsdWUgPSB0cnVlOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfml6XnqIvmt7vliqDmiJDlip8nKTsKICAgICAgICBlbWl0KCdjYWxlbmRhci1ldmVudC1hZGRlZCcpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHZhciBfZXJyb3IkcmVzcG9uc2UsIF9lcnJvciRyZXNwb25zZSRkYXRhOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5re75Yqg5pel56iL5aSx6LSl77yaJyArICgoKF9lcnJvciRyZXNwb25zZSA9IGVycm9yLnJlc3BvbnNlKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZXJyb3IkcmVzcG9uc2UkZGF0YSA9IF9lcnJvciRyZXNwb25zZS5kYXRhKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UkZGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vycm9yJHJlc3BvbnNlJGRhdGEuZXJyb3IpIHx8IGVycm9yLm1lc3NhZ2UpKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDkvb/nlKjnvJbovpHlkI7nmoTlhoXlrrnmt7vliqDliLDml6XljoYKICAgIGNvbnN0IGFkZFRvQ2FsZW5kYXJXaXRoRWRpdHMgPSBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgYWRkQ2FsZW5kYXJFdmVudChwcm9wcy5tZXNzYWdlSWQsIGVkaXRhYmxlRXZlbnQpOwogICAgICAgIGNhbGVuZGFyRXZlbnRBZGRlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgZGV0YWlsc1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5pel56iL5re75Yqg5oiQ5YqfJyk7CiAgICAgICAgZW1pdCgnY2FsZW5kYXItZXZlbnQtYWRkZWQnKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB2YXIgX2Vycm9yJHJlc3BvbnNlMiwgX2Vycm9yJHJlc3BvbnNlMiRkYXRhOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5re75Yqg5pel56iL5aSx6LSl77yaJyArICgoKF9lcnJvciRyZXNwb25zZTIgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lcnJvciRyZXNwb25zZTIkZGF0YSA9IF9lcnJvciRyZXNwb25zZTIuZGF0YSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMiRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZXJyb3IkcmVzcG9uc2UyJGRhdGEuZXJyb3IpIHx8IGVycm9yLm1lc3NhZ2UpKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDpmpDol4/ml6XnqIvljaHniYcKICAgIGNvbnN0IGhpZGVDYWxlbmRhckV2ZW50ID0gKCkgPT4gewogICAgICBlbWl0KCdjYWxlbmRhci1ldmVudC1oaWRkZW4nKTsKICAgIH07CgogICAgLy8g5qC85byP5YyW5pel5pyf6IyD5Zu0CiAgICBjb25zdCBmb3JtYXREYXRlUmFuZ2UgPSAoc3RhcnQsIGVuZCkgPT4gewogICAgICBpZiAoIXN0YXJ0KSByZXR1cm4gJ+aXtumXtOacquaMh+Wumic7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnQpOwogICAgICAgIGNvbnN0IGVuZERhdGUgPSBlbmQgPyBuZXcgRGF0ZShlbmQpIDogbnVsbDsKICAgICAgICBjb25zdCBzdGFydERhdGVTdHIgPSBmb3JtYXREYXRlKHN0YXJ0RGF0ZSwgJ1lZWVnlubRNTeaciERE5pelIEhIOm1tJyk7CiAgICAgICAgaWYgKCFlbmREYXRlKSByZXR1cm4gc3RhcnREYXRlU3RyOwoKICAgICAgICAvLyDlpoLmnpzmmK/lkIzkuIDlpKnvvIzlj6rmmL7npLrkuIDmrKHml6XmnJ8KICAgICAgICBpZiAoc3RhcnREYXRlLnRvRGF0ZVN0cmluZygpID09PSBlbmREYXRlLnRvRGF0ZVN0cmluZygpKSB7CiAgICAgICAgICByZXR1cm4gYCR7Zm9ybWF0RGF0ZShzdGFydERhdGUsICdZWVlZ5bm0TU3mnIhEROaXpSBISDptbScpfSAtICR7Zm9ybWF0RGF0ZShlbmREYXRlLCAnSEg6bW0nKX1gOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYCR7Zm9ybWF0RGF0ZShzdGFydERhdGUsICdZWVlZ5bm0TU3mnIhEROaXpSBISDptbScpfSAtICR7Zm9ybWF0RGF0ZShlbmREYXRlLCAnWVlZWeW5tE1N5pyIRETml6UgSEg6bW0nKX1gOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuICfml7bpl7TmoLzlvI/plJnor68nOwogICAgICB9CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgY2FsZW5kYXJFdmVudEFkZGVkLAogICAgICBkZXRhaWxzVmlzaWJsZSwKICAgICAgZWRpdGFibGVFdmVudCwKICAgICAgc2hvd0RldGFpbHMsCiAgICAgIGFkZFRvQ2FsZW5kYXIsCiAgICAgIGFkZFRvQ2FsZW5kYXJXaXRoRWRpdHMsCiAgICAgIGhpZGVDYWxlbmRhckV2ZW50LAogICAgICBmb3JtYXREYXRlUmFuZ2UKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["ref","reactive","computed","toRefs","defineProps","defineEmits","onMounted","ElMessage","Calendar","Clock","Location","InfoFilled","addCalendarEvent","formatDate","name","components","props","messageId","type","Number","required","eventData","Object","emits","setup","emit","calendarEventAdded","detailsVisible","editableEvent","title","start","end","location","reminder","description","is_all_day","initEditableEvent","value","formatDateForPicker","dateString","date","Date","e","showDetails","addToCalendar","success","error","_error$response","_error$response$data","response","data","message","addToCalendarWithEdits","_error$response2","_error$response2$data","hideCalendarEvent","formatDateRange","startDate","endDate","startDateStr","toDateString"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\components\\ChatCalendarEvent.vue"],"sourcesContent":["<template>\r\n  <div class=\"calendar-event-container\" v-if=\"eventData\">\r\n    <div class=\"calendar-event-card\">\r\n      <div class=\"calendar-event-header\" :class=\"'event-type-' + eventData.type\">\r\n        <i class=\"el-icon calendar-icon\"><Calendar /></i>\r\n        <span class=\"event-title\">{{ eventData.title }}</span>\r\n      </div>\r\n      <div class=\"calendar-event-content\">\r\n        <div class=\"event-time\">\r\n          <i class=\"el-icon\"><Clock /></i>\r\n          <span>{{ formatDateRange(eventData.start, eventData.end) }}</span>\r\n        </div>\r\n        <div class=\"event-location\" v-if=\"eventData.location\">\r\n          <i class=\"el-icon\"><Location /></i>\r\n          <span>{{ eventData.location }}</span>\r\n        </div>\r\n        <div class=\"event-description\" v-if=\"eventData.description\">\r\n          <i class=\"el-icon\"><InfoFilled /></i>\r\n          <span>{{ eventData.description }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"calendar-event-actions\" v-if=\"!calendarEventAdded\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"showDetails\">详情</el-button>\r\n        <el-button type=\"success\" size=\"small\" @click=\"addToCalendar\">添加</el-button>\r\n        <el-button type=\"default\" size=\"small\" @click=\"hideCalendarEvent\">取消</el-button>\r\n      </div>\r\n      <div class=\"calendar-event-success\" v-else>\r\n        <el-alert\r\n          type=\"success\"\r\n          :closable=\"false\"\r\n          show-icon\r\n        >\r\n          <span>已成功添加到日程</span>\r\n        </el-alert>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 日程详情对话框 -->\r\n    <el-dialog\r\n      v-model=\"detailsVisible\"\r\n      title=\"日程详情\"\r\n      width=\"500px\"\r\n    >\r\n      <el-form :model=\"editableEvent\" label-width=\"80px\">\r\n        <el-form-item label=\"标题\">\r\n          <el-input v-model=\"editableEvent.title\" placeholder=\"请输入日程标题\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"开始时间\">\r\n          <el-date-picker\r\n            v-model=\"editableEvent.start\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择开始时间\"\r\n            format=\"YYYY-MM-DD HH:mm\"\r\n            value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"结束时间\">\r\n          <el-date-picker\r\n            v-model=\"editableEvent.end\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择结束时间\"\r\n            format=\"YYYY-MM-DD HH:mm\"\r\n            value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"地点\">\r\n          <el-input v-model=\"editableEvent.location\" placeholder=\"请输入地点\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"类型\">\r\n          <el-select v-model=\"editableEvent.type\" placeholder=\"请选择日程类型\">\r\n            <el-option label=\"会议\" value=\"blue\"></el-option>\r\n            <el-option label=\"出差\" value=\"orange\"></el-option>\r\n            <el-option label=\"假期\" value=\"green\"></el-option>\r\n            <el-option label=\"截止日期\" value=\"red\"></el-option>\r\n            <el-option label=\"其他\" value=\"purple\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"提醒\">\r\n          <el-select v-model=\"editableEvent.reminder\" placeholder=\"请选择提醒时间\">\r\n            <el-option label=\"不提醒\" value=\"none\"></el-option>\r\n            <el-option label=\"10分钟前\" value=\"10min\"></el-option>\r\n            <el-option label=\"30分钟前\" value=\"30min\"></el-option>\r\n            <el-option label=\"1小时前\" value=\"1hour\"></el-option>\r\n            <el-option label=\"1天前\" value=\"1day\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"全天事件\">\r\n          <el-switch v-model=\"editableEvent.is_all_day\"></el-switch>\r\n        </el-form-item>\r\n        <el-form-item label=\"描述\">\r\n          <el-input \r\n            v-model=\"editableEvent.description\" \r\n            type=\"textarea\" \r\n            :rows=\"3\"\r\n            placeholder=\"请输入描述信息\"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"detailsVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"addToCalendarWithEdits\">添加</el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, toRefs, defineProps, defineEmits, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Calendar, Clock, Location, InfoFilled } from '@element-plus/icons-vue'\r\nimport { addCalendarEvent } from '@/api/chat'\r\nimport { formatDate } from '@/utils/date'\r\n\r\nexport default {\r\n  name: 'ChatCalendarEvent',\r\n  \r\n  components: {\r\n    Calendar,\r\n    Clock,\r\n    Location,\r\n    InfoFilled\r\n  },\r\n  \r\n  props: {\r\n    messageId: {\r\n      type: Number,\r\n      required: true\r\n    },\r\n    eventData: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  \r\n  emits: ['calendar-event-added', 'calendar-event-hidden'],\r\n  \r\n  setup(props, { emit }) {\r\n    const calendarEventAdded = ref(false)\r\n    const detailsVisible = ref(false)\r\n    const { eventData } = toRefs(props)\r\n    \r\n    // 创建可编辑的事件对象\r\n    const editableEvent = reactive({\r\n      title: '',\r\n      start: '',\r\n      end: '',\r\n      location: '',\r\n      type: 'blue',\r\n      reminder: '30min',\r\n      description: '',\r\n      is_all_day: false\r\n    })\r\n    \r\n    // 当打开详情对话框时，初始化可编辑事件\r\n    const initEditableEvent = () => {\r\n      if (eventData.value) {\r\n        editableEvent.title = eventData.value.title || ''\r\n        editableEvent.start = formatDateForPicker(eventData.value.start)\r\n        editableEvent.end = formatDateForPicker(eventData.value.end)\r\n        editableEvent.location = eventData.value.location || ''\r\n        editableEvent.type = eventData.value.type || 'blue'\r\n        editableEvent.reminder = eventData.value.reminder || '30min'\r\n        editableEvent.description = eventData.value.description || ''\r\n        editableEvent.is_all_day = eventData.value.is_all_day || false\r\n      }\r\n    }\r\n    \r\n    // 格式化日期为日期选择器所需格式\r\n    const formatDateForPicker = (dateString) => {\r\n      if (!dateString) return ''\r\n      \r\n      try {\r\n        const date = new Date(dateString)\r\n        return formatDate(date, 'YYYY-MM-DD HH:mm:ss')\r\n      } catch (e) {\r\n        return ''\r\n      }\r\n    }\r\n    \r\n    // 显示详情对话框\r\n    const showDetails = () => {\r\n      initEditableEvent()\r\n      detailsVisible.value = true\r\n    }\r\n    \r\n    // 添加到日历\r\n    const addToCalendar = async () => {\r\n      try {\r\n        await addCalendarEvent(props.messageId)\r\n        calendarEventAdded.value = true\r\n        ElMessage.success('日程添加成功')\r\n        emit('calendar-event-added')\r\n      } catch (error) {\r\n        ElMessage.error('添加日程失败：' + (error.response?.data?.error || error.message))\r\n      }\r\n    }\r\n    \r\n    // 使用编辑后的内容添加到日历\r\n    const addToCalendarWithEdits = async () => {\r\n      try {\r\n        await addCalendarEvent(props.messageId, editableEvent)\r\n        calendarEventAdded.value = true\r\n        detailsVisible.value = false\r\n        ElMessage.success('日程添加成功')\r\n        emit('calendar-event-added')\r\n      } catch (error) {\r\n        ElMessage.error('添加日程失败：' + (error.response?.data?.error || error.message))\r\n      }\r\n    }\r\n    \r\n    // 隐藏日程卡片\r\n    const hideCalendarEvent = () => {\r\n      emit('calendar-event-hidden')\r\n    }\r\n    \r\n    // 格式化日期范围\r\n    const formatDateRange = (start, end) => {\r\n      if (!start) return '时间未指定'\r\n      \r\n      try {\r\n        const startDate = new Date(start)\r\n        const endDate = end ? new Date(end) : null\r\n        \r\n        const startDateStr = formatDate(startDate, 'YYYY年MM月DD日 HH:mm')\r\n        \r\n        if (!endDate) return startDateStr\r\n        \r\n        // 如果是同一天，只显示一次日期\r\n        if (startDate.toDateString() === endDate.toDateString()) {\r\n          return `${formatDate(startDate, 'YYYY年MM月DD日 HH:mm')} - ${formatDate(endDate, 'HH:mm')}`\r\n        }\r\n        \r\n        return `${formatDate(startDate, 'YYYY年MM月DD日 HH:mm')} - ${formatDate(endDate, 'YYYY年MM月DD日 HH:mm')}`\r\n      } catch (e) {\r\n        return '时间格式错误'\r\n      }\r\n    }\r\n    \r\n    return {\r\n      calendarEventAdded,\r\n      detailsVisible,\r\n      editableEvent,\r\n      showDetails,\r\n      addToCalendar,\r\n      addToCalendarWithEdits,\r\n      hideCalendarEvent,\r\n      formatDateRange\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.calendar-event-container {\r\n  margin: 4px 0;\r\n  width: 100%;\r\n}\r\n\r\n.calendar-event-card {\r\n  border-radius: 6px;\r\n  overflow: hidden;\r\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\r\n  background-color: #fff;\r\n  border: 1px solid #ebeef5;\r\n}\r\n\r\n.calendar-event-header {\r\n  padding: 10px 12px;\r\n  display: flex;\r\n  align-items: center;\r\n  color: #fff;\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n}\r\n\r\n.event-type-blue {\r\n  background-color: #409eff;\r\n}\r\n\r\n.event-type-orange {\r\n  background-color: #e6a23c;\r\n}\r\n\r\n.event-type-green {\r\n  background-color: #67c23a;\r\n}\r\n\r\n.event-type-red {\r\n  background-color: #f56c6c;\r\n}\r\n\r\n.event-type-purple {\r\n  background-color: #909399;\r\n}\r\n\r\n.calendar-icon {\r\n  margin-right: 8px;\r\n}\r\n\r\n.event-title {\r\n  flex: 1;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.calendar-event-content {\r\n  padding: 12px;\r\n  font-size: 13px;\r\n  color: #606266;\r\n}\r\n\r\n.event-time, .event-location, .event-description {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.event-description {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.el-icon {\r\n  margin-right: 8px;\r\n  flex-shrink: 0;\r\n  margin-top: 2px;\r\n}\r\n\r\n.calendar-event-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  padding: 8px 12px;\r\n  border-top: 1px solid #ebeef5;\r\n  gap: 8px;\r\n}\r\n\r\n.calendar-event-success {\r\n  padding: 8px 12px;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]}]}