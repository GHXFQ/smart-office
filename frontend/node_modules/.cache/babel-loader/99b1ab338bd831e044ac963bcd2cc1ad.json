{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Redirect.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Redirect.vue","mtime":1750507793276},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0IHsgcmVmLCBvbk1vdW50ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VSb3V0ZSwgdXNlUm91dGVyIH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCB7IGZpbmRPckNyZWF0ZVByaXZhdGVDaGF0IH0gZnJvbSAnQC9hcGkvY2hhdCc7IC8vIFRoaXMgQVBJIG1ldGhvZCBuZWVkcyB0byBiZSBjcmVhdGVkCmltcG9ydCB7IEVsTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtcGx1cyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2hhdFJlZGlyZWN0JywKICBzZXR1cCgpIHsKICAgIGNvbnN0IHJvdXRlID0gdXNlUm91dGUoKTsKICAgIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpOwogICAgY29uc3QgbG9hZGluZ1RleHQgPSByZWYoJ+ato+WcqOafpeaJvuaIluWIm+W7uuiBiuWkqS4uLicpOwogICAgb25Nb3VudGVkKGFzeW5jICgpID0+IHsKICAgICAgY29uc3QgdXNlcklkID0gcm91dGUucGFyYW1zLnVzZXJJZDsKICAgICAgaWYgKCF1c2VySWQpIHsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aXoOaViOeahOeUqOaIt0lEJyk7CiAgICAgICAgcm91dGVyLnB1c2goJy9jb250YWN0cycpOyAvLyBSZWRpcmVjdCB0byBhIHNhZmUgcGFnZQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGEKICAgICAgICB9ID0gYXdhaXQgZmluZE9yQ3JlYXRlUHJpdmF0ZUNoYXQodXNlcklkKTsKICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLnNlc3Npb25faWQpIHsKICAgICAgICAgIC8vIFJlZGlyZWN0IHRvIHRoZSBjaGF0IHBhZ2Ugd2l0aCB0aGUgc2Vzc2lvbiBJRAogICAgICAgICAgcm91dGVyLnJlcGxhY2UoewogICAgICAgICAgICBwYXRoOiAnL2NoYXQnLAogICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgIHNlc3Npb25JZDogZGF0YS5zZXNzaW9uX2lkCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+acquiDveiOt+WPluiBiuWkqeS8muivnUlEJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmaW5kIG9yIGNyZWF0ZSBjaGF0OicsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAn5peg5rOV5omT5byA6IGK5aSp77yM6K+356iN5ZCO5YaN6K+V44CCJyk7CiAgICAgICAgbG9hZGluZ1RleHQudmFsdWUgPSAn5Ye66ZSZ5LqGLi4uJzsKICAgICAgICAvLyBSZWRpcmVjdCBiYWNrIHRvIHRoZSBtYWluIGNvbnRhY3RzIG9yIGRhc2hib2FyZCBwYWdlIGFmdGVyIGFuIGVycm9yCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByb3V0ZXIucHVzaCgnL2NvbnRhY3QnKSwgMjAwMCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZ1RleHQKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["ref","onMounted","useRoute","useRouter","findOrCreatePrivateChat","ElMessage","name","setup","route","router","loadingText","userId","params","error","push","data","session_id","replace","path","query","sessionId","Error","console","message","value","setTimeout"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Redirect.vue"],"sourcesContent":["<template>\r\n  <div class=\"loading-container\">\r\n    <el-loading \r\n      :text=\"loadingText\"\r\n      background=\"rgba(255, 255, 255, 0.7)\"\r\n      spinner=\"el-icon-loading\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { findOrCreatePrivateChat } from '@/api/chat'; // This API method needs to be created\r\nimport { ElMessage } from 'element-plus';\r\n\r\nexport default {\r\n  name: 'ChatRedirect',\r\n  setup() {\r\n    const route = useRoute();\r\n    const router = useRouter();\r\n    const loadingText = ref('正在查找或创建聊天...');\r\n\r\n    onMounted(async () => {\r\n      const userId = route.params.userId;\r\n      if (!userId) {\r\n        ElMessage.error('无效的用户ID');\r\n        router.push('/contacts'); // Redirect to a safe page\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const { data } = await findOrCreatePrivateChat(userId);\r\n        if (data && data.session_id) {\r\n          // Redirect to the chat page with the session ID\r\n          router.replace({ path: '/chat', query: { sessionId: data.session_id } });\r\n        } else {\r\n          throw new Error('未能获取聊天会话ID');\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to find or create chat:', error);\r\n        ElMessage.error(error.message || '无法打开聊天，请稍后再试。');\r\n        loadingText.value = '出错了...';\r\n        // Redirect back to the main contacts or dashboard page after an error\r\n        setTimeout(() => router.push('/contact'), 2000);\r\n      }\r\n    });\r\n\r\n    return {\r\n      loadingText,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.loading-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 100%;\r\n  height: 100vh;\r\n}\r\n</style> "],"mappings":";;AAWA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAK;AACpC,SAASC,QAAQ,EAAEC,SAAQ,QAAS,YAAY;AAChD,SAASC,uBAAsB,QAAS,YAAY,EAAE;AACtD,SAASC,SAAQ,QAAS,cAAc;AAExC,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIN,QAAQ,CAAC,CAAC;IACxB,MAAMO,MAAK,GAAIN,SAAS,CAAC,CAAC;IAC1B,MAAMO,WAAU,GAAIV,GAAG,CAAC,cAAc,CAAC;IAEvCC,SAAS,CAAC,YAAY;MACpB,MAAMU,MAAK,GAAIH,KAAK,CAACI,MAAM,CAACD,MAAM;MAClC,IAAI,CAACA,MAAM,EAAE;QACXN,SAAS,CAACQ,KAAK,CAAC,SAAS,CAAC;QAC1BJ,MAAM,CAACK,IAAI,CAAC,WAAW,CAAC,EAAE;QAC1B;MACF;MAEA,IAAI;QACF,MAAM;UAAEC;QAAK,IAAI,MAAMX,uBAAuB,CAACO,MAAM,CAAC;QACtD,IAAII,IAAG,IAAKA,IAAI,CAACC,UAAU,EAAE;UAC3B;UACAP,MAAM,CAACQ,OAAO,CAAC;YAAEC,IAAI,EAAE,OAAO;YAAEC,KAAK,EAAE;cAAEC,SAAS,EAAEL,IAAI,CAACC;YAAW;UAAE,CAAC,CAAC;QAC1E,OAAO;UACL,MAAM,IAAIK,KAAK,CAAC,YAAY,CAAC;QAC/B;MACF,EAAE,OAAOR,KAAK,EAAE;QACdS,OAAO,CAACT,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QACtDR,SAAS,CAACQ,KAAK,CAACA,KAAK,CAACU,OAAM,IAAK,eAAe,CAAC;QACjDb,WAAW,CAACc,KAAI,GAAI,QAAQ;QAC5B;QACAC,UAAU,CAAC,MAAMhB,MAAM,CAACK,IAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC;MACjD;IACF,CAAC,CAAC;IAEF,OAAO;MACLJ;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]}]}