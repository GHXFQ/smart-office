{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\knowledge\\components\\KnowledgeGraph.vue?vue&type=script&setup=true&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\knowledge\\components\\KnowledgeGraph.vue","mtime":1754627606600},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5kaWZmZXJlbmNlLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmludGVyc2VjdGlvbi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1kaXNqb2ludC1mcm9tLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmlzLXN1YnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1zdXBlcnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5zeW1tZXRyaWMtZGlmZmVyZW5jZS52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC51bmlvbi52Mi5qcyI7CmltcG9ydCB7IHJlZiwgcmVhY3RpdmUsIGNvbXB1dGVkLCBvbk1vdW50ZWQsIG9uVW5tb3VudGVkLCBuZXh0VGljayB9IGZyb20gJ3Z1ZSc7CmltcG9ydCAqIGFzIGVjaGFydHMgZnJvbSAnZWNoYXJ0cyc7CmltcG9ydCB7IFNlYXJjaCwgUmVmcmVzaCwgRG93bmxvYWQsIEZ1bGxTY3JlZW4sIERhdGFBbmFseXNpcywgRXhwYW5kLCBGb2xkLCBBcnJvd1JpZ2h0LCBMb2FkaW5nIH0gZnJvbSAnQGVsZW1lbnQtcGx1cy9pY29ucy12dWUnOwppbXBvcnQgeyBFbE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXBsdXMnOwppbXBvcnQgeyBnZXRLbm93bGVkZ2VHcmFwaERhdGEsIGdldEVudGl0eURldGFpbCB9IGZyb20gJ0AvYXBpL2tub3dsZWRnZSc7CgovLyDlk43lupTlvI/mlbDmja4KCmV4cG9ydCBkZWZhdWx0IHsKICBfX25hbWU6ICdLbm93bGVkZ2VHcmFwaCcsCiAgc2V0dXAoX19wcm9wcywgewogICAgZXhwb3NlOiBfX2V4cG9zZQogIH0pIHsKICAgIGNvbnN0IGNoYXJ0UmVmID0gcmVmKG51bGwpOwogICAgY29uc3QgY2hhcnQgPSByZWYobnVsbCk7CiAgICBjb25zdCBsb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNob3dFbnRpdHlEZXRhaWwgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2VsZWN0ZWRFbnRpdHkgPSByZWYobnVsbCk7CiAgICBjb25zdCBzZWFyY2hRdWVyeSA9IHJlZignJyk7CiAgICBjb25zdCBzZWxlY3RlZFR5cGVzID0gcmVmKFtdKTsKICAgIGNvbnN0IGxheW91dFR5cGUgPSByZWYoJ2NpcmN1bGFyJyk7CiAgICBjb25zdCBzaG93TGFiZWxzID0gcmVmKHRydWUpOwoKICAgIC8vIOWbvuiwseaVsOaNrgogICAgY29uc3QgZ3JhcGhEYXRhID0gcmVhY3RpdmUoewogICAgICBub2RlczogW10sCiAgICAgIGVkZ2VzOiBbXSwKICAgICAgY2F0ZWdvcmllczogW10KICAgIH0pOwogICAgY29uc3QgZW50aXR5VHlwZXMgPSByZWYoW10pOwogICAgY29uc3QgZW50aXR5UmVsYXRpb25zaGlwcyA9IHJlZihbXSk7CgogICAgLy8g5LqL5Lu25aSE55CG5Ye95pWwCiAgICBsZXQgaGFuZGxlUmVzaXplID0gbnVsbDsKICAgIGxldCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlID0gbnVsbDsKCiAgICAvLyDorqHnrpflsZ7mgKcKICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIHJldHVybiBncmFwaERhdGEuY2F0ZWdvcmllcy5tYXAoY2F0ID0+ICh7CiAgICAgICAgbmFtZTogY2F0Lm5hbWUsCiAgICAgICAgY29sb3I6IGNhdC5jb2xvcgogICAgICB9KSk7CiAgICB9KTsKCiAgICAvLyDmlrnms5UKICAgIGNvbnN0IHRvZ2dsZUNvbGxhcHNlID0gKCkgPT4gewogICAgICBpc0NvbGxhcHNlZC52YWx1ZSA9ICFpc0NvbGxhcHNlZC52YWx1ZTsKICAgIH07CiAgICBjb25zdCBoYW5kbGVTZWFyY2ggPSAoKSA9PiB7CiAgICAgIGlmICghc2VhcmNoUXVlcnkudmFsdWUudHJpbSgpKSB7CiAgICAgICAgcmVzZXRIaWdobGlnaHQoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3Qgc2VhcmNoVGVybSA9IHNlYXJjaFF1ZXJ5LnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgIGNvbnN0IG1hdGNoZWROb2RlcyA9IGdyYXBoRGF0YS5ub2Rlcy5maWx0ZXIobm9kZSA9PiBub2RlLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKSk7CiAgICAgIGlmIChtYXRjaGVkTm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgIGhpZ2hsaWdodE5vZGVzKG1hdGNoZWROb2Rlcyk7CiAgICAgICAgLy8g6IGa54Sm5Yiw56ys5LiA5Liq5Yy56YWN55qE6IqC54K5CiAgICAgICAgaWYgKGNoYXJ0LnZhbHVlKSB7CiAgICAgICAgICBjaGFydC52YWx1ZS5kaXNwYXRjaEFjdGlvbih7CiAgICAgICAgICAgIHR5cGU6ICdmb2N1c05vZGVBZGphY2VuY3knLAogICAgICAgICAgICBzZXJpZXNJbmRleDogMCwKICAgICAgICAgICAgZGF0YUluZGV4OiBncmFwaERhdGEubm9kZXMuZmluZEluZGV4KG5vZGUgPT4gbm9kZS5pZCA9PT0gbWF0Y2hlZE5vZGVzWzBdLmlkKQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfmnKrmib7liLDljLnphY3nmoTlrp7kvZMnKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGhhbmRsZVR5cGVGaWx0ZXIgPSBhc3luYyAoKSA9PiB7CiAgICAgIGF3YWl0IHVwZGF0ZUNoYXJ0KCk7CiAgICB9OwogICAgY29uc3QgaGFuZGxlTGF5b3V0Q2hhbmdlID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zb2xlLmxvZygn8J+UhCDluIPlsYDnsbvlnovmlLnlj5g6JywgbGF5b3V0VHlwZS52YWx1ZSk7CgogICAgICAvLyDlpoLmnpzliIfmjaLliLDlipvlr7zlkJHluIPlsYDvvIzmuIXpmaTmiYDmnInoioLngrnnmoTlm7rlrprkvY3nva4KICAgICAgaWYgKGxheW91dFR5cGUudmFsdWUgPT09ICdmb3JjZScpIHsKICAgICAgICBjb25zb2xlLmxvZygn8J+OryDliIfmjaLliLDlipvlr7zlkJHluIPlsYDvvIzmuIXpmaToioLngrnlm7rlrprkvY3nva4nKTsKICAgICAgICBncmFwaERhdGEubm9kZXMuZm9yRWFjaChub2RlID0+IHsKICAgICAgICAgIC8vIOenu+mZpOWPr+iDveWtmOWcqOeahOWbuuWumuS9jee9ruWxnuaApwogICAgICAgICAgZGVsZXRlIG5vZGUuZml4ZWQ7CiAgICAgICAgICBkZWxldGUgbm9kZS54OwogICAgICAgICAgZGVsZXRlIG5vZGUueTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8g5by65Yi26YeN5paw5riy5p+T5Zu+6KGoCiAgICAgIGlmIChjaGFydC52YWx1ZSAmJiAhY2hhcnQudmFsdWUuaXNEaXNwb3NlZCgpKSB7CiAgICAgICAgY2hhcnQudmFsdWUuY2xlYXIoKTsgLy8g5riF6Zmk5b2T5YmN5Zu+6KGo5YaF5a65CiAgICAgIH0KICAgICAgYXdhaXQgdXBkYXRlQ2hhcnQoKTsKICAgIH07CiAgICBjb25zdCByZXNldEdyYXBoID0gKCkgPT4gewogICAgICBzZWFyY2hRdWVyeS52YWx1ZSA9ICcnOwogICAgICBzZWxlY3RlZFR5cGVzLnZhbHVlID0gW107CiAgICAgIHJlc2V0SGlnaGxpZ2h0KCk7CiAgICAgIGlmIChjaGFydC52YWx1ZSkgewogICAgICAgIGNoYXJ0LnZhbHVlLmRpc3BhdGNoQWN0aW9uKHsKICAgICAgICAgIHR5cGU6ICdyZXN0b3JlJwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZXhwb3J0R3JhcGggPSAoKSA9PiB7CiAgICAgIGlmIChjaGFydC52YWx1ZSkgewogICAgICAgIGNvbnN0IHVybCA9IGNoYXJ0LnZhbHVlLmdldERhdGFVUkwoewogICAgICAgICAgdHlwZTogJ3BuZycsCiAgICAgICAgICBwaXhlbFJhdGlvOiAyLAogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2ZmZicKICAgICAgICB9KTsKICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICBsaW5rLmRvd25sb2FkID0gJ+efpeivhuWbvuiwsS5wbmcnOwogICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5Zu+6LCx5a+85Ye65oiQ5YqfJyk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCB0b2dnbGVGdWxsc2NyZWVuID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBjb250YWluZXIgPSBjaGFydFJlZi52YWx1ZS5wYXJlbnRFbGVtZW50OwogICAgICB0cnkgewogICAgICAgIGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCkgewogICAgICAgICAgYXdhaXQgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXdhaXQgY29udGFpbmVyLnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICAgICAgfQogICAgICAgIC8vIOetieW+heWFqOWxj+eKtuaAgeaUueWPmOWQjumHjeaWsOiwg+aVtOWbvuihqOWkp+WwjwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgaWYgKGNoYXJ0LnZhbHVlICYmICFjaGFydC52YWx1ZS5pc0Rpc3Bvc2VkKCkpIHsKICAgICAgICAgICAgY2hhcnQudmFsdWUucmVzaXplKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgMTAwKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCflhajlsY/mk43kvZzlpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5YWo5bGP5pON5L2c5aSx6LSlJyk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBnZXRFbnRpdHlDb2xvciA9IHR5cGUgPT4gewogICAgICBjb25zdCBjYXRlZ29yeSA9IGdyYXBoRGF0YS5jYXRlZ29yaWVzLmZpbmQoY2F0ID0+IGNhdC5uYW1lID09PSB0eXBlKTsKICAgICAgcmV0dXJuIGNhdGVnb3J5ID8gY2F0ZWdvcnkuY29sb3IgOiAnIzQwOUVGRic7CiAgICB9OwogICAgY29uc3QgZ2V0RW50aXR5VGFnVHlwZSA9IHR5cGUgPT4gewogICAgICBjb25zdCB0eXBlTWFwID0gewogICAgICAgICdPUkdBTklaQVRJT04nOiAncHJpbWFyeScsCiAgICAgICAgJ1BFUlNPTic6ICdzdWNjZXNzJywKICAgICAgICAnTE9DQVRJT04nOiAnd2FybmluZycsCiAgICAgICAgJ0VWRU5UJzogJ2RhbmdlcicsCiAgICAgICAgJ+e7hOe7hyc6ICdwcmltYXJ5JywKICAgICAgICAn5Lq65ZGYJzogJ3N1Y2Nlc3MnLAogICAgICAgICflnLDngrknOiAnd2FybmluZycsCiAgICAgICAgJ+S6i+S7tic6ICdkYW5nZXInCiAgICAgIH07CiAgICAgIHJldHVybiB0eXBlTWFwW3R5cGVdIHx8ICdpbmZvJzsKICAgIH07CgogICAgLy8g6Iux5paH57G75Z6L6L2s5Lit5paH5pig5bCECiAgICBjb25zdCBnZXRDaGluZXNlVHlwZSA9IGVuZ2xpc2hUeXBlID0+IHsKICAgICAgY29uc3QgdHlwZU1hcCA9IHsKICAgICAgICAnT1JHQU5JWkFUSU9OJzogJ+e7hOe7hycsCiAgICAgICAgJ1BFUlNPTic6ICfkurrlkZgnLAogICAgICAgICdMT0NBVElPTic6ICflnLDngrknLAogICAgICAgICdFVkVOVCc6ICfkuovku7YnCiAgICAgIH07CiAgICAgIHJldHVybiB0eXBlTWFwW2VuZ2xpc2hUeXBlXSB8fCBlbmdsaXNoVHlwZTsKICAgIH07CgogICAgLy8g5LyY5YyW5ZyG5b2i5biD5bGA77yM56Gu5L+d6IqC54K55LiN5rqi5Ye65a655ZmoCiAgICBjb25zdCBvcHRpbWl6ZUNpcmN1bGFyTGF5b3V0ID0gKG5vZGVzLCBjb250YWluZXJXaWR0aCwgY29udGFpbmVySGVpZ2h0KSA9PiB7CiAgICAgIGlmICghbm9kZXMgfHwgbm9kZXMubGVuZ3RoID09PSAwKSByZXR1cm4gbm9kZXM7CiAgICAgIGNvbnN0IGNlbnRlclggPSBjb250YWluZXJXaWR0aCAvIDI7CiAgICAgIGNvbnN0IGNlbnRlclkgPSBjb250YWluZXJIZWlnaHQgLyAyOwogICAgICBjb25zdCBtYXhSYWRpdXMgPSBNYXRoLm1pbihjb250YWluZXJXaWR0aCwgY29udGFpbmVySGVpZ2h0KSAvIDIgLSA4MDsgLy8g55WZ5Ye66L656LedCgogICAgICAvLyDmoLnmja7oioLngrnmlbDph4/liqjmgIHosIPmlbTljYrlvoQKICAgICAgY29uc3Qgbm9kZUNvdW50ID0gbm9kZXMubGVuZ3RoOwogICAgICBsZXQgcmFkaXVzID0gbWF4UmFkaXVzOwogICAgICBpZiAobm9kZUNvdW50ID4gMjApIHsKICAgICAgICByYWRpdXMgPSBtYXhSYWRpdXMgKiAwLjg7IC8vIOiKgueCueWkmuaXtue8qeWwj+WNiuW+hAogICAgICB9IGVsc2UgaWYgKG5vZGVDb3VudCA+IDEwKSB7CiAgICAgICAgcmFkaXVzID0gbWF4UmFkaXVzICogMC45OwogICAgICB9CgogICAgICAvLyDkuLrmr4/kuKroioLngrnorqHnrpfkvY3nva4KICAgICAgcmV0dXJuIG5vZGVzLm1hcCgobm9kZSwgaW5kZXgpID0+IHsKICAgICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLlBJICogaW5kZXggLyBub2RlQ291bnQ7CiAgICAgICAgY29uc3QgeCA9IGNlbnRlclggKyByYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgY29uc3QgeSA9IGNlbnRlclkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIC4uLm5vZGUsCiAgICAgICAgICB4OiBNYXRoLm1heCg1MCwgTWF0aC5taW4oY29udGFpbmVyV2lkdGggLSA1MCwgeCkpLAogICAgICAgICAgeTogTWF0aC5tYXgoNTAsIE1hdGgubWluKGNvbnRhaW5lckhlaWdodCAtIDUwLCB5KSkKICAgICAgICB9OwogICAgICB9KTsKICAgIH07CiAgICBjb25zdCBoaWdobGlnaHROb2RlcyA9IG5vZGVzID0+IHsKICAgICAgaWYgKCFjaGFydC52YWx1ZSkgcmV0dXJuOwogICAgICBjb25zdCBub2RlSWRzID0gbm9kZXMubWFwKG5vZGUgPT4gbm9kZS5pZCk7CiAgICAgIGNoYXJ0LnZhbHVlLmRpc3BhdGNoQWN0aW9uKHsKICAgICAgICB0eXBlOiAnaGlnaGxpZ2h0JywKICAgICAgICBzZXJpZXNJbmRleDogMCwKICAgICAgICBkYXRhSW5kZXg6IGdyYXBoRGF0YS5ub2Rlcy5tYXAoKG5vZGUsIGluZGV4KSA9PiBub2RlSWRzLmluY2x1ZGVzKG5vZGUuaWQpID8gaW5kZXggOiBudWxsKS5maWx0ZXIoaW5kZXggPT4gaW5kZXggIT09IG51bGwpCiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHJlc2V0SGlnaGxpZ2h0ID0gKCkgPT4gewogICAgICBpZiAoIWNoYXJ0LnZhbHVlKSByZXR1cm47CiAgICAgIGNoYXJ0LnZhbHVlLmRpc3BhdGNoQWN0aW9uKHsKICAgICAgICB0eXBlOiAnZG93bnBsYXknLAogICAgICAgIHNlcmllc0luZGV4OiAwCiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IGhpZ2hsaWdodFJlbGF0aW9uc2hpcCA9IHJlbGF0aW9uc2hpcCA9PiB7CiAgICAgIC8vIOmrmOS6ruaYvuekuueJueWumuWFs+ezuwogICAgICBpZiAoIWNoYXJ0LnZhbHVlKSByZXR1cm47CiAgICAgIGNvbnN0IHNvdXJjZUluZGV4ID0gZ3JhcGhEYXRhLm5vZGVzLmZpbmRJbmRleChub2RlID0+IG5vZGUuaWQgPT09IHNlbGVjdGVkRW50aXR5LnZhbHVlLmlkKTsKICAgICAgY29uc3QgdGFyZ2V0SW5kZXggPSBncmFwaERhdGEubm9kZXMuZmluZEluZGV4KG5vZGUgPT4gbm9kZS5uYW1lID09PSByZWxhdGlvbnNoaXAudGFyZ2V0TmFtZSk7CiAgICAgIGlmIChzb3VyY2VJbmRleCAhPT0gLTEgJiYgdGFyZ2V0SW5kZXggIT09IC0xKSB7CiAgICAgICAgY2hhcnQudmFsdWUuZGlzcGF0Y2hBY3Rpb24oewogICAgICAgICAgdHlwZTogJ2hpZ2hsaWdodCcsCiAgICAgICAgICBzZXJpZXNJbmRleDogMCwKICAgICAgICAgIGRhdGFJbmRleDogW3NvdXJjZUluZGV4LCB0YXJnZXRJbmRleF0KICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGluaXRDaGFydCA9IGFzeW5jIChyZXRyeUNvdW50ID0gMCkgPT4gewogICAgICB2YXIgX3RhcmdldEVsZW1lbnQkcGFyZW50OwogICAgICBjb25zb2xlLmxvZyhg8J+OryDlvIDlp4vliJ3lp4vljJblm77ooaguLi4gKOWwneivleasoeaVsDogJHtyZXRyeUNvdW50ICsgMX0pYCk7CgogICAgICAvLyDor6bnu4bmo4Dmn6VET03lhYPntKDnirbmgIEKICAgICAgY29uc29sZS5sb2coJ/CflI0gRE9N5YWD57Sg54q25oCB5qOA5p+lOicsIHsKICAgICAgICBjaGFydFJlZkV4aXN0czogISFjaGFydFJlZi52YWx1ZSwKICAgICAgICBjaGFydFJlZlZhbHVlOiAhIWNoYXJ0UmVmLnZhbHVlLAogICAgICAgIGNoYXJ0UmVmVHlwZTogdHlwZW9mIGNoYXJ0UmVmLnZhbHVlLAogICAgICAgIGRvY3VtZW50UmVhZHk6IGRvY3VtZW50LnJlYWR5U3RhdGUKICAgICAgfSk7CgogICAgICAvLyDmo4Dmn6VET03lhYPntKDmmK/lkKblrZjlnKgKICAgICAgbGV0IHRhcmdldEVsZW1lbnQgPSBjaGFydFJlZi52YWx1ZTsKICAgICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gY2hhcnRSZWYudmFsdWUg5Li656m677yM5bCd6K+V5aSH55So5pa55qGIJyk7CgogICAgICAgIC8vIOWkh+eUqOaWueahiO+8muebtOaOpemAmui/h2NsYXNz6YCJ5oup5Zmo6I635Y+W5YWD57SgCiAgICAgICAgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGFydC1jYW52YXMnKTsKICAgICAgICBjb25zb2xlLmxvZygn8J+UjSDlpIfnlKjmlrnmoYjmn6Xmib7nu5Pmnpw6JywgewogICAgICAgICAgZm91bmRCeUNsYXNzOiAhIXRhcmdldEVsZW1lbnQsCiAgICAgICAgICBlbGVtZW50VHlwZTogdGFyZ2V0RWxlbWVudCA/IHRhcmdldEVsZW1lbnQudGFnTmFtZSA6ICdOL0EnCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgICBpZiAocmV0cnlDb3VudCA8IDEwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIOetieW+hURPTeWFg+e0oOWwsee7qu+8jOesrCR7cmV0cnlDb3VudCArIDF95qyh6YeN6K+VLi4uYCk7CiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTsKICAgICAgICAgICAgcmV0dXJuIGluaXRDaGFydChyZXRyeUNvdW50ICsgMSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg6L6+5Yiw5pyA5aSn6YeN6K+V5qyh5pWw77yMRE9N5YWD57Sg5LuN54S25LiN5a2Y5ZyoJyk7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ/CflI0g5pyA57uI54q25oCB5qOA5p+lOicsIHsKICAgICAgICAgICAgICBhbGxDaGFydENhbnZhczogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNoYXJ0LWNhbnZhcycpLmxlbmd0aCwKICAgICAgICAgICAgICBib2R5Q2hpbGRyZW46IGRvY3VtZW50LmJvZHkuY2hpbGRyZW4ubGVuZ3RoLAogICAgICAgICAgICAgIGRvY3VtZW50UmVhZHk6IGRvY3VtZW50LnJlYWR5U3RhdGUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRE9N5YWD57Sg5Yid5aeL5YyW5aSx6LSlJyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOWmguaenOmAmui/h2NsYXNz5om+5Yiw5LqG5YWD57Sg77yM5pu05pawY2hhcnRSZWYKICAgICAgICAgIGNoYXJ0UmVmLnZhbHVlID0gdGFyZ2V0RWxlbWVudDsKICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUg6YCa6L+H5aSH55So5pa55qGI5om+5YiwRE9N5YWD57SgJyk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyDlvLrliLbop6blj5Hph43mjpLvvIznoa7kv51ET03lrozlhajmuLLmn5MKICAgICAgdGFyZ2V0RWxlbWVudC5vZmZzZXRIZWlnaHQ7CiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpOwoKICAgICAgLy8g5qOA5p+lRE9N5YWD57Sg5piv5ZCm5Y+v6KeB5ZKM5pyJ5bC65a+4CiAgICAgIGNvbnN0IHJlY3QgPSB0YXJnZXRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBjb25zdCBjb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGFyZ2V0RWxlbWVudCk7CiAgICAgIGNvbnN0IHBhcmVudFJlY3QgPSAoX3RhcmdldEVsZW1lbnQkcGFyZW50ID0gdGFyZ2V0RWxlbWVudC5wYXJlbnRFbGVtZW50KSA9PT0gbnVsbCB8fCBfdGFyZ2V0RWxlbWVudCRwYXJlbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90YXJnZXRFbGVtZW50JHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgIC8vIOaUvuWuveWPr+ingeaAp+ajgOafpeadoeS7tiAtIOWPquimgeWFg+e0oOWtmOWcqOS4lOS4jeaYr2Rpc3BsYXk6bm9uZeWwseiupOS4uuWPr+eUqAogICAgICBjb25zdCBpc0VsZW1lbnRVc2FibGUgPSBjb21wdXRlZFN0eWxlLmRpc3BsYXkgIT09ICdub25lJyAmJiBjb21wdXRlZFN0eWxlLnZpc2liaWxpdHkgIT09ICdoaWRkZW4nOwogICAgICBjb25zdCBwYXJlbnRWaXNpYmxlID0gIXBhcmVudFJlY3QgfHwgcGFyZW50UmVjdC53aWR0aCA+IDAgJiYgcGFyZW50UmVjdC5oZWlnaHQgPiAwOwogICAgICBjb25zb2xlLmxvZygn8J+TiiBET03lhYPntKDnirbmgIHmo4Dmn6U6JywgewogICAgICAgIHdpZHRoOiByZWN0LndpZHRoLAogICAgICAgIGhlaWdodDogcmVjdC5oZWlnaHQsCiAgICAgICAgb2Zmc2V0V2lkdGg6IHRhcmdldEVsZW1lbnQub2Zmc2V0V2lkdGgsCiAgICAgICAgb2Zmc2V0SGVpZ2h0OiB0YXJnZXRFbGVtZW50Lm9mZnNldEhlaWdodCwKICAgICAgICBjbGllbnRXaWR0aDogdGFyZ2V0RWxlbWVudC5jbGllbnRXaWR0aCwKICAgICAgICBjbGllbnRIZWlnaHQ6IHRhcmdldEVsZW1lbnQuY2xpZW50SGVpZ2h0LAogICAgICAgIGRpc3BsYXk6IGNvbXB1dGVkU3R5bGUuZGlzcGxheSwKICAgICAgICB2aXNpYmlsaXR5OiBjb21wdXRlZFN0eWxlLnZpc2liaWxpdHksCiAgICAgICAgb3BhY2l0eTogY29tcHV0ZWRTdHlsZS5vcGFjaXR5LAogICAgICAgIGlzRWxlbWVudFVzYWJsZSwKICAgICAgICBwYXJlbnRWaXNpYmxlLAogICAgICAgIHBhcmVudFJlY3Q6IHBhcmVudFJlY3QgPyB7CiAgICAgICAgICB3aWR0aDogcGFyZW50UmVjdC53aWR0aCwKICAgICAgICAgIGhlaWdodDogcGFyZW50UmVjdC5oZWlnaHQKICAgICAgICB9IDogbnVsbAogICAgICB9KTsKCiAgICAgIC8vIOWmguaenOWFg+e0oOS4jeWPr+eUqO+8jOetieW+hemHjeivlQogICAgICBpZiAoIWlzRWxlbWVudFVzYWJsZSkgewogICAgICAgIGlmIChyZXRyeUNvdW50IDwgNSkgewogICAgICAgICAgY29uc29sZS5sb2coYPCflIQgRE9N5YWD57Sg5LiN5Y+v55So77yM56ysJHtyZXRyeUNvdW50ICsgMX3mrKHph43or5UuLi5gKTsKICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTsKICAgICAgICAgIHJldHVybiBpbml0Q2hhcnQocmV0cnlDb3VudCArIDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyDlhYPntKDku43kuI3lj6/nlKjvvIzkvYbnu6fnu63lsJ3or5XliJ3lp4vljJYnKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIOacgOe7iOWwuuWvuOehruiupO+8jOS8mOWFiOS9v+eUqENTU+iuvue9rueahOWbuuWumuWwuuWvuAogICAgICBsZXQgZmluYWxXaWR0aCA9IHRhcmdldEVsZW1lbnQub2Zmc2V0V2lkdGggfHwgdGFyZ2V0RWxlbWVudC5jbGllbnRXaWR0aCB8fCByZWN0LndpZHRoOwogICAgICBsZXQgZmluYWxIZWlnaHQgPSB0YXJnZXRFbGVtZW50Lm9mZnNldEhlaWdodCB8fCB0YXJnZXRFbGVtZW50LmNsaWVudEhlaWdodCB8fCByZWN0LmhlaWdodDsKCiAgICAgIC8vIOWmguaenOaXoOazleiOt+WPluWwuuWvuO+8jOS9v+eUqENTU+S4reiuvue9rueahOm7mOiupOWAvAogICAgICBpZiAoIWZpbmFsV2lkdGggfHwgZmluYWxXaWR0aCA8IDEwMCkgewogICAgICAgIGZpbmFsV2lkdGggPSA4MDA7IC8vIOWvueW6lENTU+S4rWNoYXJ0LWNhbnZhc+eahGZsZXg6Meiuoeeul+e7k+aenAogICAgICB9CiAgICAgIGlmICghZmluYWxIZWlnaHQgfHwgZmluYWxIZWlnaHQgPCAxMDApIHsKICAgICAgICBmaW5hbEhlaWdodCA9IDUwMDsgLy8g5a+55bqUQ1NT5LitY2hhcnQtY2FudmFz55qE5Zu65a6a6auY5bqmCiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ/Cfk4og55uu5qCHRE9N5YWD57SgOicsIHRhcmdldEVsZW1lbnQpOwogICAgICBjb25zb2xlLmxvZygn8J+TiiDmnIDnu4jkvb/nlKjlsLrlr7g6JywgewogICAgICAgIHdpZHRoOiBmaW5hbFdpZHRoLAogICAgICAgIGhlaWdodDogZmluYWxIZWlnaHQsCiAgICAgICAgb2Zmc2V0V2lkdGg6IHRhcmdldEVsZW1lbnQub2Zmc2V0V2lkdGgsCiAgICAgICAgb2Zmc2V0SGVpZ2h0OiB0YXJnZXRFbGVtZW50Lm9mZnNldEhlaWdodCwKICAgICAgICBjbGllbnRXaWR0aDogdGFyZ2V0RWxlbWVudC5jbGllbnRXaWR0aCwKICAgICAgICBjbGllbnRIZWlnaHQ6IHRhcmdldEVsZW1lbnQuY2xpZW50SGVpZ2h0CiAgICAgIH0pOwoKICAgICAgLy8g5aaC5p6c5bey5pyJ5a6e5L6L77yM5YWI6ZSA5q+BCiAgICAgIGlmIChjaGFydC52YWx1ZSAmJiAhY2hhcnQudmFsdWUuaXNEaXNwb3NlZCgpKSB7CiAgICAgICAgY29uc29sZS5sb2coJ/Cfl5HvuI8g6ZSA5q+B546w5pyJRUNoYXJ0c+WunuS+iycpOwogICAgICAgIGNoYXJ0LnZhbHVlLmRpc3Bvc2UoKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygn8J+OqCDlvIDlp4vliJ3lp4vljJZFQ2hhcnRz5a6e5L6LLi4uJyk7CiAgICAgIC8vIOaYjuehruaMh+WumkVDaGFydHPphY3nva7vvIzop6PlhrPpq5hEUEnmmL7npLrlmahjYW52YXPlsLrlr7jlvILluLjpl67popgKICAgICAgY2hhcnQudmFsdWUgPSBlY2hhcnRzLmluaXQodGFyZ2V0RWxlbWVudCwgbnVsbCwgewogICAgICAgIHJlbmRlcmVyOiAnY2FudmFzJywKICAgICAgICBkZXZpY2VQaXhlbFJhdGlvOiAxLAogICAgICAgIC8vIOWbuuWumuS4ujHvvIzpgb/lhY3pq5hEUEnoh6rliqjnvKnmlL7lr7zoh7TnmoTmmL7npLrlvILluLgKICAgICAgICB3aWR0aDogZmluYWxXaWR0aCwKICAgICAgICBoZWlnaHQ6IGZpbmFsSGVpZ2h0CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZygn4pyFIEVDaGFydHMg5a6e5L6L5bey5Yib5bu6OicsICEhY2hhcnQudmFsdWUpOwogICAgICBjb25zb2xlLmxvZygn4pyFIEVDaGFydHMg5a6e5L6L54q25oCBOicsIHsKICAgICAgICBpc0Rpc3Bvc2VkOiBjaGFydC52YWx1ZSA/IGNoYXJ0LnZhbHVlLmlzRGlzcG9zZWQoKSA6ICdOL0EnLAogICAgICAgIHRhcmdldEVsZW1lbnRUYWc6IHRhcmdldEVsZW1lbnQudGFnTmFtZSwKICAgICAgICB0YXJnZXRFbGVtZW50Q2xhc3M6IHRhcmdldEVsZW1lbnQuY2xhc3NOYW1lCiAgICAgIH0pOwoKICAgICAgLy8g56Gu5L+dY2hhcnRSZWbmjIflkJHmraPnoa7nmoTlhYPntKAKICAgICAgaWYgKGNoYXJ0UmVmLnZhbHVlICE9PSB0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgY2hhcnRSZWYudmFsdWUgPSB0YXJnZXRFbGVtZW50OwogICAgICAgIGNvbnNvbGUubG9nKCfwn5SnIOW3suabtOaWsGNoYXJ0UmVm5byV55SoJyk7CiAgICAgIH0KCiAgICAgIC8vIOe7keWumuiKgueCueeCueWHu+S6i+S7tuWkhOeQhuWHveaVsAogICAgICBiaW5kQ2hhcnRFdmVudHMoKTsKICAgICAgY29uc29sZS5sb2coJ/Cfjokg5Zu+6KGo5Yid5aeL5YyW5a6M5oiQJyk7CgogICAgICAvLyDpqozor4Hlm77ooajlrp7kvovmmK/lkKbmraPluLjliJvlu7oKICAgICAgaWYgKCFjaGFydC52YWx1ZSB8fCBjaGFydC52YWx1ZS5pc0Rpc3Bvc2VkKCkpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRUNoYXJ0c+WunuS+i+WIm+W7uuWksei0peaIluW3suiiq+mUgOavgScpOwogICAgICAgIHRocm93IG5ldyBFcnJvcignRUNoYXJ0c+WunuS+i+WIm+W7uuWksei0pScpOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCfinIUgRUNoYXJ0c+WunuS+i+mqjOivgemAmui/h++8jOWbvuihqOWIneWni+WMluaIkOWKnycpOwogICAgfTsKCiAgICAvLyDnu5Hlrprlm77ooajkuovku7blpITnkIblh73mlbAKICAgIGNvbnN0IGJpbmRDaGFydEV2ZW50cyA9ICgpID0+IHsKICAgICAgaWYgKCFjaGFydC52YWx1ZSB8fCBjaGFydC52YWx1ZS5pc0Rpc3Bvc2VkKCkpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyDlm77ooajlrp7kvovkuI3lrZjlnKjvvIzml6Dms5Xnu5Hlrprkuovku7YnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOa4hemZpOS5i+WJjeeahOS6i+S7tuebkeWQrOWZqO+8jOmBv+WFjemHjeWkjee7keWumgogICAgICBjaGFydC52YWx1ZS5vZmYoJ2NsaWNrJyk7CiAgICAgIGNoYXJ0LnZhbHVlLm9mZignbW91c2Vkb3duJyk7CiAgICAgIGNoYXJ0LnZhbHVlLm9mZignbW91c2V1cCcpOwoKICAgICAgLy8g55uR5ZCs6IqC54K554K55Ye75LqL5Lu2CiAgICAgIGNoYXJ0LnZhbHVlLm9uKCdjbGljaycsIHBhcmFtcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ/CflrHvuI8g6IqC54K56KKr54K55Ye7OicsIHBhcmFtcyk7CiAgICAgICAgY29uc29sZS5sb2coJ/CflI0g54K55Ye75LqL5Lu26K+m5oOFOicsIHsKICAgICAgICAgIGRhdGFUeXBlOiBwYXJhbXMuZGF0YVR5cGUsCiAgICAgICAgICBjb21wb25lbnRUeXBlOiBwYXJhbXMuY29tcG9uZW50VHlwZSwKICAgICAgICAgIHNlcmllc1R5cGU6IHBhcmFtcy5zZXJpZXNUeXBlLAogICAgICAgICAgZGF0YTogcGFyYW1zLmRhdGEsCiAgICAgICAgICBsYXlvdXRUeXBlOiBsYXlvdXRUeXBlLnZhbHVlCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHBhcmFtcy5kYXRhVHlwZSA9PT0gJ25vZGUnICYmIHBhcmFtcy5kYXRhKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIOacieaViOeahOiKgueCueeCueWHu++8jOWHhuWkh+aYvuekuuivpuaDhScpOwogICAgICAgICAgc2VsZWN0ZWRFbnRpdHkudmFsdWUgPSBwYXJhbXMuZGF0YTsKICAgICAgICAgIGxvYWRFbnRpdHlSZWxhdGlvbnNoaXBzKHBhcmFtcy5kYXRhLmlkKTsKICAgICAgICAgIHNob3dFbnRpdHlEZXRhaWwudmFsdWUgPSB0cnVlOwogICAgICAgICAgY29uc29sZS5sb2coJ/Cfk4sg5a6e5L2T6K+m5oOF5bey6K6+572uOicsIHsKICAgICAgICAgICAgc2VsZWN0ZWRFbnRpdHk6IHNlbGVjdGVkRW50aXR5LnZhbHVlLAogICAgICAgICAgICBzaG93RW50aXR5RGV0YWlsOiBzaG93RW50aXR5RGV0YWlsLnZhbHVlCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ+KdjCDml6DmlYjnmoToioLngrnngrnlh7vmiJbnvLrlsJHmlbDmja4nKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g55uR5ZCs6IqC54K55ouW5ou95byA5aeL5LqL5Lu2CiAgICAgIGNoYXJ0LnZhbHVlLm9uKCdtb3VzZWRvd24nLCBwYXJhbXMgPT4gewogICAgICAgIGlmIChwYXJhbXMuZGF0YVR5cGUgPT09ICdub2RlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ/CflrHvuI8g5byA5aeL5ouW5ou96IqC54K5OicsIHBhcmFtcy5kYXRhLm5hbWUpOwogICAgICAgICAgLy8g5re75Yqg5ouW5ou95pe255qE6KeG6KeJ5Y+N6aaICiAgICAgICAgICBjaGFydC52YWx1ZS5zZXRPcHRpb24oewogICAgICAgICAgICBzZXJpZXM6IFt7CiAgICAgICAgICAgICAgZW1waGFzaXM6IHsKICAgICAgICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICAgICAgICBzaGFkb3dCbHVyOiAyMCwKICAgICAgICAgICAgICAgICAgc2hhZG93Q29sb3I6ICdyZ2JhKDY0LCAxNTgsIDI1NSwgMC41KScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH1dCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g55uR5ZCs6IqC54K55ouW5ou957uT5p2f5LqL5Lu2CiAgICAgIGNoYXJ0LnZhbHVlLm9uKCdtb3VzZXVwJywgcGFyYW1zID0+IHsKICAgICAgICBpZiAocGFyYW1zLmRhdGFUeXBlID09PSAnbm9kZScpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5ax77iPIOe7k+adn+aLluaLveiKgueCuTonLCBwYXJhbXMuZGF0YS5uYW1lKTsKICAgICAgICAgIC8vIOajgOafpeiKgueCueaYr+WQpui2heWHuui+ueeVjOW5tui/m+ihjOe6puadnwogICAgICAgICAgY29uc3QgY2hhcnRJbnN0YW5jZSA9IGNoYXJ0LnZhbHVlOwogICAgICAgICAgY29uc3Qgb3B0aW9uID0gY2hhcnRJbnN0YW5jZS5nZXRPcHRpb24oKTsKICAgICAgICAgIGNvbnN0IHNlcmllcyA9IG9wdGlvbi5zZXJpZXNbMF07CgogICAgICAgICAgLy8g6I635Y+W5Zu+6KGo5a655Zmo5bC65a+4CiAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY2hhcnRSZWYudmFsdWU7CiAgICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNoYXJ0V2lkdGggPSBlbGVtZW50Lm9mZnNldFdpZHRoOwogICAgICAgICAgY29uc3QgY2hhcnRIZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDsKICAgICAgICAgIGNvbnN0IG1hcmdpbiA9IDUwOyAvLyDovrnnlYzovrnot50KCiAgICAgICAgICAvLyDnuqbmnZ/oioLngrnkvY3nva7lnKjlrrnlmajojIPlm7TlhoUKICAgICAgICAgIGlmIChzZXJpZXMuZGF0YSkgewogICAgICAgICAgICBzZXJpZXMuZGF0YS5mb3JFYWNoKG5vZGUgPT4gewogICAgICAgICAgICAgIGlmIChub2RlLnggIT09IHVuZGVmaW5lZCAmJiBub2RlLnkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbm9kZS54ID0gTWF0aC5tYXgobWFyZ2luLCBNYXRoLm1pbihjaGFydFdpZHRoIC0gbWFyZ2luLCBub2RlLngpKTsKICAgICAgICAgICAgICAgIG5vZGUueSA9IE1hdGgubWF4KG1hcmdpbiwgTWF0aC5taW4oY2hhcnRIZWlnaHQgLSBtYXJnaW4sIG5vZGUueSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyDmm7TmlrDlm77ooajphY3nva4KICAgICAgICAgICAgY2hhcnRJbnN0YW5jZS5zZXRPcHRpb24oewogICAgICAgICAgICAgIHNlcmllczogW3sKICAgICAgICAgICAgICAgIGRhdGE6IHNlcmllcy5kYXRhCiAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CgogICAgLy8g5Li65Yqb5a+85ZCR5biD5bGA5re75Yqg5Yid5aeL5L2N572u6K6+572uCiAgICBjb25zdCBpbml0aWFsaXplRm9yY2VMYXlvdXRQb3NpdGlvbnMgPSAobm9kZXMsIGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpID0+IHsKICAgICAgaWYgKCFub2RlcyB8fCBub2Rlcy5sZW5ndGggPT09IDApIHJldHVybiBub2RlczsKICAgICAgY29uc3QgY2VudGVyWCA9IGNvbnRhaW5lcldpZHRoIC8gMjsKICAgICAgY29uc3QgY2VudGVyWSA9IGNvbnRhaW5lckhlaWdodCAvIDI7CiAgICAgIGNvbnN0IHJhZGl1cyA9IE1hdGgubWluKGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpIC8gNDsKICAgICAgcmV0dXJuIG5vZGVzLm1hcCgobm9kZSwgaW5kZXgpID0+IHsKICAgICAgICAvLyDlpoLmnpzoioLngrnmsqHmnInliJ3lp4vkvY3nva7vvIznu5nlroPkuIDkuKrpmo/mnLrkvYblkIjnkIbnmoTliJ3lp4vkvY3nva4KICAgICAgICBpZiAodHlwZW9mIG5vZGUueCA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIG5vZGUueSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGNvbnN0IGFuZ2xlID0gMiAqIE1hdGguUEkgKiBpbmRleCAvIG5vZGVzLmxlbmd0aDsKICAgICAgICAgIGNvbnN0IHIgPSByYWRpdXMgKiAoMC41ICsgTWF0aC5yYW5kb20oKSAqIDAuNSk7IC8vIOmaj+acuuWNiuW+hO+8jOmBv+WFjeaJgOacieiKgueCueWcqOWQjOS4gOWchuS4igoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLm5vZGUsCiAgICAgICAgICAgIHg6IGNlbnRlclggKyByICogTWF0aC5jb3MoYW5nbGUpICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogNTAsCiAgICAgICAgICAgIHk6IGNlbnRlclkgKyByICogTWF0aC5zaW4oYW5nbGUpICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogNTAsCiAgICAgICAgICAgIC8vIOehruS/neiKgueCueacieW/heimgeeahOWxnuaApwogICAgICAgICAgICBpZDogU3RyaW5nKG5vZGUuaWQgfHwgYG5vZGVfJHtpbmRleH1gKSwKICAgICAgICAgICAgLy8g56Gu5L+dSUTkuLrlrZfnrKbkuLIKICAgICAgICAgICAgbmFtZTogbm9kZS5uYW1lIHx8IGDoioLngrkke2luZGV4fWAsCiAgICAgICAgICAgIGNhdGVnb3J5OiBub2RlLmNhdGVnb3J5ICE9PSB1bmRlZmluZWQgPyBub2RlLmNhdGVnb3J5IDogbm9kZS50eXBlIHx8IDAsCiAgICAgICAgICAgIHZhbHVlOiBub2RlLnZhbHVlIHx8IDEsCiAgICAgICAgICAgIHN5bWJvbFNpemU6IG5vZGUuc3ltYm9sU2l6ZSB8fCAzMCwKICAgICAgICAgICAgLy8g56Gu5L+d6IqC54K55pyJ5q2j56Gu55qE6aKc6ImyCiAgICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICAgIGNvbG9yOiBnZXRFbnRpdHlDb2xvcihub2RlLnR5cGUgfHwgJ2RlZmF1bHQnKSwKICAgICAgICAgICAgICBib3JkZXJDb2xvcjogJyNmZmYnLAogICAgICAgICAgICAgIGJvcmRlcldpZHRoOiAyLAogICAgICAgICAgICAgIHNoYWRvd0JsdXI6IDEwLAogICAgICAgICAgICAgIHNoYWRvd0NvbG9yOiAncmdiYSgwLCAwLCAwLCAwLjMpJwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4ubm9kZSwKICAgICAgICAgIC8vIOehruS/neiKgueCueacieW/heimgeeahOWxnuaApwogICAgICAgICAgaWQ6IFN0cmluZyhub2RlLmlkIHx8IGBub2RlXyR7aW5kZXh9YCksCiAgICAgICAgICAvLyDnoa7kv51JROS4uuWtl+espuS4sgogICAgICAgICAgbmFtZTogbm9kZS5uYW1lIHx8IGDoioLngrkke2luZGV4fWAsCiAgICAgICAgICBjYXRlZ29yeTogbm9kZS5jYXRlZ29yeSAhPT0gdW5kZWZpbmVkID8gbm9kZS5jYXRlZ29yeSA6IG5vZGUudHlwZSB8fCAwLAogICAgICAgICAgdmFsdWU6IG5vZGUudmFsdWUgfHwgMSwKICAgICAgICAgIHN5bWJvbFNpemU6IG5vZGUuc3ltYm9sU2l6ZSB8fCAzMCwKICAgICAgICAgIC8vIOehruS/neiKgueCueacieato+ehrueahOminOiJsgogICAgICAgICAgaXRlbVN0eWxlOiB7CiAgICAgICAgICAgIGNvbG9yOiBnZXRFbnRpdHlDb2xvcihub2RlLnR5cGUgfHwgJ2RlZmF1bHQnKSwKICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZmZmJywKICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDIsCiAgICAgICAgICAgIHNoYWRvd0JsdXI6IDEwLAogICAgICAgICAgICBzaGFkb3dDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMC4zKScKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9KTsKICAgIH07CiAgICBjb25zdCB1cGRhdGVDaGFydCA9IGFzeW5jICgpID0+IHsKICAgICAgdmFyIF9jaGFydFJlZiR2YWx1ZSwgX2NoYXJ0UmVmJHZhbHVlMjsKICAgICAgY29uc29sZS5sb2coJ/CfjqggdXBkYXRlQ2hhcnQg6KKr6LCD55SoJyk7CiAgICAgIGNvbnNvbGUubG9nKCfwn5OKIOW9k+WJjeeKtuaAgTonLCB7CiAgICAgICAgaGFzQ2hhcnQ6ICEhY2hhcnQudmFsdWUsCiAgICAgICAgbm9kZXNDb3VudDogZ3JhcGhEYXRhLm5vZGVzLmxlbmd0aCwKICAgICAgICBlZGdlc0NvdW50OiBncmFwaERhdGEuZWRnZXMubGVuZ3RoLAogICAgICAgIHNlbGVjdGVkVHlwZXM6IHNlbGVjdGVkVHlwZXMudmFsdWUsCiAgICAgICAgbGF5b3V0VHlwZTogbGF5b3V0VHlwZS52YWx1ZQogICAgICB9KTsKCiAgICAgIC8vIOajgOafpUVDaGFydHPlrp7kvovmmK/lkKblrZjlnKjmiJblt7LooqtkaXNwb3NlCiAgICAgIGlmICghY2hhcnQudmFsdWUgfHwgY2hhcnQudmFsdWUuaXNEaXNwb3NlZCgpKSB7CiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gRUNoYXJ0c+WunuS+i+S4jeWtmOWcqOaIluW3suiiq2Rpc3Bvc2XvvIzph43mlrDliJ3lp4vljJblm77ooagnKTsKICAgICAgICBjb25zb2xlLmxvZygn8J+UpyBjaGFydFJlZi52YWx1ZeeKtuaAgTonLCAhIWNoYXJ0UmVmLnZhbHVlKTsKICAgICAgICBhd2FpdCBpbml0Q2hhcnQoKTsKICAgICAgICBpZiAoIWNoYXJ0LnZhbHVlKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg6YeN5paw5Yid5aeL5YyW5Zu+6KGo5aSx6LSlJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCfinIUgRUNoYXJ0c+WunuS+i+mHjeaWsOWIneWni+WMluaIkOWKnycpOwogICAgICB9CiAgICAgIGlmIChncmFwaERhdGEubm9kZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8g5rKh5pyJ6IqC54K55pWw5o2u77yM5peg5rOV5pu05paw5Zu+6KGoJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyDov4fmu6ToioLngrkKICAgICAgbGV0IGZpbHRlcmVkTm9kZXMgPSBbLi4uZ3JhcGhEYXRhLm5vZGVzXTsgLy8g5Yib5bu65Ymv5pys6YG/5YWN5L+u5pS55Y6f5pWw5o2uCiAgICAgIGlmIChzZWxlY3RlZFR5cGVzLnZhbHVlLmxlbmd0aCA+IDApIHsKICAgICAgICBmaWx0ZXJlZE5vZGVzID0gZ3JhcGhEYXRhLm5vZGVzLmZpbHRlcihub2RlID0+IHNlbGVjdGVkVHlwZXMudmFsdWUuaW5jbHVkZXMobm9kZS50eXBlKSk7CiAgICAgICAgY29uc29sZS5sb2coJ/CflI0g5bqU55So57G75Z6L6L+H5ruk5ZCO55qE6IqC54K55pWw6YePOicsIGZpbHRlcmVkTm9kZXMubGVuZ3RoKTsKICAgICAgfQoKICAgICAgLy8g6L+H5ruk6L6577yM56Gu5L+d6L6555qE5pWw5o2u5qC85byP5q2j56GuCiAgICAgIGNvbnN0IG5vZGVJZHMgPSBuZXcgU2V0KGZpbHRlcmVkTm9kZXMubWFwKG5vZGUgPT4gU3RyaW5nKG5vZGUuaWQpKSk7IC8vIOehruS/neiKgueCuUlE6ZuG5ZCI5Li65a2X56ym5LiyCiAgICAgIGxldCBmaWx0ZXJlZEVkZ2VzID0gZ3JhcGhEYXRhLmVkZ2VzLmZpbHRlcihlZGdlID0+IG5vZGVJZHMuaGFzKFN0cmluZyhlZGdlLnNvdXJjZSkpICYmIG5vZGVJZHMuaGFzKFN0cmluZyhlZGdlLnRhcmdldCkpIC8vIOehruS/neexu+Wei+WMuemFjQogICAgICApLm1hcChlZGdlID0+ICh7CiAgICAgICAgLi4uZWRnZSwKICAgICAgICAvLyDnoa7kv53ovrnmnInlv4XopoHnmoTlsZ7mgKfvvIzlubbnu5/kuIDmlbDmja7nsbvlnosKICAgICAgICBzb3VyY2U6IFN0cmluZyhlZGdlLnNvdXJjZSksCiAgICAgICAgLy8g56Gu5L+dc291cmNl5Li65a2X56ym5LiyCiAgICAgICAgdGFyZ2V0OiBTdHJpbmcoZWRnZS50YXJnZXQpLAogICAgICAgIC8vIOehruS/nXRhcmdldOS4uuWtl+espuS4sgogICAgICAgIHZhbHVlOiBlZGdlLnZhbHVlIHx8IGVkZ2Uud2VpZ2h0IHx8IDEsCiAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICBjb2xvcjogZWRnZS5jb2xvciB8fCAnIzk5OScsCiAgICAgICAgICB3aWR0aDogZWRnZS53aWR0aCB8fCAxCiAgICAgICAgfQogICAgICB9KSk7CiAgICAgIGNvbnNvbGUubG9nKCfwn5OIIOi/h+a7pOWQjueahOaVsOaNrjonLCB7CiAgICAgICAgZmlsdGVyZWROb2RlczogZmlsdGVyZWROb2Rlcy5sZW5ndGgsCiAgICAgICAgZmlsdGVyZWRFZGdlczogZmlsdGVyZWRFZGdlcy5sZW5ndGgKICAgICAgfSk7CgogICAgICAvLyDor6bnu4bmo4Dmn6XoioLngrlJROWSjOi+uei/nuaOpeeahOWMuemFjeaDheWGtQogICAgICBpZiAoZmlsdGVyZWROb2Rlcy5sZW5ndGggPiAwICYmIGZpbHRlcmVkRWRnZXMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IG5vZGVJZFNldCA9IG5ldyBTZXQoZmlsdGVyZWROb2Rlcy5tYXAobm9kZSA9PiBTdHJpbmcobm9kZS5pZCkpKTsKICAgICAgICBjb25zdCB1bm1hdGNoZWRFZGdlcyA9IGZpbHRlcmVkRWRnZXMuZmlsdGVyKGVkZ2UgPT4gIW5vZGVJZFNldC5oYXMoU3RyaW5nKGVkZ2Uuc291cmNlKSkgfHwgIW5vZGVJZFNldC5oYXMoU3RyaW5nKGVkZ2UudGFyZ2V0KSkpOwoKICAgICAgICAvLyDov5vkuIDmraXov4fmu6TvvIzlj6rkv53nlZnmnInmlYjnmoTovrkKICAgICAgICBmaWx0ZXJlZEVkZ2VzID0gZmlsdGVyZWRFZGdlcy5maWx0ZXIoZWRnZSA9PiB7CiAgICAgICAgICBjb25zdCBzb3VyY2VFeGlzdHMgPSBub2RlSWRTZXQuaGFzKFN0cmluZyhlZGdlLnNvdXJjZSkpOwogICAgICAgICAgY29uc3QgdGFyZ2V0RXhpc3RzID0gbm9kZUlkU2V0LmhhcyhTdHJpbmcoZWRnZS50YXJnZXQpKTsKICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBzb3VyY2VFeGlzdHMgJiYgdGFyZ2V0RXhpc3RzICYmIGVkZ2Uuc291cmNlICE9PSBlZGdlLnRhcmdldDsKICAgICAgICAgIGlmICghaXNWYWxpZCkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyDlj5HnjrDml6DmlYjovrk6JywgewogICAgICAgICAgICAgIHNvdXJjZTogZWRnZS5zb3VyY2UsCiAgICAgICAgICAgICAgdGFyZ2V0OiBlZGdlLnRhcmdldCwKICAgICAgICAgICAgICBzb3VyY2VFeGlzdHMsCiAgICAgICAgICAgICAgdGFyZ2V0RXhpc3RzLAogICAgICAgICAgICAgIGlzU2VsZkxvb3A6IGVkZ2Uuc291cmNlID09PSBlZGdlLnRhcmdldAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBpc1ZhbGlkOwogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIOiKgueCueWSjOi+ueeahOWMuemFjeWIhuaekDonLCB7CiAgICAgICAgICBub2RlSWRzOiBBcnJheS5mcm9tKG5vZGVJZFNldCkuc2xpY2UoMCwgMTApLAogICAgICAgICAgbm9kZUlkVHlwZXM6IFsuLi5uZXcgU2V0KGZpbHRlcmVkTm9kZXMubWFwKG5vZGUgPT4gdHlwZW9mIG5vZGUuaWQpKV0sCiAgICAgICAgICBlZGdlU291cmNlVGFyZ2V0U2FtcGxlOiBmaWx0ZXJlZEVkZ2VzLnNsaWNlKDAsIDUpLm1hcChlZGdlID0+ICh7CiAgICAgICAgICAgIHNvdXJjZTogZWRnZS5zb3VyY2UsCiAgICAgICAgICAgIHNvdXJjZVR5cGU6IHR5cGVvZiBlZGdlLnNvdXJjZSwKICAgICAgICAgICAgdGFyZ2V0OiBlZGdlLnRhcmdldCwKICAgICAgICAgICAgdGFyZ2V0VHlwZTogdHlwZW9mIGVkZ2UudGFyZ2V0LAogICAgICAgICAgICBzb3VyY2VFeGlzdHM6IG5vZGVJZFNldC5oYXMoU3RyaW5nKGVkZ2Uuc291cmNlKSksCiAgICAgICAgICAgIHRhcmdldEV4aXN0czogbm9kZUlkU2V0LmhhcyhTdHJpbmcoZWRnZS50YXJnZXQpKQogICAgICAgICAgfSkpLAogICAgICAgICAgdW5tYXRjaGVkRWRnZXNDb3VudDogdW5tYXRjaGVkRWRnZXMubGVuZ3RoLAogICAgICAgICAgdmFsaWRFZGdlc0NvdW50OiBmaWx0ZXJlZEVkZ2VzLmxlbmd0aCwKICAgICAgICAgIHVubWF0Y2hlZEVkZ2VzU2FtcGxlOiB1bm1hdGNoZWRFZGdlcy5zbGljZSgwLCAzKQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyDojrflj5blrrnlmajlsLrlr7gKICAgICAgY29uc3QgY29udGFpbmVyV2lkdGggPSAoKF9jaGFydFJlZiR2YWx1ZSA9IGNoYXJ0UmVmLnZhbHVlKSA9PT0gbnVsbCB8fCBfY2hhcnRSZWYkdmFsdWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jaGFydFJlZiR2YWx1ZS5vZmZzZXRXaWR0aCkgfHwgODAwOwogICAgICBjb25zdCBjb250YWluZXJIZWlnaHQgPSAoKF9jaGFydFJlZiR2YWx1ZTIgPSBjaGFydFJlZi52YWx1ZSkgPT09IG51bGwgfHwgX2NoYXJ0UmVmJHZhbHVlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NoYXJ0UmVmJHZhbHVlMi5vZmZzZXRIZWlnaHQpIHx8IDYwMDsKCiAgICAgIC8vIOagueaNruW4g+WxgOexu+Wei+WkhOeQhuiKgueCueS9jee9rgogICAgICBpZiAobGF5b3V0VHlwZS52YWx1ZSA9PT0gJ2NpcmN1bGFyJykgewogICAgICAgIGZpbHRlcmVkTm9kZXMgPSBvcHRpbWl6ZUNpcmN1bGFyTGF5b3V0KGZpbHRlcmVkTm9kZXMsIGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn46vIOW3suS8mOWMluWchuW9ouW4g+WxgO+8jOWuueWZqOWwuuWvuDonLCB7CiAgICAgICAgICBjb250YWluZXJXaWR0aCwKICAgICAgICAgIGNvbnRhaW5lckhlaWdodAogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGxheW91dFR5cGUudmFsdWUgPT09ICdmb3JjZScpIHsKICAgICAgICAvLyDkuLrlipvlr7zlkJHluIPlsYDliJ3lp4vljJboioLngrnkvY3nva4KICAgICAgICBmaWx0ZXJlZE5vZGVzID0gaW5pdGlhbGl6ZUZvcmNlTGF5b3V0UG9zaXRpb25zKGZpbHRlcmVkTm9kZXMsIGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn46vIOW3suWIneWni+WMluWKm+WvvOWQkeW4g+WxgOiKgueCueS9jee9ru+8jOWuueWZqOWwuuWvuDonLCB7CiAgICAgICAgICBjb250YWluZXJXaWR0aCwKICAgICAgICAgIGNvbnRhaW5lckhlaWdodAogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIOWKm+WvvOWQkeiKgueCueekuuS+izonLCBmaWx0ZXJlZE5vZGVzLnNsaWNlKDAsIDMpKTsKICAgICAgfQogICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgdGl0bGU6IHsKICAgICAgICAgIHRleHQ6ICfkvIHkuJrnn6Xor4blm77osLEnLAogICAgICAgICAgbGVmdDogJ2NlbnRlcicsCiAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgZm9udFNpemU6IDE4LAogICAgICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsCiAgICAgICAgICAgIGNvbG9yOiAnIzMwMzEzMycKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgIHRyaWdnZXI6ICdpdGVtJywKICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICAgICAgICBpZiAocGFyYW1zLmRhdGFUeXBlID09PSAnbm9kZScpIHsKICAgICAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgICA8ZGl2IHN0eWxlPSJwYWRkaW5nOiA2cHggMTJweDsgbWF4LXdpZHRoOiAzMDBweDsgd29yZC13cmFwOiBicmVhay13b3JkOyI+CiAgICAgICAgICAgICAgPHN0cm9uZyBzdHlsZT0iY29sb3I6ICMzMDMxMzM7Ij4ke3BhcmFtcy5kYXRhLm5hbWV9PC9zdHJvbmc+PGJyLz4KICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iY29sb3I6ICM2MDYyNjY7Ij7nsbvlnos6ICR7Z2V0Q2hpbmVzZVR5cGUocGFyYW1zLmRhdGEudHlwZSl9PC9zcGFuPjxici8+CiAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImNvbG9yOiAjOTA5Mzk5OyI+JHtwYXJhbXMuZGF0YS5kZXNjcmlwdGlvbiB8fCAn5pqC5peg5o+P6L+wJ308L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgYDsKICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJhbXMuZGF0YVR5cGUgPT09ICdlZGdlJykgewogICAgICAgICAgICAgIHJldHVybiBgCiAgICAgICAgICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6IDZweCAxMnB4OyBtYXgtd2lkdGg6IDMwMHB4OyB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7Ij4KICAgICAgICAgICAgICA8c3Ryb25nIHN0eWxlPSJjb2xvcjogIzMwMzEzMzsiPiR7cGFyYW1zLmRhdGEuc291cmNlfSDihpIgJHtwYXJhbXMuZGF0YS50YXJnZXR9PC9zdHJvbmc+PGJyLz4KICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iY29sb3I6ICM2MDYyNjY7Ij7lhbPns7s6ICR7cGFyYW1zLmRhdGEucmVsYXRpb259PC9zcGFuPjxici8+CiAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImNvbG9yOiAjOTA5Mzk5OyI+5p2D6YeNOiAke3BhcmFtcy5kYXRhLndlaWdodH08L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgYDsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC45NSknLAogICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZTRlN2VkJywKICAgICAgICAgIGJvcmRlcldpZHRoOiAxLAogICAgICAgICAgdGV4dFN0eWxlOiB7CiAgICAgICAgICAgIGZvbnRTaXplOiAxMgogICAgICAgICAgfSwKICAgICAgICAgIGV4dHJhQ3NzVGV4dDogJ21heC13aWR0aDogMzAwcHg7IG1heC1oZWlnaHQ6IDEyMHB4OyBvdmVyZmxvdzogaGlkZGVuOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7IGxpbmUtaGVpZ2h0OiAxLjQ7JwogICAgICAgIH0sCiAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICBzaG93OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgc2VyaWVzOiBbewogICAgICAgICAgdHlwZTogJ2dyYXBoJywKICAgICAgICAgIGxheW91dDogbGF5b3V0VHlwZS52YWx1ZSwKICAgICAgICAgIGRhdGE6IGZpbHRlcmVkTm9kZXMsCiAgICAgICAgICBsaW5rczogZmlsdGVyZWRFZGdlcywKICAgICAgICAgIGNhdGVnb3JpZXM6IGdyYXBoRGF0YS5jYXRlZ29yaWVzLAogICAgICAgICAgcm9hbTogdHJ1ZSwKICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSwKICAgICAgICAgIC8vIOWQr+eUqOiKgueCueaLluaLvQogICAgICAgICAgLy8g5re75Yqg6L6555qE56ym5Y+36YWN572u77yM56Gu5L+d6L+e5o6l5Yiw6IqC54K56L6557yYCiAgICAgICAgICBlZGdlU3ltYm9sOiBsYXlvdXRUeXBlLnZhbHVlID09PSAnZm9yY2UnID8gWydub25lJywgJ2Fycm93J10gOiBbJ25vbmUnLCAnbm9uZSddLAogICAgICAgICAgZWRnZVN5bWJvbFNpemU6IGxheW91dFR5cGUudmFsdWUgPT09ICdmb3JjZScgPyBbMCwgOF0gOiBbMCwgMF0sCiAgICAgICAgICAvLyDnoa7kv53ovrnov57mjqXliLDoioLngrnovrnnvJjogIzkuI3mmK/kuK3lv4MKICAgICAgICAgIGF1dG9DdXJ2ZW5lc3M6IHRydWUsCiAgICAgICAgICBsYWJlbDogewogICAgICAgICAgICBzaG93OiBzaG93TGFiZWxzLnZhbHVlLAogICAgICAgICAgICBwb3NpdGlvbjogJ2luc2lkZScsCiAgICAgICAgICAgIC8vIOaUueS4uuWGhemDqOaYvuekuu+8jOmBv+WFjea6ouWHugogICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgICAgICAvLyDlj6rmmL7npLrlrp7kvZPlkI3np7DvvIzkuI3mmL7npLrku7vkvZXmlbDlrZcKICAgICAgICAgICAgICBjb25zdCBuYW1lID0gcGFyYW1zLmRhdGEubmFtZSB8fCBwYXJhbXMubmFtZTsKICAgICAgICAgICAgICAvLyDov4fmu6Tmjonnuq/mlbDlrZflhoXlrrnvvIzlj6rkv53nlZnmlofmnKwKICAgICAgICAgICAgICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnICYmICEvXlxkKyQvLnRlc3QobmFtZS50cmltKCkpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZS5sZW5ndGggPiA4ID8gbmFtZS5zdWJzdHJpbmcoMCwgOCkgKyAnLi4uJyA6IG5hbWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiAnJzsgLy8g5aaC5p6c5piv57qv5pWw5a2X5YiZ5LiN5pi+56S6CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZvbnRTaXplOiAxMSwKICAgICAgICAgICAgY29sb3I6ICcjMzAzMTMzJywKICAgICAgICAgICAgZm9udFdlaWdodDogJ2JvbGQnLAogICAgICAgICAgICB0ZXh0Qm9yZGVyQ29sb3I6ICcjZmZmJywKICAgICAgICAgICAgdGV4dEJvcmRlcldpZHRoOiAxCiAgICAgICAgICB9LAogICAgICAgICAgZWRnZUxhYmVsOiB7CiAgICAgICAgICAgIHNob3c6IGZhbHNlLAogICAgICAgICAgICAvLyDpmpDol4/ovrnmoIfnrb7vvIzpgb/lhY3mmL7npLrmlbDlrZcKICAgICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbiAocGFyYW1zKSB7CiAgICAgICAgICAgICAgLy8g5Y+q5pi+56S65YWz57O75ZCN56ew77yM5LiN5pi+56S65p2D6YeN562J5pWw5a2XCiAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5kYXRhLnJlbGF0aW9uIHx8ICcnOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmb250U2l6ZTogMTAsCiAgICAgICAgICAgIGNvbG9yOiAnIzkwOTM5OScKICAgICAgICAgIH0sCiAgICAgICAgICBsYWJlbExheW91dDogewogICAgICAgICAgICBoaWRlT3ZlcmxhcDogdHJ1ZSwKICAgICAgICAgICAgbW92ZU92ZXJsYXA6ICdzaGlmdFknIC8vIOiHquWKqOiwg+aVtOmHjeWPoOagh+etvuS9jee9rgogICAgICAgICAgfSwKICAgICAgICAgIHNjYWxlTGltaXQ6IHsKICAgICAgICAgICAgbWluOiAwLjMsCiAgICAgICAgICAgIG1heDogMwogICAgICAgICAgfSwKICAgICAgICAgIC4uLihsYXlvdXRUeXBlLnZhbHVlID09PSAnZm9yY2UnID8gewogICAgICAgICAgICBmb3JjZTogewogICAgICAgICAgICAgIC8vIOmAguS4reeahOiKgueCuemXtOaWpeWKm++8jOmYsuatouiKgueCuemHjeWPoOS9huS4jei/h+W6puWIhuaVowogICAgICAgICAgICAgIHJlcHVsc2lvbjogWzIwMCwgNjAwXSwKICAgICAgICAgICAgICAvLyDpgILkuK3nmoTph43lipvvvIzkv53mjIHlm77lvaLogZrlkIgKICAgICAgICAgICAgICBncmF2aXR5OiAwLjE1LAogICAgICAgICAgICAgIC8vIOmAguS4reeahOi+uemVv++8jOehruS/nei/nuaOpea4heaZsOWPr+ingQogICAgICAgICAgICAgIGVkZ2VMZW5ndGg6IFs1MCwgMTAwXSwKICAgICAgICAgICAgICAvLyDlhbPpl63mjIHnu63liqjnlLvvvIzpgb/lhY3nur/mnaHmjIHnu63np7vliqgKICAgICAgICAgICAgICBsYXlvdXRBbmltYXRpb246IGZhbHNlLAogICAgICAgICAgICAgIC8vIOWinuWKoOaRqeaTpuWKm++8jOiuqeW4g+WxgOabtOW/q+eos+WumgogICAgICAgICAgICAgIGZyaWN0aW9uOiAwLjk1LAogICAgICAgICAgICAgIC8vIOiuvue9ruWIneWni+a4qeW6pu+8jOaOp+WItuW4g+WxgOaUtuaVm+mAn+W6pgogICAgICAgICAgICAgIGluaXRMYXlvdXQ6ICdjaXJjdWxhcicsCiAgICAgICAgICAgICAgLy8g5re75Yqg6L6555qE6L+e5o6l6YWN572uCiAgICAgICAgICAgICAgZWRnZVN5bWJvbDogWydub25lJywgJ2Fycm93J10sCiAgICAgICAgICAgICAgLy8g5re75Yqg566t5aS05oyH56S65pa55ZCRCiAgICAgICAgICAgICAgZWRnZVN5bWJvbFNpemU6IFswLCA4XSAvLyDnrq3lpLTlpKflsI8KICAgICAgICAgICAgfQogICAgICAgICAgfSA6IHt9KSwKICAgICAgICAgIC4uLihsYXlvdXRUeXBlLnZhbHVlID09PSAnY2lyY3VsYXInID8gewogICAgICAgICAgICBjaXJjdWxhcjogewogICAgICAgICAgICAgIHJvdGF0ZUxhYmVsOiBmYWxzZSwKICAgICAgICAgICAgICAvLyDlhbPpl63moIfnrb7ml4vovazvvIzkv53mjIHmsLTlubMKICAgICAgICAgICAgICByYWRpdXM6IDE4MCAvLyDorr7nva7lnIblvaLluIPlsYDljYrlvoTvvIzpgb/lhY3muqLlh7oKICAgICAgICAgICAgfQogICAgICAgICAgfSA6IHt9KSwKICAgICAgICAgIGxpbmVTdHlsZTogewogICAgICAgICAgICBjb2xvcjogJ3NvdXJjZScsCiAgICAgICAgICAgIGN1cnZlbmVzczogbGF5b3V0VHlwZS52YWx1ZSA9PT0gJ2ZvcmNlJyA/IDAuMSA6IDAuMSwKICAgICAgICAgICAgLy8g5YeP5bCR5byv5puy5bqm77yM6K6p6L+e57q/5pu055u0CiAgICAgICAgICAgIG9wYWNpdHk6IDAuOCwKICAgICAgICAgICAgd2lkdGg6IGxheW91dFR5cGUudmFsdWUgPT09ICdmb3JjZScgPyAyIDogMSwKICAgICAgICAgICAgLy8g5aKe5Yqg57q/5p2h5a695bqm77yM5pu05piO5pi+CiAgICAgICAgICAgIHR5cGU6ICdzb2xpZCcsCiAgICAgICAgICAgIC8vIOehruS/nee6v+adoeS4uuWunue6vwogICAgICAgICAgICBjYXA6ICdyb3VuZCcsCiAgICAgICAgICAgIC8vIOWchuW9ouerr+eCuQogICAgICAgICAgICBqb2luOiAncm91bmQnIC8vIOWchuW9oui/nuaOpeeCuQogICAgICAgICAgfSwKICAgICAgICAgIGVtcGhhc2lzOiB7CiAgICAgICAgICAgIGZvY3VzOiAnYWRqYWNlbmN5JywKICAgICAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICAgICAgd2lkdGg6IDMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICAgIGZvcm1hdHRlcjogJ3tifScsCiAgICAgICAgICAgICAgLy8g5oKs5YGc5pe25pi+56S65a6M5pW05ZCN56ewCiAgICAgICAgICAgICAgZm9udFNpemU6IDEyLAogICAgICAgICAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJwogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgLy8g6IqC54K55qC35byP546w5Zyo5Zyo5q+P5Liq6IqC54K555qEaXRlbVN0eWxl5Lit5Y2V54us6K6+572uCiAgICAgICAgICAvLyDorr7nva7oioLngrnlpKflsI8KICAgICAgICAgIHN5bWJvbFNpemU6IGZ1bmN0aW9uICh2YWx1ZSwgcGFyYW1zKSB7CiAgICAgICAgICAgIGlmIChsYXlvdXRUeXBlLnZhbHVlID09PSAnZm9yY2UnKSB7CiAgICAgICAgICAgICAgLy8g5Yqb5a+85ZCR5biD5bGA5L2/55So5pu05aSn55qE6IqC54K577yM5aKe5by66KeG6KeJ5pWI5p6cCiAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KDI1LCAocGFyYW1zLmRhdGEudmFsdWUgfHwgMSkgKiAxMiksIDYwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoMjAsIChwYXJhbXMuZGF0YS52YWx1ZSB8fCAxKSAqIDEwKSwgNTApOwogICAgICAgICAgfQogICAgICAgIH1dCiAgICAgIH07CiAgICAgIGNvbnNvbGUubG9nKCcg6K6+572u5Zu+6KGo6YWN572uOicsIHsKICAgICAgICB0aXRsZTogb3B0aW9uLnRpdGxlLnRleHQsCiAgICAgICAgc2VyaWVzRGF0YUxlbmd0aDogb3B0aW9uLnNlcmllc1swXS5kYXRhLmxlbmd0aCwKICAgICAgICBzZXJpZXNMaW5rc0xlbmd0aDogb3B0aW9uLnNlcmllc1swXS5saW5rcy5sZW5ndGgsCiAgICAgICAgbGF5b3V0VHlwZTogb3B0aW9uLnNlcmllc1swXS5sYXlvdXQsCiAgICAgICAgaGFzRm9yY2VDb25maWc6ICEhb3B0aW9uLnNlcmllc1swXS5mb3JjZSwKICAgICAgICBmb3JjZUNvbmZpZzogb3B0aW9uLnNlcmllc1swXS5mb3JjZQogICAgICB9KTsKCiAgICAgIC8vIOiuvue9ruWbvuihqOmFjee9rgogICAgICBjaGFydC52YWx1ZS5zZXRPcHRpb24ob3B0aW9uLCB0cnVlKTsKCiAgICAgIC8vIOmHjeaWsOe7keWumuS6i+S7tuWkhOeQhuWHveaVsO+8jOehruS/neW4g+WxgOWIh+aNouWQjueCueWHu+S6i+S7tuS7jeeEtuacieaViAogICAgICBiaW5kQ2hhcnRFdmVudHMoKTsKCiAgICAgIC8vIOWKm+WvvOWQkeW4g+WxgOW3suiuvue9ruS4uumdmeaAgeaooeW8j++8jOaXoOmcgOWKqOeUu+ebkeaOpwogICAgICBpZiAobGF5b3V0VHlwZS52YWx1ZSA9PT0gJ2ZvcmNlJykgewogICAgICAgIGNvbnNvbGUubG9nKCfwn46vIOWKm+WvvOWQkeW4g+WxgOW3suiuvue9ruS4uumdmeaAgeaooeW8j++8jOW4g+WxgOWwhuWcqOWIneWni+WMluWQjuS/neaMgeeos+WumicpOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCfinIUg5Zu+6KGo6YWN572u5bey6K6+572u5a6M5oiQ77yM5LqL5Lu25bey6YeN5paw57uR5a6aJyk7CiAgICAgIGNvbnNvbGUubG9nKCfwn5OKIOW9k+WJjeWbvuihqOeKtuaAgTonLCB7CiAgICAgICAgaXNEaXNwb3NlZDogY2hhcnQudmFsdWUuaXNEaXNwb3NlZCgpLAogICAgICAgIGhhc0RhdGE6IG9wdGlvbi5zZXJpZXNbMF0uZGF0YS5sZW5ndGggPiAwLAogICAgICAgIGxheW91dFR5cGU6IGxheW91dFR5cGUudmFsdWUKICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgbG9hZEdyYXBoRGF0YSA9IGFzeW5jICgpID0+IHsKICAgICAgbG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIOW8gOWni+WKoOi9veefpeivhuWbvuiwseaVsOaNri4uLicpOwogICAgICB0cnkgewogICAgICAgIGNvbnNvbGUubG9nKCfwn5OhIOiwg+eUqEFQSTogZ2V0S25vd2xlZGdlR3JhcGhEYXRhJyk7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRLbm93bGVkZ2VHcmFwaERhdGEoewogICAgICAgICAgbm9kZV9saW1pdDogMTAwCiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2coJ+KchSBBUEnlk43lupTmiJDlip86JywgcmVzcG9uc2UpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5OKIOWTjeW6lOaVsOaNrue7k+aehDonLCB7CiAgICAgICAgICBoYXNOb2RlczogISFyZXNwb25zZS5ub2RlcywKICAgICAgICAgIG5vZGVzQ291bnQ6IHJlc3BvbnNlLm5vZGVzID8gcmVzcG9uc2Uubm9kZXMubGVuZ3RoIDogMCwKICAgICAgICAgIGhhc0VkZ2VzOiAhIXJlc3BvbnNlLmVkZ2VzLAogICAgICAgICAgZWRnZXNDb3VudDogcmVzcG9uc2UuZWRnZXMgPyByZXNwb25zZS5lZGdlcy5sZW5ndGggOiAwLAogICAgICAgICAgaGFzQ2F0ZWdvcmllczogISFyZXNwb25zZS5jYXRlZ29yaWVzLAogICAgICAgICAgY2F0ZWdvcmllc0NvdW50OiByZXNwb25zZS5jYXRlZ29yaWVzID8gcmVzcG9uc2UuY2F0ZWdvcmllcy5sZW5ndGggOiAwLAogICAgICAgICAgcmVzcG9uc2VLZXlzOiBPYmplY3Qua2V5cyhyZXNwb25zZSksCiAgICAgICAgICByZXNwb25zZVR5cGU6IHR5cGVvZiByZXNwb25zZQogICAgICAgIH0pOwoKICAgICAgICAvLyDor6bnu4bmo4Dmn6Xlk43lupTmlbDmja4KICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBBUEnlk43lupTljp/lp4vmlbDmja46JywgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UsIG51bGwsIDIpKTsKCiAgICAgICAgLy8g5qOA5p+l5pWw5o2u6LWL5YC85YmN55qE54q25oCBCiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4sg6LWL5YC85YmNZ3JhcGhEYXRh54q25oCBOicsIHsKICAgICAgICAgIG5vZGVzQmVmb3JlOiBncmFwaERhdGEubm9kZXMubGVuZ3RoLAogICAgICAgICAgZWRnZXNCZWZvcmU6IGdyYXBoRGF0YS5lZGdlcy5sZW5ndGgsCiAgICAgICAgICBjYXRlZ29yaWVzQmVmb3JlOiBncmFwaERhdGEuY2F0ZWdvcmllcy5sZW5ndGgKICAgICAgICB9KTsKCiAgICAgICAgLy8g5L+u5aSN5pWw5o2u6Kej5p6Q77yaQVBJ6L+U5Zue55qE5pWw5o2u5ZyoZGF0YeWtl+auteS4rQogICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHJlc3BvbnNlLmRhdGEgfHwgcmVzcG9uc2U7CgogICAgICAgIC8vIOehruS/neaVsOaNruexu+Wei+S4gOiHtOaAp++8mue7n+S4gOi9rOaNouS4uuWtl+espuS4suexu+WeiwogICAgICAgIGNvbnN0IHJhd05vZGVzID0gcmVzcG9uc2VEYXRhLm5vZGVzIHx8IFtdOwogICAgICAgIGNvbnN0IHJhd0VkZ2VzID0gcmVzcG9uc2VEYXRhLmVkZ2VzIHx8IFtdOwoKICAgICAgICAvLyDlpITnkIboioLngrnmlbDmja7vvIznoa7kv51JROS4uuWtl+espuS4suexu+Wei+W5tuiuvue9ruato+ehrueahGNhdGVnb3J5CiAgICAgICAgZ3JhcGhEYXRhLm5vZGVzID0gcmF3Tm9kZXMubWFwKChub2RlLCBpbmRleCkgPT4gewogICAgICAgICAgLy8g5om+5Yiw5a+55bqU55qEY2F0ZWdvcnnntKLlvJUKICAgICAgICAgIGNvbnN0IGNhdGVnb3J5SW5kZXggPSByZXNwb25zZURhdGEuY2F0ZWdvcmllcyA/IHJlc3BvbnNlRGF0YS5jYXRlZ29yaWVzLmZpbmRJbmRleChjYXQgPT4gY2F0Lm5hbWUgPT09IG5vZGUudHlwZSkgOiAtMTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLm5vZGUsCiAgICAgICAgICAgIGlkOiBTdHJpbmcobm9kZS5pZCksCiAgICAgICAgICAgIC8vIOS9v+eUqOWQjuerr+i/lOWbnueahOato+ehrklECiAgICAgICAgICAgIG5hbWU6IG5vZGUubmFtZSB8fCBg6IqC54K5JHtpbmRleH1gLAogICAgICAgICAgICB0eXBlOiBub2RlLnR5cGUgfHwgJ2RlZmF1bHQnLAogICAgICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnlJbmRleCA+PSAwID8gY2F0ZWdvcnlJbmRleCA6IDAsCiAgICAgICAgICAgIC8vIOiuvue9ruato+ehrueahGNhdGVnb3J557Si5byVCiAgICAgICAgICAgIHZhbHVlOiBub2RlLnZhbHVlIHx8IDEsCiAgICAgICAgICAgIC8vIOiuvue9ruiKgueCueminOiJsu+8jOS9v+eUqGdldEVudGl0eUNvbG9y5Ye95pWw6I635Y+W6aKc6ImyCiAgICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICAgIGNvbG9yOiBnZXRFbnRpdHlDb2xvcihub2RlLnR5cGUgfHwgJ2RlZmF1bHQnKQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICAvLyDlpITnkIbovrnmlbDmja7vvIznoa7kv51zb3VyY2Xlkox0YXJnZXTkuLrlrZfnrKbkuLLnsbvlnosKICAgICAgICBncmFwaERhdGEuZWRnZXMgPSByYXdFZGdlcy5tYXAoZWRnZSA9PiAoewogICAgICAgICAgLi4uZWRnZSwKICAgICAgICAgIHNvdXJjZTogU3RyaW5nKGVkZ2Uuc291cmNlIHx8ICcnKSwKICAgICAgICAgIC8vIOehruS/nXNvdXJjZeS4uuWtl+espuS4sgogICAgICAgICAgdGFyZ2V0OiBTdHJpbmcoZWRnZS50YXJnZXQgfHwgJycpLAogICAgICAgICAgLy8g56Gu5L+ddGFyZ2V05Li65a2X56ym5LiyCiAgICAgICAgICB2YWx1ZTogZWRnZS52YWx1ZSB8fCBlZGdlLndlaWdodCB8fCAxLAogICAgICAgICAgcmVsYXRpb246IGVkZ2UucmVsYXRpb24gfHwgZWRnZS5sYWJlbCB8fCAn5YWz6IGUJwogICAgICAgIH0pKTsKICAgICAgICBncmFwaERhdGEuY2F0ZWdvcmllcyA9IHJlc3BvbnNlRGF0YS5jYXRlZ29yaWVzIHx8IFtdOwoKICAgICAgICAvLyDmo4Dmn6XmlbDmja7otYvlgLzlkI7nmoTnirbmgIEKICAgICAgICBjb25zb2xlLmxvZygn8J+TiCDotYvlgLzlkI5ncmFwaERhdGHnirbmgIE6JywgewogICAgICAgICAgbm9kZXNBZnRlcjogZ3JhcGhEYXRhLm5vZGVzLmxlbmd0aCwKICAgICAgICAgIGVkZ2VzQWZ0ZXI6IGdyYXBoRGF0YS5lZGdlcy5sZW5ndGgsCiAgICAgICAgICBjYXRlZ29yaWVzQWZ0ZXI6IGdyYXBoRGF0YS5jYXRlZ29yaWVzLmxlbmd0aCwKICAgICAgICAgIG5vZGVzVHlwZTogdHlwZW9mIGdyYXBoRGF0YS5ub2RlcywKICAgICAgICAgIG5vZGVzSXNBcnJheTogQXJyYXkuaXNBcnJheShncmFwaERhdGEubm9kZXMpCiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4gg5aSE55CG5ZCO55qE5Zu+6LCx5pWw5o2uOicsIHsKICAgICAgICAgIG5vZGVzOiBncmFwaERhdGEubm9kZXMubGVuZ3RoLAogICAgICAgICAgZWRnZXM6IGdyYXBoRGF0YS5lZGdlcy5sZW5ndGgsCiAgICAgICAgICBjYXRlZ29yaWVzOiBncmFwaERhdGEuY2F0ZWdvcmllcy5sZW5ndGgKICAgICAgICB9KTsKICAgICAgICBpZiAoZ3JhcGhEYXRhLm5vZGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHZhciBfZ3JhcGhEYXRhJG5vZGVzJCwgX2dyYXBoRGF0YSRub2RlcyQyOwogICAgICAgICAgY29uc29sZS5sb2coJ/CflI0g6IqC54K556S65L6LOicsIGdyYXBoRGF0YS5ub2Rlcy5zbGljZSgwLCAzKSk7CiAgICAgICAgICAvLyDor6bnu4bmo4Dmn6XoioLngrlJROeahOaVsOaNruexu+WeiwogICAgICAgICAgY29uc29sZS5sb2coJ/CfhpQg6IqC54K5SUTmlbDmja7nsbvlnovliIbmnpA6JywgewogICAgICAgICAgICBmaXJzdE5vZGVJZDogKF9ncmFwaERhdGEkbm9kZXMkID0gZ3JhcGhEYXRhLm5vZGVzWzBdKSA9PT0gbnVsbCB8fCBfZ3JhcGhEYXRhJG5vZGVzJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dyYXBoRGF0YSRub2RlcyQuaWQsCiAgICAgICAgICAgIGZpcnN0Tm9kZUlkVHlwZTogdHlwZW9mICgoX2dyYXBoRGF0YSRub2RlcyQyID0gZ3JhcGhEYXRhLm5vZGVzWzBdKSA9PT0gbnVsbCB8fCBfZ3JhcGhEYXRhJG5vZGVzJDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ncmFwaERhdGEkbm9kZXMkMi5pZCksCiAgICAgICAgICAgIGFsbE5vZGVJZHM6IGdyYXBoRGF0YS5ub2Rlcy5zbGljZSgwLCA1KS5tYXAobm9kZSA9PiAoewogICAgICAgICAgICAgIGlkOiBub2RlLmlkLAogICAgICAgICAgICAgIHR5cGU6IHR5cGVvZiBub2RlLmlkCiAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgbm9kZUlkVHlwZXM6IFsuLi5uZXcgU2V0KGdyYXBoRGF0YS5ub2Rlcy5tYXAobm9kZSA9PiB0eXBlb2Ygbm9kZS5pZCkpXQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChncmFwaERhdGEuZWRnZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgdmFyIF9ncmFwaERhdGEkZWRnZXMkLCBfZ3JhcGhEYXRhJGVkZ2VzJDIsIF9ncmFwaERhdGEkZWRnZXMkMywgX2dyYXBoRGF0YSRlZGdlcyQ0OwogICAgICAgICAgY29uc29sZS5sb2coJ/CflJcg6L6556S65L6LOicsIGdyYXBoRGF0YS5lZGdlcy5zbGljZSgwLCAzKSk7CiAgICAgICAgICAvLyDor6bnu4bmo4Dmn6XovrnnmoRzb3VyY2UvdGFyZ2V05pWw5o2u57G75Z6LCiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UlyDovrnov57mjqXmlbDmja7nsbvlnovliIbmnpA6JywgewogICAgICAgICAgICBmaXJzdEVkZ2VTb3VyY2U6IChfZ3JhcGhEYXRhJGVkZ2VzJCA9IGdyYXBoRGF0YS5lZGdlc1swXSkgPT09IG51bGwgfHwgX2dyYXBoRGF0YSRlZGdlcyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ncmFwaERhdGEkZWRnZXMkLnNvdXJjZSwKICAgICAgICAgICAgZmlyc3RFZGdlU291cmNlVHlwZTogdHlwZW9mICgoX2dyYXBoRGF0YSRlZGdlcyQyID0gZ3JhcGhEYXRhLmVkZ2VzWzBdKSA9PT0gbnVsbCB8fCBfZ3JhcGhEYXRhJGVkZ2VzJDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ncmFwaERhdGEkZWRnZXMkMi5zb3VyY2UpLAogICAgICAgICAgICBmaXJzdEVkZ2VUYXJnZXQ6IChfZ3JhcGhEYXRhJGVkZ2VzJDMgPSBncmFwaERhdGEuZWRnZXNbMF0pID09PSBudWxsIHx8IF9ncmFwaERhdGEkZWRnZXMkMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dyYXBoRGF0YSRlZGdlcyQzLnRhcmdldCwKICAgICAgICAgICAgZmlyc3RFZGdlVGFyZ2V0VHlwZTogdHlwZW9mICgoX2dyYXBoRGF0YSRlZGdlcyQ0ID0gZ3JhcGhEYXRhLmVkZ2VzWzBdKSA9PT0gbnVsbCB8fCBfZ3JhcGhEYXRhJGVkZ2VzJDQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ncmFwaERhdGEkZWRnZXMkNC50YXJnZXQpLAogICAgICAgICAgICBhbGxFZGdlQ29ubmVjdGlvbnM6IGdyYXBoRGF0YS5lZGdlcy5zbGljZSgwLCA1KS5tYXAoZWRnZSA9PiAoewogICAgICAgICAgICAgIHNvdXJjZTogZWRnZS5zb3VyY2UsCiAgICAgICAgICAgICAgc291cmNlVHlwZTogdHlwZW9mIGVkZ2Uuc291cmNlLAogICAgICAgICAgICAgIHRhcmdldDogZWRnZS50YXJnZXQsCiAgICAgICAgICAgICAgdGFyZ2V0VHlwZTogdHlwZW9mIGVkZ2UudGFyZ2V0CiAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgZWRnZVNvdXJjZVR5cGVzOiBbLi4ubmV3IFNldChncmFwaERhdGEuZWRnZXMubWFwKGVkZ2UgPT4gdHlwZW9mIGVkZ2Uuc291cmNlKSldLAogICAgICAgICAgICBlZGdlVGFyZ2V0VHlwZXM6IFsuLi5uZXcgU2V0KGdyYXBoRGF0YS5lZGdlcy5tYXAoZWRnZSA9PiB0eXBlb2YgZWRnZS50YXJnZXQpKV0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8g5o+Q5Y+W5a6e5L2T57G75Z6LCiAgICAgICAgZW50aXR5VHlwZXMudmFsdWUgPSBbLi4ubmV3IFNldChncmFwaERhdGEubm9kZXMubWFwKG5vZGUgPT4gbm9kZS50eXBlKSldOwogICAgICAgIGNvbnNvbGUubG9nKCfwn4+377iPIOWunuS9k+exu+WeizonLCBlbnRpdHlUeXBlcy52YWx1ZSk7CgogICAgICAgIC8vIOaVsOaNruWKoOi9veWujOaIkOWQju+8jOebtOaOpeabtOaWsOWbvuihqAogICAgICAgIGNvbnNvbGUubG9nKCfwn46oIOW8gOWni+abtOaWsOWbvuihqC4uLicpOwogICAgICAgIGF3YWl0IHVwZGF0ZUNoYXJ0KCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZSwgX2Vycm9yJHJlc3BvbnNlMiwgX2Vycm9yJHJlc3BvbnNlMzsKICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg5Yqg6L2955+l6K+G5Zu+6LCx5pWw5o2u5aSx6LSlOicsIGVycm9yKTsKICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg6ZSZ6K+v6K+m5oOFOicsIHsKICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsCiAgICAgICAgICBzdGF0dXM6IChfZXJyb3IkcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZXJyb3IkcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgc3RhdHVzVGV4dDogKF9lcnJvciRyZXNwb25zZTIgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vycm9yJHJlc3BvbnNlMi5zdGF0dXNUZXh0LAogICAgICAgICAgZGF0YTogKF9lcnJvciRyZXNwb25zZTMgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vycm9yJHJlc3BvbnNlMy5kYXRhCiAgICAgICAgfSk7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDliqDovb3nn6Xor4blm77osLHmlbDmja7lpLHotKU6ICR7ZXJyb3IubWVzc2FnZX1gKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgY29uc29sZS5sb2coJ/Cfj4Eg5pWw5o2u5Yqg6L295a6M5oiQJyk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBsb2FkRW50aXR5UmVsYXRpb25zaGlwcyA9IGFzeW5jIGVudGl0eUlkID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zb2xlLmxvZygn8J+UjSDlvIDlp4vliqDovb3lrp7kvZPlhbPns7vvvIxlbnRpdHlJZDonLCBlbnRpdHlJZCk7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRFbnRpdHlEZXRhaWwoZW50aXR5SWQpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5OKIEFQSeWTjeW6lOWujOaVtOaVsOaNrjonLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZSwgbnVsbCwgMikpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5SXIOWFs+ezu+aVsOaNruivpuaDhTonLCB7CiAgICAgICAgICBoYXNSZWxhdGlvbnNoaXBzOiAhIXJlc3BvbnNlLmRhdGEucmVsYXRpb25zaGlwcywKICAgICAgICAgIHJlbGF0aW9uc2hpcHNUeXBlOiB0eXBlb2YgcmVzcG9uc2UuZGF0YS5yZWxhdGlvbnNoaXBzLAogICAgICAgICAgcmVsYXRpb25zaGlwc0xlbmd0aDogcmVzcG9uc2UuZGF0YS5yZWxhdGlvbnNoaXBzID8gcmVzcG9uc2UuZGF0YS5yZWxhdGlvbnNoaXBzLmxlbmd0aCA6IDAsCiAgICAgICAgICByZWxhdGlvbnNoaXBzQ29udGVudDogcmVzcG9uc2UuZGF0YS5yZWxhdGlvbnNoaXBzCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgcmVsYXRpb25zaGlwcyA9IHJlc3BvbnNlLmRhdGEucmVsYXRpb25zaGlwcyB8fCBbXTsKICAgICAgICBjb25zb2xlLmxvZygn8J+TiyDlh4blpIfotYvlgLznmoTlhbPns7vmlbDmja46JywgcmVsYXRpb25zaGlwcyk7CiAgICAgICAgZW50aXR5UmVsYXRpb25zaGlwcy52YWx1ZSA9IHJlbGF0aW9uc2hpcHM7CiAgICAgICAgY29uc29sZS5sb2coJ+KchSDlhbPns7vmlbDmja7lt7LotYvlgLzvvIxlbnRpdHlSZWxhdGlvbnNoaXBzLnZhbHVlOicsIGVudGl0eVJlbGF0aW9uc2hpcHMudmFsdWUpOwogICAgICAgIGNvbnNvbGUubG9nKCfwn5OIIOacgOe7iOeKtuaAgeajgOafpTonLCB7CiAgICAgICAgICBlbnRpdHlSZWxhdGlvbnNoaXBzTGVuZ3RoOiBlbnRpdHlSZWxhdGlvbnNoaXBzLnZhbHVlLmxlbmd0aCwKICAgICAgICAgIGVudGl0eVJlbGF0aW9uc2hpcHNDb250ZW50OiBlbnRpdHlSZWxhdGlvbnNoaXBzLnZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIOWKoOi9veWunuS9k+WFs+ezu+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIOmUmeivr+ivpuaDhTonLCB7CiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLAogICAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLAogICAgICAgICAgcmVzcG9uc2U6IGVycm9yLnJlc3BvbnNlCiAgICAgICAgfSk7CiAgICAgICAgZW50aXR5UmVsYXRpb25zaGlwcy52YWx1ZSA9IFtdOwogICAgICB9CiAgICB9OwoKICAgIC8vIOeUn+WRveWRqOacnwogICAgb25Nb3VudGVkKCgpID0+IHsKICAgICAgY29uc29sZS5sb2coJ/CfmoAg57uE5Lu25bey5oyC6L2977yM562J5b6FRE9N5riy5p+T5a6M5oiQLi4uJyk7CgogICAgICAvLyDorr7nva7kuovku7bnm5HlkKzlmagKICAgICAgaGFuZGxlUmVzaXplID0gKCkgPT4gewogICAgICAgIGlmIChjaGFydC52YWx1ZSAmJiAhY2hhcnQudmFsdWUuaXNEaXNwb3NlZCgpKSB7CiAgICAgICAgICBjaGFydC52YWx1ZS5yZXNpemUoKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UgPSAoKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBpZiAoY2hhcnQudmFsdWUgJiYgIWNoYXJ0LnZhbHVlLmlzRGlzcG9zZWQoKSkgewogICAgICAgICAgICBjaGFydC52YWx1ZS5yZXNpemUoKTsKICAgICAgICAgIH0KICAgICAgICB9LCAxMDApOwogICAgICB9OwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaGFuZGxlUmVzaXplKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpOwoKICAgICAgLy8g5L2/55So5aSa6YeN5bu26L+f56Gu5L+dRE9N5a6M5YWo5riy5p+TCiAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRE9N5riy5p+T5a6M5oiQ77yM5byA5aeL5Yid5aeL5YyW5Zu+6KGoJyk7CiAgICAgICAgICAgIC8vIOWFiOWIneWni+WMluWbvuihqO+8jOatpOaXtmxvYWRpbmfkuLpmYWxzZe+8jOehruS/nURPTeWFg+e0oOacieato+ehruWwuuWvuAogICAgICAgICAgICBhd2FpdCBpbml0Q2hhcnQoKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSDlm77ooajliJ3lp4vljJblrozmiJDvvIzlvIDlp4vliqDovb3mlbDmja4nKTsKICAgICAgICAgICAgLy8g5Zu+6KGo5Yid5aeL5YyW5a6M5oiQ5ZCO5YaN5Yqg6L295pWw5o2u77yM5q2k5pe25Y+v5Lul5a6J5YWo5Zyw5pi+56S6bG9hZGluZwogICAgICAgICAgICBhd2FpdCBsb2FkR3JhcGhEYXRhKCk7CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg57uE5Lu25Yid5aeL5YyW5aSx6LSlOicsIGVycm9yKTsKICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGDlm77ooajliJ3lp4vljJblpLHotKU6ICR7ZXJyb3IubWVzc2FnZX1gKTsKCiAgICAgICAgICAgIC8vIOWmguaenOWIneWni+WMluWksei0pe+8jOWwneivlemHjeaWsOWIneWni+WMlgogICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQg5bCd6K+V6YeN5paw5Yid5aeL5YyW5Zu+6KGoLi4uJyk7CiAgICAgICAgICAgICAgICBhd2FpdCBpbml0Q2hhcnQoKTsKICAgICAgICAgICAgICAgIGF3YWl0IGxvYWRHcmFwaERhdGEoKTsKICAgICAgICAgICAgICB9IGNhdGNoIChyZXRyeUVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg6YeN5paw5Yid5aeL5YyW5Lmf5aSx6LSlOicsIHJldHJ5RXJyb3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgMTAwKTsgLy8g6aKd5aSW5bu26L+fMTAwbXPnoa7kv51ET03lrozlhajmuLLmn5MKICAgICAgfSk7CiAgICB9KTsKICAgIG9uVW5tb3VudGVkKCgpID0+IHsKICAgICAgaWYgKGNoYXJ0LnZhbHVlKSB7CiAgICAgICAgY2hhcnQudmFsdWUuZGlzcG9zZSgpOwogICAgICB9CiAgICAgIC8vIOa4heeQhuS6i+S7tuebkeWQrOWZqAogICAgICBpZiAoaGFuZGxlUmVzaXplKSB7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGhhbmRsZVJlc2l6ZSk7CiAgICAgIH0KICAgICAgaWYgKGhhbmRsZUZ1bGxzY3JlZW5DaGFuZ2UpIHsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmdWxsc2NyZWVuY2hhbmdlJywgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIOaatOmcsuaWueazlee7meeItue7hOS7tgogICAgX19leHBvc2UoewogICAgICByZWZyZXNoOiBsb2FkR3JhcGhEYXRhCiAgICB9KTsKICAgIGNvbnN0IF9fcmV0dXJuZWRfXyA9IHsKICAgICAgY2hhcnRSZWYsCiAgICAgIGNoYXJ0LAogICAgICBsb2FkaW5nLAogICAgICBpc0NvbGxhcHNlZCwKICAgICAgc2hvd0VudGl0eURldGFpbCwKICAgICAgc2VsZWN0ZWRFbnRpdHksCiAgICAgIHNlYXJjaFF1ZXJ5LAogICAgICBzZWxlY3RlZFR5cGVzLAogICAgICBsYXlvdXRUeXBlLAogICAgICBzaG93TGFiZWxzLAogICAgICBncmFwaERhdGEsCiAgICAgIGVudGl0eVR5cGVzLAogICAgICBlbnRpdHlSZWxhdGlvbnNoaXBzLAogICAgICBnZXQgaGFuZGxlUmVzaXplKCkgewogICAgICAgIHJldHVybiBoYW5kbGVSZXNpemU7CiAgICAgIH0sCiAgICAgIHNldCBoYW5kbGVSZXNpemUodikgewogICAgICAgIGhhbmRsZVJlc2l6ZSA9IHY7CiAgICAgIH0sCiAgICAgIGdldCBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlKCkgewogICAgICAgIHJldHVybiBoYW5kbGVGdWxsc2NyZWVuQ2hhbmdlOwogICAgICB9LAogICAgICBzZXQgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSh2KSB7CiAgICAgICAgaGFuZGxlRnVsbHNjcmVlbkNoYW5nZSA9IHY7CiAgICAgIH0sCiAgICAgIGNhdGVnb3JpZXMsCiAgICAgIHRvZ2dsZUNvbGxhcHNlLAogICAgICBoYW5kbGVTZWFyY2gsCiAgICAgIGhhbmRsZVR5cGVGaWx0ZXIsCiAgICAgIGhhbmRsZUxheW91dENoYW5nZSwKICAgICAgcmVzZXRHcmFwaCwKICAgICAgZXhwb3J0R3JhcGgsCiAgICAgIHRvZ2dsZUZ1bGxzY3JlZW4sCiAgICAgIGdldEVudGl0eUNvbG9yLAogICAgICBnZXRFbnRpdHlUYWdUeXBlLAogICAgICBnZXRDaGluZXNlVHlwZSwKICAgICAgb3B0aW1pemVDaXJjdWxhckxheW91dCwKICAgICAgaGlnaGxpZ2h0Tm9kZXMsCiAgICAgIHJlc2V0SGlnaGxpZ2h0LAogICAgICBoaWdobGlnaHRSZWxhdGlvbnNoaXAsCiAgICAgIGluaXRDaGFydCwKICAgICAgYmluZENoYXJ0RXZlbnRzLAogICAgICBpbml0aWFsaXplRm9yY2VMYXlvdXRQb3NpdGlvbnMsCiAgICAgIHVwZGF0ZUNoYXJ0LAogICAgICBsb2FkR3JhcGhEYXRhLAogICAgICBsb2FkRW50aXR5UmVsYXRpb25zaGlwcywKICAgICAgcmVmLAogICAgICByZWFjdGl2ZSwKICAgICAgY29tcHV0ZWQsCiAgICAgIG9uTW91bnRlZCwKICAgICAgb25Vbm1vdW50ZWQsCiAgICAgIG5leHRUaWNrLAogICAgICBnZXQgZWNoYXJ0cygpIHsKICAgICAgICByZXR1cm4gZWNoYXJ0czsKICAgICAgfSwKICAgICAgZ2V0IFNlYXJjaCgpIHsKICAgICAgICByZXR1cm4gU2VhcmNoOwogICAgICB9LAogICAgICBnZXQgUmVmcmVzaCgpIHsKICAgICAgICByZXR1cm4gUmVmcmVzaDsKICAgICAgfSwKICAgICAgZ2V0IERvd25sb2FkKCkgewogICAgICAgIHJldHVybiBEb3dubG9hZDsKICAgICAgfSwKICAgICAgZ2V0IEZ1bGxTY3JlZW4oKSB7CiAgICAgICAgcmV0dXJuIEZ1bGxTY3JlZW47CiAgICAgIH0sCiAgICAgIGdldCBEYXRhQW5hbHlzaXMoKSB7CiAgICAgICAgcmV0dXJuIERhdGFBbmFseXNpczsKICAgICAgfSwKICAgICAgZ2V0IEV4cGFuZCgpIHsKICAgICAgICByZXR1cm4gRXhwYW5kOwogICAgICB9LAogICAgICBnZXQgRm9sZCgpIHsKICAgICAgICByZXR1cm4gRm9sZDsKICAgICAgfSwKICAgICAgZ2V0IEFycm93UmlnaHQoKSB7CiAgICAgICAgcmV0dXJuIEFycm93UmlnaHQ7CiAgICAgIH0sCiAgICAgIGdldCBMb2FkaW5nKCkgewogICAgICAgIHJldHVybiBMb2FkaW5nOwogICAgICB9LAogICAgICBnZXQgRWxNZXNzYWdlKCkgewogICAgICAgIHJldHVybiBFbE1lc3NhZ2U7CiAgICAgIH0sCiAgICAgIGdldCBnZXRLbm93bGVkZ2VHcmFwaERhdGEoKSB7CiAgICAgICAgcmV0dXJuIGdldEtub3dsZWRnZUdyYXBoRGF0YTsKICAgICAgfSwKICAgICAgZ2V0IGdldEVudGl0eURldGFpbCgpIHsKICAgICAgICByZXR1cm4gZ2V0RW50aXR5RGV0YWlsOwogICAgICB9CiAgICB9OwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fcmV0dXJuZWRfXywgJ19faXNTY3JpcHRTZXR1cCcsIHsKICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgIHZhbHVlOiB0cnVlCiAgICB9KTsKICAgIHJldHVybiBfX3JldHVybmVkX187CiAgfQp9Ow=="},{"version":3,"names":["ref","reactive","computed","onMounted","onUnmounted","nextTick","echarts","Search","Refresh","Download","FullScreen","DataAnalysis","Expand","Fold","ArrowRight","Loading","ElMessage","getKnowledgeGraphData","getEntityDetail","chartRef","chart","loading","isCollapsed","showEntityDetail","selectedEntity","searchQuery","selectedTypes","layoutType","showLabels","graphData","nodes","edges","categories","entityTypes","entityRelationships","handleResize","handleFullscreenChange","map","cat","name","color","toggleCollapse","value","handleSearch","trim","resetHighlight","searchTerm","toLowerCase","matchedNodes","filter","node","includes","length","highlightNodes","dispatchAction","type","seriesIndex","dataIndex","findIndex","id","warning","handleTypeFilter","updateChart","handleLayoutChange","console","log","forEach","fixed","x","y","isDisposed","clear","resetGraph","exportGraph","url","getDataURL","pixelRatio","backgroundColor","link","document","createElement","href","download","click","success","toggleFullscreen","container","parentElement","fullscreenElement","exitFullscreen","requestFullscreen","setTimeout","resize","error","getEntityColor","category","find","getEntityTagType","typeMap","getChineseType","englishType","optimizeCircularLayout","containerWidth","containerHeight","centerX","centerY","maxRadius","Math","min","nodeCount","radius","index","angle","PI","cos","sin","max","nodeIds","highlightRelationship","relationship","sourceIndex","targetIndex","targetName","initChart","retryCount","_targetElement$parent","chartRefExists","chartRefValue","chartRefType","documentReady","readyState","targetElement","warn","querySelector","foundByClass","elementType","tagName","Promise","resolve","allChartCanvas","querySelectorAll","bodyChildren","body","children","Error","offsetHeight","rect","getBoundingClientRect","computedStyle","window","getComputedStyle","parentRect","isElementUsable","display","visibility","parentVisible","width","height","offsetWidth","clientWidth","clientHeight","opacity","finalWidth","finalHeight","dispose","init","renderer","devicePixelRatio","targetElementTag","targetElementClass","className","bindChartEvents","off","on","params","dataType","componentType","seriesType","data","loadEntityRelationships","setOption","series","emphasis","itemStyle","shadowBlur","shadowColor","chartInstance","option","getOption","element","chartWidth","chartHeight","margin","undefined","initializeForceLayoutPositions","r","random","String","symbolSize","borderColor","borderWidth","_chartRef$value","_chartRef$value2","hasChart","nodesCount","edgesCount","filteredNodes","Set","filteredEdges","edge","has","source","target","weight","lineStyle","nodeIdSet","unmatchedEdges","sourceExists","targetExists","isValid","isSelfLoop","Array","from","slice","nodeIdTypes","edgeSourceTargetSample","sourceType","targetType","unmatchedEdgesCount","validEdgesCount","unmatchedEdgesSample","title","text","left","textStyle","fontSize","fontWeight","tooltip","trigger","formatter","description","relation","extraCssText","legend","show","layout","links","roam","draggable","edgeSymbol","edgeSymbolSize","autoCurveness","label","position","test","substring","textBorderColor","textBorderWidth","edgeLabel","labelLayout","hideOverlap","moveOverlap","scaleLimit","force","repulsion","gravity","edgeLength","layoutAnimation","friction","initLayout","circular","rotateLabel","curveness","cap","join","focus","seriesDataLength","seriesLinksLength","hasForceConfig","forceConfig","hasData","loadGraphData","response","node_limit","hasNodes","hasEdges","hasCategories","categoriesCount","responseKeys","Object","keys","responseType","JSON","stringify","nodesBefore","edgesBefore","categoriesBefore","responseData","rawNodes","rawEdges","categoryIndex","nodesAfter","edgesAfter","categoriesAfter","nodesType","nodesIsArray","isArray","_graphData$nodes$","_graphData$nodes$2","firstNodeId","firstNodeIdType","allNodeIds","_graphData$edges$","_graphData$edges$2","_graphData$edges$3","_graphData$edges$4","firstEdgeSource","firstEdgeSourceType","firstEdgeTarget","firstEdgeTargetType","allEdgeConnections","edgeSourceTypes","edgeTargetTypes","_error$response","_error$response2","_error$response3","message","status","statusText","entityId","hasRelationships","relationships","relationshipsType","relationshipsLength","relationshipsContent","entityRelationshipsLength","entityRelationshipsContent","stack","addEventListener","retryError","removeEventListener","__expose","refresh"],"sources":["C:/Users/18083/Desktop/CCIT/office/o/smart-office/frontend/src/views/knowledge/components/KnowledgeGraph.vue"],"sourcesContent":["<template>\n  <div class=\"knowledge-graph-container\">\n    <!-- 控制面板 -->\n    <div class=\"control-panel\">\n      <el-card class=\"control-card\">\n        <template #header>\n          <div class=\"card-header\">\n            <span>图谱控制</span>\n            <el-button \n              type=\"text\" \n              :icon=\"isCollapsed ? Expand : Fold\" \n              @click=\"toggleCollapse\"\n            />\n          </div>\n        </template>\n        \n        <div v-show=\"!isCollapsed\" class=\"control-content\">\n          <!-- 搜索功能 -->\n          <div class=\"control-section\">\n            <h6>搜索实体</h6>\n            <el-input \n              v-model=\"searchQuery\" \n              placeholder=\"搜索实体名称...\"\n              clearable\n              :prefix-icon=\"Search\"\n              @input=\"handleSearch\"\n            />\n          </div>\n          \n          <!-- 实体类型筛选 -->\n          <div class=\"control-section\">\n            <h6>实体类型</h6>\n            <el-select \n              v-model=\"selectedTypes\" \n              multiple \n              placeholder=\"选择实体类型\"\n              style=\"width: 100%\"\n              @change=\"handleTypeFilter\"\n            >\n              <el-option \n                v-for=\"type in entityTypes\" \n                :key=\"type\" \n                :label=\"type\" \n                :value=\"type\"\n              />\n            </el-select>\n          </div>\n          \n          <!-- 布局控制 -->\n          <div class=\"control-section\">\n            <h6>布局算法</h6>\n            <el-select \n              v-model=\"layoutType\" \n              placeholder=\"选择布局\"\n              style=\"width: 100%\"\n              @change=\"handleLayoutChange\"\n            >\n              <el-option label=\"圆形布局\" value=\"circular\" />\n              <el-option label=\"力导向布局\" value=\"force\" />\n            </el-select>\n          </div>\n          \n          <!-- 操作按钮 -->\n          <div class=\"control-section\">\n            <div class=\"action-buttons\">\n              <el-button \n                class=\"action-btn\" \n                type=\"primary\" \n                :icon=\"Refresh\" \n                @click=\"resetGraph\"\n              >\n                <el-icon><Refresh /></el-icon> 重置视图\n              </el-button>\n              <el-button \n                class=\"action-btn\" \n                type=\"success\" \n                :icon=\"Download\" \n                @click=\"exportGraph\"\n              >\n                <el-icon><Download /></el-icon> 导出图片\n              </el-button>\n            </div>\n          </div>\n        </div>\n      </el-card>\n      \n\n    </div>\n    \n    <!-- 图谱展示区域 -->\n    <div class=\"graph-container\">\n      <div class=\"graph-header\">\n        <div class=\"header-left\">\n          <h3>企业知识图谱</h3>\n        </div>\n        <div class=\"header-center\">\n          <!-- 移除文档管理和知识图谱按钮 -->\n        </div>\n        <div class=\"header-right\">\n          <el-button type=\"text\" :icon=\"FullScreen\" @click=\"toggleFullscreen\">全屏</el-button>\n        </div>\n      </div>\n      \n      <div class=\"graph-content\">\n        <div \n          ref=\"chartRef\" \n          class=\"chart-canvas\"\n        ></div>\n        \n        <!-- 图例说明 - 移到右侧 -->\n        <div class=\"legend-panel\">\n          <el-card class=\"legend-card-right\">\n            <template #header>\n              <span>图例说明</span>\n            </template>\n            <div class=\"legend-content\">\n              <div v-for=\"category in categories\" :key=\"category.name\" class=\"legend-item\">\n                <div class=\"legend-color\" :style=\"{backgroundColor: category.color}\"></div>\n                <span class=\"legend-label\">{{ category.name }}</span>\n              </div>\n            </div>\n          </el-card>\n        </div>\n      </div>\n      \n      <!-- 独立的loading遮罩，不影响chart-canvas尺寸 -->\n      <div v-if=\"loading\" class=\"loading-overlay\">\n        <el-icon class=\"loading-icon\"><Loading /></el-icon>\n        <span>正在加载知识图谱...</span>\n      </div>\n      \n      <div v-if=\"!loading && graphData.nodes.length === 0\" class=\"empty-state\">\n        <div class=\"empty-icon\">\n          <el-icon><DataAnalysis /></el-icon>\n        </div>\n        <h3>暂无知识图谱数据</h3>\n        <p>请先构建知识库以生成图谱数据</p>\n      </div>\n    </div>\n    \n    <!-- 实体详情抽屉 -->\n    <el-drawer \n      v-model=\"showEntityDetail\" \n      title=\"实体详情\" \n      size=\"400px\"\n      direction=\"rtl\"\n    >\n      <div v-if=\"selectedEntity\" class=\"entity-detail\">\n        <div class=\"entity-header\">\n          <div class=\"entity-icon\" :style=\"{backgroundColor: getEntityColor(selectedEntity.type)}\">\n            <el-icon><DataAnalysis /></el-icon>\n          </div>\n          <div class=\"entity-info\">\n            <h4>{{ selectedEntity.name }}</h4>\n            <el-tag :type=\"getEntityTagType(selectedEntity.type)\">{{ getChineseType(selectedEntity.type) }}</el-tag>\n          </div>\n        </div>\n        \n        <div class=\"entity-content\">\n          <el-descriptions :column=\"1\" border>\n            <el-descriptions-item label=\"实体ID\">{{ selectedEntity.id }}</el-descriptions-item>\n            <el-descriptions-item label=\"类型\">{{ getChineseType(selectedEntity.type) }}</el-descriptions-item>\n            <el-descriptions-item label=\"描述\">\n              <div class=\"description-text\">{{ selectedEntity.description || '暂无描述' }}</div>\n            </el-descriptions-item>\n            <el-descriptions-item label=\"度数\">{{ selectedEntity.symbolSize || 0 }}</el-descriptions-item>\n          </el-descriptions>\n          \n          <div class=\"relationships-section\">\n            <h5>关联关系</h5>\n            <div v-if=\"entityRelationships.length === 0\" class=\"no-relationships\">\n              暂无关联关系\n            </div>\n            <div v-else class=\"relationships-list\">\n              <div \n                v-for=\"rel in entityRelationships\" \n                :key=\"rel.id\" \n                class=\"relationship-item\"\n                @click=\"highlightRelationship(rel)\"\n              >\n                <div class=\"relationship-info\">\n                  <span class=\"relationship-target\">\n                    <span class=\"relationship-direction\">{{ rel.direction === 'outgoing' ? '→' : '←' }}</span>\n                    {{ rel.direction === 'outgoing' ? rel.targetName : rel.sourceName }}\n                  </span>\n                  <span class=\"relationship-type\">{{ rel.relation }}</span>\n                </div>\n                <el-icon class=\"relationship-arrow\"><ArrowRight /></el-icon>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </el-drawer>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted, onUnmounted, nextTick } from 'vue'\nimport * as echarts from 'echarts'\nimport { \n  Search, \n  Refresh, \n  Download,\n  FullScreen, \n  DataAnalysis,\n  Expand,\n  Fold,\n  ArrowRight,\n  Loading\n} from '@element-plus/icons-vue'\nimport { ElMessage } from 'element-plus'\nimport { getKnowledgeGraphData, getEntityDetail } from '@/api/knowledge'\n\n// 响应式数据\nconst chartRef = ref(null)\nconst chart = ref(null)\nconst loading = ref(false)\nconst isCollapsed = ref(false)\nconst showEntityDetail = ref(false)\nconst selectedEntity = ref(null)\nconst searchQuery = ref('')\nconst selectedTypes = ref([])\nconst layoutType = ref('circular')\nconst showLabels = ref(true)\n\n// 图谱数据\nconst graphData = reactive({\n  nodes: [],\n  edges: [],\n  categories: []\n})\n\nconst entityTypes = ref([])\nconst entityRelationships = ref([])\n\n// 事件处理函数\nlet handleResize = null\nlet handleFullscreenChange = null\n\n// 计算属性\nconst categories = computed(() => {\n  return graphData.categories.map(cat => ({\n    name: cat.name,\n    color: cat.color\n  }))\n})\n\n// 方法\nconst toggleCollapse = () => {\n  isCollapsed.value = !isCollapsed.value\n}\n\nconst handleSearch = () => {\n  if (!searchQuery.value.trim()) {\n    resetHighlight()\n    return\n  }\n  \n  const searchTerm = searchQuery.value.toLowerCase()\n  const matchedNodes = graphData.nodes.filter(node => \n    node.name.toLowerCase().includes(searchTerm)\n  )\n  \n  if (matchedNodes.length > 0) {\n    highlightNodes(matchedNodes)\n    // 聚焦到第一个匹配的节点\n    if (chart.value) {\n      chart.value.dispatchAction({\n        type: 'focusNodeAdjacency',\n        seriesIndex: 0,\n        dataIndex: graphData.nodes.findIndex(node => node.id === matchedNodes[0].id)\n      })\n    }\n  } else {\n    ElMessage.warning('未找到匹配的实体')\n  }\n}\n\nconst handleTypeFilter = async () => {\n  await updateChart()\n}\n\nconst handleLayoutChange = async () => {\n  console.log('🔄 布局类型改变:', layoutType.value)\n  \n  // 如果切换到力导向布局，清除所有节点的固定位置\n  if (layoutType.value === 'force') {\n    console.log('🎯 切换到力导向布局，清除节点固定位置')\n    graphData.nodes.forEach(node => {\n      // 移除可能存在的固定位置属性\n      delete node.fixed\n      delete node.x\n      delete node.y\n    })\n  }\n  \n  // 强制重新渲染图表\n  if (chart.value && !chart.value.isDisposed()) {\n    chart.value.clear() // 清除当前图表内容\n  }\n  \n  await updateChart()\n}\n\nconst resetGraph = () => {\n  searchQuery.value = ''\n  selectedTypes.value = []\n  resetHighlight()\n  if (chart.value) {\n    chart.value.dispatchAction({\n      type: 'restore'\n    })\n  }\n}\n\nconst exportGraph = () => {\n  if (chart.value) {\n    const url = chart.value.getDataURL({\n      type: 'png',\n      pixelRatio: 2,\n      backgroundColor: '#fff'\n    })\n    \n    const link = document.createElement('a')\n    link.href = url\n    link.download = '知识图谱.png'\n    link.click()\n    \n    ElMessage.success('图谱导出成功')\n  }\n}\n\nconst toggleFullscreen = async () => {\n  const container = chartRef.value.parentElement\n  try {\n    if (document.fullscreenElement) {\n      await document.exitFullscreen()\n    } else {\n      await container.requestFullscreen()\n    }\n    // 等待全屏状态改变后重新调整图表大小\n    setTimeout(() => {\n      if (chart.value && !chart.value.isDisposed()) {\n        chart.value.resize()\n      }\n    }, 100)\n  } catch (error) {\n    console.error('全屏操作失败:', error)\n    ElMessage.error('全屏操作失败')\n  }\n}\n\nconst getEntityColor = (type) => {\n  const category = graphData.categories.find(cat => cat.name === type)\n  return category ? category.color : '#409EFF'\n}\n\nconst getEntityTagType = (type) => {\n  const typeMap = {\n    'ORGANIZATION': 'primary',\n    'PERSON': 'success',\n    'LOCATION': 'warning',\n    'EVENT': 'danger',\n    '组织': 'primary',\n    '人员': 'success',\n    '地点': 'warning',\n    '事件': 'danger'\n  }\n  return typeMap[type] || 'info'\n}\n\n// 英文类型转中文映射\nconst getChineseType = (englishType) => {\n  const typeMap = {\n    'ORGANIZATION': '组织',\n    'PERSON': '人员',\n    'LOCATION': '地点',\n    'EVENT': '事件'\n  }\n  return typeMap[englishType] || englishType\n}\n\n// 优化圆形布局，确保节点不溢出容器\nconst optimizeCircularLayout = (nodes, containerWidth, containerHeight) => {\n  if (!nodes || nodes.length === 0) return nodes\n  \n  const centerX = containerWidth / 2\n  const centerY = containerHeight / 2\n  const maxRadius = Math.min(containerWidth, containerHeight) / 2 - 80 // 留出边距\n  \n  // 根据节点数量动态调整半径\n  const nodeCount = nodes.length\n  let radius = maxRadius\n  \n  if (nodeCount > 20) {\n    radius = maxRadius * 0.8 // 节点多时缩小半径\n  } else if (nodeCount > 10) {\n    radius = maxRadius * 0.9\n  }\n  \n  // 为每个节点计算位置\n  return nodes.map((node, index) => {\n    const angle = (2 * Math.PI * index) / nodeCount\n    const x = centerX + radius * Math.cos(angle)\n    const y = centerY + radius * Math.sin(angle)\n    \n    return {\n      ...node,\n      x: Math.max(50, Math.min(containerWidth - 50, x)),\n      y: Math.max(50, Math.min(containerHeight - 50, y))\n    }\n  })\n}\n\nconst highlightNodes = (nodes) => {\n  if (!chart.value) return\n  \n  const nodeIds = nodes.map(node => node.id)\n  chart.value.dispatchAction({\n    type: 'highlight',\n    seriesIndex: 0,\n    dataIndex: graphData.nodes.map((node, index) => \n      nodeIds.includes(node.id) ? index : null\n    ).filter(index => index !== null)\n  })\n}\n\nconst resetHighlight = () => {\n  if (!chart.value) return\n  \n  chart.value.dispatchAction({\n    type: 'downplay',\n    seriesIndex: 0\n  })\n}\n\nconst highlightRelationship = (relationship) => {\n  // 高亮显示特定关系\n  if (!chart.value) return\n  \n  const sourceIndex = graphData.nodes.findIndex(node => node.id === selectedEntity.value.id)\n  const targetIndex = graphData.nodes.findIndex(node => node.name === relationship.targetName)\n  \n  if (sourceIndex !== -1 && targetIndex !== -1) {\n    chart.value.dispatchAction({\n      type: 'highlight',\n      seriesIndex: 0,\n      dataIndex: [sourceIndex, targetIndex]\n    })\n  }\n}\n\nconst initChart = async (retryCount = 0) => {\n  console.log(`🎯 开始初始化图表... (尝试次数: ${retryCount + 1})`)\n  \n  // 详细检查DOM元素状态\n  console.log('🔍 DOM元素状态检查:', {\n    chartRefExists: !!chartRef.value,\n    chartRefValue: !!chartRef.value,\n    chartRefType: typeof chartRef.value,\n    documentReady: document.readyState\n  })\n  \n  // 检查DOM元素是否存在\n  let targetElement = chartRef.value\n  \n  if (!targetElement) {\n    console.warn('⚠️ chartRef.value 为空，尝试备用方案')\n    \n    // 备用方案：直接通过class选择器获取元素\n    targetElement = document.querySelector('.chart-canvas')\n    console.log('🔍 备用方案查找结果:', {\n      foundByClass: !!targetElement,\n      elementType: targetElement ? targetElement.tagName : 'N/A'\n    })\n    \n    if (!targetElement) {\n      if (retryCount < 10) {\n        console.log(`🔄 等待DOM元素就绪，第${retryCount + 1}次重试...`)\n        await new Promise(resolve => setTimeout(resolve, 200))\n        return initChart(retryCount + 1)\n      } else {\n        console.error('❌ 达到最大重试次数，DOM元素仍然不存在')\n        console.error('🔍 最终状态检查:', {\n          allChartCanvas: document.querySelectorAll('.chart-canvas').length,\n          bodyChildren: document.body.children.length,\n          documentReady: document.readyState\n        })\n        throw new Error('DOM元素初始化失败')\n      }\n    } else {\n      // 如果通过class找到了元素，更新chartRef\n      chartRef.value = targetElement\n      console.log('✅ 通过备用方案找到DOM元素')\n    }\n  }\n  \n  // 强制触发重排，确保DOM完全渲染\n  targetElement.offsetHeight\n  await new Promise(resolve => setTimeout(resolve, 50))\n  \n  // 检查DOM元素是否可见和有尺寸\n  const rect = targetElement.getBoundingClientRect()\n  const computedStyle = window.getComputedStyle(targetElement)\n  const parentRect = targetElement.parentElement?.getBoundingClientRect()\n  \n  // 放宽可见性检查条件 - 只要元素存在且不是display:none就认为可用\n  const isElementUsable = (\n    computedStyle.display !== 'none' &&\n    computedStyle.visibility !== 'hidden'\n  )\n  const parentVisible = !parentRect || (parentRect.width > 0 && parentRect.height > 0)\n  \n  console.log('📊 DOM元素状态检查:', {\n    width: rect.width,\n    height: rect.height,\n    offsetWidth: targetElement.offsetWidth,\n    offsetHeight: targetElement.offsetHeight,\n    clientWidth: targetElement.clientWidth,\n    clientHeight: targetElement.clientHeight,\n    display: computedStyle.display,\n    visibility: computedStyle.visibility,\n    opacity: computedStyle.opacity,\n    isElementUsable,\n    parentVisible,\n    parentRect: parentRect ? { width: parentRect.width, height: parentRect.height } : null\n  })\n  \n  // 如果元素不可用，等待重试\n  if (!isElementUsable) {\n    if (retryCount < 5) {\n      console.log(`🔄 DOM元素不可用，第${retryCount + 1}次重试...`)\n      await new Promise(resolve => setTimeout(resolve, 200))\n      return initChart(retryCount + 1)\n    } else {\n      console.warn('⚠️ 元素仍不可用，但继续尝试初始化')\n    }\n  }\n  \n  // 最终尺寸确认，优先使用CSS设置的固定尺寸\n  let finalWidth = targetElement.offsetWidth || targetElement.clientWidth || rect.width\n  let finalHeight = targetElement.offsetHeight || targetElement.clientHeight || rect.height\n  \n  // 如果无法获取尺寸，使用CSS中设置的默认值\n  if (!finalWidth || finalWidth < 100) {\n    finalWidth = 800 // 对应CSS中chart-canvas的flex:1计算结果\n  }\n  if (!finalHeight || finalHeight < 100) {\n    finalHeight = 500 // 对应CSS中chart-canvas的固定高度\n  }\n  \n  console.log('📊 目标DOM元素:', targetElement)\n  console.log('📊 最终使用尺寸:', {\n    width: finalWidth,\n    height: finalHeight,\n    offsetWidth: targetElement.offsetWidth,\n    offsetHeight: targetElement.offsetHeight,\n    clientWidth: targetElement.clientWidth,\n    clientHeight: targetElement.clientHeight\n  })\n  \n  // 如果已有实例，先销毁\n  if (chart.value && !chart.value.isDisposed()) {\n    console.log('🗑️ 销毁现有ECharts实例')\n    chart.value.dispose()\n  }\n  \n  console.log('🎨 开始初始化ECharts实例...')\n  // 明确指定ECharts配置，解决高DPI显示器canvas尺寸异常问题\n  chart.value = echarts.init(targetElement, null, {\n    renderer: 'canvas',\n    devicePixelRatio: 1, // 固定为1，避免高DPI自动缩放导致的显示异常\n    width: finalWidth,\n    height: finalHeight\n  })\n  console.log('✅ ECharts 实例已创建:', !!chart.value)\n  console.log('✅ ECharts 实例状态:', {\n    isDisposed: chart.value ? chart.value.isDisposed() : 'N/A',\n    targetElementTag: targetElement.tagName,\n    targetElementClass: targetElement.className\n  })\n  \n  // 确保chartRef指向正确的元素\n  if (chartRef.value !== targetElement) {\n    chartRef.value = targetElement\n    console.log('🔧 已更新chartRef引用')\n  }\n  \n  // 绑定节点点击事件处理函数\n  bindChartEvents()\n  \n  console.log('🎉 图表初始化完成')\n  \n  // 验证图表实例是否正常创建\n  if (!chart.value || chart.value.isDisposed()) {\n    console.error('❌ ECharts实例创建失败或已被销毁')\n    throw new Error('ECharts实例创建失败')\n  }\n  \n  console.log('✅ ECharts实例验证通过，图表初始化成功')\n}\n\n// 绑定图表事件处理函数\nconst bindChartEvents = () => {\n  if (!chart.value || chart.value.isDisposed()) {\n    console.warn('⚠️ 图表实例不存在，无法绑定事件')\n    return\n  }\n  \n  // 清除之前的事件监听器，避免重复绑定\n  chart.value.off('click')\n  chart.value.off('mousedown')\n  chart.value.off('mouseup')\n  \n  // 监听节点点击事件\n  chart.value.on('click', (params) => {\n    console.log('🖱️ 节点被点击:', params)\n    console.log('🔍 点击事件详情:', {\n      dataType: params.dataType,\n      componentType: params.componentType,\n      seriesType: params.seriesType,\n      data: params.data,\n      layoutType: layoutType.value\n    })\n    \n    if (params.dataType === 'node' && params.data) {\n      console.log('✅ 有效的节点点击，准备显示详情')\n      selectedEntity.value = params.data\n      loadEntityRelationships(params.data.id)\n      showEntityDetail.value = true\n      console.log('📋 实体详情已设置:', {\n        selectedEntity: selectedEntity.value,\n        showEntityDetail: showEntityDetail.value\n      })\n    } else {\n       console.log('❌ 无效的节点点击或缺少数据')\n     }\n   })\n  \n  // 监听节点拖拽开始事件\n  chart.value.on('mousedown', (params) => {\n    if (params.dataType === 'node') {\n      console.log('🖱️ 开始拖拽节点:', params.data.name)\n      // 添加拖拽时的视觉反馈\n      chart.value.setOption({\n        series: [{\n          emphasis: {\n            itemStyle: {\n              shadowBlur: 20,\n              shadowColor: 'rgba(64, 158, 255, 0.5)'\n            }\n          }\n        }]\n      })\n    }\n  })\n  \n  // 监听节点拖拽结束事件\n  chart.value.on('mouseup', (params) => {\n    if (params.dataType === 'node') {\n      console.log('🖱️ 结束拖拽节点:', params.data.name)\n      // 检查节点是否超出边界并进行约束\n      const chartInstance = chart.value\n      const option = chartInstance.getOption()\n      const series = option.series[0]\n      \n      // 获取图表容器尺寸\n      const element = chartRef.value\n      if (!element) return\n      \n      const chartWidth = element.offsetWidth\n      const chartHeight = element.offsetHeight\n      const margin = 50 // 边界边距\n      \n      // 约束节点位置在容器范围内\n      if (series.data) {\n        series.data.forEach(node => {\n          if (node.x !== undefined && node.y !== undefined) {\n            node.x = Math.max(margin, Math.min(chartWidth - margin, node.x))\n            node.y = Math.max(margin, Math.min(chartHeight - margin, node.y))\n          }\n        })\n        \n        // 更新图表配置\n        chartInstance.setOption({\n          series: [{\n            data: series.data\n          }]\n        })\n      }\n    }\n  })\n}\n\n// 为力导向布局添加初始位置设置\nconst initializeForceLayoutPositions = (nodes, containerWidth, containerHeight) => {\n  if (!nodes || nodes.length === 0) return nodes\n  \n  const centerX = containerWidth / 2\n  const centerY = containerHeight / 2\n  const radius = Math.min(containerWidth, containerHeight) / 4\n  \n  return nodes.map((node, index) => {\n    // 如果节点没有初始位置，给它一个随机但合理的初始位置\n    if (typeof node.x === 'undefined' || typeof node.y === 'undefined') {\n      const angle = (2 * Math.PI * index) / nodes.length\n      const r = radius * (0.5 + Math.random() * 0.5) // 随机半径，避免所有节点在同一圆上\n      \n      return {\n        ...node,\n        x: centerX + r * Math.cos(angle) + (Math.random() - 0.5) * 50,\n        y: centerY + r * Math.sin(angle) + (Math.random() - 0.5) * 50,\n        // 确保节点有必要的属性\n        id: String(node.id || `node_${index}`), // 确保ID为字符串\n        name: node.name || `节点${index}`,\n        category: node.category !== undefined ? node.category : (node.type || 0),\n        value: node.value || 1,\n        symbolSize: node.symbolSize || 30,\n        // 确保节点有正确的颜色\n        itemStyle: {\n          color: getEntityColor(node.type || 'default'),\n          borderColor: '#fff',\n          borderWidth: 2,\n          shadowBlur: 10,\n          shadowColor: 'rgba(0, 0, 0, 0.3)'\n        }\n      }\n    }\n    \n    return {\n      ...node,\n      // 确保节点有必要的属性\n      id: String(node.id || `node_${index}`), // 确保ID为字符串\n      name: node.name || `节点${index}`,\n      category: node.category !== undefined ? node.category : (node.type || 0),\n      value: node.value || 1,\n      symbolSize: node.symbolSize || 30,\n      // 确保节点有正确的颜色\n      itemStyle: {\n        color: getEntityColor(node.type || 'default'),\n        borderColor: '#fff',\n        borderWidth: 2,\n        shadowBlur: 10,\n        shadowColor: 'rgba(0, 0, 0, 0.3)'\n      }\n    }\n  })\n}\n\nconst updateChart = async () => {\n  console.log('🎨 updateChart 被调用')\n  console.log('📊 当前状态:', {\n    hasChart: !!chart.value,\n    nodesCount: graphData.nodes.length,\n    edgesCount: graphData.edges.length,\n    selectedTypes: selectedTypes.value,\n    layoutType: layoutType.value\n  })\n  \n  // 检查ECharts实例是否存在或已被dispose\n  if (!chart.value || chart.value.isDisposed()) {\n    console.warn('⚠️ ECharts实例不存在或已被dispose，重新初始化图表')\n    console.log('🔧 chartRef.value状态:', !!chartRef.value)\n    await initChart()\n    if (!chart.value) {\n      console.error('❌ 重新初始化图表失败')\n      return\n    }\n    console.log('✅ ECharts实例重新初始化成功')\n  }\n  \n  if (graphData.nodes.length === 0) {\n    console.warn('⚠️ 没有节点数据，无法更新图表')\n    return\n  }\n  \n  // 过滤节点\n  let filteredNodes = [...graphData.nodes] // 创建副本避免修改原数据\n  if (selectedTypes.value.length > 0) {\n    filteredNodes = graphData.nodes.filter(node => \n      selectedTypes.value.includes(node.type)\n    )\n    console.log('🔍 应用类型过滤后的节点数量:', filteredNodes.length)\n  }\n  \n  // 过滤边，确保边的数据格式正确\n  const nodeIds = new Set(filteredNodes.map(node => String(node.id))) // 确保节点ID集合为字符串\n  let filteredEdges = graphData.edges.filter(edge => \n    nodeIds.has(String(edge.source)) && nodeIds.has(String(edge.target)) // 确保类型匹配\n  ).map(edge => ({\n    ...edge,\n    // 确保边有必要的属性，并统一数据类型\n    source: String(edge.source), // 确保source为字符串\n    target: String(edge.target), // 确保target为字符串\n    value: edge.value || edge.weight || 1,\n    lineStyle: {\n      color: edge.color || '#999',\n      width: edge.width || 1\n    }\n  }))\n  \n  console.log('📈 过滤后的数据:', {\n    filteredNodes: filteredNodes.length,\n    filteredEdges: filteredEdges.length\n  })\n  \n  // 详细检查节点ID和边连接的匹配情况\n  if (filteredNodes.length > 0 && filteredEdges.length > 0) {\n    const nodeIdSet = new Set(filteredNodes.map(node => String(node.id)))\n    const unmatchedEdges = filteredEdges.filter(edge => \n      !nodeIdSet.has(String(edge.source)) || !nodeIdSet.has(String(edge.target))\n    )\n    \n    // 进一步过滤，只保留有效的边\n    filteredEdges = filteredEdges.filter(edge => {\n      const sourceExists = nodeIdSet.has(String(edge.source))\n      const targetExists = nodeIdSet.has(String(edge.target))\n      const isValid = sourceExists && targetExists && edge.source !== edge.target\n      \n      if (!isValid) {\n        console.warn('⚠️ 发现无效边:', {\n          source: edge.source,\n          target: edge.target,\n          sourceExists,\n          targetExists,\n          isSelfLoop: edge.source === edge.target\n        })\n      }\n      \n      return isValid\n    })\n    \n    console.log('🔍 节点和边的匹配分析:', {\n      nodeIds: Array.from(nodeIdSet).slice(0, 10),\n      nodeIdTypes: [...new Set(filteredNodes.map(node => typeof node.id))],\n      edgeSourceTargetSample: filteredEdges.slice(0, 5).map(edge => ({\n        source: edge.source,\n        sourceType: typeof edge.source,\n        target: edge.target,\n        targetType: typeof edge.target,\n        sourceExists: nodeIdSet.has(String(edge.source)),\n        targetExists: nodeIdSet.has(String(edge.target))\n      })),\n      unmatchedEdgesCount: unmatchedEdges.length,\n      validEdgesCount: filteredEdges.length,\n      unmatchedEdgesSample: unmatchedEdges.slice(0, 3)\n    })\n  }\n  \n  // 获取容器尺寸\n  const containerWidth = chartRef.value?.offsetWidth || 800\n  const containerHeight = chartRef.value?.offsetHeight || 600\n  \n  // 根据布局类型处理节点位置\n  if (layoutType.value === 'circular') {\n    filteredNodes = optimizeCircularLayout(filteredNodes, containerWidth, containerHeight)\n    console.log('🎯 已优化圆形布局，容器尺寸:', { containerWidth, containerHeight })\n  } else if (layoutType.value === 'force') {\n    // 为力导向布局初始化节点位置\n    filteredNodes = initializeForceLayoutPositions(filteredNodes, containerWidth, containerHeight)\n    console.log('🎯 已初始化力导向布局节点位置，容器尺寸:', { containerWidth, containerHeight })\n    console.log('🔍 力导向节点示例:', filteredNodes.slice(0, 3))\n  }\n  \n  const option = {\n    title: {\n      text: '企业知识图谱',\n      left: 'center',\n      textStyle: {\n        fontSize: 18,\n        fontWeight: 'bold',\n        color: '#303133'\n      }\n    },\n    tooltip: {\n      trigger: 'item',\n      formatter: function(params) {\n        if (params.dataType === 'node') {\n          return `\n            <div style=\"padding: 6px 12px; max-width: 300px; word-wrap: break-word;\">\n              <strong style=\"color: #303133;\">${params.data.name}</strong><br/>\n              <span style=\"color: #606266;\">类型: ${getChineseType(params.data.type)}</span><br/>\n              <span style=\"color: #909399;\">${params.data.description || '暂无描述'}</span>\n            </div>\n          `\n        } else if (params.dataType === 'edge') {\n          return `\n            <div style=\"padding: 6px 12px; max-width: 300px; word-wrap: break-word;\">\n              <strong style=\"color: #303133;\">${params.data.source} → ${params.data.target}</strong><br/>\n              <span style=\"color: #606266;\">关系: ${params.data.relation}</span><br/>\n              <span style=\"color: #909399;\">权重: ${params.data.weight}</span>\n            </div>\n          `\n        }\n      },\n      backgroundColor: 'rgba(255, 255, 255, 0.95)',\n      borderColor: '#e4e7ed',\n      borderWidth: 1,\n      textStyle: {\n        fontSize: 12\n      },\n      extraCssText: 'max-width: 300px; max-height: 120px; overflow: hidden; white-space: normal; word-wrap: break-word; line-height: 1.4;'\n    },\n    legend: {\n      show: false\n    },\n    series: [{\n      type: 'graph',\n      layout: layoutType.value,\n      data: filteredNodes,\n      links: filteredEdges,\n      categories: graphData.categories,\n      roam: true,\n      draggable: true, // 启用节点拖拽\n      // 添加边的符号配置，确保连接到节点边缘\n      edgeSymbol: layoutType.value === 'force' ? ['none', 'arrow'] : ['none', 'none'],\n      edgeSymbolSize: layoutType.value === 'force' ? [0, 8] : [0, 0],\n      // 确保边连接到节点边缘而不是中心\n      autoCurveness: true,\n      label: {\n        show: showLabels.value,\n        position: 'inside', // 改为内部显示，避免溢出\n        formatter: function(params) {\n          // 只显示实体名称，不显示任何数字\n          const name = params.data.name || params.name\n          // 过滤掉纯数字内容，只保留文本\n          if (typeof name === 'string' && !/^\\d+$/.test(name.trim())) {\n            return name.length > 8 ? name.substring(0, 8) + '...' : name\n          }\n          return '' // 如果是纯数字则不显示\n        },\n        fontSize: 11,\n        color: '#303133',\n        fontWeight: 'bold',\n        textBorderColor: '#fff',\n        textBorderWidth: 1\n      },\n      edgeLabel: {\n        show: false, // 隐藏边标签，避免显示数字\n        formatter: function(params) {\n          // 只显示关系名称，不显示权重等数字\n          return params.data.relation || ''\n        },\n        fontSize: 10,\n        color: '#909399'\n      },\n      labelLayout: {\n        hideOverlap: true,\n        moveOverlap: 'shiftY' // 自动调整重叠标签位置\n      },\n      scaleLimit: {\n        min: 0.3,\n        max: 3\n      },\n      ...(layoutType.value === 'force' ? {\n        force: {\n          // 适中的节点间斥力，防止节点重叠但不过度分散\n          repulsion: [200, 600],\n          // 适中的重力，保持图形聚合\n          gravity: 0.15,\n          // 适中的边长，确保连接清晰可见\n          edgeLength: [50, 100],\n          // 关闭持续动画，避免线条持续移动\n          layoutAnimation: false,\n          // 增加摩擦力，让布局更快稳定\n          friction: 0.95,\n          // 设置初始温度，控制布局收敛速度\n          initLayout: 'circular',\n          // 添加边的连接配置\n          edgeSymbol: ['none', 'arrow'], // 添加箭头指示方向\n          edgeSymbolSize: [0, 8] // 箭头大小\n        }\n      } : {}),\n      ...(layoutType.value === 'circular' ? {\n        circular: {\n          rotateLabel: false, // 关闭标签旋转，保持水平\n          radius: 180 // 设置圆形布局半径，避免溢出\n        }\n      } : {}),\n      lineStyle: {\n        color: 'source',\n        curveness: layoutType.value === 'force' ? 0.1 : 0.1, // 减少弯曲度，让连线更直\n        opacity: 0.8,\n        width: layoutType.value === 'force' ? 2 : 1, // 增加线条宽度，更明显\n        type: 'solid', // 确保线条为实线\n        cap: 'round', // 圆形端点\n        join: 'round' // 圆形连接点\n      },\n      emphasis: {\n        focus: 'adjacency',\n        lineStyle: {\n          width: 3\n        },\n        label: {\n          show: true,\n          formatter: '{b}', // 悬停时显示完整名称\n          fontSize: 12,\n          fontWeight: 'bold'\n        }\n      },\n      // 节点样式现在在每个节点的itemStyle中单独设置\n      // 设置节点大小\n      symbolSize: function(value, params) {\n        if (layoutType.value === 'force') {\n          // 力导向布局使用更大的节点，增强视觉效果\n          return Math.min(Math.max(25, (params.data.value || 1) * 12), 60)\n        }\n        return Math.min(Math.max(20, (params.data.value || 1) * 10), 50)\n      }\n    }]\n  }\n  \n  console.log(' 设置图表配置:', {\n    title: option.title.text,\n    seriesDataLength: option.series[0].data.length,\n    seriesLinksLength: option.series[0].links.length,\n    layoutType: option.series[0].layout,\n    hasForceConfig: !!option.series[0].force,\n    forceConfig: option.series[0].force\n  })\n  \n  // 设置图表配置\n  chart.value.setOption(option, true)\n  \n  // 重新绑定事件处理函数，确保布局切换后点击事件仍然有效\n  bindChartEvents()\n  \n  // 力导向布局已设置为静态模式，无需动画监控\n  if (layoutType.value === 'force') {\n    console.log('🎯 力导向布局已设置为静态模式，布局将在初始化后保持稳定')\n  }\n  \n  console.log('✅ 图表配置已设置完成，事件已重新绑定')\n  console.log('📊 当前图表状态:', {\n    isDisposed: chart.value.isDisposed(),\n    hasData: option.series[0].data.length > 0,\n    layoutType: layoutType.value\n  })\n}\n\nconst loadGraphData = async () => {\n  loading.value = true\n  console.log('🚀 开始加载知识图谱数据...')\n  \n  try {\n    console.log('📡 调用API: getKnowledgeGraphData')\n    const response = await getKnowledgeGraphData({\n      node_limit: 100\n    })\n    \n    console.log('✅ API响应成功:', response)\n    console.log('📊 响应数据结构:', {\n      hasNodes: !!response.nodes,\n      nodesCount: response.nodes ? response.nodes.length : 0,\n      hasEdges: !!response.edges,\n      edgesCount: response.edges ? response.edges.length : 0,\n      hasCategories: !!response.categories,\n      categoriesCount: response.categories ? response.categories.length : 0,\n      responseKeys: Object.keys(response),\n      responseType: typeof response\n    })\n    \n    // 详细检查响应数据\n    console.log('🔍 API响应原始数据:', JSON.stringify(response, null, 2))\n    \n    // 检查数据赋值前的状态\n    console.log('📋 赋值前graphData状态:', {\n      nodesBefore: graphData.nodes.length,\n      edgesBefore: graphData.edges.length,\n      categoriesBefore: graphData.categories.length\n    })\n    \n    // 修复数据解析：API返回的数据在data字段中\n    const responseData = response.data || response\n    \n    // 确保数据类型一致性：统一转换为字符串类型\n    const rawNodes = responseData.nodes || []\n    const rawEdges = responseData.edges || []\n    \n    // 处理节点数据，确保ID为字符串类型并设置正确的category\n    graphData.nodes = rawNodes.map((node, index) => {\n      // 找到对应的category索引\n      const categoryIndex = responseData.categories ? \n        responseData.categories.findIndex(cat => cat.name === node.type) : -1\n      \n      return {\n        ...node,\n        id: String(node.id), // 使用后端返回的正确ID\n        name: node.name || `节点${index}`,\n        type: node.type || 'default',\n        category: categoryIndex >= 0 ? categoryIndex : 0, // 设置正确的category索引\n        value: node.value || 1,\n        // 设置节点颜色，使用getEntityColor函数获取颜色\n        itemStyle: {\n          color: getEntityColor(node.type || 'default')\n        }\n      }\n    })\n    \n    // 处理边数据，确保source和target为字符串类型\n    graphData.edges = rawEdges.map((edge) => ({\n      ...edge,\n      source: String(edge.source || ''), // 确保source为字符串\n      target: String(edge.target || ''), // 确保target为字符串\n      value: edge.value || edge.weight || 1,\n      relation: edge.relation || edge.label || '关联'\n    }))\n    \n    graphData.categories = responseData.categories || []\n    \n    // 检查数据赋值后的状态\n    console.log('📈 赋值后graphData状态:', {\n      nodesAfter: graphData.nodes.length,\n      edgesAfter: graphData.edges.length,\n      categoriesAfter: graphData.categories.length,\n      nodesType: typeof graphData.nodes,\n      nodesIsArray: Array.isArray(graphData.nodes)\n    })\n    \n    console.log('📈 处理后的图谱数据:', {\n      nodes: graphData.nodes.length,\n      edges: graphData.edges.length,\n      categories: graphData.categories.length\n    })\n    \n    if (graphData.nodes.length > 0) {\n      console.log('🔍 节点示例:', graphData.nodes.slice(0, 3))\n      // 详细检查节点ID的数据类型\n      console.log('🆔 节点ID数据类型分析:', {\n        firstNodeId: graphData.nodes[0]?.id,\n        firstNodeIdType: typeof graphData.nodes[0]?.id,\n        allNodeIds: graphData.nodes.slice(0, 5).map(node => ({ id: node.id, type: typeof node.id })),\n        nodeIdTypes: [...new Set(graphData.nodes.map(node => typeof node.id))]\n      })\n    }\n    \n    if (graphData.edges.length > 0) {\n      console.log('🔗 边示例:', graphData.edges.slice(0, 3))\n      // 详细检查边的source/target数据类型\n      console.log('🔗 边连接数据类型分析:', {\n        firstEdgeSource: graphData.edges[0]?.source,\n        firstEdgeSourceType: typeof graphData.edges[0]?.source,\n        firstEdgeTarget: graphData.edges[0]?.target,\n        firstEdgeTargetType: typeof graphData.edges[0]?.target,\n        allEdgeConnections: graphData.edges.slice(0, 5).map(edge => ({\n          source: edge.source,\n          sourceType: typeof edge.source,\n          target: edge.target,\n          targetType: typeof edge.target\n        })),\n        edgeSourceTypes: [...new Set(graphData.edges.map(edge => typeof edge.source))],\n        edgeTargetTypes: [...new Set(graphData.edges.map(edge => typeof edge.target))]\n      })\n    }\n    \n    // 提取实体类型\n    entityTypes.value = [...new Set(graphData.nodes.map(node => node.type))]\n    console.log('🏷️ 实体类型:', entityTypes.value)\n    \n    // 数据加载完成后，直接更新图表\n    console.log('🎨 开始更新图表...')\n    await updateChart()\n  } catch (error) {\n    console.error('❌ 加载知识图谱数据失败:', error)\n    console.error('❌ 错误详情:', {\n      message: error.message,\n      status: error.response?.status,\n      statusText: error.response?.statusText,\n      data: error.response?.data\n    })\n    ElMessage.error(`加载知识图谱数据失败: ${error.message}`)\n  } finally {\n    loading.value = false\n    console.log('🏁 数据加载完成')\n  }\n}\n\nconst loadEntityRelationships = async (entityId) => {\n  try {\n    console.log('🔍 开始加载实体关系，entityId:', entityId)\n    const response = await getEntityDetail(entityId)\n    console.log('📊 API响应完整数据:', JSON.stringify(response, null, 2))\n    console.log('🔗 关系数据详情:', {\n      hasRelationships: !!response.data.relationships,\n      relationshipsType: typeof response.data.relationships,\n      relationshipsLength: response.data.relationships ? response.data.relationships.length : 0,\n      relationshipsContent: response.data.relationships\n    })\n    \n    const relationships = response.data.relationships || []\n    console.log('📋 准备赋值的关系数据:', relationships)\n    entityRelationships.value = relationships\n    console.log('✅ 关系数据已赋值，entityRelationships.value:', entityRelationships.value)\n    console.log('📈 最终状态检查:', {\n      entityRelationshipsLength: entityRelationships.value.length,\n      entityRelationshipsContent: entityRelationships.value\n    })\n  } catch (error) {\n    console.error('❌ 加载实体关系失败:', error)\n    console.error('❌ 错误详情:', {\n      message: error.message,\n      stack: error.stack,\n      response: error.response\n    })\n    entityRelationships.value = []\n  }\n}\n\n// 生命周期\nonMounted(() => {\n  console.log('🚀 组件已挂载，等待DOM渲染完成...')\n  \n  // 设置事件监听器\n  handleResize = () => {\n    if (chart.value && !chart.value.isDisposed()) {\n      chart.value.resize()\n    }\n  }\n  \n  handleFullscreenChange = () => {\n    setTimeout(() => {\n      if (chart.value && !chart.value.isDisposed()) {\n        chart.value.resize()\n      }\n    }, 100)\n  }\n  \n  window.addEventListener('resize', handleResize)\n  document.addEventListener('fullscreenchange', handleFullscreenChange)\n  \n  // 使用多重延迟确保DOM完全渲染\n  nextTick(() => {\n    setTimeout(async () => {\n      try {\n        console.log('✅ DOM渲染完成，开始初始化图表')\n        // 先初始化图表，此时loading为false，确保DOM元素有正确尺寸\n        await initChart()\n        console.log('✅ 图表初始化完成，开始加载数据')\n        // 图表初始化完成后再加载数据，此时可以安全地显示loading\n        await loadGraphData()\n      } catch (error) {\n        console.error('❌ 组件初始化失败:', error)\n        ElMessage.error(`图表初始化失败: ${error.message}`)\n        \n        // 如果初始化失败，尝试重新初始化\n        setTimeout(async () => {\n          try {\n            console.log('🔄 尝试重新初始化图表...')\n            await initChart()\n            await loadGraphData()\n          } catch (retryError) {\n            console.error('❌ 重新初始化也失败:', retryError)\n          }\n        }, 1000)\n      }\n    }, 100) // 额外延迟100ms确保DOM完全渲染\n  })\n})\n\nonUnmounted(() => {\n  if (chart.value) {\n    chart.value.dispose()\n  }\n  // 清理事件监听器\n  if (handleResize) {\n    window.removeEventListener('resize', handleResize)\n  }\n  if (handleFullscreenChange) {\n    document.removeEventListener('fullscreenchange', handleFullscreenChange)\n  }\n})\n\n// 暴露方法给父组件\ndefineExpose({\n  refresh: loadGraphData\n})\n</script>\n\n<style scoped>\n.knowledge-graph-container {\n  display: flex;\n  height: 600px;\n  gap: 20px;\n}\n\n.control-panel {\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.control-card {\n  flex-shrink: 0;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.control-content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.control-section h6 {\n  margin: 0 0 8px 0;\n  font-weight: 600;\n  color: #303133;\n  font-size: 14px;\n}\n\n.action-buttons {\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n}\n\n.action-btn {\n  flex: 1;\n  justify-content: center;\n}\n\n\n\n.graph-container {\n  flex: 1;\n  height: 100%; /* 确保有明确的高度 */\n  display: flex;\n  flex-direction: column;\n  background: white;\n  border-radius: 8px;\n  border: 1px solid #e4e7ed;\n  position: relative; /* 为loading-overlay提供定位基准 */\n}\n\n.graph-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid #e4e7ed;\n}\n\n.header-left h3 {\n  margin: 0;\n  color: #303133;\n  font-weight: 600;\n}\n\n.header-center {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.header-right {\n  display: flex;\n  gap: 8px;\n}\n\n.graph-content {\n  display: flex;\n  flex: 1;\n  gap: 16px;\n  padding: 16px;\n}\n\n.chart-canvas {\n  flex: 1;\n  height: 500px; /* 使用固定高度，避免calc()在loading状态下计算为0 */\n  min-height: 400px;\n  overflow: hidden; /* 防止内容溢出 */\n  position: relative;\n  border-radius: 8px;\n  border: 1px solid #e4e7ed;\n  cursor: grab; /* 显示可拖拽光标 */\n  /* 确保元素有明确的尺寸 */\n  box-sizing: border-box;\n  flex-shrink: 0;\n}\n\n.legend-panel {\n  width: 200px;\n  flex-shrink: 0;\n}\n\n.legend-card-right {\n  height: fit-content;\n}\n\n.legend-content {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.legend-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.legend-color {\n  width: 12px;\n  height: 12px;\n  border-radius: 2px;\n}\n\n.legend-label {\n  font-size: 12px;\n  color: #606266;\n}\n\n.chart-canvas:active {\n  cursor: grabbing; /* 拖拽时的光标 */\n}\n\n.loading-overlay {\n  position: absolute;\n  top: 65px; /* 跳过graph-header的高度 */\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.9);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n  border-radius: 0 0 8px 8px;\n}\n\n.loading-icon {\n  font-size: 32px;\n  color: #409eff;\n  margin-bottom: 12px;\n  animation: rotate 2s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.empty-state {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: #909399;\n}\n\n.empty-icon {\n  font-size: 64px;\n  margin-bottom: 16px;\n}\n\n.empty-state h3 {\n  margin: 0 0 8px 0;\n  font-weight: 500;\n}\n\n.empty-state p {\n  margin: 0;\n  font-size: 14px;\n}\n\n.entity-detail {\n  padding: 20px;\n}\n\n.entity-header {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #e4e7ed;\n}\n\n.entity-icon {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 24px;\n}\n\n.entity-info h4 {\n  margin: 0 0 8px 0;\n  color: #303133;\n  font-weight: 600;\n}\n\n.entity-content {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.description-text {\n  line-height: 1.5;\n  color: #606266;\n}\n\n.relationships-section h5 {\n  margin: 0 0 12px 0;\n  color: #303133;\n  font-weight: 600;\n}\n\n.no-relationships {\n  color: #909399;\n  font-size: 14px;\n  text-align: center;\n  padding: 20px;\n}\n\n.relationships-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.relationship-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px;\n  border: 1px solid #e4e7ed;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.relationship-item:hover {\n  background-color: #f5f7fa;\n  border-color: #409eff;\n}\n\n.relationship-info {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.relationship-target {\n  font-weight: 500;\n  color: #303133;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.relationship-direction {\n  font-size: 14px;\n  color: #409eff;\n  font-weight: bold;\n}\n\n.relationship-type {\n  font-size: 12px;\n  color: #909399;\n}\n\n.relationship-arrow {\n  color: #409eff;\n}\n\n/* 响应式设计 */\n@media (max-width: 1200px) {\n  .knowledge-graph-container {\n    flex-direction: column;\n    height: auto;\n  }\n  \n  .control-panel {\n    width: 100%;\n    flex-direction: row;\n    overflow-x: auto;\n  }\n  \n  .control-card {\n    min-width: 250px;\n  }\n  \n  .graph-container {\n    height: 500px;\n  }\n  \n  .graph-content {\n    flex-direction: column;\n  }\n  \n  .legend-panel {\n    width: 100%;\n    order: -1;\n  }\n  \n  .chart-canvas {\n    height: 400px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]}]}