{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Index.vue","mtime":1750938394745},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3Iuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5kaWZmZXJlbmNlLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmludGVyc2VjdGlvbi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1kaXNqb2ludC1mcm9tLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmlzLXN1YnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1zdXBlcnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5zeW1tZXRyaWMtZGlmZmVyZW5jZS52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC51bmlvbi52Mi5qcyI7CmltcG9ydCB7IHJlZiwgY29tcHV0ZWQsIG9uTW91bnRlZCwgbmV4dFRpY2ssIGdldEN1cnJlbnRJbnN0YW5jZSwgcHJvdmlkZSwgb25BY3RpdmF0ZWQsIHdhdGNoIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlUm91dGVyLCB1c2VSb3V0ZSB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCwgRWxMb2FkaW5nIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IHsgU2VhcmNoLCBQbHVzLCBFZGl0UGVuLCBTaGFyZSwgRm9sZGVyLCBDbG9zZSwgTW9yZSwgRG9jdW1lbnQsIENsb2NrLCBVcGxvYWQgfSBmcm9tICdAZWxlbWVudC1wbHVzL2ljb25zLXZ1ZSc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IGdldERvY3VtZW50cywgZ2V0UmVjZW50RG9jdW1lbnRzLCBnZXRTaGFyZWREb2N1bWVudHMsIGdldERvY3VtZW50Q2F0ZWdvcmllcywgY3JlYXRlRG9jdW1lbnQsIGRlbGV0ZURvY3VtZW50IGFzIGFwaURlbGV0ZURvY3VtZW50LCBzaGFyZURvY3VtZW50IGFzIGFwaVNoYXJlRG9jdW1lbnQsIGNyZWF0ZURvY3VtZW50Q2F0ZWdvcnksIHVwZGF0ZURvY3VtZW50Q2F0ZWdvcnksIGRlbGV0ZURvY3VtZW50Q2F0ZWdvcnksIGFpR2VuZXJhdGVEb2N1bWVudCwgZ2V0RG9jdW1lbnREZXRhaWwsIHVwZGF0ZURvY3VtZW50LCBpbXBvcnRXb3JkRG9jdW1lbnQgfSBmcm9tICdAL2FwaS9zbWFydGRvYyc7CmltcG9ydCB1c2VyQXBpIGZyb20gJ0AvYXBpL3VzZXInOwppbXBvcnQgeyBjcmVhdGVDaGF0U2Vzc2lvbiwgZ2V0Q2hhdFNlc3Npb25zIH0gZnJvbSAnQC9hcGkvY2hhdCc7CmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU21hcnREb2NIb21lJywKICBjb21wb25lbnRzOiB7CiAgICBTZWFyY2gsCiAgICBQbHVzLAogICAgRWRpdFBlbiwKICAgIFNoYXJlLAogICAgRm9sZGVyLAogICAgQ2xvc2UsCiAgICBNb3JlLAogICAgRG9jdW1lbnQsCiAgICBDbG9jaywKICAgIFVwbG9hZAogIH0sCiAgc2V0dXAoKSB7CiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTsKICAgIGNvbnN0IHJvdXRlID0gdXNlUm91dGUoKTsKICAgIGNvbnN0IHsKICAgICAgcHJveHkKICAgIH0gPSBnZXRDdXJyZW50SW5zdGFuY2UoKTsgLy8g6I635Y+W57uE5Lu25a6e5L6LCgogICAgLy8g5Yik5pat5piv5ZCm5Li65byA5Y+R546v5aKDCiAgICBjb25zdCAkX2lzRGV2ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCc7CgogICAgLy8g5Yi35paw6Kem5Y+R5Zmo77yM55So5LqO5by65Yi257uE5Lu25Yi35pawCiAgICBjb25zdCByZWZyZXNoVHJpZ2dlciA9IHJlZihEYXRlLm5vdygpKTsKCiAgICAvLyDnirbmgIHmlbDmja4KICAgIGNvbnN0IGRvY3VtZW50cyA9IHJlZihbXSk7CiAgICBjb25zdCByZWNlbnREb2N1bWVudHMgPSByZWYoW10pOwogICAgY29uc3Qgc2hhcmVkRG9jdW1lbnRzID0gcmVmKFtdKTsKICAgIGNvbnN0IGRvY3VtZW50Q2F0ZWdvcmllcyA9IHJlZihbXSk7CiAgICBjb25zdCBzZWFyY2hRdWVyeSA9IHJlZignJyk7CiAgICBjb25zdCBzZWFyY2hDYXRlZ29yeSA9IHJlZignYWxsJyk7CiAgICBjb25zdCBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2hhcmVEaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGRlbGV0ZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZG9jdW1lbnRDcmVhdGVUeXBlID0gcmVmKCdibGFuaycpOwogICAgY29uc3Qgc2VsZWN0ZWREb2N1bWVudCA9IHJlZihudWxsKTsKICAgIGNvbnN0IHNlbGVjdGVkVXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgYXZhaWxhYmxlVXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgY3JlYXRlTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzaGFyZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZGVsZXRlTG9hZGluZyA9IHJlZihmYWxzZSk7CgogICAgLy8g5re75Yqg5YiG5Lqr55u45YWz5Y+Y6YePCiAgICBjb25zdCBzaGFyZU1ldGhvZCA9IHJlZigncGVybWlzc2lvbicpOyAvLyDliIbkuqvmlrnlvI/vvJpwZXJtaXNzaW9uKOaOiOadgykg5oiWIGNoYXQo5Y+R6YCB5Yiw6IGK5aSpKQogICAgY29uc3Qgc2hhcmVGb3JtYXQgPSByZWYoJ3BkZicpOyAvLyDliIbkuqvmlofmoaPmoLzlvI/vvJpwZGYg5oiWIHdvcmQKICAgIGNvbnN0IHNlbGVjdGVkQ2hhdFVzZXJzID0gcmVmKFtdKTsgLy8g6YCJ5oup55qE6IGK5aSp55So5oi3CgogICAgLy8g5YiG6aG155u45YWz54q25oCBCiAgICBjb25zdCBwYWdlID0gcmVmKDEpOwogICAgY29uc3QgcGFnZVNpemUgPSAxMTsgLy8g5q+P6aG15pi+56S6MTHkuKrmlofmoaPvvIzliqDkuIoi5paw5bu6IuWNoeeJh+WFsTEy5LiqCiAgICBjb25zdCB0b3RhbENvdW50ID0gcmVmKDApOwogICAgY29uc3QgZ3JhbmRUb3RhbENvdW50ID0gcmVmKDApOyAvLyDnlKjkuo7lrZjlgqjnnJ/lrp7nmoTmlofmoaPmgLvmlbAKICAgIC8vIOa3u+WKoOWKoOi9veabtOWkmuebuOWFs+eKtuaAgQogICAgY29uc3QgaGFzTW9yZSA9IHJlZih0cnVlKTsKICAgIGNvbnN0IGxvYWRpbmdNb3JlID0gcmVmKGZhbHNlKTsKCiAgICAvLyDmt7vliqDnvJbovpHmlofmoaPnm7jlhbPnirbmgIEKICAgIGNvbnN0IGVkaXREaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGVkaXREb2N1bWVudEZvcm0gPSByZWYoewogICAgICBpZDogbnVsbCwKICAgICAgdGl0bGU6ICcnLAogICAgICB0eXBlOiAnJywKICAgICAgY2F0ZWdvcnlfaWQ6IG51bGwKICAgIH0pOwogICAgY29uc3QgZWRpdExvYWRpbmcgPSByZWYoZmFsc2UpOwoKICAgIC8vIOihqOWNleaVsOaNrgogICAgY29uc3QgbmV3RG9jdW1lbnRGb3JtID0gcmVmKHsKICAgICAgdGl0bGU6ICcnLAogICAgICB0eXBlOiAnJwogICAgfSk7CiAgICBjb25zdCBhaURvY3VtZW50Rm9ybSA9IHJlZih7CiAgICAgIHRpdGxlOiAnJywKICAgICAgcmVxdWlyZW1lbnRzOiAnJwogICAgfSk7CgogICAgLy8g6KGo5Y2V5qCh6aqM6KeE5YiZCiAgICBjb25zdCBibGFua0Zvcm1SdWxlcyA9IHsKICAgICAgdGl0bGU6IFt7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+aho+agh+mimCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICBtaW46IDIsCiAgICAgICAgbWF4OiA1MCwKICAgICAgICBtZXNzYWdlOiAn6ZW/5bqm5ZyoIDIg5YiwIDUwIOS4quWtl+espicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dCiAgICB9OwogICAgY29uc3QgYWlGb3JtUnVsZXMgPSB7CiAgICAgIHRpdGxlOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmlofmoaPkuLvpopgnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgbWluOiAyLAogICAgICAgIG1heDogNTAsCiAgICAgICAgbWVzc2FnZTogJ+mVv+W6puWcqCAyIOWIsCA1MCDkuKrlrZfnrKYnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgcmVxdWlyZW1lbnRzOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmlofmoaPopoHmsYInLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgbWluOiAxMCwKICAgICAgICBtYXg6IDUwMCwKICAgICAgICBtZXNzYWdlOiAn6ZW/5bqm5ZyoIDEwIOWIsCA1MDAg5Liq5a2X56ymJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfV0KICAgIH07CgogICAgLy8g5re75Yqg57yW6L6R6KGo5Y2V6aqM6K+B6KeE5YiZCiAgICBjb25zdCBlZGl0Rm9ybVJ1bGVzID0gewogICAgICB0aXRsZTogW3sKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5paH5qGj5qCH6aKYJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwgewogICAgICAgIG1pbjogMiwKICAgICAgICBtYXg6IDUwLAogICAgICAgIG1lc3NhZ2U6ICfplb/luqblnKggMiDliLAgNTAg5Liq5a2X56ymJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfV0KICAgIH07CiAgICBjb25zdCBibGFua0Zvcm1SZWYgPSByZWYobnVsbCk7CiAgICBjb25zdCBhaUZvcm1SZWYgPSByZWYobnVsbCk7CiAgICBjb25zdCBlZGl0Rm9ybVJlZiA9IHJlZihudWxsKTsKCiAgICAvLyDorqHnrpflsZ7mgKcKICAgIGNvbnN0IHRvdGFsRG9jdW1lbnRzID0gY29tcHV0ZWQoKCkgPT4gewogICAgICByZXR1cm4gZ3JhbmRUb3RhbENvdW50LnZhbHVlOwogICAgfSk7CiAgICBjb25zdCByZWNlbnRFZGl0Q291bnQgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIHJldHVybiByZWNlbnREb2N1bWVudHMudmFsdWUubGVuZ3RoIHx8IDA7CiAgICB9KTsKCiAgICAvLyDliIbnsbvnrqHnkIbnm7jlhbPnirbmgIEKICAgIGNvbnN0IGNhdGVnb3J5RGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBlZGl0aW5nQ2F0ZWdvcnkgPSByZWYoewogICAgICBuYW1lOiAnJywKICAgICAgY29sb3I6ICcjNDA5RUZGJywKICAgICAgZGVzY3JpcHRpb246ICcnCiAgICB9KTsKICAgIGNvbnN0IGNhdGVnb3J5Rm9ybVJlZiA9IHJlZihudWxsKTsKICAgIGNvbnN0IGNhdGVnb3J5TG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBjYXRlZ29yeUZvcm1SdWxlcyA9IHsKICAgICAgbmFtZTogW3sKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl57G75Z6L5ZCN56ewJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwgewogICAgICAgIG1pbjogMiwKICAgICAgICBtYXg6IDIwLAogICAgICAgIG1lc3NhZ2U6ICfplb/luqblnKgy5YiwMjDkuKrlrZfnrKYnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgY29sb3I6IFt7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeminOiJsicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfV0KICAgIH07CgogICAgLy8g6L6F5Yqp5pa55rOV77ya5by65Yi25Yi35paw6KeG5Zu+CiAgICBjb25zdCBmb3JjZVVwZGF0ZSA9IGFzeW5jICgpID0+IHsKICAgICAgLy8g5Yib5bu65Li05pe25pWw5o2u77yM6Kem5Y+R5rex5bqm5ZON5bqU5byP5pu05pawCiAgICAgIGRvY3VtZW50cy52YWx1ZSA9IFsuLi5kb2N1bWVudHMudmFsdWVdOwogICAgICByZWNlbnREb2N1bWVudHMudmFsdWUgPSBbLi4ucmVjZW50RG9jdW1lbnRzLnZhbHVlXTsKICAgICAgc2hhcmVkRG9jdW1lbnRzLnZhbHVlID0gWy4uLnNoYXJlZERvY3VtZW50cy52YWx1ZV07CgogICAgICAvLyDkvb/nlKhWdWXlrp7kvovnmoQkZm9yY2VVcGRhdGXmlrnms5UKICAgICAgaWYgKHByb3h5ICYmIHByb3h5LiRmb3JjZVVwZGF0ZSkgewogICAgICAgIHByb3h5LiRmb3JjZVVwZGF0ZSgpOwogICAgICB9CgogICAgICAvLyDnrYnlvoVET03mm7TmlrAKICAgICAgYXdhaXQgbmV4dFRpY2soKTsKICAgIH07CgogICAgLy8g5pa55rOVCiAgICBjb25zdCBmZXRjaERvY3VtZW50cyA9IGFzeW5jIChmb3JjZVJlZnJlc2ggPSBmYWxzZSwgYXBwZW5kID0gZmFsc2UsIHRpbWVzdGFtcCA9IG51bGwpID0+IHsKICAgICAgaWYgKGZvcmNlUmVmcmVzaCkgewogICAgICAgIHBhZ2UudmFsdWUgPSAxOwogICAgICAgIGhhc01vcmUudmFsdWUgPSB0cnVlOwogICAgICB9CgogICAgICAvLyDlj6rmnInlnKjliqDovb3mm7TlpJrmqKHlvI/kuIvmiY3mo4Dmn6VoYXNNb3JlCiAgICAgIGlmIChhcHBlbmQgJiYgIWhhc01vcmUudmFsdWUgJiYgIWZvcmNlUmVmcmVzaCkgewogICAgICAgIGNvbnNvbGUubG9nKCfmsqHmnInmm7TlpJrmlofmoaPvvIzlj5bmtojojrflj5YnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCFhcHBlbmQpIHsKICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb2FkaW5nTW9yZS52YWx1ZSA9IHRydWU7CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICAvLyDmnoTlu7rov4fmu6TmnaHku7YKICAgICAgICBjb25zdCBmaWx0ZXJzID0ge307CgogICAgICAgIC8vIOa3u+WKoOWIhuexu+i/h+a7pAogICAgICAgIGlmIChzZWFyY2hDYXRlZ29yeS52YWx1ZSAmJiBzZWFyY2hDYXRlZ29yeS52YWx1ZSAhPT0gJ2FsbCcpIHsKICAgICAgICAgIGZpbHRlcnMuY2F0ZWdvcnkgPSBzZWFyY2hDYXRlZ29yeS52YWx1ZTsKICAgICAgICB9CgogICAgICAgIC8vIOa3u+WKoOaQnOe0ouafpeivogogICAgICAgIGlmIChzZWFyY2hRdWVyeS52YWx1ZSkgewogICAgICAgICAgZmlsdGVycy5zZWFyY2ggPSBzZWFyY2hRdWVyeS52YWx1ZTsKICAgICAgICB9CgogICAgICAgIC8vIEFQSeivt+axguWPguaVsCAtIOS9v+eUqOS4jkRSRuWFvOWuueeahHBhZ2Vfc2l6ZeWPguaVsOWQjQogICAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICAgIHBhZ2U6IHBhZ2UudmFsdWUsCiAgICAgICAgICBwYWdlX3NpemU6IHBhZ2VTaXplLAogICAgICAgICAgLy8g5bCGcGFnZVNpemXkvZzkuLpwYWdlX3NpemXlj4LmlbDkvKDpgJLvvIzkuI7lkI7nq69SRVNUIGZyYW1ld29ya+WPguaVsOS/neaMgeS4gOiHtAogICAgICAgICAgX3Q6IHRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvLyDmt7vliqDml7bpl7TmiLPvvIznoa7kv53kuI3kvb/nlKjnvJPlrZgKICAgICAgICB9OwoKICAgICAgICAvLyDlkIjlubbov4fmu6TmnaHku7YKICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgZmlsdGVycyk7CiAgICAgICAgY29uc29sZS5sb2coYOiOt+WPluaWh+aho+WIl+ihqO+8jOmhteeggTogJHtwYWdlLnZhbHVlfe+8jOWPguaVsDpgLCBwYXJhbXMpOwogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldERvY3VtZW50cyhwYXJhbXMpOwogICAgICAgIGNvbnNvbGUubG9nKCfmlofmoaPliJfooahBUEnlk43lupQ6JywgcmVzKTsKICAgICAgICBsZXQgbmV3RG9jdW1lbnRzID0gW107CiAgICAgICAgbGV0IGN1cnJlbnRWaWV3Q291bnQgPSAwOwoKICAgICAgICAvLyDlpITnkIbkuI3lkIzmoLzlvI/nmoTlk43lupQKICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhICYmIEFycmF5LmlzQXJyYXkocmVzLmRhdGEpKSB7CiAgICAgICAgICAvLyDmoIflh4bmoLzlvI/lk43lupQKICAgICAgICAgIG5ld0RvY3VtZW50cyA9IHJlcy5kYXRhOwogICAgICAgICAgY3VycmVudFZpZXdDb3VudCA9IHJlcy50b3RhbCB8fCByZXMuY291bnQgfHwgMDsKICAgICAgICB9IGVsc2UgaWYgKHJlcyAmJiByZXMucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHJlcy5yZXN1bHRzKSkgewogICAgICAgICAgLy8gRGphbmdvIFJFU1TmoLzlvI/lk43lupQKICAgICAgICAgIG5ld0RvY3VtZW50cyA9IHJlcy5yZXN1bHRzOwogICAgICAgICAgY3VycmVudFZpZXdDb3VudCA9IHJlcy5jb3VudCB8fCAwOwogICAgICAgIH0gZWxzZSBpZiAocmVzICYmIHJlcy5kYXRhICYmIHJlcy5kYXRhLnJlc3VsdHMgJiYgQXJyYXkuaXNBcnJheShyZXMuZGF0YS5yZXN1bHRzKSkgewogICAgICAgICAgLy8g5bWM5aWX5qC85byP5ZON5bqUCiAgICAgICAgICBuZXdEb2N1bWVudHMgPSByZXMuZGF0YS5yZXN1bHRzOwogICAgICAgICAgY3VycmVudFZpZXdDb3VudCA9IHJlcy5kYXRhLmNvdW50IHx8IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybignQVBJ6L+U5Zue55qE5paH5qGj5pWw5o2u5qC85byP5peg5pWIOicsIHJlcyk7CiAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIOabtOaWsOeUqOS6juWIhumhteeahOaAu+aVsAogICAgICAgIHRvdGFsQ291bnQudmFsdWUgPSBjdXJyZW50Vmlld0NvdW50OwoKICAgICAgICAvLyDku4XlvZPmsqHmnInnrZvpgInmnaHku7bml7bvvIzmiY3mm7TmlrAi5YWo6YOo5paH5qGjIueahOecn+WunuaAu+aVsAogICAgICAgIGlmICghZmlsdGVycy5jYXRlZ29yeSAmJiAhZmlsdGVycy5zZWFyY2gpIHsKICAgICAgICAgIGdyYW5kVG90YWxDb3VudC52YWx1ZSA9IGN1cnJlbnRWaWV3Q291bnQ7CiAgICAgICAgfQoKICAgICAgICAvLyDlpoLmnpzmmK/ov73liqDmqKHlvI8KICAgICAgICBpZiAoYXBwZW5kKSB7CiAgICAgICAgICAvLyDmo4Dmn6Xlubbpgb/lhY3mt7vliqDph43lpI3nmoTmlofmoaMKICAgICAgICAgIGNvbnN0IGV4aXN0aW5nSWRzID0gbmV3IFNldChkb2N1bWVudHMudmFsdWUubWFwKGRvYyA9PiBkb2MuaWQpKTsKICAgICAgICAgIGNvbnN0IHVuaXF1ZU5ld0RvY3MgPSBuZXdEb2N1bWVudHMuZmlsdGVyKGRvYyA9PiAhZXhpc3RpbmdJZHMuaGFzKGRvYy5pZCkpOwogICAgICAgICAgaWYgKHVuaXF1ZU5ld0RvY3MubGVuZ3RoID4gMCkgewogICAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbLi4uZG9jdW1lbnRzLnZhbHVlLCAuLi51bmlxdWVOZXdEb2NzXTsKICAgICAgICAgICAgY29uc29sZS5sb2coYOi/veWKoOS6hiAke3VuaXF1ZU5ld0RvY3MubGVuZ3RofSDkuKrmlrDmlofmoaPvvIzlvZPliY3lhbEgJHtkb2N1bWVudHMudmFsdWUubGVuZ3RofSDkuKpgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmsqHmnInmlrDnmoTmlofmoaPooqvov73liqAnKTsKICAgICAgICAgICAgLy8g5Y2z5L2/5rKh5pyJ5paw5paH5qGj77yM5Lmf5Y+v6IO95piv5Zug5Li65oiR5Lus5Zyo5LiN5ZCM55qE6aG156CB5LiK6I635Y+W5LqG6YeN5aSN5pWw5o2uCiAgICAgICAgICAgIGhhc01vcmUudmFsdWUgPSBuZXdEb2N1bWVudHMubGVuZ3RoID4gMDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g6Z2e6L+95Yqg5qih5byP77yM55u05o6l5pu/5o2iCiAgICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBuZXdEb2N1bWVudHM7CiAgICAgICAgICBjb25zb2xlLmxvZyhg6K6+572u5LqGICR7ZG9jdW1lbnRzLnZhbHVlLmxlbmd0aH0g5Liq5paH5qGjYCk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKGDlvZPliY3mlofmoaNJROWIl+ihqDogWyR7ZG9jdW1lbnRzLnZhbHVlLm1hcChkID0+IGQuaWQpLmpvaW4oJywgJyl9XWApOwoKICAgICAgICAvLyDorqHnrpfmgLvpobXmlbAKICAgICAgICBjb25zdCB0b3RhbFBhZ2VzID0gTWF0aC5jZWlsKGN1cnJlbnRWaWV3Q291bnQgLyBwYWdlU2l6ZSk7CiAgICAgICAgY29uc29sZS5sb2coYOWIhumhteeKtuaAgSAtIOW9k+WJjemhtTogJHtwYWdlLnZhbHVlfSwg5oC76aG15pWwOiAke3RvdGFsUGFnZXN9LCDmgLvmlofmoaPmlbA6ICR7Y3VycmVudFZpZXdDb3VudH1gKTsKCiAgICAgICAgLy8g5qOA5p+l5b2T5YmN6aG15piv5ZCm6LaF5Ye66IyD5Zu0CiAgICAgICAgaWYgKHBhZ2UudmFsdWUgPiB0b3RhbFBhZ2VzICYmIHRvdGFsUGFnZXMgPiAwICYmICFhcHBlbmQpIHsKICAgICAgICAgIGNvbnNvbGUud2Fybihg5b2T5YmN6aG1ICR7cGFnZS52YWx1ZX0g6LaF5Ye66IyD5Zu077yM6Ieq5Yqo5L+u5q2j5Li65pyA5ZCO5LiA6aG1ICR7dG90YWxQYWdlc31gKTsKCiAgICAgICAgICAvLyDkvb/nlKhzZXRUaW1lb3V06YG/5YWN6Kem5Y+Rd2F0Y2jkuovku7YKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBwYWdlLnZhbHVlID0gdG90YWxQYWdlczsKICAgICAgICAgIH0sIDApOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8g5pu05paw5piv5ZCm5pyJ5pu05aSa6aG15qCH5b+XCiAgICAgICAgaGFzTW9yZS52YWx1ZSA9IHBhZ2UudmFsdWUgPCB0b3RhbFBhZ2VzOwoKICAgICAgICAvLyDlpoLmnpzljLnphY3nmoTmlofmoaPlpKrlsJHvvIjmr5TlpoLkvY7kuo7kuIDlsY/vvInvvIzlubbkuJTmnInmm7TlpJrmlbDmja7vvIzoh6rliqjliqDovb3mm7TlpJoKICAgICAgICBpZiAoIWFwcGVuZCAmJiBkb2N1bWVudHMudmFsdWUubGVuZ3RoIDwgOCAmJiBoYXNNb3JlLnZhbHVlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5paH5qGj5pWw6YeP6L6D5bCR77yM6Ieq5Yqo5Yqg6L295LiL5LiA6aG1Jyk7CiAgICAgICAgICAvLyDlu7bov58xMDBtc+mBv+WFjeivt+axgui/h+S6jumikee5gQogICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpOwogICAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudHMoZmFsc2UsIHRydWUsIHRpbWVzdGFtcCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluaWh+aho+WIl+ihqOWksei0pScsIGVycm9yKTsKICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+iOt+WPluaWh+aho+WIl+ihqOWksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGlmICghYXBwZW5kKSB7CiAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvYWRpbmdNb3JlLnZhbHVlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgY29uc3QgZmV0Y2hSZWNlbnREb2N1bWVudHMgPSBhc3luYyAoZm9yY2VSZWZyZXNoID0gZmFsc2UsIHRpbWVzdGFtcCA9IG51bGwpID0+IHsKICAgICAgY29uc29sZS5sb2coJ+W8gOWni+iOt+WPluacgOi/keaWh+ahoy4uLicpOwogICAgICB0cnkgewogICAgICAgIC8vIOWHhuWkh+WPguaVsO+8jOWmguaenOW8uuWItuWIt+aWsOa3u+WKoOaXtumXtOaIswogICAgICAgIGNvbnN0IHBhcmFtcyA9IGZvcmNlUmVmcmVzaCA/IHsKICAgICAgICAgIF90OiB0aW1lc3RhbXAgfHwgbmV3IERhdGUoKS5nZXRUaW1lKCkKICAgICAgICB9IDoge307CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0UmVjZW50RG9jdW1lbnRzKHBhcmFtcyk7CiAgICAgICAgY29uc29sZS5sb2coJ+acgOi/keaWh+aho0FQSeWTjeW6lDonLCByZXMpOwogICAgICAgIGlmIChyZXMgJiYgcmVzLmRhdGEpIHsKICAgICAgICAgIC8vIOWujOWFqOabv+aNouaVsOe7hOiAjOS4jeaYr+S/ruaUueW8leeUqAogICAgICAgICAgcmVjZW50RG9jdW1lbnRzLnZhbHVlID0gQXJyYXkuaXNBcnJheShyZXMuZGF0YSkgPyBbLi4ucmVzLmRhdGFdIDogW107CiAgICAgICAgICBjb25zb2xlLmxvZyhg6K6+572u5pyA6L+R5paH5qGjOiAke3JlY2VudERvY3VtZW50cy52YWx1ZS5sZW5ndGh95p2h6K6w5b2VYCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybignQVBJ6L+U5Zue55qE5pyA6L+R5paH5qGj5pWw5o2u5peg5pWIOicsIHJlcyk7CiAgICAgICAgICByZWNlbnREb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5pyA6L+R5paH5qGj5aSx6LSlOicsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+iOt+WPluacgOi/keaWh+aho+Wksei0pScpOwogICAgICAgIHJlY2VudERvY3VtZW50cy52YWx1ZSA9IFtdOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZmV0Y2hTaGFyZWREb2N1bWVudHMgPSBhc3luYyAodGltZXN0YW1wID0gbnVsbCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0U2hhcmVkRG9jdW1lbnRzKHRpbWVzdGFtcCk7CiAgICAgICAgc2hhcmVkRG9jdW1lbnRzLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5blhbHkuqvmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfojrflj5blhbHkuqvmlofmoaPlpLHotKUnKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGZldGNoRG9jdW1lbnRDYXRlZ29yaWVzID0gYXN5bmMgKHRpbWVzdGFtcCA9IG51bGwsIHJldHJ5Q291bnQgPSAwKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vojrflj5bmlofmoaPliIbnsbsuLi4nKTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXREb2N1bWVudENhdGVnb3JpZXModGltZXN0YW1wKTsKICAgICAgICBjb25zb2xlLmxvZygn5paH5qGj5YiG57G7QVBJ5ZON5bqUOicsIHJlcyk7CiAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSkgewogICAgICAgICAgZG9jdW1lbnRDYXRlZ29yaWVzLnZhbHVlID0gcmVzLmRhdGE7CiAgICAgICAgICBjb25zb2xlLmxvZyhg6K6+572u5paH5qGj5YiG57G7OiAke2RvY3VtZW50Q2F0ZWdvcmllcy52YWx1ZS5sZW5ndGh95p2h6K6w5b2VLCDmlbDmja46YCwgZG9jdW1lbnRDYXRlZ29yaWVzLnZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdBUEnov5Tlm57nmoTmlofmoaPliIbnsbvmlbDmja7ml6DmlYg6JywgcmVzKTsKICAgICAgICAgIGRvY3VtZW50Q2F0ZWdvcmllcy52YWx1ZSA9IFtdOwoKICAgICAgICAgIC8vIOWmguaenOi/lOWbnuepuuaVsOaNruS4lOacqui+vuWIsOacgOWkp+mHjeivleasoeaVsO+8jOWwneivlemHjeivlQogICAgICAgICAgaWYgKGRvY3VtZW50Q2F0ZWdvcmllcy52YWx1ZS5sZW5ndGggPT09IDAgJiYgcmV0cnlDb3VudCA8IDIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYOaWh+aho+WIhuexu+aVsOaNruS4uuepuu+8jCR7cmV0cnlDb3VudCArIDF956eS5ZCO6YeN6K+VLi4uYCk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZmV0Y2hEb2N1bWVudENhdGVnb3JpZXModGltZXN0YW1wLCByZXRyeUNvdW50ICsgMSksIChyZXRyeUNvdW50ICsgMSkgKiAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5paH5qGj5YiG57G75aSx6LSlOicsIGVycm9yKTsKCiAgICAgICAgLy8g5aaC5p6c5piv5pyN5Yqh5Zmo6ZSZ6K+v5LiU5pyq6L6+5Yiw5pyA5aSn6YeN6K+V5qyh5pWw77yM5bCd6K+V6YeN6K+VCiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA+PSA1MDAgJiYgcmV0cnlDb3VudCA8IDIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGDmnI3liqHlmajplJnor6/vvIwke3JldHJ5Q291bnQgKyAxfeenkuWQjumHjeivlS4uLmApOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBmZXRjaERvY3VtZW50Q2F0ZWdvcmllcyh0aW1lc3RhbXAsIHJldHJ5Q291bnQgKyAxKSwgKHJldHJ5Q291bnQgKyAxKSAqIDEwMDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+iOt+WPluaWh+aho+WIhuexu+Wksei0pe+8jOivt+WIt+aWsOmhtemdoumHjeivlScpOwogICAgICAgICAgLy8g5Yid5aeL5YyW56m65pWw57uECiAgICAgICAgICBkb2N1bWVudENhdGVnb3JpZXMudmFsdWUgPSBbXTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8g55uR5ZCs5pCc57Si5p+l6K+i5Y+Y5YyW77yM5a6e546w5a6e5pe25pCc57SiCiAgICB3YXRjaChzZWFyY2hRdWVyeSwgXy5kZWJvdW5jZShhc3luYyAoKSA9PiB7CiAgICAgIC8vIOmHjee9ruWIhumhtQogICAgICBwYWdlLnZhbHVlID0gMTsKICAgICAgaGFzTW9yZS52YWx1ZSA9IHRydWU7CgogICAgICAvLyDmuIXnqbrnjrDmnInmlofmoaPliJfooajvvIzmmL7npLrliqDovb3nirbmgIEKICAgICAgZG9jdW1lbnRzLnZhbHVlID0gW107CiAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIC8vIOiOt+WPluaWsOeahOaQnOe0oue7k+aenAogICAgICAgIGF3YWl0IGZldGNoRG9jdW1lbnRzKHRydWUpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aQnOe0ouWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmkJzntKLmlofmoaPlpLHotKXvvIzor7fph43or5UnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH0sIDMwMCkpOwogICAgY29uc3QgY3JlYXRlTmV3RG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIC8vIOmHjee9ruihqOWNlQogICAgICBuZXdEb2N1bWVudEZvcm0udmFsdWUgPSB7CiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIHR5cGU6ICcnCiAgICAgIH07CiAgICAgIGFpRG9jdW1lbnRGb3JtLnZhbHVlID0gewogICAgICAgIHRpdGxlOiAnJywKICAgICAgICByZXF1aXJlbWVudHM6ICcnCiAgICAgIH07CiAgICAgIGRvY3VtZW50Q3JlYXRlVHlwZS52YWx1ZSA9ICdibGFuayc7CiAgICAgIG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CgogICAgICAvLyDnm5HlkKzlr7nor53moYblhbPpl63kuovku7bvvIzmuIXnkIbooajljZUKICAgICAgbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWwtZGlhbG9nJyk7CiAgICAgICAgICBpZiAoZGlhbG9nKSB7CiAgICAgICAgICAgIGRpYWxvZy5hZGRFdmVudExpc3RlbmVyKCdjbG9zZWQnLCAoKSA9PiB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmIChibGFua0Zvcm1SZWYudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgYmxhbmtGb3JtUmVmLnZhbHVlLmNsZWFyVmFsaWRhdGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChhaUZvcm1SZWYudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgYWlGb3JtUmVmLnZhbHVlLmNsZWFyVmFsaWRhdGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIGZvcm0gdmFsaWRhdGlvbjonLCBlcnIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIG9uY2U6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHVwIGRpYWxvZyBldmVudCBsaXN0ZW5lcjonLCBlcnIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3Qgc3VibWl0TmV3RG9jdW1lbnQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmIChkb2N1bWVudENyZWF0ZVR5cGUudmFsdWUgPT09ICdibGFuaycpIHsKICAgICAgICBpZiAoIWJsYW5rRm9ybVJlZi52YWx1ZSkgewogICAgICAgICAgY29uc29sZS53YXJuKCfooajljZXlvJXnlKjkuI3lrZjlnKgnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgYmxhbmtGb3JtUmVmLnZhbHVlLnZhbGlkYXRlKCkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign6KGo5Y2V6aqM6K+B5aSx6LSlOicsIGVycik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vliJvlu7rmlofmoaM6JywgewogICAgICAgICAgICAgICAgdGl0bGU6IG5ld0RvY3VtZW50Rm9ybS52YWx1ZS50aXRsZSwKICAgICAgICAgICAgICAgIHR5cGU6IG5ld0RvY3VtZW50Rm9ybS52YWx1ZS50eXBlIHx8ICfpgJrnlKgnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjcmVhdGVEb2N1bWVudCh7CiAgICAgICAgICAgICAgICB0aXRsZTogbmV3RG9jdW1lbnRGb3JtLnZhbHVlLnRpdGxlLAogICAgICAgICAgICAgICAgdHlwZTogbmV3RG9jdW1lbnRGb3JtLnZhbHVlLnR5cGUgfHwgJ+mAmueUqCcsCiAgICAgICAgICAgICAgICBjb250ZW50OiAnJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfliJvlu7rmlofmoaPlk43lupTmlbDmja7vvJonLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZSkpOwoKICAgICAgICAgICAgICAvLyDlhbPpl63lr7nor53moYYKICAgICAgICAgICAgICBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5qGj5Yib5bu65oiQ5YqfJyk7CgogICAgICAgICAgICAgIC8vIOino+aekOi/lOWbnueahOaWh+aho0lECiAgICAgICAgICAgICAgbGV0IGRvY0lkID0gbnVsbDsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuaWQpIHsKICAgICAgICAgICAgICAgICAgZG9jSWQgPSByZXNwb25zZS5kYXRhLmlkOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEpICYmIHJlc3BvbnNlLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICBkb2NJZCA9IHJlc3BvbnNlLmRhdGFbMF0uaWQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEucmVzdWx0cykgJiYgcmVzcG9uc2UuZGF0YS5yZXN1bHRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgZG9jSWQgPSByZXNwb25zZS5kYXRhLnJlc3VsdHNbMF0uaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyDnrYnlvoXlr7nor53moYblhbPpl63lrozmiJDlkI7lho3miafooYzot7PovazvvIzpgb/lhY1ET03plJnor68KICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChkb2NJZCkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg5YeG5aSH6Lez6L2s5Yiw5paH5qGj6K+m5oOF6aG177yMSUQ6ICR7ZG9jSWR9YCk7CgogICAgICAgICAgICAgICAgICAvLyDlhYjliLfmlrDmlofmoaPliJfooajvvIznoa7kv53mlbDmja7mmK/mnIDmlrDnmoQKICAgICAgICAgICAgICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgICAgICAgZmV0Y2hSZWNlbnREb2N1bWVudHMoKTsKCiAgICAgICAgICAgICAgICAgIC8vIOeEtuWQjuWGjeaJp+ihjOWvvOiIqgogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnU21hcnREb2NEZXRhaWwnLAogICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkb2NJZAogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfot6/nlLHlr7zoiKrlpLHotKU6JywgZXJyKTsKICAgICAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign6Lez6L2s5paH5qGj6K+m5oOF6aG15aSx6LSl77yM6K+35omL5Yqo5Yi35paw6aG16Z2iJyk7CiAgICAgICAgICAgICAgICAgICAgICAvLyDlsJ3or5Xot6/lvoTot7PovawKICAgICAgICAgICAgICAgICAgICAgIHJvdXRlci5wdXNoKGAvc21hcnRkb2MvJHtkb2NJZH1gKS5jYXRjaChuYXZFcnIgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfot6/lvoTlr7zoiKrkuZ/lpLHotKU6JywgbmF2RXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfot6/lvoTot7Povazor6bmg4XpobXkuZ/lpLHotKUnKTsKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfliJvlu7rmlofmoaPmiJDlip/vvIzkvYbov5Tlm57nmoTmlbDmja7moLzlvI/kuI3mraPnoa4nLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgIC8vIOWIt+aWsOaWh+aho+WIl+ihqAogICAgICAgICAgICAgICAgICBmZXRjaERvY3VtZW50cygpOwogICAgICAgICAgICAgICAgICBmZXRjaFJlY2VudERvY3VtZW50cygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign5Yib5bu65paH5qGj5aSx6LSlJywgZXJyb3IpOwogICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yib5bu65paH5qGj5aSx6LSlJyk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aPkOS6pOihqOWNleaXtuWPkeeUn+mUmeivrzonLCBlcnJvcik7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+ihqOWNleaPkOS6pOWksei0pScpOwogICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkb2N1bWVudENyZWF0ZVR5cGUudmFsdWUgPT09ICdhaScpIHsKICAgICAgICBpZiAoIWFpRm9ybVJlZi52YWx1ZSkgewogICAgICAgICAgY29uc29sZS53YXJuKCdBSeihqOWNleW8leeUqOS4jeWtmOWcqCcpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCBhaUZvcm1SZWYudmFsdWUudmFsaWRhdGUoKS5jYXRjaChlcnIgPT4gewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBSeihqOWNlemqjOivgeWksei0pTonLCBlcnIpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAvLyDosIPnlKhBSeeUn+aIkOaWh+aho0FQSQogICAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5SWQgPSBzZWFyY2hDYXRlZ29yeS52YWx1ZSAhPT0gJ2FsbCcgPyBzZWFyY2hDYXRlZ29yeS52YWx1ZSA6IG51bGw7CiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhaUdlbmVyYXRlRG9jdW1lbnQoewogICAgICAgICAgICAgICAgdGl0bGU6IGFpRG9jdW1lbnRGb3JtLnZhbHVlLnRpdGxlLAogICAgICAgICAgICAgICAgcmVxdWlyZW1lbnQ6IGFpRG9jdW1lbnRGb3JtLnZhbHVlLnJlcXVpcmVtZW50cywKICAgICAgICAgICAgICAgIGNhdGVnb3J5X2lkOiBjYXRlZ29yeUlkLAogICAgICAgICAgICAgICAgZG9jX3R5cGU6ICdBSScKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQUnnlJ/miJDmlofmoaPlk43lupTmlbDmja7vvJonLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgLy8g5qOA5p+l6LaF5pe2CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgICB2YXIgX3Jlc3BvbnNlJGRhdGE7CiAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoKChfcmVzcG9uc2UkZGF0YSA9IHJlc3BvbnNlLmRhdGEpID09PSBudWxsIHx8IF9yZXNwb25zZSRkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcmVzcG9uc2UkZGF0YS5kZXRhaWwpIHx8ICdBSeeUn+aIkOi2heaXtu+8jOivt+eugOWMlumcgOaxguaIlueojeWQjumHjeivlScpOwogICAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGF0YSAmJiB0eXBlb2YgcmVzcG9uc2UuZGF0YS5kZXRhaWwgPT09ICdzdHJpbmcnICYmIHJlc3BvbnNlLmRhdGEuZGV0YWlsLmluY2x1ZGVzKCfotoXml7YnKSkgewogICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEuZGV0YWlsKTsKICAgICAgICAgICAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbmV3RG9jdW1lbnREaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ0FJ55Sf5oiQ5paH5qGj5oiQ5YqfJyk7CiAgICAgICAgICAgICAgbGV0IGRvY0lkID0gbnVsbDsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmlkKSB7CiAgICAgICAgICAgICAgICBkb2NJZCA9IHJlc3BvbnNlLmRhdGEuaWQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChkb2NJZCkgewogICAgICAgICAgICAgICAgLy8g6Lez6L2s5YmN5omT5Y2w5pel5b+XCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5YeG5aSH6Lez6L2s5Yiw5paH5qGj6K+m5oOF6aG177yM6Lev55Sx5ZCNOiBTbWFydERvY0RldGFpbCwgaWQ6JywgZG9jSWQpOwogICAgICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICBuYW1lOiAnU21hcnREb2NEZXRhaWwnLAogICAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICBpZDogU3RyaW5nKGRvY0lkKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign6Lev55Sx5a+86Iiq5aSx6LSlOicsIGVycik7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign6Lez6L2s5paH5qGj6K+m5oOF6aG15aSx6LSl77yM6K+35omL5Yqo5Yi35paw6aG16Z2iJyk7CiAgICAgICAgICAgICAgICAgIC8vIOWwneivlei3r+W+hOi3s+i9rAogICAgICAgICAgICAgICAgICByb3V0ZXIucHVzaChgL3NtYXJ0ZG9jLyR7ZG9jSWR9YCkuY2F0Y2gobmF2RXJyID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfot6/lvoTlr7zoiKrkuZ/lpLHotKU6JywgbmF2RXJyKTsKICAgICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+i3r+W+hOi3s+i9rOivpuaDhemhteS5n+Wksei0pScpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAvLyDlvILmraXliLfmlrDmlbDmja4KICAgICAgICAgICAgICAgIGZldGNoRG9jdW1lbnRzKCk7CiAgICAgICAgICAgICAgICBmZXRjaFJlY2VudERvY3VtZW50cygpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBmZXRjaERvY3VtZW50cygpOwogICAgICAgICAgICAgICAgZmV0Y2hSZWNlbnREb2N1bWVudHMoKTsKICAgICAgICAgICAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQUnnlJ/miJDmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCdBSeeUn+aIkOaWh+aho+Wksei0pScpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfmj5DkuqRBSeihqOWNleaXtuWPkeeUn+mUmeivrzonLCBlcnJvcik7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+ihqOWNleaPkOS6pOWksei0pScpOwogICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIGNvbnN0IG9wZW5Eb2N1bWVudCA9IGRvYyA9PiB7CiAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnU21hcnREb2NEZXRhaWwnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgaWQ6IGRvYy5pZAogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgZWRpdERvY3VtZW50ID0gKGRvYywgZXZlbnQpID0+IHsKICAgICAgLy8g6Zi75q2i5LqL5Lu25YaS5rOh77yM6Ziy5q2i6Kem5Y+R5Y2h54mH54K55Ye75LqL5Lu2CiAgICAgIGlmIChldmVudCkgewogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9CgogICAgICAvLyDnoa7kv53liIbnsbtJROaYr+aVsOWtl+exu+WeiwogICAgICBsZXQgY2F0ZWdvcnlJZCA9IG51bGw7CiAgICAgIGlmIChkb2MuY2F0ZWdvcnkgJiYgZG9jLmNhdGVnb3J5LmlkKSB7CiAgICAgICAgY2F0ZWdvcnlJZCA9IE51bWJlcihkb2MuY2F0ZWdvcnkuaWQpOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCfnvJbovpHmlofmoaM6JywgZG9jLmlkLCAn5b2T5YmN5YiG57G7OicsIGNhdGVnb3J5SWQpOwoKICAgICAgLy8g6K6+572u6KGo5Y2V5pWw5o2uCiAgICAgIGVkaXREb2N1bWVudEZvcm0udmFsdWUgPSB7CiAgICAgICAgaWQ6IGRvYy5pZCwKICAgICAgICB0aXRsZTogZG9jLnRpdGxlLAogICAgICAgIHR5cGU6IGRvYy50eXBlIHx8ICcnLAogICAgICAgIGNhdGVnb3J5X2lkOiBjYXRlZ29yeUlkCiAgICAgIH07CgogICAgICAvLyDmmL7npLrnvJbovpHlr7nor53moYYKICAgICAgZWRpdERpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKCiAgICAvLyDmj5DkuqTnvJbovpHmlofmoaMKICAgIGNvbnN0IHN1Ym1pdEVkaXREb2N1bWVudCA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFlZGl0Rm9ybVJlZi52YWx1ZSkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgZWRpdEZvcm1SZWYudmFsdWUudmFsaWRhdGUoKTsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGVkaXRMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKCiAgICAgICAgICAvLyDlh4blpIfmm7TmlrDnmoTmlbDmja4KICAgICAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7CiAgICAgICAgICAgIHRpdGxlOiBlZGl0RG9jdW1lbnRGb3JtLnZhbHVlLnRpdGxlLAogICAgICAgICAgICB0eXBlOiBlZGl0RG9jdW1lbnRGb3JtLnZhbHVlLnR5cGUgfHwgJ+mAmueUqCcsCiAgICAgICAgICAgIGNhdGVnb3J5X2lkOiBlZGl0RG9jdW1lbnRGb3JtLnZhbHVlLmNhdGVnb3J5X2lkCiAgICAgICAgICB9OwoKICAgICAgICAgIC8vIOiwg+eUqEFQSeabtOaWsOaWh+ahowogICAgICAgICAgYXdhaXQgdXBkYXRlRG9jdW1lbnQoZWRpdERvY3VtZW50Rm9ybS52YWx1ZS5pZCwgdXBkYXRlRGF0YSk7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5qGj5pu05paw5oiQ5YqfJyk7CiAgICAgICAgICBlZGl0RGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgIC8vIOW8uuWItuWIt+aWsOaJgOacieaVsOaNruS7peehruS/neinhuWbvuWQjOatpQogICAgICAgICAgYXdhaXQgcmVsb2FkQWxsRGF0YSgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfmm7TmlrDmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmm7TmlrDmlofmoaPlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBlZGl0TG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZXhwb3J0RG9jdW1lbnQgPSBkb2MgPT4gewogICAgICBFbE1lc3NhZ2VCb3goewogICAgICAgIHRpdGxlOiAn5a+85Ye65paH5qGjJywKICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oup5a+85Ye65qC85byPJywKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn5a+85Ye65Li6UERGJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5a+85Ye65Li6V29yZCcsCiAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IHRydWUsCiAgICAgICAgY2FsbGJhY2s6IGFjdGlvbiA9PiB7CiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpIHsKICAgICAgICAgICAgZXhwb3J0VG9QZGYoZG9jKTsKICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnY2FuY2VsJykgewogICAgICAgICAgICBleHBvcnRUb1dvcmQoZG9jKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICAvLyDlr7zlh7rkuLpQREYKICAgIGNvbnN0IGV4cG9ydFRvUGRmID0gYXN5bmMgZG9jID0+IHsKICAgICAgaWYgKCFkb2MpIHsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+ayoeacieWPr+WvvOWHuueahOaWh+ahoycpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g5YWI6I635Y+W5paH5qGj6K+m5oOF5YaF5a65CiAgICAgIGNvbnN0IGxvYWRpbmcgPSBFbExvYWRpbmcuc2VydmljZSh7CiAgICAgICAgbG9jazogdHJ1ZSwKICAgICAgICB0ZXh0OiAn5q2j5Zyo5Yqg6L295paH5qGj5YaF5a65Li4uJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpJwogICAgICB9KTsKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5bmlofmoaPor6bmg4UKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50RGV0YWlsKGRvYy5pZCk7CiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZW50ID0gcmVzcG9uc2UuZGF0YS5jb250ZW50OwogICAgICAgIGlmICghZG9jdW1lbnRDb250ZW50KSB7CiAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aWh+aho+WGheWuueS4uuepuu+8jOaXoOazleWvvOWHuicpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCBkb2NUaXRsZSA9IGRvYy50aXRsZSB8fCAn5pyq5ZG95ZCN5paH5qGjJzsKICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGAke2RvY1RpdGxlfS5wZGZgOwoKICAgICAgICAvLyDliJvlu7rkuLTml7blrrnlmajnlKjkuo7lr7zlh7oKICAgICAgICBjb25zdCB0ZW1wQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgdGVtcENvbnRhaW5lci5pbm5lckhUTUwgPSBkb2N1bWVudENvbnRlbnQ7CiAgICAgICAgdGVtcENvbnRhaW5lci5jbGFzc05hbWUgPSAndGVtcC1leHBvcnQtY29udGFpbmVyJzsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIpOwogICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7CiAgICAgICAgICBtYXJnaW46IFsxNSwgMTUsIDE1LCAxNV0sCiAgICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWUsCiAgICAgICAgICBpbWFnZTogewogICAgICAgICAgICB0eXBlOiAnanBlZycsCiAgICAgICAgICAgIHF1YWxpdHk6IDAuOTgKICAgICAgICAgIH0sCiAgICAgICAgICBodG1sMmNhbnZhczogewogICAgICAgICAgICBzY2FsZTogMiwKICAgICAgICAgICAgdXNlQ09SUzogdHJ1ZQogICAgICAgICAgfSwKICAgICAgICAgIGpzUERGOiB7CiAgICAgICAgICAgIHVuaXQ6ICdtbScsCiAgICAgICAgICAgIGZvcm1hdDogJ2E0JywKICAgICAgICAgICAgb3JpZW50YXRpb246ICdwb3J0cmFpdCcKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICAvLyDmm7TmlrDliqDovb3mj5DnpLoKICAgICAgICBsb2FkaW5nLnNldFRleHQoJ+ato+WcqOeUn+aIkFBERi4uLicpOwoKICAgICAgICAvLyDliqjmgIHlr7zlhaVodG1sMnBkZi5qcwogICAgICAgIGNvbnN0IGh0bWwycGRmTW9kdWxlID0gYXdhaXQgaW1wb3J0KCdodG1sMnBkZi5qcycpOwogICAgICAgIGNvbnN0IGh0bWwycGRmID0gaHRtbDJwZGZNb2R1bGUuZGVmYXVsdDsKICAgICAgICBhd2FpdCBodG1sMnBkZigpLmZyb20odGVtcENvbnRhaW5lcikuc2V0KG9wdGlvbnMpLnNhdmUoKTsKCiAgICAgICAgLy8g5riF55CG5Li05pe25YWD57SgCiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZW1wQ29udGFpbmVyKTsKICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ1BERuWvvOWHuuaIkOWKnycpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BERuWvvOWHuuWksei0pTonLCBlcnJvcik7CiAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcignUERG5a+85Ye65aSx6LSlOiAnICsgKGVycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivrycpKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDlr7zlh7rkuLpXb3Jk77yI5L+d55WZ5Zu+54mH77yJCiAgICBjb25zdCBleHBvcnRUb1dvcmQgPSBhc3luYyBkb2MgPT4gewogICAgICBpZiAoIWRvYykgewogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5rKh5pyJ5Y+v5a+85Ye655qE5paH5qGjJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGxvYWRpbmcgPSBFbExvYWRpbmcuc2VydmljZSh7CiAgICAgICAgbG9jazogdHJ1ZSwKICAgICAgICB0ZXh0OiAn5q2j5Zyo5Yqg6L295paH5qGj5YaF5a65Li4uJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpJwogICAgICB9KTsKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5bmlofmoaPor6bmg4UKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50RGV0YWlsKGRvYy5pZCk7CiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZW50ID0gcmVzcG9uc2UuZGF0YS5jb250ZW50OwogICAgICAgIGlmICghZG9jdW1lbnRDb250ZW50KSB7CiAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aWh+aho+WGheWuueS4uuepuu+8jOaXoOazleWvvOWHuicpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCBkb2NUaXRsZSA9IGRvYy50aXRsZSB8fCAn5pyq5ZG95ZCN5paH5qGjJzsKICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGAke2RvY1RpdGxlfS5kb2NgOwoKICAgICAgICAvLyDliJvlu7rkuIDkuKrkuLTml7bmlofmoaPlrrnlmajlpITnkIblhoXlrrkKICAgICAgICBjb25zdCBjb250ZW50Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgY29udGVudENvbnRhaW5lci5pbm5lckhUTUwgPSBkb2N1bWVudENvbnRlbnQ7CgogICAgICAgIC8vIOabtOaWsOWKoOi9veaPkOekugogICAgICAgIGxvYWRpbmcuc2V0VGV4dCgn5q2j5Zyo55Sf5oiQV29yZOaWh+ahoy4uLicpOwoKICAgICAgICAvLyDliJvlu7rlvq7ova9Xb3Jk5YW85a6555qESFRNTOaWh+ahowogICAgICAgIGNvbnN0IG1zV29yZEh0bWwgPSBgCiAgICAgICAgICA8aHRtbCB4bWxuczpvPSJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTpvZmZpY2UiIAogICAgICAgICAgICAgICAgeG1sbnM6dz0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6d29yZCIgCiAgICAgICAgICAgICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MCI+CiAgICAgICAgICA8aGVhZD4KICAgICAgICAgICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogICAgICAgICAgICA8dGl0bGU+JHtkb2NUaXRsZX08L3RpdGxlPgogICAgICAgICAgICA8c3R5bGU+CiAgICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OiBTaW1TdW4sIEFyaWFsLCBzYW5zLXNlcmlmOyBtYXJnaW46IDFjbTsgfQogICAgICAgICAgICAgIGltZyB7IG1heC13aWR0aDogMTAwJTsgaGVpZ2h0OiBhdXRvOyB9CiAgICAgICAgICAgICAgcCB7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgfQogICAgICAgICAgICAgIGgxIHsgZm9udC1zaXplOiAxOHB0OyB9CiAgICAgICAgICAgICAgaDIgeyBmb250LXNpemU6IDE2cHQ7IH0KICAgICAgICAgICAgICBoMyB7IGZvbnQtc2l6ZTogMTRwdDsgfQogICAgICAgICAgICAgIHRhYmxlIHsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgd2lkdGg6IDEwMCU7IH0KICAgICAgICAgICAgICB0ZCwgdGggeyBib3JkZXI6IDFweCBzb2xpZCAjMDAwOyBwYWRkaW5nOiA1cHg7IH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAgIDwvaGVhZD4KICAgICAgICAgIDxib2R5PgogICAgICAgICAgICA8aDE+JHtkb2NUaXRsZX08L2gxPgogICAgICAgICAgICAke2NvbnRlbnRDb250YWluZXIuaW5uZXJIVE1MfQogICAgICAgICAgPC9ib2R5PgogICAgICAgICAgPC9odG1sPgogICAgICAgIGA7CgogICAgICAgIC8vIOS9v+eUqGZpbGUtc2F2ZXLkv53lrZjmlofku7YKICAgICAgICBjb25zdCBGaWxlU2F2ZXIgPSBhd2FpdCBpbXBvcnQoJ2ZpbGUtc2F2ZXInKTsKICAgICAgICBjb25zdCBzYXZlQXMgPSBGaWxlU2F2ZXIuc2F2ZUFzIHx8IEZpbGVTYXZlci5kZWZhdWx0OwogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbbXNXb3JkSHRtbF0sIHsKICAgICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9tc3dvcmQnCiAgICAgICAgfSk7CiAgICAgICAgc2F2ZUFzKGJsb2IsIGZpbGVuYW1lKTsKICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ1dvcmTmlofmoaPlr7zlh7rmiJDlip8nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdXb3Jk5a+85Ye65aSx6LSlOicsIGVycm9yKTsKICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKGBXb3Jk5a+85Ye65aSx6LSlOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivryd9YCk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBzaGFyZURvY3VtZW50ID0gYXN5bmMgZG9jID0+IHsKICAgICAgc2VsZWN0ZWREb2N1bWVudC52YWx1ZSA9IGRvYzsKCiAgICAgIC8vIOaYvuekuuWKoOi9veeKtuaAgQogICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIC8vIOS7jkFQSeiOt+WPluWFrOWPuOaJgOacieeUqOaItwogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVzZXJBcGkuZ2V0Q29tcGFueVVzZXJzKCk7CiAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzICYmIEFycmF5LmlzQXJyYXkocmVzdWx0LmRhdGEpKSB7CiAgICAgICAgICAvLyDojrflj5blvZPliY3nlKjmiLdJRAogICAgICAgICAgY29uc3QgY3VycmVudFVzZXJKc29uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKTsKICAgICAgICAgIGxldCBjdXJyZW50VXNlcklkID0gbnVsbDsKICAgICAgICAgIGlmIChjdXJyZW50VXNlckpzb24pIHsKICAgICAgICAgICAgY29uc3QgY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKGN1cnJlbnRVc2VySnNvbik7CiAgICAgICAgICAgIGN1cnJlbnRVc2VySWQgPSBjdXJyZW50VXNlci5pZDsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyDov4fmu6TmjonlvZPliY3nlKjmiLfvvIzlj6rmmL7npLrlhbbku5bnlKjmiLcKICAgICAgICAgIGF2YWlsYWJsZVVzZXJzLnZhbHVlID0gcmVzdWx0LmRhdGEuZmlsdGVyKHVzZXIgPT4gdXNlci5pZCAhPT0gY3VycmVudFVzZXJJZCkubWFwKHVzZXIgPT4gKHsKICAgICAgICAgICAgaWQ6IHVzZXIuaWQsCiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLm5hbWUgfHwgdXNlci51c2VybmFtZSB8fCB1c2VyLmVtYWlsIHx8IGDnlKjmiLcke3VzZXIuaWR9YAogICAgICAgICAgfSkpOwogICAgICAgICAgY29uc29sZS5sb2coJ+WPr+WIhuS6q+eUqOaIt+WIl+ihqDonLCBhdmFpbGFibGVVc2Vycy52YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfojrflj5bnlKjmiLfliJfooajlpLHotKU6ICcgKyAocmVzdWx0Lm1lc3NhZ2UgfHwgJ+acquefpemUmeivrycpKTsKICAgICAgICAgIGF2YWlsYWJsZVVzZXJzLnZhbHVlID0gW107CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPlueUqOaIt+WIl+ihqOWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+iOt+WPlueUqOaIt+WIl+ihqOWksei0pe+8jOivt+mHjeivlScpOwogICAgICAgIGF2YWlsYWJsZVVzZXJzLnZhbHVlID0gW107CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgLy8g6ZqQ6JeP5Yqg6L2954q25oCBCiAgICAgICAgc2hhcmVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CgogICAgICAgIC8vIOmHjee9ruWIhuS6q+ebuOWFs+WPmOmHjwogICAgICAgIHNoYXJlTWV0aG9kLnZhbHVlID0gJ3Blcm1pc3Npb24nOwogICAgICAgIHNoYXJlRm9ybWF0LnZhbHVlID0gJ3BkZic7CiAgICAgICAgc2VsZWN0ZWRVc2Vycy52YWx1ZSA9IFtdOwogICAgICAgIHNlbGVjdGVkQ2hhdFVzZXJzLnZhbHVlID0gW107CgogICAgICAgIC8vIOaYvuekuuWvueivneahhgogICAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBjb25maXJtU2hhcmUgPSBhc3luYyAoKSA9PiB7CiAgICAgIC8vIOadg+mZkOWIhuS6q+aWueW8jwogICAgICBpZiAoc2hhcmVNZXRob2QudmFsdWUgPT09ICdwZXJtaXNzaW9uJykgewogICAgICAgIGlmICghc2VsZWN0ZWREb2N1bWVudC52YWx1ZSB8fCBzZWxlY3RlZFVzZXJzLnZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+ivt+mAieaLqeiHs+WwkeS4gOS4queUqOaItycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCBhcGlTaGFyZURvY3VtZW50KHNlbGVjdGVkRG9jdW1lbnQudmFsdWUuaWQsIHNlbGVjdGVkVXNlcnMudmFsdWUpOwogICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+WIhuS6q+aIkOWKnycpOwogICAgICAgICAgc2hhcmVEaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuS6q+aWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5YiG5Lqr5paH5qGj5aSx6LSlJyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIHNoYXJlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyDogYrlpKnliIbkuqvmlrnlvI8KICAgICAgZWxzZSBpZiAoc2hhcmVNZXRob2QudmFsdWUgPT09ICdjaGF0JykgewogICAgICAgIGlmICghc2VsZWN0ZWREb2N1bWVudC52YWx1ZSB8fCBzZWxlY3RlZENoYXRVc2Vycy52YWx1ZS5sZW5ndGggPT09IDApIHsKICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfor7fpgInmi6noh7PlsJHkuIDkuKrmjqXmlLbnlKjmiLcnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgc2hhcmVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICB0cnkgewogICAgICAgICAgLy8g6I635Y+W5b2T5YmN55So5oi35L+h5oGvCiAgICAgICAgICBjb25zdCBjdXJyZW50VXNlckpzb24gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpOwogICAgICAgICAgbGV0IGN1cnJlbnRVc2VySWQgPSBudWxsOwogICAgICAgICAgaWYgKGN1cnJlbnRVc2VySnNvbikgewogICAgICAgICAgICBjb25zdCBjdXJyZW50VXNlciA9IEpTT04ucGFyc2UoY3VycmVudFVzZXJKc29uKTsKICAgICAgICAgICAgY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VyLmlkOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCFjdXJyZW50VXNlcklkKSB7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5rOV6I635Y+W5b2T5YmN55So5oi35L+h5oGvJyk7CiAgICAgICAgICAgIHNoYXJlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgLy8g6ZyA6KaB6I635Y+W5paH5qGj5YaF5a65CiAgICAgICAgICBjb25zdCBkb2NSZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50RGV0YWlsKHNlbGVjdGVkRG9jdW1lbnQudmFsdWUuaWQpOwogICAgICAgICAgY29uc3QgY3VycmVudERvYyA9IGRvY1Jlc3BvbnNlLmRhdGE7CiAgICAgICAgICBpZiAoIWN1cnJlbnREb2MgfHwgIWN1cnJlbnREb2MuY29udGVudCkgewogICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aXoOazleiOt+WPluaWh+aho+WGheWuuScpOwogICAgICAgICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIOS9v+eUqOWJjeerr+WvvOWHuuaWh+S7tueahOaWueW8j+iOt+WPluaWh+S7tgogICAgICAgICAgY29uc3QgbG9hZGluZyA9IEVsTG9hZGluZy5zZXJ2aWNlKHsKICAgICAgICAgICAgbG9jazogdHJ1ZSwKICAgICAgICAgICAgdGV4dDogYOato+WcqOWHhuWkhyR7c2hhcmVGb3JtYXQudmFsdWUgPT09ICdwZGYnID8gJ1BERicgOiAnV29yZCd95paH5Lu2Li4uYCwKICAgICAgICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC43KScKICAgICAgICAgIH0pOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8g5YeG5aSH5paH5qGj5YaF5a65CiAgICAgICAgICAgIGNvbnN0IGRvY1RpdGxlID0gY3VycmVudERvYy50aXRsZSB8fCAn5pyq5ZG95ZCN5paH5qGjJzsKICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZW50ID0gY3VycmVudERvYy5jb250ZW50OwoKICAgICAgICAgICAgLy8g5Yib5bu65Li05pe25a655Zmo55So5LqO5a+85Ye6CiAgICAgICAgICAgIGNvbnN0IHRlbXBDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgdGVtcENvbnRhaW5lci5pbm5lckhUTUwgPSBkb2N1bWVudENvbnRlbnQ7CiAgICAgICAgICAgIHRlbXBDb250YWluZXIuY2xhc3NOYW1lID0gJ3RlbXAtZXhwb3J0LWNvbnRhaW5lcic7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGVtcENvbnRhaW5lcik7CiAgICAgICAgICAgIGxldCBkb2N1bWVudEZpbGUgPSBudWxsOwogICAgICAgICAgICBsZXQgZmlsZU5hbWUgPSBkb2NUaXRsZTsKICAgICAgICAgICAgbGV0IGZpbGVUeXBlID0gJyc7CiAgICAgICAgICAgIGlmIChzaGFyZUZvcm1hdC52YWx1ZSA9PT0gJ3BkZicpIHsKICAgICAgICAgICAgICBmaWxlTmFtZSArPSAnLnBkZic7CiAgICAgICAgICAgICAgZmlsZVR5cGUgPSAnYXBwbGljYXRpb24vcGRmJzsKICAgICAgICAgICAgICBsb2FkaW5nLnNldFRleHQoJ+ato+WcqOeUn+aIkFBERuaWh+S7ti4uLicpOwoKICAgICAgICAgICAgICAvLyDliqjmgIHlr7zlhaVodG1sMnBkZi5qcwogICAgICAgICAgICAgIGNvbnN0IGh0bWwycGRmTW9kdWxlID0gYXdhaXQgaW1wb3J0KCdodG1sMnBkZi5qcycpOwogICAgICAgICAgICAgIGNvbnN0IGh0bWwycGRmID0gaHRtbDJwZGZNb2R1bGUuZGVmYXVsdDsKICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICAgICAgICAgbWFyZ2luOiBbMTUsIDE1LCAxNSwgMTVdLAogICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGVOYW1lLAogICAgICAgICAgICAgICAgaW1hZ2U6IHsKICAgICAgICAgICAgICAgICAgdHlwZTogJ2pwZWcnLAogICAgICAgICAgICAgICAgICBxdWFsaXR5OiAwLjk4CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgaHRtbDJjYW52YXM6IHsKICAgICAgICAgICAgICAgICAgc2NhbGU6IDIsCiAgICAgICAgICAgICAgICAgIHVzZUNPUlM6IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBqc1BERjogewogICAgICAgICAgICAgICAgICB1bml0OiAnbW0nLAogICAgICAgICAgICAgICAgICBmb3JtYXQ6ICdhNCcsCiAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uOiAncG9ydHJhaXQnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgLy8g55Sf5oiQUERG5bm26I635Y+WQmxvYgogICAgICAgICAgICAgIGRvY3VtZW50RmlsZSA9IGF3YWl0IGh0bWwycGRmKCkuZnJvbSh0ZW1wQ29udGFpbmVyKS5zZXQob3B0aW9ucykub3V0cHV0UGRmKCdibG9iJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZmlsZU5hbWUgKz0gJy5kb2MnOwogICAgICAgICAgICAgIGZpbGVUeXBlID0gJ2FwcGxpY2F0aW9uL21zd29yZCc7CiAgICAgICAgICAgICAgbG9hZGluZy5zZXRUZXh0KCfmraPlnKjnlJ/miJBXb3Jk5paH5Lu2Li4uJyk7CgogICAgICAgICAgICAgIC8vIOWIm+W7uuW+rui9r1dvcmTlhbzlrrnnmoRIVE1M5paH5qGjCiAgICAgICAgICAgICAgY29uc3QgbXNXb3JkSHRtbCA9IGAKICAgICAgICAgICAgICAgIDxodG1sIHhtbG5zOm89InVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgCiAgICAgICAgICAgICAgICAgICAgICB4bWxuczp3PSJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTp3b3JkIiAKICAgICAgICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwIj4KICAgICAgICAgICAgICAgIDxoZWFkPgogICAgICAgICAgICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgICAgICAgICAgIDx0aXRsZT4ke2RvY1RpdGxlfTwvdGl0bGU+CiAgICAgICAgICAgICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgICAgICAgICBib2R5IHsgZm9udC1mYW1pbHk6IFNpbVN1biwgQXJpYWwsIHNhbnMtc2VyaWY7IG1hcmdpbjogMWNtOyB9CiAgICAgICAgICAgICAgICAgICAgaW1nIHsgbWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IGF1dG87IH0KICAgICAgICAgICAgICAgICAgICBwIHsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyB9CiAgICAgICAgICAgICAgICAgICAgaDEgeyBmb250LXNpemU6IDE4cHQ7IH0KICAgICAgICAgICAgICAgICAgICBoMiB7IGZvbnQtc2l6ZTogMTZwdDsgfQogICAgICAgICAgICAgICAgICAgIGgzIHsgZm9udC1zaXplOiAxNHB0OyB9CiAgICAgICAgICAgICAgICAgICAgdGFibGUgeyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyB3aWR0aDogMTAwJTsgfQogICAgICAgICAgICAgICAgICAgIHRkLCB0aCB7IGJvcmRlcjogMXB4IHNvbGlkICMwMDA7IHBhZGRpbmc6IDVweDsgfQogICAgICAgICAgICAgICAgICA8L3N0eWxlPgogICAgICAgICAgICAgICAgPC9oZWFkPgogICAgICAgICAgICAgICAgPGJvZHk+CiAgICAgICAgICAgICAgICAgIDxoMT4ke2RvY1RpdGxlfTwvaDE+CiAgICAgICAgICAgICAgICAgICR7dGVtcENvbnRhaW5lci5pbm5lckhUTUx9CiAgICAgICAgICAgICAgICA8L2JvZHk+CiAgICAgICAgICAgICAgICA8L2h0bWw+CiAgICAgICAgICAgICAgYDsKCiAgICAgICAgICAgICAgLy8g5Yib5bu6QmxvYgogICAgICAgICAgICAgIGRvY3VtZW50RmlsZSA9IG5ldyBCbG9iKFttc1dvcmRIdG1sXSwgewogICAgICAgICAgICAgICAgdHlwZTogZmlsZVR5cGUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5riF55CG5Li05pe25YWD57SgCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGVtcENvbnRhaW5lcik7CgogICAgICAgICAgICAvLyDlhYjojrflj5bmiYDmnInogYrlpKnkvJror53liJfooajvvIzlj6rojrflj5bkuIDmrKEKICAgICAgICAgICAgbG9hZGluZy5zZXRUZXh0KCfmraPlnKjmn6Xmib7ogYrlpKnkvJror50uLi4nKTsKICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbnNSZXNwb25zZSA9IGF3YWl0IGdldENoYXRTZXNzaW9ucygpOwogICAgICAgICAgICBsZXQgY2hhdFNlc3Npb25zID0gW107CgogICAgICAgICAgICAvLyDlpITnkIbkuI3lkIzmoLzlvI/nmoRBUEnov5Tlm57nu5PmnpwKICAgICAgICAgICAgaWYgKHNlc3Npb25zUmVzcG9uc2UgJiYgc2Vzc2lvbnNSZXNwb25zZS5kYXRhICYmIEFycmF5LmlzQXJyYXkoc2Vzc2lvbnNSZXNwb25zZS5kYXRhKSkgewogICAgICAgICAgICAgIGNoYXRTZXNzaW9ucyA9IHNlc3Npb25zUmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZXNzaW9uc1Jlc3BvbnNlICYmIHNlc3Npb25zUmVzcG9uc2UucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHNlc3Npb25zUmVzcG9uc2UucmVzdWx0cykpIHsKICAgICAgICAgICAgICBjaGF0U2Vzc2lvbnMgPSBzZXNzaW9uc1Jlc3BvbnNlLnJlc3VsdHM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2coYOiOt+WPluWIsCAke2NoYXRTZXNzaW9ucy5sZW5ndGh9IOS4quS8muivnWApOwogICAgICAgICAgICBsb2FkaW5nLnNldFRleHQoJ+ato+WcqOWHhuWkh+WPkemAgS4uLicpOwoKICAgICAgICAgICAgLy8g5Li65q+P5Liq55So5oi35YeG5aSH5Lya6K+dSUTvvIzkvb/nlKhNYXDlrZjlgqh1c2VySWQgLT4gY2hhdElk55qE5pig5bCECiAgICAgICAgICAgIGNvbnN0IHVzZXJTZXNzaW9uTWFwID0gbmV3IE1hcCgpOwoKICAgICAgICAgICAgLy8g5YWI5om56YeP5p+l5om+546w5pyJ5Lya6K+d77yM5YeP5bCR6YeN5aSN5qOA5p+lCiAgICAgICAgICAgIGZvciAoY29uc3QgdXNlcklkIG9mIHNlbGVjdGVkQ2hhdFVzZXJzLnZhbHVlKSB7CiAgICAgICAgICAgICAgLy8g5p+l5om+5piv5ZCm5pyJ5LiO6K+l55So5oi355qE5Lya6K+dCiAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdTZXNzaW9uID0gY2hhdFNlc3Npb25zLmZpbmQoc2Vzc2lvbiA9PiBzZXNzaW9uLnBhcnRpY2lwYW50cy5sZW5ndGggPT09IDIgJiYgc2Vzc2lvbi5wYXJ0aWNpcGFudHMuc29tZShwID0+IHAuaWQgPT09IHVzZXJJZCkgJiYgc2Vzc2lvbi5wYXJ0aWNpcGFudHMuc29tZShwID0+IHAuaWQgPT09IGN1cnJlbnRVc2VySWQpKTsKICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdTZXNzaW9uKSB7CiAgICAgICAgICAgICAgICB1c2VyU2Vzc2lvbk1hcC5zZXQodXNlcklkLCBleGlzdGluZ1Nlc3Npb24uaWQpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOeUqOaItyR7dXNlcklkfeacieeOsOacieS8muivnTogJHtleGlzdGluZ1Nlc3Npb24uaWR9YCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDkuLrmsqHmnInkvJror53nmoTnlKjmiLfliJvlu7rmlrDkvJror50KICAgICAgICAgICAgY29uc3QgbmV3U2Vzc2lvblByb21pc2VzID0gW107CiAgICAgICAgICAgIGZvciAoY29uc3QgdXNlcklkIG9mIHNlbGVjdGVkQ2hhdFVzZXJzLnZhbHVlKSB7CiAgICAgICAgICAgICAgaWYgKCF1c2VyU2Vzc2lvbk1hcC5oYXModXNlcklkKSkgewogICAgICAgICAgICAgICAgbmV3U2Vzc2lvblByb21pc2VzLnB1c2goY3JlYXRlQ2hhdFNlc3Npb24oewogICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudF9pZHM6IFtjdXJyZW50VXNlcklkLCB1c2VySWRdLAogICAgICAgICAgICAgICAgICB0aXRsZTogJ+aWh+aho+WIhuS6qycKICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmlkKSB7CiAgICAgICAgICAgICAgICAgICAgdXNlclNlc3Npb25NYXAuc2V0KHVzZXJJZCwgcmVzcG9uc2UuZGF0YS5pZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOS4uueUqOaItyR7dXNlcklkfeWIm+W7uuaWsOS8muivnTogJHtyZXNwb25zZS5kYXRhLmlkfWApOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIm+W7uuiBiuWkqeS8muivneWksei0pTonLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihg5Li655So5oi3JHt1c2VySWR95Yib5bu65Lya6K+d5aSx6LSlOmAsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDnrYnlvoXmiYDmnInmlrDkvJror53liJvlu7rlrozmiJAKICAgICAgICAgICAgaWYgKG5ld1Nlc3Npb25Qcm9taXNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgbG9hZGluZy5zZXRUZXh0KGDmraPlnKjliJvlu7ogJHtuZXdTZXNzaW9uUHJvbWlzZXMubGVuZ3RofSDkuKrmlrDkvJror50uLi5gKTsKICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChuZXdTZXNzaW9uUHJvbWlzZXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDlh4blpIflj5HpgIHmlofku7YKICAgICAgICAgICAgbG9hZGluZy5zZXRUZXh0KCfmraPlnKjlj5HpgIHmlofku7YuLi4nKTsKICAgICAgICAgICAgY29uc3Qgc2VuZFByb21pc2VzID0gW107CgogICAgICAgICAgICAvLyDpgY3ljobnlKjmiLflj5HpgIHmlofku7YKICAgICAgICAgICAgZm9yIChjb25zdCB1c2VySWQgb2Ygc2VsZWN0ZWRDaGF0VXNlcnMudmFsdWUpIHsKICAgICAgICAgICAgICBjb25zdCBjaGF0SWQgPSB1c2VyU2Vzc2lvbk1hcC5nZXQodXNlcklkKTsKICAgICAgICAgICAgICBpZiAoIWNoYXRJZCkgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihg5pyq6IO95om+5Yiw5oiW5Yib5bu655So5oi3JHt1c2VySWR955qE5Lya6K+dYCk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIOWIm+W7ukZvcm1EYXRh5a+56LGh77yM5re75Yqg5paH5Lu25ZKM55u45YWz5L+h5oGvCiAgICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NoYXQnLCBjaGF0SWQpOwogICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbWVzc2FnZV90eXBlJywgJ2ZpbGUnKTsKICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NvbnRlbnQnLCBg5YiG5Lqr5LqG5LiA5LiqJHtzaGFyZUZvcm1hdC52YWx1ZSA9PT0gJ3BkZicgPyAnUERGJyA6ICdXb3JkJ33mlofmoaM6ICR7ZG9jVGl0bGV9YCk7CgogICAgICAgICAgICAgIC8vIOWwhuaWh+S7tkJsb2LovazmjaLkuLpGaWxl5a+56LGhIC0g5Li65q+P5Liq55So5oi35Yib5bu65paw55qERmlsZeWvueixoQogICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBuZXcgRmlsZShbZG9jdW1lbnRGaWxlXSwgZmlsZU5hbWUsIHsKICAgICAgICAgICAgICAgIHR5cGU6IGZpbGVUeXBlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7CgogICAgICAgICAgICAgIC8vIOWPkemAgeaWh+S7tua2iOaBrwogICAgICAgICAgICAgIHNlbmRQcm9taXNlcy5wdXNoKHJlcXVlc3QoewogICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9jaGF0L21lc3NhZ2VzLycsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdGltZW91dDogMzAwMDAgLy8g5aKe5Yqg6LaF5pe25pe26Ze0CiAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICB1c2VySWQsCiAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihg5ZCR55So5oi3ICR7dXNlcklkfSDlj5HpgIHmlofmoaPlpLHotKU6YCwgZXJyb3IpOwogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgdXNlcklkLAogICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgZXJyb3IKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDnrYnlvoXmiYDmnInlj5HpgIHmk43kvZzlrozmiJAKICAgICAgICAgICAgY29uc3Qgc2VuZFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChzZW5kUHJvbWlzZXMpOwogICAgICAgICAgICBjb25zdCBzdWNjZXNzQ291bnQgPSBzZW5kUmVzdWx0cy5maWx0ZXIocmVzdWx0ID0+IHJlc3VsdC5zdWNjZXNzKS5sZW5ndGg7CiAgICAgICAgICAgIGlmIChzdWNjZXNzQ291bnQgPiAwKSB7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoYOaIkOWKn+WPkemAgeaWh+aho+WIsCAke3N1Y2Nlc3NDb3VudH0vJHtzZWxlY3RlZENoYXRVc2Vycy52YWx1ZS5sZW5ndGh9IOS4queUqOaIt+eahOiBiuWkqWApOwogICAgICAgICAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Y+R6YCB5paH5qGj5aSx6LSl77yM6K+36YeN6K+VJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+eUn+aIkOaWh+aho+aWh+S7tuWksei0pTonLCBlcnJvcik7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign55Sf5oiQ5paH5qGj5paH5Lu25aSx6LSlJyk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuS6q+aWh+aho+WIsOiBiuWkqeWksei0pTonLCBlcnJvcik7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIhuS6q+aWh+aho+WIsOiBiuWkqeWksei0pScpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBkZWxldGVEb2N1bWVudCA9IGRvYyA9PiB7CiAgICAgIHNlbGVjdGVkRG9jdW1lbnQudmFsdWUgPSBkb2M7CiAgICAgIGRlbGV0ZURpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKICAgIGNvbnN0IGNvbmZpcm1EZWxldGUgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghc2VsZWN0ZWREb2N1bWVudC52YWx1ZSkgcmV0dXJuOwogICAgICBkZWxldGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgX3NlbGVjdGVkRG9jdW1lbnQkdmFsOwogICAgICAgIC8vIOiusOW9leimgeWIoOmZpOeahOaWh+aho0lE5ZKM57G75YirCiAgICAgICAgY29uc3QgZGVsZXRlZERvY0lkID0gc2VsZWN0ZWREb2N1bWVudC52YWx1ZS5pZDsKICAgICAgICBjb25zdCBkZWxldGVkRG9jQ2F0ZWdvcnlJZCA9IChfc2VsZWN0ZWREb2N1bWVudCR2YWwgPSBzZWxlY3RlZERvY3VtZW50LnZhbHVlLmNhdGVnb3J5KSA9PT0gbnVsbCB8fCBfc2VsZWN0ZWREb2N1bWVudCR2YWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zZWxlY3RlZERvY3VtZW50JHZhbC5pZDsKCiAgICAgICAgLy8g5YWI5YWz6Zet5a+56K+d5qGG77yM5o+Q6auY55So5oi35L2T6aqMCiAgICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAvLyDmiafooYzliKDpmaTmk43kvZwKICAgICAgICBhd2FpdCBhcGlEZWxldGVEb2N1bWVudChkZWxldGVkRG9jSWQpOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPliKDpmaTmiJDlip8nKTsKCiAgICAgICAgLy8g5by65Yi25riF6Zmk6YCJ5Lit55qE5paH5qGjCiAgICAgICAgc2VsZWN0ZWREb2N1bWVudC52YWx1ZSA9IG51bGw7CgogICAgICAgIC8vIOa4hemZpOWPr+iDveeahOe8k+WtmOaVsOaNrgogICAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICAvLyDnp7vpmaTlj6/og73lrZjlnKjnmoTnm7jlhbPnvJPlrZgKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oYGRvY19jYWNoZV8ke2RlbGV0ZWREb2NJZH1gKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oYHJlY2VudF9kb2NzX2NhY2hlYCk7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGBkb2NfbGlzdF9jYWNoZWApOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfmuIXpmaTmnKzlnLDnvJPlrZjlpLHotKU6JywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyDmm7TmlrDliLfmlrDop6blj5HlmagKICAgICAgICByZWZyZXNoVHJpZ2dlci52YWx1ZSA9IERhdGUubm93KCk7CgogICAgICAgIC8vIOS9v+eUqOaWsOaVsOe7hOabv+aNouWOn+aVsOe7hO+8jOehruS/nVZ1ZeiDveajgOa1i+WIsOWPmOWMliAKICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBbLi4uZG9jdW1lbnRzLnZhbHVlLmZpbHRlcihkb2MgPT4gZG9jLmlkICE9PSBkZWxldGVkRG9jSWQpXTsKICAgICAgICByZWNlbnREb2N1bWVudHMudmFsdWUgPSBbLi4ucmVjZW50RG9jdW1lbnRzLnZhbHVlLmZpbHRlcihkb2MgPT4gZG9jLmlkICE9PSBkZWxldGVkRG9jSWQpXTsKICAgICAgICBzaGFyZWREb2N1bWVudHMudmFsdWUgPSBbLi4uc2hhcmVkRG9jdW1lbnRzLnZhbHVlLmZpbHRlcihkb2MgPT4gZG9jLmlkICE9PSBkZWxldGVkRG9jSWQpXTsKCiAgICAgICAgLy8g5by65Yi25pu05paw6KeG5Zu+CiAgICAgICAgYXdhaXQgZm9yY2VVcGRhdGUoKTsKCiAgICAgICAgLy8g5pu05paw5YiG57G75Lit55qE5paH5qGj6K6h5pWwCiAgICAgICAgaWYgKGRlbGV0ZWREb2NDYXRlZ29yeUlkKSB7CiAgICAgICAgICBjb25zdCBjYXRlZ29yeSA9IGRvY3VtZW50Q2F0ZWdvcmllcy52YWx1ZS5maW5kKGMgPT4gYy5pZCA9PT0gZGVsZXRlZERvY0NhdGVnb3J5SWQpOwogICAgICAgICAgaWYgKGNhdGVnb3J5ICYmIGNhdGVnb3J5LmRvY3VtZW50X2NvdW50ID4gMCkgewogICAgICAgICAgICBjYXRlZ29yeS5kb2N1bWVudF9jb3VudC0tOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g562J5b6FRE9N5pu05pawCiAgICAgICAgYXdhaXQgbmV4dFRpY2soKTsKCiAgICAgICAgLy8g6YeN5paw5a+86Iiq5Yiw5paH5qGj6aaW6aG177yM56Gu5L+d54q25oCB5YWo6YOo5Yi35pawCiAgICAgICAgaWYgKHJvdXRlci5jdXJyZW50Um91dGUudmFsdWUubmFtZSA9PT0gJ1NtYXJ0RG9jRGV0YWlsJykgewogICAgICAgICAgY29uc29sZS5sb2coJ+S7juivpuaDhemhteWIoOmZpOaWh+aho++8jOmHjeaWsOWvvOiIquWIsOaWh+aho+mmlumhtScpOwoKICAgICAgICAgIC8vIOWFiOW8uuWItuWIt+aWsOaVsOaNru+8jOehruS/neWvvOiIquWQjuaVsOaNruaYr+acgOaWsOeahAogICAgICAgICAgYXdhaXQgcmVsb2FkQWxsRGF0YSgpOwoKICAgICAgICAgIC8vIOS9v+eUqHJlcGxhY2XmqKHlvI/ot7PovazvvIzkuI3nlZnkuIvljoblj7LorrDlvZXvvIzlubbmt7vliqDlvLrliLbliLfmlrDlj4LmlbAKICAgICAgICAgIHJvdXRlci5yZXBsYWNlKHsKICAgICAgICAgICAgbmFtZTogJ1NtYXJ0RG9jJywKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICBfcmVmcmVzaDogRGF0ZS5ub3coKQogICAgICAgICAgICB9IC8vIOa3u+WKoOaXtumXtOaIs+WPguaVsOmYsuatoue8k+WtmAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOWmguaenOW3sue7j+WcqOaWh+aho+mmlumhte+8jOeri+WNs+mHjei9veaVsOaNruW5tuW8uuWItuWIt+aWsOmhtemdogogICAgICAgICAgYXdhaXQgcmVmcmVzaERhdGEoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yig6Zmk5paH5qGj5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yig6Zmk5paH5qGj5aSx6LSlJyk7CiAgICAgICAgLy8g5aaC5p6c5Yig6Zmk5aSx6LSl77yM5YWz6Zet5a+56K+d5qGGCiAgICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGRlbGV0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHZpZXdBbGxEb2N1bWVudHMgPSB0eXBlID0+IHsKICAgICAgaWYgKHR5cGUgPT09ICdyZWNlbnQnKSB7CiAgICAgICAgLy8g6Lev55Sx5Lit5rKh5pyJU21hcnREb2NMaXN077yM55u05o6l6Lez6L2s5Yiw5pm66IO95paH5qGj6aaW6aG15bm25rua5Yqo5Yiw5paH5qGj5YiX6KGoCiAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ1NtYXJ0RG9jJwogICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGRvY1NlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbicpOwogICAgICAgICAgICBpZiAoZG9jU2VjdGlvbikgewogICAgICAgICAgICAgIGRvY1NlY3Rpb24uc2Nyb2xsSW50b1ZpZXcoewogICAgICAgICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBzZWxlY3RDYXRlZ29yeSA9IGNhdGVnb3J5ID0+IHsKICAgICAgY29uc29sZS5sb2coJ+mAieaLqeWIhuexuzonLCBjYXRlZ29yeSk7CgogICAgICAvLyDlpITnkIbkuI3lkIznsbvlnovnmoRjYXRlZ29yeeWPguaVsAogICAgICBsZXQgY2F0ZWdvcnlJZDsKICAgICAgaWYgKGNhdGVnb3J5ID09PSAnYWxsJykgewogICAgICAgIGNhdGVnb3J5SWQgPSAnYWxsJzsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY2F0ZWdvcnkgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgY2F0ZWdvcnlJZCA9IGNhdGVnb3J5OwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYXRlZ29yeSA9PT0gJ29iamVjdCcgJiYgY2F0ZWdvcnkgIT09IG51bGwpIHsKICAgICAgICBjYXRlZ29yeUlkID0gY2F0ZWdvcnkuaWQudG9TdHJpbmcoKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygn5aSE55CG5ZCO55qE5YiG57G7SUQ6JywgY2F0ZWdvcnlJZCk7CgogICAgICAvLyDlpoLmnpzpgInmi6nnmoTliIbnsbvkuI7lvZPliY3liIbnsbvnm7jlkIzvvIzliJnkuI3lgZrku7vkvZXmk43kvZwKICAgICAgaWYgKGNhdGVnb3J5SWQgPT09IHNlYXJjaENhdGVnb3J5LnZhbHVlKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+WIhuexu+acquWPmOWMlu+8jOS4jemHjeaWsOWKoOi9vScpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g6K6+572u5paw55qE5YiG57G7CiAgICAgIHNlYXJjaENhdGVnb3J5LnZhbHVlID0gY2F0ZWdvcnlJZDsKCiAgICAgIC8vIOa3u+WKoOWKqOeUu+aViOaenAogICAgICBkb2N1bWVudHMudmFsdWUgPSBbXTsKICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IHRydWU7CgogICAgICAvLyDph43nva7liIbpobXlkozliqDovb3nirbmgIEKICAgICAgcGFnZS52YWx1ZSA9IDE7CiAgICAgIGhhc01vcmUudmFsdWUgPSB0cnVlOwoKICAgICAgLy8g5bu26L+f6I635Y+W77yM5a6e546w6L+H5rih5pWI5p6cCiAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICAvLyDlvLrliLbliLfmlrDmlofmoaPliJfooagKICAgICAgICAgIGF3YWl0IGZldGNoRG9jdW1lbnRzKHRydWUpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bmlofmoaPlpLHotKU6JywgZXJyb3IpOwogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfojrflj5bmlofmoaPliJfooajlpLHotKXvvIzor7fliLfmlrDpobXpnaLph43or5UnKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8g6Kem5Y+R5LiA5Liq566A5Y2V55qE5Yqo55S75pWI5p6c77yM56qB5Ye65pi+56S65bey562b6YCJ55qE5paH5qGjCiAgICAgICAgY29uc3QgZG9jQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZG9jLWNhcmQnKTsKICAgICAgICBpZiAoZG9jQ2FyZHMgJiYgZG9jQ2FyZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgZG9jQ2FyZHMuZm9yRWFjaCgoY2FyZCwgaW5kZXgpID0+IHsKICAgICAgICAgICAgaWYgKGNhcmQpIHsKICAgICAgICAgICAgICBjYXJkLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gYCR7aW5kZXggKiA1MH1tc2A7CiAgICAgICAgICAgICAgY2FyZC5jbGFzc0xpc3QucmVtb3ZlKCdmYWRlSW4nKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChjYXJkKSB7CiAgICAgICAgICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgnZmFkZUluJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgMTApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIDMwMCk7CiAgICB9OwoKICAgIC8vIOiOt+WPlumAieS4reWIhuexu+eahOminOiJsgogICAgY29uc3QgZ2V0U2VsZWN0ZWRDYXRlZ29yeUNvbG9yID0gKCkgPT4gewogICAgICBpZiAoc2VhcmNoQ2F0ZWdvcnkudmFsdWUgPT09ICdhbGwnKSByZXR1cm4gJyM0MDlFRkYnOwogICAgICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gZG9jdW1lbnRDYXRlZ29yaWVzLnZhbHVlLmZpbmQoYyA9PiBjLmlkLnRvU3RyaW5nKCkgPT09IHNlYXJjaENhdGVnb3J5LnZhbHVlKTsKICAgICAgcmV0dXJuIChzZWxlY3RlZENhdGVnb3J5ID09PSBudWxsIHx8IHNlbGVjdGVkQ2F0ZWdvcnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNlbGVjdGVkQ2F0ZWdvcnkuY29sb3IpIHx8ICcjNjdDMjNBJzsKICAgIH07CgogICAgLy8g6I635Y+W6YCJ5Lit5YiG57G755qE5ZCN56ewCiAgICBjb25zdCBnZXRTZWxlY3RlZENhdGVnb3J5TmFtZSA9ICgpID0+IHsKICAgICAgaWYgKHNlYXJjaENhdGVnb3J5LnZhbHVlID09PSAnYWxsJykgcmV0dXJuICflhajpg6jmlofmoaMnOwogICAgICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gZG9jdW1lbnRDYXRlZ29yaWVzLnZhbHVlLmZpbmQoYyA9PiBjLmlkLnRvU3RyaW5nKCkgPT09IHNlYXJjaENhdGVnb3J5LnZhbHVlKTsKICAgICAgcmV0dXJuIChzZWxlY3RlZENhdGVnb3J5ID09PSBudWxsIHx8IHNlbGVjdGVkQ2F0ZWdvcnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNlbGVjdGVkQ2F0ZWdvcnkubmFtZSkgfHwgJ+acquefpeWIhuexuyc7CiAgICB9OwogICAgY29uc3QgbWFuYWdlQ2F0ZWdvcmllcyA9ICgpID0+IHsKICAgICAgY2F0ZWdvcnlEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgICAgcmVzZXRDYXRlZ29yeUZvcm0oKTsKICAgIH07CiAgICBjb25zdCBlZGl0Q2F0ZWdvcnkgPSBjYXRlZ29yeSA9PiB7CiAgICAgIGVkaXRpbmdDYXRlZ29yeS52YWx1ZSA9IHsKICAgICAgICAuLi5jYXRlZ29yeQogICAgICB9OwogICAgfTsKICAgIGNvbnN0IHJlc2V0Q2F0ZWdvcnlGb3JtID0gKCkgPT4gewogICAgICBlZGl0aW5nQ2F0ZWdvcnkudmFsdWUgPSB7CiAgICAgICAgaWQ6ICcnLAogICAgICAgIG5hbWU6ICcnLAogICAgICAgIGNvbG9yOiAnIzQwOUVGRicsCiAgICAgICAgZGVzY3JpcHRpb246ICcnCiAgICAgIH07CiAgICAgIGlmIChjYXRlZ29yeUZvcm1SZWYudmFsdWUpIHsKICAgICAgICBjYXRlZ29yeUZvcm1SZWYudmFsdWUucmVzZXRGaWVsZHMoKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHN1Ym1pdENhdGVnb3J5ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWNhdGVnb3J5Rm9ybVJlZi52YWx1ZSkgcmV0dXJuOwogICAgICBhd2FpdCBjYXRlZ29yeUZvcm1SZWYudmFsdWUudmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgY2F0ZWdvcnlMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5RGF0YSA9IHsKICAgICAgICAgICAgICBuYW1lOiBlZGl0aW5nQ2F0ZWdvcnkudmFsdWUubmFtZSwKICAgICAgICAgICAgICBjb2xvcjogZWRpdGluZ0NhdGVnb3J5LnZhbHVlLmNvbG9yLAogICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlZGl0aW5nQ2F0ZWdvcnkudmFsdWUuZGVzY3JpcHRpb24gfHwgJycKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKGVkaXRpbmdDYXRlZ29yeS52YWx1ZS5pZCkgewogICAgICAgICAgICAgIC8vIOabtOaWsOWIhuexuwogICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZURvY3VtZW50Q2F0ZWdvcnkoZWRpdGluZ0NhdGVnb3J5LnZhbHVlLmlkLCBjYXRlZ29yeURhdGEpOwogICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfliIbnsbvmm7TmlrDmiJDlip8nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyDliJvlu7rliIbnsbsKICAgICAgICAgICAgICBhd2FpdCBjcmVhdGVEb2N1bWVudENhdGVnb3J5KGNhdGVnb3J5RGF0YSk7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+WIhuexu+WIm+W7uuaIkOWKnycpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDph43mlrDojrflj5bliIbnsbvliJfooagKICAgICAgICAgICAgZmV0Y2hEb2N1bWVudENhdGVnb3JpZXMoKTsKICAgICAgICAgICAgcmVzZXRDYXRlZ29yeUZvcm0oKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOWIhuexu+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5L+d5a2Y5YiG57G75aSx6LSlJyk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjYXRlZ29yeUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IGRlbGV0ZUNhdGVnb3J5ID0gY2F0ZWdvcnkgPT4gewogICAgICBpZiAoY2F0ZWdvcnkuZG9jdW1lbnRfY291bnQgPiAwKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+ivpeWIhuexu+S4i+acieaWh+aho++8jOaXoOazleWIoOmZpCcpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBFbE1lc3NhZ2VCb3guY29uZmlybShg56Gu5a6a6KaB5Yig6Zmk5YiG57G7IiR7Y2F0ZWdvcnkubmFtZX0i5ZCX77yfYCwgJ+WIoOmZpOWIhuexuycsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCBkZWxldGVEb2N1bWVudENhdGVnb3J5KGNhdGVnb3J5LmlkKTsKICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfliIbnsbvliKDpmaTmiJDlip8nKTsKICAgICAgICAgIGZldGNoRG9jdW1lbnRDYXRlZ29yaWVzKCk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOWIhuexu+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOWIhuexu+Wksei0pScpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfTsKICAgIGNvbnN0IGZvcm1hdERhdGUgPSBkYXRlU3RyaW5nID0+IHsKICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpOwogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwoKICAgICAgLy8g5ZCM5LiA5aSp5pi+56S65pe26Ze0CiAgICAgIGlmIChkYXRlLnRvRGF0ZVN0cmluZygpID09PSBub3cudG9EYXRlU3RyaW5nKCkpIHsKICAgICAgICByZXR1cm4gZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoJ3poLUNOJywgewogICAgICAgICAgaG91cjogJzItZGlnaXQnLAogICAgICAgICAgbWludXRlOiAnMi1kaWdpdCcKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8g5pio5aSpCiAgICAgIGNvbnN0IHllc3RlcmRheSA9IG5ldyBEYXRlKG5vdyk7CiAgICAgIHllc3RlcmRheS5zZXREYXRlKG5vdy5nZXREYXRlKCkgLSAxKTsKICAgICAgaWYgKGRhdGUudG9EYXRlU3RyaW5nKCkgPT09IHllc3RlcmRheS50b0RhdGVTdHJpbmcoKSkgewogICAgICAgIHJldHVybiAn5pio5aSpJzsKICAgICAgfQoKICAgICAgLy8g5LiA5ZGo5YaF5pi+56S65pif5pyfCiAgICAgIGNvbnN0IHdlZWtEYXlzID0gWyflkajml6UnLCAn5ZGo5LiAJywgJ+WRqOS6jCcsICflkajkuIknLCAn5ZGo5ZubJywgJ+WRqOS6lCcsICflkajlha0nXTsKICAgICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLnJvdW5kKChub3cgLSBkYXRlKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7CiAgICAgIGlmIChkaWZmRGF5cyA8IDcpIHsKICAgICAgICByZXR1cm4gd2Vla0RheXNbZGF0ZS5nZXREYXkoKV07CiAgICAgIH0KCiAgICAgIC8vIOWFtuS7luaDheWGteaYvuekuuaXpeacnwogICAgICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3poLUNOJywgewogICAgICAgIG1vbnRoOiAnbnVtZXJpYycsCiAgICAgICAgZGF5OiAnbnVtZXJpYycKICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgcmVzZXRDYXRlZ29yeUZpbHRlciA9ICgpID0+IHsKICAgICAgc2VhcmNoQ2F0ZWdvcnkudmFsdWUgPSAnYWxsJzsKICAgICAgcGFnZS52YWx1ZSA9IDE7CiAgICAgIGZldGNoRG9jdW1lbnRzKHRydWUpOwogICAgfTsKCiAgICAvLyDmt7vliqDpobXpnaLmv4DmtLvpkqnlrZDvvIznoa7kv53ku47lhbbku5bpobXpnaLov5Tlm57ml7bph43mlrDojrflj5bmlbDmja4KICAgIG9uQWN0aXZhdGVkKCgpID0+IHsKICAgICAgY29uc29sZS5sb2coJ1NtYXJ0RG9j57uE5Lu26KKr5r+A5rS777yM6YeN5paw6I635Y+W5pWw5o2uJyk7CiAgICAgIHJlbG9hZEFsbERhdGEoKTsKICAgIH0pOwoKICAgIC8vIOmhtemdoua/gOa0u+WQjumHjeaWsOWKoOi9veaJgOacieaVsOaNrueahOWHveaVsAogICAgY29uc3QgcmVsb2FkQWxsRGF0YSA9IGFzeW5jICgpID0+IHsKICAgICAgcGFnZS52YWx1ZSA9IDE7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc29sZS5sb2coJ+mHjeaWsOWKoOi9veaJgOacieaWh+aho+aVsOaNri4uLicpOwogICAgICAgIGNyZWF0ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwoKICAgICAgICAvLyDmt7vliqDml7bpl7TmiLPpmLLmraLnvJPlrZgKICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpOwoKICAgICAgICAvLyDmuIXpmaTmnKzlnLDnvJPlrZgKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHsKICAgICAgICAgICAgLy8g5riF6Zmk5paH5qGj55u45YWz55qE57yT5a2YCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdkb2NfbGlzdF9jYWNoZScpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncmVjZW50X2RvY3NfY2FjaGUnKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2RvY19jYXRlZ29yaWVzX2NhY2hlJyk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgY29uc29sZS5lcnJvcign5riF6Zmk57yT5a2Y5aSx6LSlOicsIGUpOwogICAgICAgIH0KCiAgICAgICAgLy8g5YWI6I635Y+W5YiG57G777yM5Zug5Li65pi+56S65paH5qGj5pe26ZyA6KaB5YiG57G75L+h5oGvCiAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudENhdGVnb3JpZXModGltZXN0YW1wKTsKCiAgICAgICAgLy8g54S25ZCO5bm26KGM6I635Y+W5YW25LuW5pWw5o2u77yM5L2G5LiN6ZyA6KaB5L+d5a2Y6L+U5Zue5YC8CiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW2ZldGNoRG9jdW1lbnRzKHRydWUsIGZhbHNlLCB0aW1lc3RhbXApLCBmZXRjaFJlY2VudERvY3VtZW50cyh0cnVlLCB0aW1lc3RhbXApLCBmZXRjaFNoYXJlZERvY3VtZW50cyh0aW1lc3RhbXApXSk7CiAgICAgICAgY29uc29sZS5sb2coJ+aVsOaNrumHjeaWsOWKoOi9veWujOaIkCcsIHsKICAgICAgICAgIOWIhuexu+aVsOmHjzogZG9jdW1lbnRDYXRlZ29yaWVzLnZhbHVlLmxlbmd0aCwKICAgICAgICAgIOaWh+aho+aVsOmHjzogZG9jdW1lbnRzLnZhbHVlLmxlbmd0aCwKICAgICAgICAgIOacgOi/keaWh+ahozogcmVjZW50RG9jdW1lbnRzLnZhbHVlLmxlbmd0aCwKICAgICAgICAgIOWFseS6q+aWh+ahozogc2hhcmVkRG9jdW1lbnRzLnZhbHVlLmxlbmd0aCwKICAgICAgICAgIOaAu+iuoeaVsDogdG90YWxDb3VudC52YWx1ZQogICAgICAgIH0pOwoKICAgICAgICAvLyDlvLrliLbmm7TmlrDop4blm74KICAgICAgICBhd2FpdCBmb3JjZVVwZGF0ZSgpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aVsOaNrumHjeaWsOWKoOi9veWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3mlbDmja7lpLHotKXvvIzor7fliLfmlrDpobXpnaInKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgLy8g5o+Q5L6b6YeN6L295Ye95pWw57uZ5a2Q57uE5Lu25oiW54i257uE5Lu25L2/55SoCiAgICBwcm92aWRlKCdyZWxvYWREb2N1bWVudHMnLCByZWxvYWRBbGxEYXRhKTsKCiAgICAvLyDnm5HlkKzot6/nlLHlj5jljJbvvIzlvLrliLbliLfmlrDmlbDmja4KICAgIHdhdGNoKCgpID0+IHJvdXRlLnF1ZXJ5Ll9yZWZyZXNoLCBuZXdWYWwgPT4gewogICAgICBpZiAobmV3VmFsKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+ajgOa1i+WIsOi3r+eUseWIt+aWsOWPguaVsDonLCBuZXdWYWwpOwogICAgICAgIHJlZnJlc2hUcmlnZ2VyLnZhbHVlID0gRGF0ZS5ub3coKTsKICAgICAgICByZWxvYWRBbGxEYXRhKCk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIOebkeWQrOi3r+eUseWPguaVsO+8jOWkhOeQhuS4jeWQjOaDheWGtQogICAgd2F0Y2goKCkgPT4gcm91dGUucGF0aCwgKG5ld1BhdGgsIG9sZFBhdGgpID0+IHsKICAgICAgY29uc29sZS5sb2coJ+i3r+eUseWPmOWMljonLCBvbGRQYXRoLCAnLT4nLCBuZXdQYXRoKTsKICAgICAgaWYgKG5ld1BhdGggPT09ICcvc21hcnRkb2MnICYmIG9sZFBhdGggJiYgb2xkUGF0aC5zdGFydHNXaXRoKCcvc21hcnRkb2MvJykpIHsKICAgICAgICAvLyDku47mlofmoaPor6bmg4XpobXov5Tlm57mlofmoaPliJfooajpobXvvIzlvLrliLbliLfmlrAKICAgICAgICBjb25zb2xlLmxvZygn5LuO6K+m5oOF6aG16L+U5Zue5YiX6KGo6aG177yM5by65Yi25Yi35paw5pWw5o2uJyk7CiAgICAgICAgcmVmcmVzaFRyaWdnZXIudmFsdWUgPSBEYXRlLm5vdygpOwogICAgICAgIHJlbG9hZEFsbERhdGEoKTsKICAgICAgfQogICAgfSk7CgogICAgLy8g5omL5Yqo5by65Yi25Yi35paw5pa55rOVCiAgICBjb25zdCByZWZyZXNoRGF0YSA9IGFzeW5jICgpID0+IHsKICAgICAgcGFnZS52YWx1ZSA9IDE7CiAgICAgIGF3YWl0IHJlbG9hZEFsbERhdGEoKTsKICAgICAgaWYgKHByb3h5ICYmIHByb3h5LiRmb3JjZVVwZGF0ZSkgewogICAgICAgIHByb3h5LiRmb3JjZVVwZGF0ZSgpOwogICAgICB9CiAgICB9OwoKICAgIC8vIOWkhOeQhuWIhumhteWPmOWMlueahOaWueazlSAtIOeugOWNleiusOW9leS6i+S7tgogICAgY29uc3Qgb25QYWdlQ2hhbmdlID0gbmV3UGFnZSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKGDliIbpobXngrnlh7vkuovku7YgLSDliIfmjaLliLDpobXpnaI6ICR7bmV3UGFnZX1gKTsKICAgIH07CgogICAgLy8g55uR5ZCs6aG156CB5Y+Y5YyW77yM5Yqg6L295a+55bqU6aG16Z2i5pWw5o2uCiAgICB3YXRjaCgoKSA9PiBwYWdlLnZhbHVlLCBhc3luYyAobmV3UGFnZSwgb2xkUGFnZSkgPT4gewogICAgICBjb25zb2xlLmxvZyhg6aG156CB5Y+Y5YyWOiAke29sZFBhZ2V9IC0+ICR7bmV3UGFnZX1gKTsKICAgICAgaWYgKG5ld1BhZ2UgPT09IG9sZFBhZ2UpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICAvLyDmmL7npLrliqDovb3nirbmgIEKICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKCiAgICAgICAgLy8g6YeN572uaGFzTW9yZeagh+W/l++8jOehruS/neWPr+S7peWKoOi9veaVsOaNrgogICAgICAgIGhhc01vcmUudmFsdWUgPSB0cnVlOwoKICAgICAgICAvLyDojrflj5bmlrDpobXpnaLmlbDmja4KICAgICAgICBhd2FpdCBmZXRjaERvY3VtZW50cyhmYWxzZSwgZmFsc2UsIERhdGUubm93KCkpOwoKICAgICAgICAvLyDmu5rliqjliLDliJfooajpobbpg6gKICAgICAgICBjb25zdCBkb2NTZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24nKTsKICAgICAgICBpZiAoZG9jU2VjdGlvbikgewogICAgICAgICAgZG9jU2VjdGlvbi5zY3JvbGxJbnRvVmlldyh7CiAgICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+mhteeggeWPmOWMluWKoOi9veWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3mlbDmja7lpLHotKXvvIzor7fph43or5UnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIOa3u+WKoOWKoOi9veabtOWkmuaWh+aho+eahOaWueazlQogICAgY29uc3QgbG9hZE1vcmVEb2N1bWVudHMgPSAoKSA9PiB7CiAgICAgIGlmIChsb2FkaW5nTW9yZS52YWx1ZSB8fCAhaGFzTW9yZS52YWx1ZSkgcmV0dXJuOwogICAgICBwYWdlLnZhbHVlKys7CiAgICAgIGZldGNoRG9jdW1lbnRzKGZhbHNlLCB0cnVlKTsKICAgIH07CgogICAgLy8g55Sf5ZG95ZGo5pyf6ZKp5a2QCiAgICBvbk1vdW50ZWQoKCkgPT4gewogICAgICBjb25zb2xlLmxvZygnU21hcnREb2Pnu4Tku7Ztb3VudGVk77yM5Yqg6L295pWw5o2uJyk7CgogICAgICAvLyDmo4Dmn6VVUkzkuK3mmK/lkKbmnIlfcmVmcmVzaOWPguaVsAogICAgICBjb25zdCByZWZyZXNoUGFyYW0gPSByb3V0ZS5xdWVyeS5fcmVmcmVzaDsKICAgICAgaWYgKHJlZnJlc2hQYXJhbSkgewogICAgICAgIGNvbnNvbGUubG9nKCfmo4DmtYvliLBVUkzkuK3nmoTliLfmlrDlj4LmlbA6JywgcmVmcmVzaFBhcmFtKTsKICAgICAgICAvLyDlvLrliLbliLfmlrDvvIznoa7kv53mlofmoaPliJfooajmmK/mnIDmlrDnmoQKICAgICAgICByZWZyZXNoVHJpZ2dlci52YWx1ZSA9IERhdGUubm93KCk7CiAgICAgICAgLy8g6K6+572u5LiA5Liq6LaF55+t5bu26L+f77yM56Gu5L+dRE9N5bey57uP5a6M5YWo5oyC6L29CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICByZWxvYWRBbGxEYXRhKCk7CiAgICAgICAgfSwgMTApOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOato+W4uOWKoOi9veaVsOaNrgogICAgICAgIHJlbG9hZEFsbERhdGEoKTsKICAgICAgfQogICAgfSk7CiAgICBjb25zdCBoYW5kbGVJbXBvcnRXb3JkID0gKCkgPT4gewogICAgICAvLyDliJvlu7rkuIDkuKrpmpDol4/nmoTmlofku7bkuIrkvKBpbnB1dAogICAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJzsKICAgICAgZmlsZUlucHV0LmFjY2VwdCA9ICcuZG9jeCwuZG9jJzsKICAgICAgZmlsZUlucHV0LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZmlsZUlucHV0KTsKCiAgICAgIC8vIOebkeWQrOaWh+S7tumAieaLqeS6i+S7tgogICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgYXN5bmMgZXZlbnQgPT4gewogICAgICAgIGlmIChldmVudC50YXJnZXQuZmlsZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKCiAgICAgICAgICAvLyDmmL7npLrliqDovb3kuK3vvIzkvb/nlKjlhajlsY/liqDovb3vvIznpoHmraLnlKjmiLfmk43kvZwKICAgICAgICAgIGNvbnN0IGxvYWRpbmdJbnN0YW5jZSA9IEVsTG9hZGluZy5zZXJ2aWNlKHsKICAgICAgICAgICAgZnVsbHNjcmVlbjogdHJ1ZSwKICAgICAgICAgICAgdGV4dDogJ+ato+WcqOWvvOWFpVdvcmTmlofmoaMuLi4nLAogICAgICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJywKICAgICAgICAgICAgbG9jazogdHJ1ZSAvLyDplIHlrprlsY/luZXvvIzpmLLmraLnlKjmiLfmk43kvZwKICAgICAgICAgIH0pOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8g5Yib5bu6Rm9ybURhdGHlr7nosaEKICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7CgogICAgICAgICAgICAvLyDlj5HpgIHor7fmsYLvvIzosIPnlKhBUEkKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbXBvcnRXb3JkRG9jdW1lbnQoZm9ybURhdGEpOwogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuaWQpIHsKICAgICAgICAgICAgICAvLyDlhYjliLfmlrDmlofmoaPpppbpobUKICAgICAgICAgICAgICBhd2FpdCByZWxvYWRBbGxEYXRhKCk7CgogICAgICAgICAgICAgIC8vIOaYvuekuuaIkOWKn+a2iOaBrwogICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCdXb3Jk5paH5qGj5a+85YWl5oiQ5YqfJyk7CgogICAgICAgICAgICAgIC8vIOW7tui/n+S4gOenkuWQjui3s+i9rO+8jOehruS/neeUqOaIt+eci+WIsOWIt+aWsOaViOaenOWSjOaIkOWKn+aPkOekugogICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgLy8g5a+85YWl5oiQ5Yqf5ZCO6Lez6L2s5Yiw5paH5qGj6K+m5oOF6aG1CiAgICAgICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIGlkOiByZXNwb25zZS5pZAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgICAgICAgIF9yZWZyZXNoOiBEYXRlLm5vdygpCiAgICAgICAgICAgICAgICAgIH0gLy8g5re75Yqg5Yi35paw5Y+C5pWw77yM56Gu5L+d6K+m5oOF6aG15Yi35pawCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WvvOWFpeWksei0pe+8micgKyAoKHJlc3BvbnNlID09PSBudWxsIHx8IHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXNwb25zZS5kZXRhaWwpIHx8ICfmnKrnn6XplJnor68nKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WvvOWFpVdvcmTmlofmoaPlh7rplJk6JywgZXJyb3IpOwogICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WvvOWFpVdvcmTmlofmoaPlpLHotKU6ICcgKyAoZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJykpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgLy8g56Gu5L+d5LiA5a6a5pe26Ze05ZCO5YWz6Zet5Yqg6L295o+Q56S677yM6Ziy5q2i55WM6Z2i5Y2h5q27CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIGxvYWRpbmdJbnN0YW5jZS5jbG9zZSgpOwogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZmlsZUlucHV0KTsKICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8g6Kem5Y+R5paH5Lu26YCJ5oup5a+56K+d5qGGCiAgICAgIGZpbGVJbnB1dC5jbGljaygpOwogICAgfTsKICAgIHJldHVybiB7CiAgICAgIGRvY3VtZW50cywKICAgICAgcmVjZW50RG9jdW1lbnRzLAogICAgICBzaGFyZWREb2N1bWVudHMsCiAgICAgIGRvY3VtZW50Q2F0ZWdvcmllcywKICAgICAgc2VhcmNoUXVlcnksCiAgICAgIHNlYXJjaENhdGVnb3J5LAogICAgICB0b3RhbERvY3VtZW50cywKICAgICAgcmVjZW50RWRpdENvdW50LAogICAgICBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUsCiAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZSwKICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZSwKICAgICAgZG9jdW1lbnRDcmVhdGVUeXBlLAogICAgICBuZXdEb2N1bWVudEZvcm0sCiAgICAgIGFpRG9jdW1lbnRGb3JtLAogICAgICBibGFua0Zvcm1SdWxlcywKICAgICAgYWlGb3JtUnVsZXMsCiAgICAgIGJsYW5rRm9ybVJlZiwKICAgICAgYWlGb3JtUmVmLAogICAgICBzZWxlY3RlZERvY3VtZW50LAogICAgICBzZWxlY3RlZFVzZXJzLAogICAgICBhdmFpbGFibGVVc2VycywKICAgICAgY3JlYXRlTG9hZGluZywKICAgICAgc2hhcmVMb2FkaW5nLAogICAgICBkZWxldGVMb2FkaW5nLAogICAgICBjcmVhdGVOZXdEb2N1bWVudCwKICAgICAgc3VibWl0TmV3RG9jdW1lbnQsCiAgICAgIG9wZW5Eb2N1bWVudCwKICAgICAgZWRpdERvY3VtZW50LAogICAgICBzdWJtaXRFZGl0RG9jdW1lbnQsCiAgICAgIGV4cG9ydERvY3VtZW50LAogICAgICBzaGFyZURvY3VtZW50LAogICAgICBjb25maXJtU2hhcmUsCiAgICAgIGRlbGV0ZURvY3VtZW50LAogICAgICBjb25maXJtRGVsZXRlLAogICAgICB2aWV3QWxsRG9jdW1lbnRzLAogICAgICBmb3JtYXREYXRlLAogICAgICBjYXRlZ29yeURpYWxvZ1Zpc2libGUsCiAgICAgIGVkaXRpbmdDYXRlZ29yeSwKICAgICAgY2F0ZWdvcnlGb3JtUmVmLAogICAgICBjYXRlZ29yeUxvYWRpbmcsCiAgICAgIGNhdGVnb3J5Rm9ybVJ1bGVzLAogICAgICBlZGl0Q2F0ZWdvcnksCiAgICAgIHJlc2V0Q2F0ZWdvcnlGb3JtLAogICAgICBzdWJtaXRDYXRlZ29yeSwKICAgICAgZGVsZXRlQ2F0ZWdvcnksCiAgICAgIHJlc2V0Q2F0ZWdvcnlGaWx0ZXIsCiAgICAgIHNlbGVjdENhdGVnb3J5LAogICAgICBnZXRTZWxlY3RlZENhdGVnb3J5Q29sb3IsCiAgICAgIGdldFNlbGVjdGVkQ2F0ZWdvcnlOYW1lLAogICAgICBtYW5hZ2VDYXRlZ29yaWVzLAogICAgICByZWxvYWRBbGxEYXRhLAogICAgICByZWZyZXNoRGF0YSwKICAgICAgcmVmcmVzaFRyaWdnZXIsCiAgICAgIGhhc01vcmUsCiAgICAgIGxvYWRpbmdNb3JlLAogICAgICBsb2FkTW9yZURvY3VtZW50cywKICAgICAgZXhwb3J0VG9QZGYsCiAgICAgIGV4cG9ydFRvV29yZCwKICAgICAgLy8g5re75Yqg57yW6L6R5a+56K+d5qGG55u45YWz5Y+Y6YePCiAgICAgIGVkaXREaWFsb2dWaXNpYmxlLAogICAgICBlZGl0RG9jdW1lbnRGb3JtLAogICAgICBlZGl0Rm9ybVJlZiwKICAgICAgZWRpdExvYWRpbmcsCiAgICAgIGVkaXRGb3JtUnVsZXMsCiAgICAgIC8vIOa3u+WKoOWIhumhteWkhOeQhuaWueazlQogICAgICBvblBhZ2VDaGFuZ2UsCiAgICAgIHBhZ2UsCiAgICAgIHBhZ2VTaXplLAogICAgICB0b3RhbENvdW50LAogICAgICAvLyDlvIDlj5Hnjq/looPmoIflv5cKICAgICAgJF9pc0RldiwKICAgICAgLy8g5re75Yqg55u05o6lQVBJ6LCD55So5Ye95pWwCiAgICAgIGZldGNoRG9jdW1lbnRzLAogICAgICAvLyDmt7vliqDliIbkuqvmlrnlvI/nm7jlhbPlj5jph48KICAgICAgc2hhcmVNZXRob2QsCiAgICAgIHNoYXJlRm9ybWF0LAogICAgICBzZWxlY3RlZENoYXRVc2VycywKICAgICAgaGFuZGxlSW1wb3J0V29yZAogICAgfTsKICB9Cn07"},{"version":3,"names":["ref","computed","onMounted","nextTick","getCurrentInstance","provide","onActivated","watch","useRouter","useRoute","ElMessage","ElMessageBox","ElLoading","Search","Plus","EditPen","Share","Folder","Close","More","Document","Clock","Upload","_","getDocuments","getRecentDocuments","getSharedDocuments","getDocumentCategories","createDocument","deleteDocument","apiDeleteDocument","shareDocument","apiShareDocument","createDocumentCategory","updateDocumentCategory","deleteDocumentCategory","aiGenerateDocument","getDocumentDetail","updateDocument","importWordDocument","userApi","createChatSession","getChatSessions","request","name","components","setup","router","route","proxy","$_isDev","process","env","NODE_ENV","refreshTrigger","Date","now","documents","recentDocuments","sharedDocuments","documentCategories","searchQuery","searchCategory","newDocumentDialogVisible","shareDialogVisible","deleteDialogVisible","documentCreateType","selectedDocument","selectedUsers","availableUsers","createLoading","shareLoading","deleteLoading","shareMethod","shareFormat","selectedChatUsers","page","pageSize","totalCount","grandTotalCount","hasMore","loadingMore","editDialogVisible","editDocumentForm","id","title","type","category_id","editLoading","newDocumentForm","aiDocumentForm","requirements","blankFormRules","required","message","trigger","min","max","aiFormRules","editFormRules","blankFormRef","aiFormRef","editFormRef","totalDocuments","value","recentEditCount","length","categoryDialogVisible","editingCategory","color","description","categoryFormRef","categoryLoading","categoryFormRules","forceUpdate","$forceUpdate","fetchDocuments","forceRefresh","append","timestamp","console","log","filters","category","search","params","page_size","_t","getTime","Object","assign","res","newDocuments","currentViewCount","data","Array","isArray","total","count","results","warn","existingIds","Set","map","doc","uniqueNewDocs","filter","has","d","join","totalPages","Math","ceil","setTimeout","Promise","resolve","error","fetchRecentDocuments","fetchSharedDocuments","response","fetchDocumentCategories","retryCount","status","debounce","createNewDocument","dialog","document","querySelector","addEventListener","clearValidate","err","once","submitNewDocument","valid","validate","catch","content","JSON","stringify","success","docId","push","then","navErr","categoryId","requirement","doc_type","_response$data","detail","includes","String","openDocument","editDocument","event","stopPropagation","Number","submitEditDocument","updateData","reloadAllData","exportDocument","showCancelButton","confirmButtonText","cancelButtonText","closeOnClickModal","callback","action","exportToPdf","exportToWord","loading","service","lock","text","background","documentContent","close","docTitle","filename","tempContainer","createElement","innerHTML","className","body","appendChild","options","margin","image","quality","html2canvas","scale","useCORS","jsPDF","unit","format","orientation","setText","html2pdfModule","html2pdf","default","from","set","save","removeChild","contentContainer","msWordHtml","FileSaver","saveAs","blob","Blob","result","getCompanyUsers","currentUserJson","localStorage","getItem","currentUserId","currentUser","parse","user","username","email","warning","confirmShare","docResponse","currentDoc","documentFile","fileName","fileType","outputPdf","sessionsResponse","chatSessions","userSessionMap","Map","userId","existingSession","find","session","participants","some","p","newSessionPromises","participant_ids","all","sendPromises","chatId","get","formData","FormData","file","File","url","method","headers","timeout","sendResults","successCount","confirmDelete","_selectedDocument$val","deletedDocId","deletedDocCategoryId","window","removeItem","e","c","document_count","currentRoute","replace","query","_refresh","refreshData","viewAllDocuments","docSection","scrollIntoView","behavior","selectCategory","toString","docCards","querySelectorAll","forEach","card","index","style","animationDelay","classList","remove","add","getSelectedCategoryColor","selectedCategory","getSelectedCategoryName","manageCategories","resetCategoryForm","editCategory","resetFields","submitCategory","categoryData","deleteCategory","confirm","formatDate","dateString","date","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","weekDays","diffDays","round","getDay","toLocaleDateString","month","day","resetCategoryFilter","","","","","","newVal","path","newPath","oldPath","startsWith","onPageChange","newPage","oldPage","loadMoreDocuments","refreshParam","handleImportWord","fileInput","accept","display","target","files","loadingInstance","fullscreen","click"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Index.vue"],"sourcesContent":["<template>\n  <div class=\"smartdoc-home-container\">\n    <!--  -->\n    <div style=\"display: none;\">{{ refreshTrigger }}</div>\n    \n    <!--  -->\n    <div class=\"page-header\">\n      <div class=\"left-section\">\n        <h2 class=\"page-title\"></h2>\n        <p class=\"page-description\"></p>\n        </div>\n      <div class=\"right-section\">\n        <div class=\"search-controls\">\n          <el-select \n            v-model=\"searchCategory\" \n            placeholder=\"\" \n            @change=\"selectCategory(searchCategory)\" \n            class=\"category-select\"\n          >\n            <el-option label=\"\" value=\"all\" />\n            <el-option \n              v-for=\"category in documentCategories\" \n              :key=\"category.id\" \n              :label=\"category.name\" \n              :value=\"category.id.toString()\"\n            />\n          </el-select>\n          \n          <el-input\n            placeholder=\"...\"\n            v-model=\"searchQuery\"\n          class=\"search-input\"\n            clearable\n          >\n            <template #prefix>\n              <el-icon><Search /></el-icon>\n            </template>\n          </el-input>\n        </div>\n        \n        <el-button type=\"success\" @click=\"handleImportWord\" style=\"margin-right: 10px;\">\n          <el-icon><Upload /></el-icon> Word\n        </el-button>\n        <el-button type=\"primary\" @click=\"createNewDocument\">\n          <el-icon><Plus /></el-icon> \n        </el-button>\n          </div>\n        </div>\n\n    <!--  -->\n    <div class=\"stats-cards\">\n      <el-card class=\"stat-card\" shadow=\"hover\" @click=\"selectCategory('all')\">\n        <div class=\"stat-content\">\n          <div class=\"stat-icon doc-icon\">\n                <el-icon><Document /></el-icon>\n              </div>\n          <div class=\"stat-info\">\n            <div class=\"stat-value\">{{ totalDocuments }}</div>\n            <div class=\"stat-label\"></div>\n                </div>\n              </div>\n      </el-card>\n      \n      <el-card class=\"stat-card\" shadow=\"hover\">\n        <div class=\"stat-content\">\n          <div class=\"stat-icon edit-icon\">\n            <el-icon><EditPen /></el-icon>\n            </div>\n          <div class=\"stat-info\">\n            <div class=\"stat-value\">{{ recentEditCount }}</div>\n            <div class=\"stat-label\"></div>\n          </div>\n        </div>\n      </el-card>\n      \n      <el-card class=\"stat-card\" shadow=\"hover\">\n        <div class=\"stat-content\">\n          <div class=\"stat-icon share-icon\">\n            <el-icon><Share /></el-icon>\n          </div>\n          <div class=\"stat-info\">\n            <div class=\"stat-value\">{{ sharedDocuments.length }}</div>\n            <div class=\"stat-label\"></div>\n            </div>\n        </div>\n      </el-card>\n    </div>\n\n    <!--  -->\n    <div v-if=\"searchCategory !== 'all'\" class=\"filter-status-bar\">\n      <div class=\"filter-bar-content\">\n        <div class=\"filter-title\">\n          <span>: </span>\n          <span class=\"filter-category\" :style=\"{ backgroundColor: getSelectedCategoryColor() }\">\n            {{ getSelectedCategoryName() }}\n          </span>\n        </div>\n        <div class=\"filter-actions\">\n          <el-button type=\"primary\" link @click=\"resetCategoryFilter\">\n            <el-icon><Close /></el-icon> \n          </el-button>\n        </div>\n      </div>\n    </div>\n\n    <!--  -  -->\n    <div class=\"section category-section\">\n      <div class=\"section-header\">\n        <h3></h3>\n        <div class=\"section-actions\">\n          <el-button text @click=\"manageCategories\"></el-button>\n        </div>\n      </div>\n      \n      <div class=\"category-cards\">\n        <!--  -->\n        <div \n          class=\"category-card\" \n          :class=\"{ 'category-active': searchCategory === 'all' }\"\n          @click=\"selectCategory('all')\"\n        >\n          <div class=\"category-icon\" :style=\"{ backgroundColor: '#409EFF' }\">\n            <el-icon><Document /></el-icon>\n          </div>\n          <div class=\"category-info\">\n            <h4></h4>\n            <div class=\"category-count\">{{ totalDocuments }} </div>\n          </div>\n          <div v-if=\"searchCategory === 'all'\" class=\"category-selected-indicator\"></div>\n        </div>\n        \n        <!--  -->\n        <div \n          v-for=\"category in documentCategories\" \n          :key=\"category.id\" \n          class=\"category-card\" \n          :class=\"{ 'category-active': searchCategory === category.id.toString() }\"\n          @click=\"selectCategory(category)\"\n        >\n          <div class=\"category-icon\" :style=\"{ backgroundColor: category.color }\">\n            <el-icon><Folder /></el-icon>\n          </div>\n          <div class=\"category-info\">\n            <h4>{{ category.name }}</h4>\n            <div class=\"category-count\">{{ category.document_count }} </div>\n          </div>\n          <div v-if=\"searchCategory === category.id.toString()\" class=\"category-selected-indicator\"></div>\n        </div>\n      </div>\n    </div>\n\n    <!--  -->\n    <div class=\"section\">\n      <div class=\"section-header\">\n        <h3></h3>\n        <div class=\"filter-controls\">\n          <el-button text @click=\"() => fetchDocuments(true)\"></el-button>\n        </div>\n              </div>\n      \n      <div class=\"document-cards\">\n        <el-card \n          v-for=\"doc in documents\" \n          :key=\"doc.id\" \n          class=\"doc-card\" \n          shadow=\"hover\"\n          @click=\"openDocument(doc)\"\n        >\n          <div class=\"doc-card-header\">\n            <div class=\"doc-info\">\n              <div class=\"doc-type-tag\">{{ doc.type }}</div>\n              <div v-if=\"doc.category\" \n                   class=\"doc-category-tag\" \n                   :style=\"{ backgroundColor: doc.category.color || '#67C23A' }\"\n              >\n                {{ doc.category.name }}\n              </div>\n            </div>\n            <div class=\"doc-menu btn-container\" @click.stop>\n              <el-dropdown trigger=\"click\" @click.stop>\n                <el-icon><More /></el-icon>\n                <template #dropdown>\n                  <el-dropdown-menu>\n                    <el-dropdown-item @click.stop=\"openDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"editDocument(doc, $event)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"exportDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"shareDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item divided @click.stop=\"deleteDocument(doc)\" type=\"danger\"></el-dropdown-item>\n                  </el-dropdown-menu>\n                </template>\n              </el-dropdown>\n            </div>\n          </div>\n          \n          <div class=\"card-content-area\">\n            <h4 class=\"doc-title\" :title=\"doc.title\">{{ doc.title }}</h4>\n            <div class=\"doc-preview\" v-html=\"doc.preview || ''\"></div>\n          </div>\n          \n          <div class=\"doc-footer\">\n            <div class=\"doc-time\">\n              <el-icon><Clock /></el-icon>\n              <span>{{ formatDate(doc.update_time) }}</span>\n            </div>\n            <div class=\"doc-actions btn-container\">\n              <el-tooltip content=\"\" placement=\"top\">\n                <el-button link circle size=\"small\" @click.stop=\"editDocument(doc, $event)\">\n                  <el-icon><EditPen /></el-icon>\n                </el-button>\n              </el-tooltip>\n              <el-tooltip content=\"\" placement=\"top\">\n                <el-button link circle size=\"small\" @click.stop=\"shareDocument(doc)\">\n                  <el-icon><Share /></el-icon>\n                </el-button>\n              </el-tooltip>\n            </div>\n          </div>\n        </el-card>\n        \n        <!--  -->\n        <div class=\"doc-card new-doc-card\" @click=\"createNewDocument\">\n          <div class=\"new-doc-content\">\n            <el-icon><Plus /></el-icon>\n            <span></span>\n          </div>\n        </div>\n      </div>\n      \n      <!--  -->\n      <div v-if=\"totalCount > 0\" class=\"pagination-container\">\n        <el-pagination\n          background\n          layout=\"prev, pager, next, jumper\"\n          :total=\"totalCount\"\n          :page-size=\"pageSize\"\n          v-model:current-page=\"page\"\n          @current-change=\"onPageChange\"\n          :pager-count=\"7\"\n        />\n        <!-- () -->\n        <div v-if=\"$_isDev\" class=\"pagination-debug\">\n          <small>: {{ page }} / : {{ Math.ceil(totalCount / pageSize) || 0 }} ({{ totalCount }})</small>\n        </div>\n      </div>\n    </div>\n\n    <!--  -->\n    <div class=\"section\">\n      <div class=\"section-header\">\n        <h3></h3>\n        <div class=\"section-actions\">\n          <el-button text @click=\"viewAllDocuments('recent')\"></el-button>\n        </div>\n      </div>\n      \n      <div class=\"document-cards\">\n        <el-card \n          v-for=\"doc in recentDocuments\" \n          :key=\"doc.id\" \n          class=\"doc-card\" \n          shadow=\"hover\"\n          @click=\"openDocument(doc)\"\n        >\n          <div class=\"doc-card-header\">\n            <div class=\"doc-info\">\n              <div class=\"doc-type-tag\">{{ doc.type }}</div>\n              <div v-if=\"doc.category\" \n                   class=\"doc-category-tag\" \n                   :style=\"{ backgroundColor: doc.category.color || '#67C23A' }\"\n              >\n                {{ doc.category.name }}\n              </div>\n            </div>\n            <div class=\"doc-menu btn-container\" @click.stop>\n              <el-dropdown trigger=\"click\" @click.stop>\n                <el-icon><More /></el-icon>\n                <template #dropdown>\n                  <el-dropdown-menu>\n                    <el-dropdown-item @click.stop=\"openDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"editDocument(doc, $event)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"exportDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item @click.stop=\"shareDocument(doc)\"></el-dropdown-item>\n                    <el-dropdown-item divided @click.stop=\"deleteDocument(doc)\" type=\"danger\"></el-dropdown-item>\n                  </el-dropdown-menu>\n                </template>\n              </el-dropdown>\n            </div>\n          </div>\n          \n          <div class=\"card-content-area\">\n            <h4 class=\"doc-title\" :title=\"doc.title\">{{ doc.title }}</h4>\n            <div class=\"doc-preview\" v-html=\"doc.preview || ''\"></div>\n          </div>\n          \n          <div class=\"doc-footer\">\n            <div class=\"doc-time\">\n              <el-icon><Clock /></el-icon>\n              <span>{{ formatDate(doc.update_time) }}</span>\n            </div>\n            <div class=\"doc-actions btn-container\">\n              <el-tooltip content=\"\" placement=\"top\">\n                <el-button link circle size=\"small\" @click.stop=\"editDocument(doc, $event)\">\n                  <el-icon><EditPen /></el-icon>\n                </el-button>\n              </el-tooltip>\n              <el-tooltip content=\"\" placement=\"top\">\n                <el-button link circle size=\"small\" @click.stop=\"shareDocument(doc)\">\n                  <el-icon><Share /></el-icon>\n                </el-button>\n              </el-tooltip>\n            </div>\n          </div>\n        </el-card>\n        \n        <!--  -->\n        <div class=\"doc-card new-doc-card\" @click=\"createNewDocument\">\n          <div class=\"new-doc-content\">\n            <el-icon><Plus /></el-icon>\n            <span></span>\n          </div>\n        </div>\n      </div>\n      \n      <div v-if=\"recentDocuments.length === 0\" class=\"empty-state\">\n        <!--  -->\n    </div>\n  </div>\n\n    <!--  -->\n  <el-dialog\n      v-model=\"newDocumentDialogVisible\"\n      title=\"\"\n      width=\"35%\"\n    >\n      <el-tabs v-model=\"documentCreateType\">\n        <el-tab-pane label=\"\" name=\"blank\">\n          <el-form \n            :model=\"newDocumentForm\" \n            label-width=\"80px\" \n            class=\"mt-4\"\n            :rules=\"blankFormRules\"\n            ref=\"blankFormRef\"\n          >\n            <el-form-item label=\"\" prop=\"title\">\n              <el-input v-model=\"newDocumentForm.title\" placeholder=\"\" />\n      </el-form-item>\n            <el-form-item label=\"\">\n              <el-input v-model=\"newDocumentForm.type\" placeholder=\"\" />\n              <div class=\"form-tip\"></div>\n            </el-form-item>\n          </el-form>\n        </el-tab-pane>\n        <el-tab-pane label=\"AI\" name=\"ai\">\n          <el-form \n            :model=\"aiDocumentForm\" \n            label-width=\"80px\" \n            class=\"mt-4\"\n            :rules=\"aiFormRules\"\n            ref=\"aiFormRef\"\n          >\n            <el-form-item label=\"\" prop=\"title\">\n              <el-input v-model=\"aiDocumentForm.title\" placeholder=\"\" />\n            </el-form-item>\n            <el-form-item label=\"\" prop=\"requirements\">\n        <el-input\n                v-model=\"aiDocumentForm.requirements\" \n          type=\"textarea\"\n                :rows=\"3\" \n                placeholder=\"\"\n        />\n              <div class=\"form-tip\"></div>\n      </el-form-item>\n    </el-form>\n        </el-tab-pane>\n      </el-tabs>\n    <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"newDocumentDialogVisible = false\"></el-button>\n          <el-button type=\"primary\" @click=\"submitNewDocument\" :loading=\"createLoading\">\n            \n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!--  -->\n    <el-dialog\n      v-model=\"shareDialogVisible\"\n      title=\"\"\n      width=\"30%\"\n    >\n      <div v-if=\"selectedDocument\">\n        <p>: <strong>{{ selectedDocument.title }}</strong></p>\n        \n        <!--  -->\n        <el-form label-width=\"120px\" class=\"mt-4\">\n          <el-form-item label=\"\">\n            <el-radio-group v-model=\"shareMethod\">\n              <el-radio label=\"permission\"></el-radio>\n              <el-radio label=\"chat\"></el-radio>\n            </el-radio-group>\n          </el-form-item>\n          \n          <!--  -->\n          <el-form-item label=\"\" v-if=\"shareMethod === 'permission'\">\n            <el-select\n              v-model=\"selectedUsers\"\n              multiple\n              placeholder=\"\"\n              style=\"width: 100%\"\n            >\n              <el-option\n                v-for=\"user in availableUsers\"\n                :key=\"user.id\"\n                :label=\"user.username\"\n                :value=\"user.id\"\n              />\n            </el-select>\n          </el-form-item>\n          \n          <!--  -->\n          <template v-if=\"shareMethod === 'chat'\">\n            <el-form-item label=\"\">\n              <el-radio-group v-model=\"shareFormat\">\n                <el-radio label=\"pdf\">PDF</el-radio>\n                <el-radio label=\"word\">Word</el-radio>\n              </el-radio-group>\n            </el-form-item>\n            \n            <el-form-item label=\"\">\n              <el-select\n                v-model=\"selectedChatUsers\"\n                multiple\n                placeholder=\"\"\n                style=\"width: 100%\"\n              >\n                <el-option\n                  v-for=\"user in availableUsers\"\n                  :key=\"user.id\"\n                  :label=\"user.username\"\n                  :value=\"user.id\"\n                />\n              </el-select>\n              <div class=\"form-tip\"></div>\n            </el-form-item>\n          </template>\n        </el-form>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"shareDialogVisible = false\"></el-button>\n          <el-button type=\"primary\" @click=\"confirmShare\" :loading=\"shareLoading\">\n            \n          </el-button>\n        </span>\n    </template>\n  </el-dialog>\n    \n    <!--  -->\n    <el-dialog\n      v-model=\"deleteDialogVisible\"\n      title=\"\"\n      width=\"30%\"\n    >\n      <div v-if=\"selectedDocument\">\n        <p> <strong>{{ selectedDocument.title }}</strong> ?</p>\n        <p class=\"warning-text\">!</p>\n  </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"deleteDialogVisible = false\"></el-button>\n          <el-button type=\"danger\" @click=\"confirmDelete\" :loading=\"deleteLoading\">\n            \n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!--  -->\n    <el-dialog\n      v-model=\"categoryDialogVisible\"\n      title=\"\"\n      width=\"40%\"\n    >\n      <div class=\"category-management\">\n        <div class=\"category-list\">\n          <h4></h4>\n          <el-table :data=\"documentCategories\" style=\"width: 100%\">\n            <el-table-column prop=\"name\" label=\"\" />\n            <el-table-column label=\"\" width=\"120\">\n              <template #default=\"scope\">\n                <div class=\"color-preview\" :style=\"{ backgroundColor: scope.row.color }\"></div>\n                {{ scope.row.color }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"\" width=\"100\">\n              <template #default=\"scope\">\n                {{ scope.row.document_count || 0 }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"\" width=\"150\">\n              <template #default=\"scope\">\n                <el-button type=\"primary\" link @click=\"editCategory(scope.row)\"></el-button>\n                <el-button \n                  type=\"danger\" \n                  link \n                  @click=\"deleteCategory(scope.row)\"\n                  :disabled=\"scope.row.document_count > 0\"\n                ></el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        \n        <el-divider />\n        \n        <div class=\"category-form\">\n          <h4>{{ editingCategory.id ? '' : '' }}</h4>\n          <el-form \n            :model=\"editingCategory\" \n            :rules=\"categoryFormRules\" \n            label-width=\"80px\"\n            ref=\"categoryFormRef\"\n          >\n            <el-form-item label=\"\" prop=\"name\">\n              <el-input v-model=\"editingCategory.name\" placeholder=\"\" />\n            </el-form-item>\n            <el-form-item label=\"\" prop=\"color\">\n              <el-color-picker v-model=\"editingCategory.color\" />\n              <span class=\"color-value\">{{ editingCategory.color }}</span>\n            </el-form-item>\n            <el-form-item label=\"\">\n              <el-input \n                v-model=\"editingCategory.description\" \n                type=\"textarea\" \n                :rows=\"3\" \n                placeholder=\"\" \n              />\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"submitCategory\" :loading=\"categoryLoading\">\n                {{ editingCategory.id ? '' : '' }}\n              </el-button>\n              <el-button @click=\"resetCategoryForm\"></el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!--  -->\n    <el-dialog\n      v-model=\"editDialogVisible\"\n      title=\"\"\n      width=\"35%\"\n    >\n      <el-form \n        :model=\"editDocumentForm\" \n        label-width=\"80px\" \n        class=\"mt-4\"\n        :rules=\"editFormRules\"\n        ref=\"editFormRef\"\n      >\n        <el-form-item label=\"\" prop=\"title\">\n          <el-input v-model=\"editDocumentForm.title\" placeholder=\"\" />\n        </el-form-item>\n        <el-form-item label=\"\">\n          <el-input v-model=\"editDocumentForm.type\" placeholder=\"\" />\n          <div class=\"form-tip\"></div>\n        </el-form-item>\n        <el-form-item label=\"\">\n          <el-select v-model=\"editDocumentForm.category_id\" placeholder=\"\" style=\"width: 100%\">\n            <el-option label=\"\" :value=\"null\" />\n            <el-option \n              v-for=\"category in documentCategories\" \n              :key=\"category.id\" \n              :label=\"category.name\" \n              :value=\"category.id\"\n            />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"editDialogVisible = false\"></el-button>\n          <el-button type=\"primary\" @click=\"submitEditDocument\" :loading=\"editLoading\">\n            \n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, nextTick, getCurrentInstance, provide, onActivated, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { ElMessage, ElMessageBox, ElLoading } from 'element-plus'\nimport { Search, Plus, EditPen, Share, Folder, Close, More, Document, Clock, Upload } from '@element-plus/icons-vue'\nimport _ from 'lodash'\nimport { \n  getDocuments,\n  getRecentDocuments,\n  getSharedDocuments,\n  getDocumentCategories,\n  createDocument,\n  deleteDocument as apiDeleteDocument,\n  shareDocument as apiShareDocument,\n  createDocumentCategory,\n  updateDocumentCategory,\n  deleteDocumentCategory,\n  aiGenerateDocument,\n  getDocumentDetail,\n  updateDocument,\n  importWordDocument\n} from '@/api/smartdoc'\nimport userApi from '@/api/user';\nimport { createChatSession, getChatSessions } from '@/api/chat';\nimport request from '@/utils/request';\n\nexport default {\n  name: 'SmartDocHome',\n  components: {\n    Search,\n    Plus,\n    EditPen,\n    Share,\n    Folder,\n    Close,\n    More,\n    Document,\n    Clock,\n    Upload\n  },\n  setup() {\n    const router = useRouter()\n    const route = useRoute()\n    const { proxy } = getCurrentInstance() // \n    \n    // \n    const $_isDev = process.env.NODE_ENV === 'development'\n    \n    // \n    const refreshTrigger = ref(Date.now())\n    \n    // \n    const documents = ref([])\n    const recentDocuments = ref([])\n    const sharedDocuments = ref([])\n    const documentCategories = ref([])\n    const searchQuery = ref('')\n    const searchCategory = ref('all')\n    const newDocumentDialogVisible = ref(false)\n    const shareDialogVisible = ref(false)\n    const deleteDialogVisible = ref(false)\n    const documentCreateType = ref('blank')\n    const selectedDocument = ref(null)\n    const selectedUsers = ref([])\n    const availableUsers = ref([])\n    const createLoading = ref(false)\n    const shareLoading = ref(false)\n    const deleteLoading = ref(false)\n    \n    // \n    const shareMethod = ref('permission') // permission()  chat()\n    const shareFormat = ref('pdf') // pdf  word\n    const selectedChatUsers = ref([]) // \n    \n    // \n    const page = ref(1)\n    const pageSize = 11 // 11\"\"12\n    const totalCount = ref(0)\n    const grandTotalCount = ref(0) // \n    // \n    const hasMore = ref(true)\n    const loadingMore = ref(false)\n    \n    // \n    const editDialogVisible = ref(false)\n    const editDocumentForm = ref({\n      id: null,\n      title: '',\n      type: '',\n      category_id: null\n    })\n    const editLoading = ref(false)\n    \n    // \n    const newDocumentForm = ref({\n        title: '',\n        type: ''\n    })\n    \n    const aiDocumentForm = ref({\n        title: '',\n      requirements: ''\n    })\n    \n    // \n    const blankFormRules = {\n        title: [\n        { required: true, message: '', trigger: 'blur' },\n        { min: 2, max: 50, message: ' 2  50 ', trigger: 'blur' }\n        ]\n    }\n    \n    const aiFormRules = {\n        title: [\n        { required: true, message: '', trigger: 'blur' },\n        { min: 2, max: 50, message: ' 2  50 ', trigger: 'blur' }\n        ],\n        requirements: [\n        { required: true, message: '', trigger: 'blur' },\n        { min: 10, max: 500, message: ' 10  500 ', trigger: 'blur' }\n      ]\n    }\n    \n    // \n    const editFormRules = {\n      title: [\n        { required: true, message: '', trigger: 'blur' },\n        { min: 2, max: 50, message: ' 2  50 ', trigger: 'blur' }\n      ]\n    }\n    \n    const blankFormRef = ref(null)\n    const aiFormRef = ref(null)\n    const editFormRef = ref(null)\n    \n    // \n    const totalDocuments = computed(() => {\n      return grandTotalCount.value;\n    });\n    \n    const recentEditCount = computed(() => {\n      return recentDocuments.value.length || 0;\n    });\n    \n    // \n    const categoryDialogVisible = ref(false)\n    const editingCategory = ref({\n      name: '',\n      color: '#409EFF',\n      description: '',\n    })\n    const categoryFormRef = ref(null)\n    const categoryLoading = ref(false)\n    const categoryFormRules = {\n      name: [\n        { required: true, message: '', trigger: 'blur' },\n        { min: 2, max: 20, message: '220', trigger: 'blur' }\n      ],\n      color: [\n        { required: true, message: '', trigger: 'change' }\n      ]\n    }\n    \n    // \n    const forceUpdate = async () => {\n      // \n      documents.value = [...documents.value];\n      recentDocuments.value = [...recentDocuments.value]; \n      sharedDocuments.value = [...sharedDocuments.value];\n      \n      // Vue$forceUpdate\n      if (proxy && proxy.$forceUpdate) {\n        proxy.$forceUpdate();\n      }\n      \n      // DOM\n      await nextTick();\n    };\n    \n    // \n    const fetchDocuments = async (forceRefresh = false, append = false, timestamp = null) => {\n      if (forceRefresh) {\n        page.value = 1\n        hasMore.value = true\n      }\n      \n      // hasMore\n      if (append && !hasMore.value && !forceRefresh) {\n        console.log('')\n        return\n      }\n      \n      if (!append) {\n        createLoading.value = true\n      } else {\n        loadingMore.value = true\n      }\n      \n      try {\n        // \n        const filters = {}\n        \n        // \n        if (searchCategory.value && searchCategory.value !== 'all') {\n          filters.category = searchCategory.value\n        }\n        \n        // \n        if (searchQuery.value) {\n          filters.search = searchQuery.value\n        }\n        \n        // API - DRFpage_size\n        const params = {\n          page: page.value,\n          page_size: pageSize, // pageSizepage_sizeREST framework\n          _t: timestamp || new Date().getTime() // \n        }\n        \n        // \n        Object.assign(params, filters)\n        \n        console.log(`: ${page.value}:`, params)\n        \n        const res = await getDocuments(params)\n        console.log('API:', res)\n        \n        let newDocuments = []\n        let currentViewCount = 0;\n        \n        // \n        if (res && res.data && Array.isArray(res.data)) {\n          // \n          newDocuments = res.data\n          currentViewCount = res.total || res.count || 0\n        } else if (res && res.results && Array.isArray(res.results)) {\n          // Django REST\n          newDocuments = res.results\n          currentViewCount = res.count || 0\n        } else if (res && res.data && res.data.results && Array.isArray(res.data.results)) {\n          // \n          newDocuments = res.data.results\n          currentViewCount = res.data.count || 0\n        } else {\n          console.warn('API:', res)\n          documents.value = []\n          return\n        }\n          \n        // \n        totalCount.value = currentViewCount;\n\n        // \"\"\n        if (!filters.category && !filters.search) {\n            grandTotalCount.value = currentViewCount;\n        }\n\n        // \n        if (append) {\n          // \n          const existingIds = new Set(documents.value.map(doc => doc.id))\n          const uniqueNewDocs = newDocuments.filter(doc => !existingIds.has(doc.id))\n          \n          if (uniqueNewDocs.length > 0) {\n            documents.value = [...documents.value, ...uniqueNewDocs]\n            console.log(` ${uniqueNewDocs.length}  ${documents.value.length} `)\n          } else {\n            console.log('')\n            // \n            hasMore.value = newDocuments.length > 0\n          }\n        } else {\n          // \n          documents.value = newDocuments\n          console.log(` ${documents.value.length} `)\n        }\n        \n        console.log(`ID: [${documents.value.map(d => d.id).join(', ')}]`)\n        \n        // \n        const totalPages = Math.ceil(currentViewCount / pageSize);\n        console.log(` - : ${page.value}, : ${totalPages}, : ${currentViewCount}`);\n        \n        // \n        if (page.value > totalPages && totalPages > 0 && !append) {\n          console.warn(` ${page.value}  ${totalPages}`);\n          \n          // setTimeoutwatch\n          setTimeout(() => {\n            page.value = totalPages;\n          }, 0);\n          \n          return;\n        }\n        \n        // \n        hasMore.value = page.value < totalPages;\n        \n        // \n        if (!append && documents.value.length < 8 && hasMore.value) {\n          console.log('')\n          // 100ms\n          await new Promise(resolve => setTimeout(resolve, 100));\n          await fetchDocuments(false, true, timestamp);\n        }\n          \n      } catch (error) {\n        console.error('', error)\n        documents.value = []\n        ElMessage.error('')\n      } finally {\n        if (!append) {\n          createLoading.value = false\n        } else {\n          loadingMore.value = false\n        }\n      }\n    }\n    \n    const fetchRecentDocuments = async (forceRefresh = false, timestamp = null) => {\n      console.log('...');\n      try {\n        // \n        const params = forceRefresh ? { _t: timestamp || new Date().getTime() } : {};\n        \n        const res = await getRecentDocuments(params);\n        console.log('API:', res);\n        \n        if (res && res.data) {\n          // \n          recentDocuments.value = Array.isArray(res.data) ? [...res.data] : [];\n          console.log(`: ${recentDocuments.value.length}`);\n        } else {\n          console.warn('API:', res);\n          recentDocuments.value = [];\n        }\n      } catch (error) {\n        console.error(':', error);\n        ElMessage.error('');\n        recentDocuments.value = [];\n      }\n    }\n    \n    const fetchSharedDocuments = async (timestamp = null) => {\n      try {\n        const response = await getSharedDocuments(timestamp)\n        sharedDocuments.value = response.data\n      } catch (error) {\n        console.error('', error)\n        ElMessage.error('')\n      }\n    }\n    \n    const fetchDocumentCategories = async (timestamp = null, retryCount = 0) => {\n      console.log('...');\n      try {\n        const res = await getDocumentCategories(timestamp);\n        console.log('API:', res);\n        \n        if (res && res.data) {\n          documentCategories.value = res.data;\n          console.log(`: ${documentCategories.value.length}, :`, documentCategories.value);\n        } else {\n          console.warn('API:', res);\n          documentCategories.value = [];\n          \n          // \n          if (documentCategories.value.length === 0 && retryCount < 2) {\n            console.log(`${retryCount + 1}...`);\n            setTimeout(() => fetchDocumentCategories(timestamp, retryCount + 1), (retryCount + 1) * 1000);\n          }\n        }\n      } catch (error) {\n        console.error(':', error);\n        \n        // \n        if (error.response && error.response.status >= 500 && retryCount < 2) {\n          console.log(`${retryCount + 1}...`);\n          setTimeout(() => fetchDocumentCategories(timestamp, retryCount + 1), (retryCount + 1) * 1000);\n        } else {\n          ElMessage.error('');\n          // \n          documentCategories.value = [];\n        }\n      }\n    }\n    \n    // \n    watch(searchQuery, _.debounce(async () => {\n      // \n      page.value = 1\n      hasMore.value = true\n      \n      // \n      documents.value = []\n      createLoading.value = true\n      \n      try {\n        // \n        await fetchDocuments(true)\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      } finally {\n        createLoading.value = false\n      }\n    }, 300))\n    \n    const createNewDocument = () => {\n      // \n      newDocumentForm.value = { title: '', type: '' }\n      aiDocumentForm.value = { title: '', requirements: '' }\n      documentCreateType.value = 'blank'\n      newDocumentDialogVisible.value = true\n      \n      // \n      nextTick(() => {\n        try {\n          const dialog = document.querySelector('.el-dialog');\n          if (dialog) {\n            dialog.addEventListener('closed', () => {\n              try {\n                if (blankFormRef.value) {\n                  blankFormRef.value.clearValidate();\n                }\n                if (aiFormRef.value) {\n                  aiFormRef.value.clearValidate();\n                }\n              } catch (err) {\n                console.error('Error clearing form validation:', err);\n              }\n            }, { once: true });\n          }\n        } catch (err) {\n          console.error('Error setting up dialog event listener:', err);\n        }\n      });\n    }\n    \n    const submitNewDocument = async () => {\n      if (documentCreateType.value === 'blank') {\n        if (!blankFormRef.value) {\n          console.warn('');\n          return;\n        }\n        \n        try {\n          const valid = await blankFormRef.value.validate()\n            .catch(err => {\n              console.error(':', err);\n              return false;\n            });\n          \n          if (valid) {\n            createLoading.value = true;\n            try {\n              console.log(':', {\n                title: newDocumentForm.value.title,\n                type: newDocumentForm.value.type || ''\n              });\n              \n              const response = await createDocument({ \n                title: newDocumentForm.value.title,\n                type: newDocumentForm.value.type || '',\n                content: ''\n              });\n              \n              console.log('', JSON.stringify(response));\n              \n              // \n              newDocumentDialogVisible.value = false;\n              ElMessage.success('');\n              \n              // ID\n              let docId = null;\n              if (response && response.data) {\n                if (response.data.id) {\n                  docId = response.data.id;\n                } else if (Array.isArray(response.data) && response.data.length > 0) {\n                  docId = response.data[0].id;\n                } else if (response.data.results && Array.isArray(response.data.results) && response.data.results.length > 0) {\n                  docId = response.data.results[0].id;\n                }\n              }\n              \n              // DOM\n              setTimeout(() => {\n                if (docId) {\n                  console.log(`ID: ${docId}`);\n                  \n                  // \n                  fetchDocuments();\n                  fetchRecentDocuments();\n                  \n                  // \n                  setTimeout(() => {\n                    router.push({\n                      name: 'SmartDocDetail',\n                      params: { id: docId }\n                    }).then(() => {\n                      createLoading.value = false;\n                    }).catch(err => {\n                      console.error(':', err);\n                      ElMessage.error('');\n                      // \n                      router.push(`/smartdoc/${docId}`).catch(navErr => {\n                        console.error(':', navErr);\n                        ElMessage.error('');\n                      });\n                      createLoading.value = false;\n                    });\n                  }, 300);\n                } else {\n                  console.warn('', response);\n                  // \n                  fetchDocuments();\n                  fetchRecentDocuments();\n                }\n              }, 100);\n            } catch (error) {\n              console.error('', error);\n              ElMessage.error('');\n            } finally {\n              createLoading.value = false;\n            }\n          }\n        } catch (error) {\n          console.error(':', error);\n          ElMessage.error('');\n          createLoading.value = false;\n        }\n      } else if (documentCreateType.value === 'ai') {\n        if (!aiFormRef.value) {\n          console.warn('AI');\n          return;\n        }\n        \n        try {\n          const valid = await aiFormRef.value.validate()\n            .catch(err => {\n              console.error('AI:', err);\n              return false;\n            });\n          \n          if (valid) {\n            createLoading.value = true;\n            try {\n              // AIAPI\n              const categoryId = searchCategory.value !== 'all' ? searchCategory.value : null;\n              const response = await aiGenerateDocument({\n                title: aiDocumentForm.value.title,\n                requirement: aiDocumentForm.value.requirements,\n                category_id: categoryId,\n                doc_type: 'AI'\n              });\n              console.log('AI', response);\n              // \n              if (response && response.status === 504) {\n                ElMessage.error(response.data?.detail || 'AI');\n                createLoading.value = false;\n                return;\n              }\n              if (response && response.data && typeof response.data.detail === 'string' && response.data.detail.includes('')) {\n                ElMessage.error(response.data.detail);\n                createLoading.value = false;\n                return;\n              }\n              newDocumentDialogVisible.value = false;\n              ElMessage.success('AI');\n              let docId = null;\n              if (response && response.data && response.data.id) {\n                docId = response.data.id;\n              }\n              if (docId) {\n                // \n                console.log(': SmartDocDetail, id:', docId);\n                router.push({\n                  name: 'SmartDocDetail',\n                  params: { id: String(docId) }\n                }).then(() => {\n                  createLoading.value = false;\n                }).catch(err => {\n                  console.error(':', err);\n                  ElMessage.error('');\n                  // \n                  router.push(`/smartdoc/${docId}`).catch(navErr => {\n                    console.error(':', navErr);\n                    ElMessage.error('');\n                  });\n                  createLoading.value = false;\n                });\n                // \n                fetchDocuments();\n                fetchRecentDocuments();\n              } else {\n                fetchDocuments();\n                fetchRecentDocuments();\n                createLoading.value = false;\n              }\n            } catch (error) {\n              console.error('AI', error);\n              ElMessage.error('AI');\n            } finally {\n              createLoading.value = false;\n            }\n          }\n        } catch (error) {\n          console.error('AI:', error);\n          ElMessage.error('');\n          createLoading.value = false;\n        }\n      }\n    }\n    \n    const openDocument = (doc) => {\n      router.push({ name: 'SmartDocDetail', params: { id: doc.id } })\n    }\n    \n    const editDocument = (doc, event) => {\n      // \n      if (event) {\n        event.stopPropagation();\n      }\n      \n      // ID\n      let categoryId = null;\n      if (doc.category && doc.category.id) {\n        categoryId = Number(doc.category.id);\n      }\n      \n      console.log(':', doc.id, ':', categoryId);\n      \n      // \n      editDocumentForm.value = {\n        id: doc.id,\n        title: doc.title,\n        type: doc.type || '',\n        category_id: categoryId\n      };\n      \n      // \n      editDialogVisible.value = true;\n    };\n    \n    // \n    const submitEditDocument = async () => {\n      if (!editFormRef.value) return;\n      \n      try {\n        const valid = await editFormRef.value.validate();\n        \n        if (valid) {\n          editLoading.value = true;\n          \n          // \n          const updateData = {\n            title: editDocumentForm.value.title,\n            type: editDocumentForm.value.type || '',\n            category_id: editDocumentForm.value.category_id\n          };\n          \n          // API\n          await updateDocument(editDocumentForm.value.id, updateData);\n          \n          ElMessage.success('');\n          editDialogVisible.value = false;\n          \n          // \n          await reloadAllData();\n        }\n      } catch (error) {\n        console.error('', error);\n        ElMessage.error('');\n      } finally {\n        editLoading.value = false;\n      }\n    };\n    \n    const exportDocument = (doc) => {\n      ElMessageBox({\n        title: '',\n        message: '',\n        showCancelButton: true,\n        confirmButtonText: 'PDF',\n        cancelButtonText: 'Word',\n        closeOnClickModal: true,\n        callback: (action) => {\n          if (action === 'confirm') {\n            exportToPdf(doc)\n          } else if (action === 'cancel') {\n            exportToWord(doc)\n          }\n        }\n      })\n    }\n    \n    // PDF\n    const exportToPdf = async (doc) => {\n      if (!doc) {\n        ElMessage.error('')\n        return\n      }\n      \n      // \n      const loading = ElLoading.service({\n        lock: true,\n        text: '...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      \n      try {\n        // \n        const response = await getDocumentDetail(doc.id)\n        const documentContent = response.data.content\n        \n        if (!documentContent) {\n          loading.close()\n          ElMessage.error('')\n          return\n        }\n        \n        const docTitle = doc.title || ''\n        const filename = `${docTitle}.pdf`\n        \n        // \n        const tempContainer = document.createElement('div')\n        tempContainer.innerHTML = documentContent\n        tempContainer.className = 'temp-export-container'\n        document.body.appendChild(tempContainer)\n        \n        const options = {\n          margin: [15, 15, 15, 15],\n          filename: filename,\n          image: { type: 'jpeg', quality: 0.98 },\n          html2canvas: { scale: 2, useCORS: true },\n          jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n        }\n        \n        // \n        loading.setText('PDF...')\n        \n        // html2pdf.js\n        const html2pdfModule = await import('html2pdf.js')\n        const html2pdf = html2pdfModule.default\n        \n        await html2pdf().from(tempContainer).set(options).save()\n        \n        // \n        document.body.removeChild(tempContainer)\n        \n        loading.close()\n        ElMessage.success('PDF')\n      } catch (error) {\n        console.error('PDF:', error)\n        loading.close()\n        ElMessage.error('PDF: ' + (error.message || ''))\n      }\n    }\n    \n    // Word\n    const exportToWord = async (doc) => {\n      if (!doc) {\n        ElMessage.error('')\n        return\n      }\n      \n      const loading = ElLoading.service({\n        lock: true,\n        text: '...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      \n      try {\n        // \n        const response = await getDocumentDetail(doc.id)\n        const documentContent = response.data.content\n        \n        if (!documentContent) {\n          loading.close()\n          ElMessage.error('')\n          return\n        }\n        \n        const docTitle = doc.title || ''\n        const filename = `${docTitle}.doc`\n        \n        // \n        const contentContainer = document.createElement('div')\n        contentContainer.innerHTML = documentContent\n        \n        // \n        loading.setText('Word...')\n        \n        // WordHTML\n        const msWordHtml = `\n          <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" \n                xmlns:w=\"urn:schemas-microsoft-com:office:word\" \n                xmlns=\"http://www.w3.org/TR/REC-html40\">\n          <head>\n            <meta charset=\"utf-8\">\n            <title>${docTitle}</title>\n            <style>\n              body { font-family: SimSun, Arial, sans-serif; margin: 1cm; }\n              img { max-width: 100%; height: auto; }\n              p { margin: 0; padding: 0; }\n              h1 { font-size: 18pt; }\n              h2 { font-size: 16pt; }\n              h3 { font-size: 14pt; }\n              table { border-collapse: collapse; width: 100%; }\n              td, th { border: 1px solid #000; padding: 5px; }\n            </style>\n          </head>\n          <body>\n            <h1>${docTitle}</h1>\n            ${contentContainer.innerHTML}\n          </body>\n          </html>\n        `\n        \n        // file-saver\n        const FileSaver = await import('file-saver')\n        const saveAs = FileSaver.saveAs || FileSaver.default\n        const blob = new Blob([msWordHtml], { type: 'application/msword' })\n        saveAs(blob, filename)\n        \n        loading.close()\n        ElMessage.success('Word')\n      } catch (error) {\n        console.error('Word:', error)\n        loading.close()\n        ElMessage.error(`Word: ${error.message || ''}`)\n      }\n    }\n    \n    const shareDocument = async (doc) => {\n      selectedDocument.value = doc\n      \n      // \n      shareLoading.value = true\n      \n      try {\n        // API\n        const result = await userApi.getCompanyUsers()\n        \n        if (result.success && Array.isArray(result.data)) {\n          // ID\n          const currentUserJson = localStorage.getItem('user')\n          let currentUserId = null\n          if (currentUserJson) {\n            const currentUser = JSON.parse(currentUserJson)\n            currentUserId = currentUser.id\n          }\n          \n          // \n          availableUsers.value = result.data\n            .filter(user => user.id !== currentUserId)\n            .map(user => ({\n              id: user.id,\n              username: user.name || user.username || user.email || `${user.id}`\n            }))\n          \n          console.log(':', availableUsers.value)\n        } else {\n          ElMessage.warning(': ' + (result.message || ''))\n          availableUsers.value = []\n        }\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.warning('')\n        availableUsers.value = []\n      } finally {\n        // \n        shareLoading.value = false\n        \n        // \n        shareMethod.value = 'permission'\n        shareFormat.value = 'pdf'\n        selectedUsers.value = []\n        selectedChatUsers.value = []\n        \n        // \n        shareDialogVisible.value = true\n      }\n    }\n    \n    const confirmShare = async () => {\n      // \n      if (shareMethod.value === 'permission') {\n        if (!selectedDocument.value || selectedUsers.value.length === 0) {\n          ElMessage.warning('')\n          return\n        }\n        \n        shareLoading.value = true\n        try {\n          await apiShareDocument(selectedDocument.value.id, selectedUsers.value)\n          ElMessage.success('')\n          shareDialogVisible.value = false\n        } catch (error) {\n          console.error('', error)\n          ElMessage.error('')\n        } finally {\n          shareLoading.value = false\n        }\n      } \n      // \n      else if (shareMethod.value === 'chat') {\n        if (!selectedDocument.value || selectedChatUsers.value.length === 0) {\n          ElMessage.warning('')\n          return\n        }\n        \n        shareLoading.value = true\n        try {\n          // \n          const currentUserJson = localStorage.getItem('user')\n          let currentUserId = null\n          if (currentUserJson) {\n            const currentUser = JSON.parse(currentUserJson)\n            currentUserId = currentUser.id\n          }\n          \n          if (!currentUserId) {\n            ElMessage.error('')\n            shareLoading.value = false\n            return\n          }\n          \n          // \n          const docResponse = await getDocumentDetail(selectedDocument.value.id);\n          const currentDoc = docResponse.data;\n          \n          if (!currentDoc || !currentDoc.content) {\n            ElMessage.error('')\n            shareLoading.value = false\n            return\n          }\n          \n          // \n          const loading = ElLoading.service({\n            lock: true,\n            text: `${shareFormat.value === 'pdf' ? 'PDF' : 'Word'}...`,\n            background: 'rgba(255, 255, 255, 0.7)'\n          });\n          \n          try {\n            // \n            const docTitle = currentDoc.title || '';\n            const documentContent = currentDoc.content;\n            \n            // \n            const tempContainer = document.createElement('div');\n            tempContainer.innerHTML = documentContent;\n            tempContainer.className = 'temp-export-container';\n            document.body.appendChild(tempContainer);\n            \n            let documentFile = null;\n            let fileName = docTitle;\n            let fileType = '';\n            \n            if (shareFormat.value === 'pdf') {\n              fileName += '.pdf';\n              fileType = 'application/pdf';\n              \n              loading.setText('PDF...');\n              \n              // html2pdf.js\n              const html2pdfModule = await import('html2pdf.js');\n              const html2pdf = html2pdfModule.default;\n              \n              const options = {\n                margin: [15, 15, 15, 15],\n                filename: fileName,\n                image: { type: 'jpeg', quality: 0.98 },\n                html2canvas: { scale: 2, useCORS: true },\n                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n              };\n              \n              // PDFBlob\n              documentFile = await html2pdf().from(tempContainer).set(options).outputPdf('blob');\n            }\n            else {\n              fileName += '.doc';\n              fileType = 'application/msword';\n              \n              loading.setText('Word...');\n              \n              // WordHTML\n              const msWordHtml = `\n                <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" \n                      xmlns:w=\"urn:schemas-microsoft-com:office:word\" \n                      xmlns=\"http://www.w3.org/TR/REC-html40\">\n                <head>\n                  <meta charset=\"utf-8\">\n                  <title>${docTitle}</title>\n                  <style>\n                    body { font-family: SimSun, Arial, sans-serif; margin: 1cm; }\n                    img { max-width: 100%; height: auto; }\n                    p { margin: 0; padding: 0; }\n                    h1 { font-size: 18pt; }\n                    h2 { font-size: 16pt; }\n                    h3 { font-size: 14pt; }\n                    table { border-collapse: collapse; width: 100%; }\n                    td, th { border: 1px solid #000; padding: 5px; }\n                  </style>\n                </head>\n                <body>\n                  <h1>${docTitle}</h1>\n                  ${tempContainer.innerHTML}\n                </body>\n                </html>\n              `;\n              \n              // Blob\n              documentFile = new Blob([msWordHtml], { type: fileType });\n            }\n            \n            // \n            document.body.removeChild(tempContainer);\n            \n            // \n            loading.setText('...');\n            const sessionsResponse = await getChatSessions();\n            let chatSessions = [];\n            \n            // API\n            if (sessionsResponse && sessionsResponse.data && Array.isArray(sessionsResponse.data)) {\n              chatSessions = sessionsResponse.data;\n            } else if (sessionsResponse && sessionsResponse.results && Array.isArray(sessionsResponse.results)) {\n              chatSessions = sessionsResponse.results;\n            }\n            \n            console.log(` ${chatSessions.length} `);\n            loading.setText('...');\n            \n            // IDMapuserId -> chatId\n            const userSessionMap = new Map();\n            \n            // \n            for (const userId of selectedChatUsers.value) {\n              // \n              const existingSession = chatSessions.find(session => \n                session.participants.length === 2 && \n                session.participants.some(p => p.id === userId) &&\n                session.participants.some(p => p.id === currentUserId)\n              );\n              \n              if (existingSession) {\n                userSessionMap.set(userId, existingSession.id);\n                console.log(`${userId}: ${existingSession.id}`);\n              }\n            }\n            \n            // \n            const newSessionPromises = [];\n            for (const userId of selectedChatUsers.value) {\n              if (!userSessionMap.has(userId)) {\n                newSessionPromises.push(\n                  createChatSession({\n                    participant_ids: [currentUserId, userId],\n                    title: ''\n                  }).then(response => {\n                    if (response && response.data && response.data.id) {\n                      userSessionMap.set(userId, response.data.id);\n                      console.log(`${userId}: ${response.data.id}`);\n                    } else {\n                      console.error(':', response);\n                      return null;\n                    }\n                  }).catch(error => {\n                    console.error(`${userId}:`, error);\n                    return null;\n                  })\n                );\n              }\n            }\n            \n            // \n            if (newSessionPromises.length > 0) {\n              loading.setText(` ${newSessionPromises.length} ...`);\n              await Promise.all(newSessionPromises);\n            }\n            \n            // \n            loading.setText('...');\n            const sendPromises = [];\n            \n            // \n            for (const userId of selectedChatUsers.value) {\n              const chatId = userSessionMap.get(userId);\n              if (!chatId) {\n                console.error(`${userId}`);\n                continue;\n              }\n              \n              // FormData\n              const formData = new FormData();\n              formData.append('chat', chatId);\n              formData.append('message_type', 'file');\n              formData.append('content', `${shareFormat.value === 'pdf' ? 'PDF' : 'Word'}: ${docTitle}`);\n              \n              // BlobFile - File\n              const file = new File([documentFile], fileName, { type: fileType });\n              formData.append('file', file);\n              \n              // \n              sendPromises.push(\n                request({\n                  url: '/api/chat/messages/',\n                  method: 'post',\n                  data: formData,\n                  headers: {\n                    'Content-Type': 'multipart/form-data'\n                  },\n                  timeout: 30000 // \n                }).then(() => {\n                  return { userId, success: true };\n                }).catch(error => {\n                  console.error(` ${userId} :`, error);\n                  return { userId, success: false, error };\n                })\n              );\n            }\n            \n            // \n            const sendResults = await Promise.all(sendPromises);\n            const successCount = sendResults.filter(result => result.success).length;\n            \n            if (successCount > 0) {\n              ElMessage.success(` ${successCount}/${selectedChatUsers.value.length} `);\n              shareDialogVisible.value = false;\n            } else {\n              ElMessage.error('');\n            }\n          } catch (error) {\n            console.error(':', error);\n            ElMessage.error('');\n          } finally {\n            loading.close();\n          }\n        } catch (error) {\n          console.error(':', error);\n          ElMessage.error('');\n        } finally {\n          shareLoading.value = false;\n        }\n      }\n    }\n    \n    const deleteDocument = (doc) => {\n      selectedDocument.value = doc\n      deleteDialogVisible.value = true\n    }\n    \n    const confirmDelete = async () => {\n      if (!selectedDocument.value) return\n      \n      deleteLoading.value = true\n      try {\n        // ID\n        const deletedDocId = selectedDocument.value.id;\n        const deletedDocCategoryId = selectedDocument.value.category?.id;\n        \n        // \n        deleteDialogVisible.value = false;\n        \n        // \n        await apiDeleteDocument(deletedDocId)\n        ElMessage.success('')\n        \n        // \n        selectedDocument.value = null;\n        \n        // \n        if (window.localStorage) {\n          try {\n            // \n            localStorage.removeItem(`doc_cache_${deletedDocId}`);\n            localStorage.removeItem(`recent_docs_cache`);\n            localStorage.removeItem(`doc_list_cache`);\n          } catch (e) {\n            console.error(':', e);\n          }\n        }\n        \n        // \n        refreshTrigger.value = Date.now();\n        \n        // Vue \n        documents.value = [...documents.value.filter(doc => doc.id !== deletedDocId)];\n        recentDocuments.value = [...recentDocuments.value.filter(doc => doc.id !== deletedDocId)];\n        sharedDocuments.value = [...sharedDocuments.value.filter(doc => doc.id !== deletedDocId)];\n        \n        // \n        await forceUpdate();\n        \n        // \n        if (deletedDocCategoryId) {\n          const category = documentCategories.value.find(c => c.id === deletedDocCategoryId);\n          if (category && category.document_count > 0) {\n            category.document_count--;\n          }\n        }\n        \n        // DOM\n        await nextTick();\n        \n        // \n        if (router.currentRoute.value.name === 'SmartDocDetail') {\n          console.log('');\n          \n          // \n          await reloadAllData();\n          \n          // replace\n          router.replace({ \n            name: 'SmartDoc',\n            query: { _refresh: Date.now() } // \n          });\n        } else {\n          // \n          await refreshData();\n        }\n      } catch (error) {\n        console.error('', error);\n        ElMessage.error('');\n        // \n        deleteDialogVisible.value = false;\n      } finally {\n        deleteLoading.value = false;\n      }\n    }\n    \n    const viewAllDocuments = (type) => {\n      if (type === 'recent') {\n        // SmartDocList\n        router.push({ name: 'SmartDoc' }).then(() => {\n          setTimeout(() => {\n            const docSection = document.querySelector('.section');\n            if (docSection) {\n              docSection.scrollIntoView({ behavior: 'smooth' });\n            }\n          }, 300);\n        });\n      }\n    }\n    \n    const selectCategory = (category) => {\n      console.log(':', category);\n      \n      // category\n      let categoryId;\n      if (category === 'all') {\n        categoryId = 'all';\n      } else if (typeof category === 'string') {\n        categoryId = category;\n      } else if (typeof category === 'object' && category !== null) {\n        categoryId = category.id.toString();\n      }\n      \n      console.log('ID:', categoryId);\n      \n      // \n      if (categoryId === searchCategory.value) {\n        console.log('');\n        return;\n      }\n      \n      // \n      searchCategory.value = categoryId;\n      \n      // \n      documents.value = [];\n      createLoading.value = true;\n      \n      // \n      page.value = 1;\n      hasMore.value = true;\n      \n      // \n      setTimeout(async () => {\n        try {\n          // \n          await fetchDocuments(true);\n        } catch (error) {\n          console.error(':', error);\n          ElMessage.error('');\n        } finally {\n          createLoading.value = false;\n        }\n        \n        // \n        const docCards = document.querySelectorAll('.doc-card');\n        if (docCards && docCards.length > 0) {\n          docCards.forEach((card, index) => {\n            if (card) {\n              card.style.animationDelay = `${index * 50}ms`;\n              card.classList.remove('fadeIn');\n              setTimeout(() => {\n                if (card) {\n                  card.classList.add('fadeIn');\n                }\n              }, 10);\n            }\n          });\n        }\n      }, 300);\n    };\n\n    // \n    const getSelectedCategoryColor = () => {\n      if (searchCategory.value === 'all') return '#409EFF';\n      const selectedCategory = documentCategories.value.find(c => c.id.toString() === searchCategory.value);\n      return selectedCategory?.color || '#67C23A';\n    };\n\n    // \n    const getSelectedCategoryName = () => {\n      if (searchCategory.value === 'all') return '';\n      const selectedCategory = documentCategories.value.find(c => c.id.toString() === searchCategory.value);\n      return selectedCategory?.name || '';\n    };\n    \n    const manageCategories = () => {\n      categoryDialogVisible.value = true\n      resetCategoryForm()\n    }\n    \n    const editCategory = (category) => {\n      editingCategory.value = { ...category }\n    }\n    \n    const resetCategoryForm = () => {\n      editingCategory.value = {\n        id: '',\n        name: '',\n        color: '#409EFF',\n        description: ''\n      }\n      if (categoryFormRef.value) {\n        categoryFormRef.value.resetFields()\n      }\n    }\n    \n    const submitCategory = async () => {\n      if (!categoryFormRef.value) return\n      \n      await categoryFormRef.value.validate(async (valid) => {\n        if (valid) {\n          categoryLoading.value = true\n          try {\n            const categoryData = {\n              name: editingCategory.value.name,\n              color: editingCategory.value.color,\n              description: editingCategory.value.description || ''\n            }\n            \n            if (editingCategory.value.id) {\n              // \n              await updateDocumentCategory(editingCategory.value.id, categoryData)\n              ElMessage.success('')\n            } else {\n              // \n              await createDocumentCategory(categoryData)\n              ElMessage.success('')\n            }\n            \n            // \n            fetchDocumentCategories()\n            resetCategoryForm()\n          } catch (error) {\n            console.error(':', error)\n            ElMessage.error('')\n          } finally {\n            categoryLoading.value = false\n          }\n        }\n      })\n    }\n    \n    const deleteCategory = (category) => {\n      if (category.document_count > 0) {\n        ElMessage.warning('')\n        return\n      }\n      \n      ElMessageBox.confirm(\n        `\"${category.name}\"`,\n        '',\n        {\n          confirmButtonText: '',\n          cancelButtonText: '',\n          type: 'warning'\n        }\n      ).then(async () => {\n        try {\n          await deleteDocumentCategory(category.id)\n          ElMessage.success('')\n          fetchDocumentCategories()\n        } catch (error) {\n          console.error(':', error)\n          ElMessage.error('')\n        }\n      }).catch(() => {})\n    }\n    \n    const formatDate = (dateString) => {\n      const date = new Date(dateString)\n      const now = new Date()\n      \n      // \n      if (date.toDateString() === now.toDateString()) {\n        return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n      }\n      \n      // \n      const yesterday = new Date(now)\n      yesterday.setDate(now.getDate() - 1)\n      if (date.toDateString() === yesterday.toDateString()) {\n        return ''\n      }\n      \n      // \n      const weekDays = ['', '', '', '', '', '', '']\n      const diffDays = Math.round((now - date) / (1000 * 60 * 60 * 24))\n      if (diffDays < 7) {\n        return weekDays[date.getDay()]\n      }\n      \n      // \n      return date.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' })\n    }\n    \n    const resetCategoryFilter = () => {\n      searchCategory.value = 'all'\n      page.value = 1\n      fetchDocuments(true)\n    }\n    \n    // \n    onActivated(() => {\n      console.log('SmartDoc');\n      reloadAllData();\n    });\n\n    // \n    const reloadAllData = async () => {\n      page.value = 1\n      try {\n        console.log('...')\n        createLoading.value = true\n        \n        // \n        const timestamp = Date.now();\n        \n        // \n        try {\n          if (window.localStorage) {\n            // \n            localStorage.removeItem('doc_list_cache');\n            localStorage.removeItem('recent_docs_cache');\n            localStorage.removeItem('doc_categories_cache');\n          }\n        } catch (e) {\n          console.error(':', e);\n        }\n        \n        // \n        await fetchDocumentCategories(timestamp)\n        \n        // \n        await Promise.all([\n          fetchDocuments(true, false, timestamp),\n          fetchRecentDocuments(true, timestamp),\n          fetchSharedDocuments(timestamp)\n        ])\n        \n        console.log('', {\n          : documentCategories.value.length,\n          : documents.value.length,\n          : recentDocuments.value.length,\n          : sharedDocuments.value.length,\n          : totalCount.value,\n        })\n        \n        // \n        await forceUpdate()\n        \n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      } finally {\n        createLoading.value = false\n      }\n    }\n\n    // \n    provide('reloadDocuments', reloadAllData);\n    \n    // \n    watch(() => route.query._refresh, (newVal) => {\n      if (newVal) {\n        console.log(':', newVal);\n        refreshTrigger.value = Date.now();\n        reloadAllData();\n      }\n    });\n\n    // \n    watch(() => route.path, (newPath, oldPath) => {\n      console.log(':', oldPath, '->', newPath);\n      if (newPath === '/smartdoc' && oldPath && oldPath.startsWith('/smartdoc/')) {\n        // \n        console.log('');\n        refreshTrigger.value = Date.now();\n        reloadAllData();\n      }\n    });\n\n    // \n    const refreshData = async () => {\n      page.value = 1\n      await reloadAllData()\n      if (proxy && proxy.$forceUpdate) {\n        proxy.$forceUpdate()\n      }\n    }\n\n    //  - \n    const onPageChange = (newPage) => {\n      console.log(` - : ${newPage}`);\n    }\n    \n    // \n    watch(() => page.value, async (newPage, oldPage) => {\n      console.log(`: ${oldPage} -> ${newPage}`);\n      \n      if (newPage === oldPage) return;\n      \n      try {\n        // \n        createLoading.value = true;\n        \n        // hasMore\n        hasMore.value = true;\n        \n        // \n        await fetchDocuments(false, false, Date.now());\n        \n        // \n        const docSection = document.querySelector('.section');\n        if (docSection) {\n          docSection.scrollIntoView({ behavior: 'smooth' });\n        }\n      } catch (error) {\n        console.error(':', error);\n        ElMessage.error('');\n      } finally {\n        createLoading.value = false;\n      }\n    });\n\n    // \n    const loadMoreDocuments = () => {\n      if (loadingMore.value || !hasMore.value) return\n      page.value++\n      fetchDocuments(false, true)\n    }\n\n    // \n    onMounted(() => {\n      console.log('SmartDocmounted');\n      \n      // URL_refresh\n      const refreshParam = route.query._refresh;\n      if (refreshParam) {\n        console.log('URL:', refreshParam);\n        // \n        refreshTrigger.value = Date.now();\n        // DOM\n        setTimeout(() => {\n          reloadAllData();\n        }, 10);\n      } else {\n        // \n        reloadAllData();\n      }\n    })\n    \n    const handleImportWord = () => {\n      // input\n      const fileInput = document.createElement('input');\n      fileInput.type = 'file';\n      fileInput.accept = '.docx,.doc';\n      fileInput.style.display = 'none';\n      document.body.appendChild(fileInput);\n      \n      // \n      fileInput.addEventListener('change', async (event) => {\n        if (event.target.files.length > 0) {\n          const file = event.target.files[0];\n          \n          // \n          const loadingInstance = ElLoading.service({\n            fullscreen: true,\n            text: 'Word...',\n            background: 'rgba(255, 255, 255, 0.8)',\n            lock: true // \n          });\n          \n          try {\n            // FormData\n            const formData = new FormData();\n            formData.append('file', file);\n            \n            // API\n            const response = await importWordDocument(formData);\n            \n            if (response && response.id) {\n              // \n              await reloadAllData();\n              \n              // \n              ElMessage.success('Word');\n              \n              // \n              setTimeout(() => {\n                // \n                router.push({\n                  name: 'SmartDocDetail',\n                  params: { id: response.id },\n                  query: { _refresh: Date.now() } // \n                });\n              }, 1000);\n            } else {\n              ElMessage.error('' + (response?.detail || ''));\n            }\n          } catch (error) {\n            console.error('Word:', error);\n            ElMessage.error('Word: ' + (error.message || ''));\n          } finally {\n            // \n            setTimeout(() => {\n              loadingInstance.close();\n              document.body.removeChild(fileInput);\n            }, 500);\n          }\n        }\n      });\n      \n      // \n      fileInput.click();\n    }\n    \n    return {\n      documents,\n      recentDocuments,\n      sharedDocuments,\n      documentCategories,\n      searchQuery,\n      searchCategory,\n      totalDocuments,\n      recentEditCount,\n      newDocumentDialogVisible,\n      shareDialogVisible,\n      deleteDialogVisible,\n      documentCreateType,\n      newDocumentForm,\n      aiDocumentForm,\n      blankFormRules,\n      aiFormRules,\n      blankFormRef,\n      aiFormRef,\n      selectedDocument,\n      selectedUsers,\n      availableUsers,\n      createLoading,\n      shareLoading,\n      deleteLoading,\n      createNewDocument,\n      submitNewDocument,\n      openDocument,\n      editDocument,\n      submitEditDocument,\n      exportDocument,\n      shareDocument,\n      confirmShare,\n      deleteDocument,\n      confirmDelete,\n      viewAllDocuments,\n      formatDate,\n      categoryDialogVisible,\n      editingCategory,\n      categoryFormRef,\n      categoryLoading,\n      categoryFormRules,\n      editCategory,\n      resetCategoryForm,\n      submitCategory,\n      deleteCategory,\n      resetCategoryFilter,\n      selectCategory,\n      getSelectedCategoryColor,\n      getSelectedCategoryName,\n      manageCategories,\n      reloadAllData,\n      refreshData,\n      refreshTrigger,\n      hasMore,\n      loadingMore,\n      loadMoreDocuments,\n      exportToPdf,\n      exportToWord,\n      // \n      editDialogVisible,\n      editDocumentForm,\n      editFormRef,\n      editLoading,\n      editFormRules,\n      // \n      onPageChange,\n      page,\n      pageSize,\n      totalCount,\n      // \n      $_isDev,\n      // API\n      fetchDocuments,\n      // \n      shareMethod,\n      shareFormat,\n      selectedChatUsers,\n      handleImportWord\n    }\n  }\n}\n</script>\n\n<style scoped>\n.smartdoc-home-container {\n  padding: 20px;\n  background-color: var(--el-bg-color-page);\n}\n\n/*  */\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n\n.page-title {\n  font-size: 24px;\n  font-weight: 600;\n  margin: 0;\n  color: var(--el-text-color-primary);\n}\n\n.page-description {\n  color: var(--el-text-color-secondary);\n  margin: 4px 0 0 0;\n}\n\n.right-section {\n  display: flex;\n  gap: 16px;\n  align-items: center;\n}\n\n.search-controls {\n  display: flex;\n  gap: 16px;\n  align-items: center;\n}\n\n.search-input {\n  width: 240px;\n}\n\n/*  */\n.stats-cards {\n  display: flex;\n  gap: 16px;\n  margin-bottom: 24px;\n}\n\n.stat-card {\n  flex: 1;\n  transition: all 0.3s;\n  background-color: var(--el-bg-color-overlay);\n  border-color: var(--el-border-color-lighter);\n}\n\n.stat-card:hover {\n  transform: translateY(-5px);\n  box-shadow: var(--el-box-shadow-light);\n}\n\n.stat-content {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n}\n\n.stat-icon {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 16px;\n  font-size: 24px;\n  color: white;\n}\n\n.doc-icon {\n  background-color: #409EFF;\n}\n\n.edit-icon {\n  background-color: #67C23A;\n}\n\n.share-icon {\n  background-color: #E6A23C;\n}\n\n.stat-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.stat-value {\n  font-size: 24px;\n  font-weight: 600;\n  margin-bottom: 4px;\n  color: var(--el-text-color-primary);\n}\n\n.stat-label {\n  font-size: 14px;\n  color: var(--el-text-color-secondary);\n}\n\n/*  */\n.section {\n  margin-bottom: 32px;\n}\n\n/*  */\n.category-section {\n  margin-bottom: 16px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n\n.section-header h3 {\n  font-size: 18px;\n  font-weight: 600;\n  margin: 0;\n  color: #303133;\n}\n\n.section-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.filter-tag {\n  background-color: #f0f2f5;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 13px;\n  color: #606266;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n/*  */\n.document-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 20px;\n  margin-bottom: 30px;\n}\n\n.doc-card {\n  height: 220px;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s;\n  position: relative;\n  overflow: hidden;\n  background-color: var(--el-bg-color-overlay);\n  border-color: var(--el-border-color-lighter);\n}\n\n.doc-card:hover {\n  transform: translateY(-5px);\n  box-shadow: var(--el-box-shadow-light);\n}\n\n.doc-card:hover .doc-actions {\n  opacity: 1;\n  transform: translateY(0);\n}\n\n.doc-card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 12px;\n}\n\n.doc-info {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 8px;\n}\n\n.doc-type-tag {\n  font-size: 12px;\n  color: #606266;\n  background-color: #f5f7fa;\n  padding: 2px 8px;\n  border-radius: 4px;\n  white-space: nowrap;\n}\n\n.doc-category-tag {\n  font-size: 12px;\n  color: white;\n  padding: 2px 8px;\n  border-radius: 4px;\n  white-space: nowrap;\n  display: inline-flex;\n  align-items: center;\n}\n\n.doc-title {\n  margin: 0 0 12px 0;\n  font-size: 16px;\n  font-weight: 600;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  color: var(--el-text-color-primary);\n}\n\n.doc-preview {\n  font-size: 14px;\n  color: var(--el-text-color-regular);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  margin-bottom: 12px;\n  line-height: 1.5;\n}\n\n.doc-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 0 4px;\n  border-top: 1px solid var(--el-border-color-lighter);\n  margin-top: auto;\n  position: relative;\n  z-index: 2;\n}\n\n.doc-time {\n  font-size: 13px;\n  color: var(--el-text-color-secondary);\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-weight: 500;\n}\n\n.doc-actions {\n  display: flex;\n  gap: 8px;\n  position: relative;\n  opacity: 0;\n  transform: translateY(10px);\n  transition: all 0.3s ease;\n}\n\n.new-doc-card {\n  border: 2px dashed var(--el-border-color);\n  background-color: var(--el-fill-color-light);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.new-doc-card:hover {\n  border-color: var(--el-color-primary);\n  color: var(--el-color-primary);\n  background-color: var(--el-color-primary-light-9);\n}\n\n.new-doc-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  color: var(--el-text-color-secondary);\n}\n\n.new-doc-content .el-icon {\n  font-size: 32px;\n}\n\n/*  */\n.category-cards {\n  display: flex;\n  gap: 16px;\n  overflow-x: auto;\n  padding-bottom: 8px;\n}\n\n.category-card {\n  min-width: 180px;\n  height: 80px;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  transition: all 0.3s;\n  border-radius: 8px;\n  padding: 12px 16px;\n  border: 2px solid transparent;\n  position: relative;\n  overflow: hidden;\n  background-color: var(--el-fill-color-light);\n}\n\n.category-card:hover {\n  transform: translateY(-4px);\n  box-shadow: var(--el-box-shadow-light);\n  background-color: var(--el-color-primary-light-9);\n}\n\n.category-active {\n  transform: translateY(-2px);\n  box-shadow: var(--el-box-shadow-light);\n  border-color: var(--el-color-primary);\n  background-color: var(--el-color-primary-light-9);\n}\n\n.category-selected-indicator {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 3px;\n  background-color: var(--el-color-primary);\n  transition: all 0.3s;\n}\n\n.category-icon {\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  color: white;\n  margin-right: 12px;\n  transition: all 0.3s;\n}\n\n.category-active .category-icon {\n  transform: scale(1.1);\n}\n\n.category-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.category-info h4 {\n  margin: 0 0 4px 0;\n  font-size: 15px;\n  font-weight: 500;\n  color: var(--el-text-color-primary);\n  transition: all 0.3s;\n}\n\n.category-active .category-info h4 {\n  color: var(--el-color-primary);\n  font-weight: 600;\n}\n\n.category-count {\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n}\n\n.mt-4 {\n  margin-top: 16px;\n}\n\n.form-tip {\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n  margin-top: 4px;\n}\n\n.category-management {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.category-list {\n  margin-bottom: 20px;\n}\n\n.category-form {\n  margin-top: 20px;\n}\n\n.color-preview {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  border-radius: 4px;\n  margin-right: 8px;\n  vertical-align: middle;\n}\n\n.color-value {\n  margin-left: 12px;\n  color: var(--el-text-color-regular);\n}\n\n.category-select {\n  width: 200px;\n}\n\n.doc-menu {\n  color: var(--el-text-color-secondary);\n  cursor: pointer;\n  position: relative;\n}\n\n/*  */\n.filter-status-bar {\n  background-color: var(--el-color-primary-light-9);\n  padding: 12px 20px;\n  margin-bottom: 20px;\n  border-radius: 8px;\n  transition: all 0.3s ease;\n  animation: slideDown 0.3s ease-in-out;\n  box-shadow: var(--el-box-shadow-light);\n  border-left: 4px solid var(--el-color-primary);\n  position: relative;\n  overflow: hidden;\n}\n\n/*  */\n:deep(.dark .filter-status-bar) {\n  background-color: var(--el-color-primary-dark-2);\n  border-left-color: var(--el-color-primary-light-3);\n}\n\n.filter-bar-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.filter-title {\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: var(--el-text-color-primary);\n}\n\n.filter-category {\n  padding: 4px 10px;\n  border-radius: 4px;\n  color: white;\n  font-size: 14px;\n  font-weight: 600;\n}\n\n.filter-actions {\n  display: flex;\n  align-items: center;\n}\n\n.section {\n  margin-bottom: 32px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n\n.section-header h3 {\n  font-size: 18px;\n  font-weight: 600;\n  margin: 0;\n  color: var(--el-text-color-primary);\n}\n\n.section-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n/*  */\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.empty-state {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 200px;\n}\n\n.loading-state {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 200px;\n}\n\n.pagination-container {\n  display: flex;\n  justify-content: center;\n  margin-top: 24px;\n  flex-direction: column;\n  align-items: center;\n  position: relative;\n  z-index: 20;\n}\n\n.pagination-container :deep(.el-pagination) {\n  user-select: none;\n}\n\n.pagination-container :deep(.el-pagination button),\n.pagination-container :deep(.el-pagination .el-pager li) {\n  cursor: pointer !important;\n  z-index: 30;\n  position: relative;\n}\n\n.pagination-debug {\n  margin-top: 8px;\n  color: #909399;\n  font-size: 12px;\n  background-color: #f5f7fa;\n  padding: 4px 8px;\n  border-radius: 4px;\n}\n\n/* CSS */\n.btn-container {\n  position: relative;\n  z-index: 5;\n}\n\n.doc-actions .el-button {\n  position: relative;\n  z-index: 5;\n}\n\n/*  */\n:deep(.el-dropdown-menu) {\n  z-index: 3000 !important;\n}\n\n/*  */\n.card-content-area {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  z-index: 1;\n  min-height: 0;\n}\n\n.filter-controls {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n/*  */\n.document-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 20px;\n  margin-bottom: 30px;\n}\n\n.doc-card {\n  animation: fadeIn 0.4s ease-in-out;\n}\n\n.fadeIn {\n  animation: fadeIn 0.4s ease-in-out;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/*  */\n.temp-export-container {\n  position: fixed;\n  top: -9999px;\n  left: -9999px;\n  width: 210mm; /* A4 */\n  background: var(--el-bg-color);\n  padding: 20px;\n  z-index: -1;\n  font-family: SimSun, Arial, sans-serif;\n  font-size: 12pt;\n  line-height: 1.5;\n}\n\n.temp-export-container img {\n  max-width: 100%;\n  height: auto;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}