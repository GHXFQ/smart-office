{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue","mtime":1749798028648},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1746431219000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLnNvbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuZGVsZXRlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmhhcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5zaXplLmpzIjsKaW1wb3J0IHsgcmVmLCBuZXh0VGljaywgY29tcHV0ZWQsIG9uTW91bnRlZCwgd2F0Y2ggfSBmcm9tICd2dWUnOwppbXBvcnQgeyBVcGxvYWRGaWxsZWQsIERvY3VtZW50LCBDbG9zZSwgQ2hlY2ssIERlbGV0ZSwgRGF0YUFuYWx5c2lzLCBDcHUsIE1hZ2ljU3RpY2ssIENoYXRMaW5lU3F1YXJlLCBGb2xkLCBFeHBhbmQgfSBmcm9tICdAZWxlbWVudC1wbHVzL2ljb25zLXZ1ZSc7CmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7CmltcG9ydCB7IG1hcmtlZCB9IGZyb20gJ21hcmtlZCc7CmltcG9ydCB7IEVsTWVzc2FnZSwgRWxUb29sdGlwIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IHsgYWlDaGF0V2l0aERvY3VtZW50c1N0cmVhbSwgZ2V0QUlDaGF0U2Vzc2lvbnMsIGdldEFJQ2hhdFNlc3Npb24gfSBmcm9tICdAL2FwaS9haSc7CmZ1bmN0aW9uIGZvcm1hdFNpemUoc2l6ZSkgewogIGlmIChzaXplIDwgMTAyNCkgcmV0dXJuIHNpemUgKyAnQic7CiAgaWYgKHNpemUgPCAxMDI0ICogMTAyNCkgcmV0dXJuIChzaXplIC8gMTAyNCkudG9GaXhlZCgxKSArICdLQic7CiAgcmV0dXJuIChzaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMSkgKyAnTUInOwp9CmZ1bmN0aW9uIGdldEV4dChuYW1lKSB7CiAgY29uc3QgYXJyID0gbmFtZS5zcGxpdCgnLicpOwogIHJldHVybiBhcnIubGVuZ3RoID4gMSA/IGFyclthcnIubGVuZ3RoIC0gMV0udG9Mb3dlckNhc2UoKSA6ICcnOwp9CmZ1bmN0aW9uIGdldEZpbGVMYWJlbCh0eXBlLCBleHQpIHsKICBjb25zdCBleHRfbG93ZXIgPSBleHQudG9Mb3dlckNhc2UoKTsKICBpZiAodHlwZS5zdGFydHNXaXRoKCdpbWFnZS8nKSkgcmV0dXJuICflm77niYcnOwogIGlmIChleHRfbG93ZXIgPT09ICdwZGYnKSByZXR1cm4gJ1BERic7CiAgaWYgKFsnY3N2JywgJ3hscycsICd4bHN4J10uaW5jbHVkZXMoZXh0X2xvd2VyKSkgcmV0dXJuICfooajmoLwnOwogIGlmIChbJ2RvYycsICdkb2N4J10uaW5jbHVkZXMoZXh0X2xvd2VyKSkgcmV0dXJuICfmlofmoaMnOwogIGlmIChleHRfbG93ZXIgPT09ICdtZCcpIHJldHVybiAnTWFya2Rvd24nOwogIGlmIChleHRfbG93ZXIgPT09ICd0eHQnKSByZXR1cm4gJ+aWh+acrCc7CiAgcmV0dXJuIGV4dF9sb3dlci50b1VwcGVyQ2FzZSgpOwp9CmZ1bmN0aW9uIGdldEZpbGVCZyhleHQpIHsKICBjb25zdCBleHRfbG93ZXIgPSBleHQudG9Mb3dlckNhc2UoKTsKICBpZiAoZXh0X2xvd2VyID09PSAncGRmJykgcmV0dXJuICcjZjg3MTcxJzsgLy8g57qi6ImyCiAgaWYgKFsnY3N2JywgJ3hscycsICd4bHN4J10uaW5jbHVkZXMoZXh0X2xvd2VyKSkgcmV0dXJuICcjMzRkMzk5JzsgLy8g57u/6ImyCiAgaWYgKFsnZG9jJywgJ2RvY3gnXS5pbmNsdWRlcyhleHRfbG93ZXIpKSByZXR1cm4gJyM2MGE1ZmEnOyAvLyDok53oibIKICBpZiAoZXh0X2xvd2VyID09PSAnbWQnKSByZXR1cm4gJyNhNzhiZmEnOyAvLyDntKvoibIKICBpZiAoZXh0X2xvd2VyID09PSAndHh0JykgcmV0dXJuICcjZmJiZjI0JzsgLy8g6buE6ImyCiAgcmV0dXJuICcjYTViNGZjJzsgLy8g6buY6K6k5reh57Sr6ImyCn0KZnVuY3Rpb24gZXNjYXBlSHRtbChodG1sKSB7CiAgcmV0dXJuIGh0bWwucmVwbGFjZSgvWyY8PiInXS9nLCBmdW5jdGlvbiAobSkgewogICAgcmV0dXJuIHsKICAgICAgJyYnOiAnJmFtcDsnLAogICAgICAnPCc6ICcmbHQ7JywKICAgICAgJz4nOiAnJmd0OycsCiAgICAgICciJzogJyZxdW90OycsCiAgICAgICInIjogJyYjMzk7JwogICAgfVttXTsKICB9KTsKfQoKLy8g5qC85byP5YyW5pel5pyf5pe26Ze0CmZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZVRpbWVTdHIpIHsKICBpZiAoIWRhdGVUaW1lU3RyKSByZXR1cm4gJyc7CiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVUaW1lU3RyKTsKICByZXR1cm4gYCR7ZGF0ZS5nZXRNb250aCgpICsgMX3mnIgke2RhdGUuZ2V0RGF0ZSgpfeaXpSAke2RhdGUuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7ZGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7Cn0KZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEYXNoYm9hcmQnLAogIGNvbXBvbmVudHM6IHsKICAgIFVwbG9hZEZpbGxlZCwKICAgIERvY3VtZW50LAogICAgQ2xvc2UsCiAgICBDaGVjaywKICAgIERlbGV0ZSwKICAgIEVsVG9vbHRpcCwKICAgIERhdGFBbmFseXNpcywKICAgIENwdSwKICAgIE1hZ2ljU3RpY2ssCiAgICBDaGF0TGluZVNxdWFyZSwKICAgIEZvbGQsCiAgICBFeHBhbmQKICB9LAogIHNldHVwKCkgewogICAgY29uc3QgaW5wdXQgPSByZWYoJycpOwogICAgY29uc3QgbWVzc2FnZXMgPSByZWYoW3sKICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsCiAgICAgIGNvbnRlbnQ6ICfmgqjlpb3vvIzmiJHmmK/mgqjnmoRBSeWKqeaJi++8jOacieS7gOS5iOWPr+S7peW4ruaCqO+8nycsCiAgICAgIHJhd0NvbnRlbnQ6ICfmgqjlpb3vvIzmiJHmmK/mgqjnmoRBSeWKqeaJi++8jOacieS7gOS5iOWPr+S7peW4ruaCqO+8nycsCiAgICAgIHR5cGU6ICd0ZXh0JwogICAgfV0pOwogICAgY29uc3QgY2hhdEJvZHkgPSByZWYobnVsbCk7CiAgICBjb25zdCBmaWxlSW5wdXQgPSByZWYobnVsbCk7CiAgICBjb25zdCBzZWxlY3RlZEZpbGVzID0gcmVmKFtdKTsKICAgIGNvbnN0IGxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgcHJvY2Vzc2luZ0ZpbGVzID0gY29tcHV0ZWQoKCkgPT4gewogICAgICByZXR1cm4gc2VsZWN0ZWRGaWxlcy52YWx1ZS5zb21lKGZpbGUgPT4gZmlsZS5zdGF0dXMgIT09ICdjb21wbGV0ZWQnICYmIGZpbGUuc3RhdHVzICE9PSAnZmFpbGVkJyk7CiAgICB9KTsKICAgIGNvbnN0IGNoYXRJZCA9IHJlZihudWxsKTsgLy8g5a2Y5YKo5b2T5YmN6IGK5aSpSUTvvIznlKjkuo7nu7TmjIHlr7nor53kuIrkuIvmlocKICAgIGNvbnN0IHNob3dDb250ZXh0QmFyID0gY29tcHV0ZWQoKCkgPT4gY2hhdElkLnZhbHVlICE9PSBudWxsKTsKICAgIGNvbnN0IHVzZXJBdmF0YXJVcmwgPSByZWYobnVsbCk7IC8vIOWtmOWCqOeUqOaIt+WktOWDj1VSTAogICAgY29uc3Qgc2VhcmNoTWV0aG9kID0gcmVmKCdsb2NhbCcpOyAvLyDmlrDlop7vvJrmkJzntKLmlrnms5UsIOm7mOiupOS4umxvY2FsCiAgICBjb25zdCBjaGF0TW9kZSA9IHJlZignYWdlbnQnKTsgLy8gYWdlbnQg5oiWIGtub3dsZWRnZV9iYXNlCiAgICBjb25zdCByZXRyaWV2YWxTY29wZSA9IHJlZignbG9jYWwnKTsgLy8gJ2xvY2FsJywgJ2dsb2JhbCcsIG9yICdiYXNpYycKCiAgICAvLyDmt7vliqDlj5jph4/mnaXlrZjlgqjlvZPliY3or7fmsYLnmoTmjqfliLblmagKICAgIGNvbnN0IGN1cnJlbnRSZXF1ZXN0Q29udHJvbGxlciA9IHJlZihudWxsKTsKCiAgICAvLyDlj7PkvqfpnaLmnb/nm7jlhbPnirbmgIEKICAgIGNvbnN0IHJpZ2h0UGFuZWxDb2xsYXBzZWQgPSByZWYoZmFsc2UpOwogICAgY29uc3QgY2hhdFNlc3Npb25zID0gcmVmKFtdKTsKCiAgICAvLyDojrflj5bogYrlpKnkvJror53liJfooagKICAgIGNvbnN0IGZldGNoQ2hhdFNlc3Npb25zID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEFJQ2hhdFNlc3Npb25zKCk7CiAgICAgICAgaWYgKHJlcy5kYXRhICYmIEFycmF5LmlzQXJyYXkocmVzLmRhdGEpKSB7CiAgICAgICAgICBjaGF0U2Vzc2lvbnMudmFsdWUgPSByZXMuZGF0YTsKICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLnJlc3VsdHMgJiYgQXJyYXkuaXNBcnJheShyZXMuZGF0YS5yZXN1bHRzKSkgewogICAgICAgICAgY2hhdFNlc3Npb25zLnZhbHVlID0gcmVzLmRhdGEucmVzdWx0czsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W6IGK5aSp5Lya6K+d5YiX6KGo5aSx6LSlOicsIGVycm9yKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDliIfmjaLogYrlpKnkvJror50KICAgIGNvbnN0IHN3aXRjaENoYXRTZXNzaW9uID0gYXN5bmMgc2Vzc2lvbklkID0+IHsKICAgICAgaWYgKHNlc3Npb25JZCA9PT0gY2hhdElkLnZhbHVlKSByZXR1cm47CiAgICAgIHRyeSB7CiAgICAgICAgbG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0QUlDaGF0U2Vzc2lvbihzZXNzaW9uSWQpOwogICAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgICAgY2hhdElkLnZhbHVlID0gc2Vzc2lvbklkOwogICAgICAgICAgLy8g5Yqg6L296IGK5aSp5Y6G5Y+yCiAgICAgICAgICBpZiAocmVzLmRhdGEubWVzc2FnZXMgJiYgQXJyYXkuaXNBcnJheShyZXMuZGF0YS5tZXNzYWdlcykpIHsKICAgICAgICAgICAgbWVzc2FnZXMudmFsdWUgPSByZXMuZGF0YS5tZXNzYWdlcy5tYXAobXNnID0+IHsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgcm9sZTogbXNnLnJvbGUsCiAgICAgICAgICAgICAgICBjb250ZW50OiBtc2cuY29udGVudCwKICAgICAgICAgICAgICAgIHJhd0NvbnRlbnQ6IG1zZy5jb250ZW50LAogICAgICAgICAgICAgICAgdHlwZTogbXNnLnR5cGUgfHwgJ3RleHQnCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluiBiuWkqeS8muivneivpuaDheWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliIfmjaLogYrlpKnkvJror53lpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgLy8g55uR5ZCs6IGK5aSpSUTlj5jljJbvvIzmm7TmlrDkvJror53liJfooagKICAgIHdhdGNoKGNoYXRJZCwgbmV3Q2hhdElkID0+IHsKICAgICAgaWYgKG5ld0NoYXRJZCkgewogICAgICAgIGZldGNoQ2hhdFNlc3Npb25zKCk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIOiOt+WPlueUqOaIt+S/oeaBrwogICAgY29uc3QgZ2V0VXNlckluZm8gPSBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICcvYXBpL2F1dGgvdXNlcnMvbWUvJywKICAgICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygn55So5oi35L+h5oGv5a6M5pW05ZON5bqUOicsIHJlcyk7CgogICAgICAgIC8vIOWwneivleS7juWTjeW6lOeahOS4jeWQjOS9jee9ruiOt+WPluWktOWDj1VSTAogICAgICAgIGxldCBhdmF0YXJVcmwgPSBudWxsOwogICAgICAgIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5kYXRhICYmIHJlcy5kYXRhLmRhdGEuYXZhdGFyKSB7CiAgICAgICAgICBhdmF0YXJVcmwgPSByZXMuZGF0YS5kYXRhLmF2YXRhcjsKICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLmF2YXRhcikgewogICAgICAgICAgYXZhdGFyVXJsID0gcmVzLmRhdGEuYXZhdGFyOwogICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEpIHsKICAgICAgICAgIC8vIOmBjeWOhnJlcy5kYXRh5p+l5om+YXZhdGFy5a2X5q61CiAgICAgICAgICBjb25zdCBmaW5kQXZhdGFyID0gb2JqID0+IHsKICAgICAgICAgICAgaWYgKCFvYmogfHwgdHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAoJ2F2YXRhcicgaW4gb2JqKSByZXR1cm4gb2JqLmF2YXRhcjsKCiAgICAgICAgICAgIC8vIOmAkuW9kuaQnOe0ouaJgOacieWtkOWvueixoQogICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHsKICAgICAgICAgICAgICBpZiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZmluZEF2YXRhcihvYmpba2V5XSk7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH07CiAgICAgICAgICBhdmF0YXJVcmwgPSBmaW5kQXZhdGFyKHJlcy5kYXRhKTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5sb2coJ+aJvuWIsOeahOWktOWDj1VSTDonLCBhdmF0YXJVcmwpOwogICAgICAgIGlmIChhdmF0YXJVcmwpIHsKICAgICAgICAgIC8vIOWmguaenOaYr+ebuOWvuei3r+W+hO+8jOa3u+WKoOWfuuehgFVSTAogICAgICAgICAgaWYgKCFhdmF0YXJVcmwuc3RhcnRzV2l0aCgnaHR0cCcpICYmICFhdmF0YXJVcmwuc3RhcnRzV2l0aCgnZGF0YTonKSkgewogICAgICAgICAgICAvLyDnoa7kv53lqpLkvZNVUkzmraPnoa7mi7zmjqUKICAgICAgICAgICAgY29uc3QgYmFzZVVybCA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW47CiAgICAgICAgICAgIGlmIChhdmF0YXJVcmwuc3RhcnRzV2l0aCgnLycpKSB7CiAgICAgICAgICAgICAgdXNlckF2YXRhclVybC52YWx1ZSA9IGAke2Jhc2VVcmx9JHthdmF0YXJVcmx9YDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB1c2VyQXZhdGFyVXJsLnZhbHVlID0gYCR7YmFzZVVybH0vJHthdmF0YXJVcmx9YDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdXNlckF2YXRhclVybC52YWx1ZSA9IGF2YXRhclVybDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCflpITnkIblkI7nmoTnlKjmiLflpLTlg49VUkw6JywgdXNlckF2YXRhclVybC52YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfnlKjmiLfkv6Hmga/kuK3msqHmnInmib7liLDlpLTlg486JywgcmVzLmRhdGEpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bnlKjmiLfkv6Hmga/lpLHotKU6JywgZXJyb3IpOwogICAgICB9CiAgICB9OwogICAgY29uc3Qgc2Nyb2xsVG9Cb3R0b20gPSAoKSA9PiB7CiAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICBpZiAoY2hhdEJvZHkudmFsdWUpIGNoYXRCb2R5LnZhbHVlLnNjcm9sbFRvcCA9IGNoYXRCb2R5LnZhbHVlLnNjcm9sbEhlaWdodDsKICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgdXBsb2FkRmlsZUFuZEdldElkID0gYXN5bmMgZmlsZSA9PiB7CiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUucmF3RmlsZSk7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5qCH6K6w5paH5Lu25Li65LiK5Lyg5LitCiAgICAgICAgZmlsZS5wcm9ncmVzcyA9IDA7CiAgICAgICAgZmlsZS5zdGF0dXMgPSAncGVuZGluZyc7CiAgICAgICAgbGV0IHNtb290aFRpbWVyID0gbnVsbDsKICAgICAgICBsZXQgbGFzdFByb2dyZXNzID0gMDsKICAgICAgICBsZXQgdXBsb2FkRmluaXNoZWQgPSBmYWxzZTsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy9hcGkvYWkvZG9jdW1lbnRzL3VwbG9hZC8nLAogICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICBkYXRhOiBmb3JtRGF0YSwKICAgICAgICAgIG9uVXBsb2FkUHJvZ3Jlc3M6IHByb2dyZXNzRXZlbnQgPT4gewogICAgICAgICAgICBjb25zdCBwZXJjZW50Q29tcGxldGVkID0gTWF0aC5yb3VuZChwcm9ncmVzc0V2ZW50LmxvYWRlZCAqIDEwMCAvIHByb2dyZXNzRXZlbnQudG90YWwpOwogICAgICAgICAgICBpZiAocGVyY2VudENvbXBsZXRlZCA8IDEwMCkgewogICAgICAgICAgICAgIGZpbGUucHJvZ3Jlc3MgPSBwZXJjZW50Q29tcGxldGVkOwogICAgICAgICAgICAgIGxhc3RQcm9ncmVzcyA9IHBlcmNlbnRDb21wbGV0ZWQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8g5LiK5Lyg556s6Ze05a6M5oiQ77yM5bmz5ruR6YCS5aKe5YiwOTUlCiAgICAgICAgICAgICAgaWYgKCF1cGxvYWRGaW5pc2hlZCkgewogICAgICAgICAgICAgICAgdXBsb2FkRmluaXNoZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGV0IGZha2VQcm9ncmVzcyA9IGxhc3RQcm9ncmVzczsKICAgICAgICAgICAgICAgIHNtb290aFRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICBmYWtlUHJvZ3Jlc3MgKz0gMzsKICAgICAgICAgICAgICAgICAgaWYgKGZha2VQcm9ncmVzcyA+PSA5NSkgewogICAgICAgICAgICAgICAgICAgIGZha2VQcm9ncmVzcyA9IDk1OwogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoc21vb3RoVGltZXIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGZpbGUucHJvZ3Jlc3MgPSBmYWtlUHJvZ3Jlc3M7CiAgICAgICAgICAgICAgICB9LCAyMCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgLy8g5LiK5Lyg5a6M5oiQ5ZCO77yM54q25oCB5pS55Li65aSE55CG5Lit77yM5LiN6YeN572u6L+b5bqm5p2hCiAgICAgICAgaWYgKHNtb290aFRpbWVyKSBjbGVhckludGVydmFsKHNtb290aFRpbWVyKTsKICAgICAgICBpZiAoZmlsZS5wcm9ncmVzcyA8IDk1KSBmaWxlLnByb2dyZXNzID0gOTU7CiAgICAgICAgZmlsZS5zdGF0dXMgPSAncHJvY2Vzc2luZyc7CiAgICAgICAgZmlsZS5kb2N1bWVudElkID0gcmVzLmRhdGEuaWQ7CiAgICAgICAgcG9sbERvY3VtZW50U3RhdHVzKGZpbGUpOwogICAgICAgIHJldHVybiByZXMuZGF0YS5pZDsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBmaWxlLnN0YXR1cyA9ICdmYWlsZWQnOwogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aWh+S7tuS4iuS8oOWksei0pTonLCBlcnJvcik7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDkuIrkvKDmlofku7YgJHtmaWxlLm5hbWV9IOWksei0pTogJHtlcnJvci5tZXNzYWdlIHx8ICfmnI3liqHlmajplJnor68nfWApOwogICAgICB9CiAgICB9OwoKICAgIC8vIOi9ruivouaWh+aho+WkhOeQhueKtuaAgQogICAgY29uc3QgcG9sbERvY3VtZW50U3RhdHVzID0gYXN5bmMgKGZpbGUsIGludGVydmFsID0gMTAwMCkgPT4gewogICAgICBpZiAoIWZpbGUuZG9jdW1lbnRJZCkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoewogICAgICAgICAgdXJsOiBgL2FwaS9haS9kb2N1bWVudHMvJHtmaWxlLmRvY3VtZW50SWR9L2AsCiAgICAgICAgICBtZXRob2Q6ICdnZXQnCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpIHsKICAgICAgICAgIGZpbGUucHJvZ3Jlc3MgPSAxMDA7CiAgICAgICAgICBmaWxlLnN0YXR1cyA9ICdjb21wbGV0ZWQnOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuc3RhdHVzID09PSAnZmFpbGVkJykgewogICAgICAgICAgZmlsZS5zdGF0dXMgPSAnZmFpbGVkJzsKICAgICAgICAgIGZpbGUucHJvZ3Jlc3MgPSAwOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuc3RhdHVzID09PSAncHJvY2Vzc2luZycpIHsKICAgICAgICAgIC8vIOWkhOeQhuS4re+8jOWinuWKoOi/m+W6pu+8iOS7heWcqOWwj+S6jjk15pe26YCS5aKe77yJCiAgICAgICAgICBpZiAoZmlsZS5wcm9ncmVzcyA8IDk1KSB7CiAgICAgICAgICAgIGZpbGUucHJvZ3Jlc3MgPSBNYXRoLm1pbihmaWxlLnByb2dyZXNzICsgNSwgOTUpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g57un57ut6L2u6K+iCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwb2xsRG9jdW1lbnRTdGF0dXMoZmlsZSwgaW50ZXJ2YWwpLCBpbnRlcnZhbCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyDlh7rplJnml7bvvIznu6fnu63ova7or6LvvIzkvYbkuI3mm7TmlrDov5vluqYKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHBvbGxEb2N1bWVudFN0YXR1cyhmaWxlLCBpbnRlcnZhbCksIGludGVydmFsKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGNsZWFyQ2hhdCA9ICgpID0+IHsKICAgICAgLy8g5riF56m65a+56K+d5Y6G5Y+y77yM5byA5aeL5paw55qE5a+56K+dCiAgICAgIGNoYXRJZC52YWx1ZSA9IG51bGw7CiAgICAgIG1lc3NhZ2VzLnZhbHVlID0gW3sKICAgICAgICByb2xlOiAnYXNzaXN0YW50JywKICAgICAgICBjb250ZW50OiAn5oKo5aW977yM5oiR5piv5oKo55qEQUnliqnmiYvvvIzmnInku4DkuYjlj6/ku6XluK7mgqjvvJ8nLAogICAgICAgIHJhd0NvbnRlbnQ6ICfmgqjlpb3vvIzmiJHmmK/mgqjnmoRBSeWKqeaJi++8jOacieS7gOS5iOWPr+S7peW4ruaCqO+8nycsCiAgICAgICAgdHlwZTogJ3RleHQnCiAgICAgIH1dOwogICAgICAvLyDmuIXnqbrpgInmi6nnmoTmlofku7YKICAgICAgc2VsZWN0ZWRGaWxlcy52YWx1ZSA9IFtdOwogICAgICAvLyDliLfmlrDljoblj7LorrDlvZUKICAgICAgZmV0Y2hDaGF0U2Vzc2lvbnMoKTsKICAgIH07CgogICAgLy8g5Y+R6YCB5raI5oGvCiAgICBmdW5jdGlvbiBzZW5kTXNnKCkgewogICAgICBpZiAoIWlucHV0LnZhbHVlLnRyaW0oKSAmJiBzZWxlY3RlZEZpbGVzLnZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfor7fovpPlhaXlhoXlrrnmiJbkuIrkvKDmlofku7YnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOWmguaenOi/mOacieaWh+S7tuWcqOWkhOeQhuS4re+8jOS4jeWFgeiuuOWPkemAgQogICAgICBpZiAocHJvY2Vzc2luZ0ZpbGVzLnZhbHVlKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+aWh+S7tuato+WcqOWkhOeQhuS4re+8jOivt+eojeWAmeWGjeivlScpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g5aaC5p6c5pyJ5LiK5LiA5Liq6K+35rGC5q2j5Zyo6L+b6KGM77yM5YWI5Y+W5raI5a6DCiAgICAgIGlmIChjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUpIHsKICAgICAgICBjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUuYWJvcnQoKTsKICAgICAgICBjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUgPSBudWxsOwogICAgICB9CgogICAgICAvLyDmt7vliqDnlKjmiLfmtojmga/liLDliJfooagKICAgICAgY29uc3QgdXNlck1zZyA9IHsKICAgICAgICByb2xlOiAndXNlcicsCiAgICAgICAgY29udGVudDogaW5wdXQudmFsdWUsCiAgICAgICAgdHlwZTogJ3RleHQnCiAgICAgIH07CiAgICAgIG1lc3NhZ2VzLnZhbHVlLnB1c2godXNlck1zZyk7CgogICAgICAvLyDlpoLmnpzmnInmlofku7bvvIzmt7vliqDmlofku7bmtojmga8KICAgICAgaWYgKHNlbGVjdGVkRmlsZXMudmFsdWUubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IGZpbGVNc2cgPSB7CiAgICAgICAgICByb2xlOiAndXNlcicsCiAgICAgICAgICBjb250ZW50OiBg5LiK5Lyg5LqGJHtzZWxlY3RlZEZpbGVzLnZhbHVlLmxlbmd0aH3kuKrmlofku7ZgLAogICAgICAgICAgdHlwZTogJ2ZpbGUnLAogICAgICAgICAgZmlsZXM6IHNlbGVjdGVkRmlsZXMudmFsdWUubWFwKGYgPT4gKHsKICAgICAgICAgICAgbmFtZTogZi5uYW1lLAogICAgICAgICAgICBzaXplOiBmLnNpemUsCiAgICAgICAgICAgIGV4dDogZi5leHQKICAgICAgICAgIH0pKQogICAgICAgIH07CiAgICAgICAgbWVzc2FnZXMudmFsdWUucHVzaChmaWxlTXNnKTsKICAgICAgfQoKICAgICAgLy8g5re75Yqg56m655qE5Yqp5omL5raI5oGv77yM55So5LqO5rWB5byP5pu05pawCiAgICAgIGNvbnN0IGFzc2lzdGFudE1zZyA9IHsKICAgICAgICByb2xlOiAnYXNzaXN0YW50JywKICAgICAgICBjb250ZW50OiAnJywKICAgICAgICB0eXBlOiAndGV4dCcsCiAgICAgICAgc3RyZWFtaW5nOiB0cnVlCiAgICAgIH07CiAgICAgIG1lc3NhZ2VzLnZhbHVlLnB1c2goYXNzaXN0YW50TXNnKTsKCiAgICAgIC8vIOa4heepuui+k+WFpeahhuWSjOaWh+S7tuWIl+ihqAogICAgICBjb25zdCBjdXJyZW50SW5wdXQgPSBpbnB1dC52YWx1ZTsKICAgICAgaW5wdXQudmFsdWUgPSAnJzsKCiAgICAgIC8vIOWtmOWCqOW9k+WJjeW3sue7j+S4iuS8oOeahOaWh+S7tklECiAgICAgIGNvbnN0IGN1cnJlbnREb2N1bWVudElkcyA9IHNlbGVjdGVkRmlsZXMudmFsdWUubWFwKGYgPT4gZi5kb2NJZCkuZmlsdGVyKEJvb2xlYW4pOwogICAgICBzZWxlY3RlZEZpbGVzLnZhbHVlID0gW107CgogICAgICAvLyDmu5rliqjliLDlupXpg6gKICAgICAgc2Nyb2xsVG9Cb3R0b20oKTsKCiAgICAgIC8vIOiuvue9ruWKoOi9veeKtuaAgQogICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKCiAgICAgIC8vIOWHhuWkh+ivt+axguWPguaVsAogICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IHsKICAgICAgICBtZXNzYWdlOiBjdXJyZW50SW5wdXQsCiAgICAgICAgY2hhdF9pZDogY2hhdElkLnZhbHVlLAogICAgICAgIGRvY3VtZW50X2lkczogY3VycmVudERvY3VtZW50SWRzLAogICAgICAgIGNoYXRNb2RlOiBjaGF0TW9kZS52YWx1ZSwKICAgICAgICBzZWFyY2hfbWV0aG9kOiBzZWFyY2hNZXRob2QudmFsdWUKICAgICAgfTsKCiAgICAgIC8vIOS9v+eUqOa1geW8j0FQSei/m+ihjOivt+axggogICAgICBjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUgPSBhaUNoYXRXaXRoRG9jdW1lbnRzU3RyZWFtKHJlcXVlc3REYXRhLAogICAgICAvLyDmlbDmja7lnZflpITnkIblm57osIMKICAgICAgKGNodW5rLCBuZXdDaGF0SWQpID0+IHsKICAgICAgICAvLyDmtYHlvI/mm7TmlrDmnIDlkI7kuIDmnaHmtojmga/nmoTlhoXlrrkKICAgICAgICBjb25zdCBsYXN0TXNnID0gbWVzc2FnZXMudmFsdWVbbWVzc2FnZXMudmFsdWUubGVuZ3RoIC0gMV07CiAgICAgICAgaWYgKGxhc3RNc2cgJiYgbGFzdE1zZy5yb2xlID09PSAnYXNzaXN0YW50JyAmJiBsYXN0TXNnLnN0cmVhbWluZykgewogICAgICAgICAgLy8g5a2Y5YKo5Y6f5aeL5paH5pys5YaF5a65CiAgICAgICAgICBpZiAoIWxhc3RNc2cucmF3Q29udGVudCkgewogICAgICAgICAgICBsYXN0TXNnLnJhd0NvbnRlbnQgPSAnJzsKICAgICAgICAgIH0KICAgICAgICAgIC8vIOe0r+enr+WOn+Wni+aWh+acrAogICAgICAgICAgbGFzdE1zZy5yYXdDb250ZW50ICs9IGNodW5rOwoKICAgICAgICAgIC8vIOS9v+eUqG1hcmtlZOW6k+Wwhk1hcmtkb3du5qC85byP6L2s5o2i5Li6SFRNTO+8iOS4gOasoeaAp+i9rOaNouaVtOS4quWGheWuue+8iQogICAgICAgICAgbGFzdE1zZy5jb250ZW50ID0gbWFya2VkKGxhc3RNc2cucmF3Q29udGVudCk7CgogICAgICAgICAgLy8g5rua5Yqo5Yiw5bqV6YOo5Lul5pi+56S65paw5YaF5a65CiAgICAgICAgICBzY3JvbGxUb0JvdHRvbSgpOwogICAgICAgIH0KCiAgICAgICAgLy8g5aaC5p6c5ZON5bqU5Lit5YyF5ZCr5paw55qE6IGK5aSpSUTvvIzmm7TmlrBjaGF0SWQKICAgICAgICBpZiAobmV3Q2hhdElkICYmICFjaGF0SWQudmFsdWUpIHsKICAgICAgICAgIGNoYXRJZC52YWx1ZSA9IG5ld0NoYXRJZDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIOWujOaIkOWbnuiwgwogICAgICBuZXdDaGF0SWQgPT4gewogICAgICAgIC8vIOabtOaWsOacgOWQjuS4gOadoea2iOaBr++8jOenu+mZpHN0cmVhbWluZ+agh+iusAogICAgICAgIGNvbnN0IGxhc3RNc2cgPSBtZXNzYWdlcy52YWx1ZVttZXNzYWdlcy52YWx1ZS5sZW5ndGggLSAxXTsKICAgICAgICBpZiAobGFzdE1zZyAmJiBsYXN0TXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnKSB7CiAgICAgICAgICBsYXN0TXNnLnN0cmVhbWluZyA9IGZhbHNlOwoKICAgICAgICAgIC8vIOehruS/neacgOWQjuS4gOasoeWujOaVtOeahE1hcmtkb3du5riy5p+TCiAgICAgICAgICBpZiAobGFzdE1zZy5yYXdDb250ZW50KSB7CiAgICAgICAgICAgIGxhc3RNc2cuY29udGVudCA9IG1hcmtlZChsYXN0TXNnLnJhd0NvbnRlbnQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g6K6+572uY2hhdElk77yI5aaC5p6c5ZON5bqU5Lit5pyJ5paw55qE77yJCiAgICAgICAgaWYgKG5ld0NoYXRJZCkgewogICAgICAgICAgY2hhdElkLnZhbHVlID0gbmV3Q2hhdElkOwogICAgICAgIH0KCiAgICAgICAgLy8g5riF6ZmkbG9hZGluZ+eKtuaAgQogICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICBjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUgPSBudWxsOwogICAgICB9LAogICAgICAvLyDplJnor6/lm57osIMKICAgICAgZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+a1geW8j+ivt+axguWHuumUmTonLCBlcnJvcik7CgogICAgICAgIC8vIOabtOaWsOacgOWQjuS4gOadoea2iOaBr++8jOaYvuekuumUmeivrwogICAgICAgIGNvbnN0IGxhc3RNc2cgPSBtZXNzYWdlcy52YWx1ZVttZXNzYWdlcy52YWx1ZS5sZW5ndGggLSAxXTsKICAgICAgICBpZiAobGFzdE1zZyAmJiBsYXN0TXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnKSB7CiAgICAgICAgICBsYXN0TXNnLmNvbnRlbnQgPSAn5oqx5q2J77yM5ZON5bqU55Sf5oiQ6L+H56iL5Lit5Ye6546w6ZSZ6K+v77yM6K+356iN5ZCO6YeN6K+V44CCJzsKICAgICAgICAgIGxhc3RNc2cuc3RyZWFtaW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyDmuIXpmaRsb2FkaW5n54q25oCBCiAgICAgICAgbG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIGN1cnJlbnRSZXF1ZXN0Q29udHJvbGxlci52YWx1ZSA9IG51bGw7CgogICAgICAgIC8vIOaYvuekuumUmeivr+a2iOaBrwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign6K+35rGC5Ye66ZSZOiAnICsgKGVycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivrycpKTsKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCB0cmlnZ2VyRmlsZUlucHV0ID0gKCkgPT4gewogICAgICBpZiAoZmlsZUlucHV0LnZhbHVlKSBmaWxlSW5wdXQudmFsdWUudmFsdWUgPSAnJzsKICAgICAgZmlsZUlucHV0LnZhbHVlICYmIGZpbGVJbnB1dC52YWx1ZS5jbGljaygpOwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUZpbGVVcGxvYWQgPSBlID0+IHsKICAgICAgY29uc3QgZmlsZXMgPSBlLnRhcmdldC5maWxlczsKICAgICAgaWYgKCFmaWxlcyB8fCAhZmlsZXMubGVuZ3RoKSByZXR1cm47CgogICAgICAvLyDmlK/mjIHnmoTmlofku7bnsbvlnovphY3nva4KICAgICAgY29uc3QgYWxsb3dlZFR5cGVzID0gewogICAgICAgIC8vIOaWh+aho+exu+WeiwogICAgICAgICd0ZXh0L3BsYWluJzogJ3R4dCcsCiAgICAgICAgLy8gdHh05paH5Lu2CiAgICAgICAgJ2FwcGxpY2F0aW9uL3BkZic6ICdwZGYnLAogICAgICAgIC8vIHBkZuaWh+S7tgogICAgICAgICdhcHBsaWNhdGlvbi9tc3dvcmQnOiAnZG9jJywKICAgICAgICAvLyBkb2Pmlofku7YKICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnQnOiAnZG9jeCcsCiAgICAgICAgLy8gZG9jeOaWh+S7tgogICAgICAgICd0ZXh0L21hcmtkb3duJzogJ21kJywKICAgICAgICAvLyBtYXJrZG93buaWh+S7tgogICAgICAgICd0ZXh0L3gtbWFya2Rvd24nOiAnbWQnLAogICAgICAgIC8vIG1hcmtkb3du5paH5Lu25Y+Y5L2TCgogICAgICAgIC8vIOihqOagvOexu+WeiwogICAgICAgICd0ZXh0L2Nzdic6ICdjc3YnLAogICAgICAgIC8vIGNzduaWh+S7tgogICAgICAgICdhcHBsaWNhdGlvbi9jc3YnOiAnY3N2JywKICAgICAgICAvLyBjc3bmlofku7blj6bkuIDnp41NSU1FCiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCc6ICd4bHMnLAogICAgICAgIC8vIHhsc+aWh+S7tgogICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCc6ICd4bHN4JywKICAgICAgICAvLyB4bHN45paH5Lu2CgogICAgICAgIC8vIOWbvueJh+exu+WeiwogICAgICAgICdpbWFnZS9qcGVnJzogJ2pwZycsCiAgICAgICAgLy8ganBnL2pwZWflm77niYcKICAgICAgICAnaW1hZ2UvcG5nJzogJ3BuZycsCiAgICAgICAgLy8gcG5n5Zu+54mHCiAgICAgICAgJ2ltYWdlL2dpZic6ICdnaWYnLAogICAgICAgIC8vIGdpZuWbvueJhwogICAgICAgICdpbWFnZS9ibXAnOiAnYm1wJywKICAgICAgICAvLyBibXDlm77niYcKICAgICAgICAnaW1hZ2Uvd2VicCc6ICd3ZWJwJywKICAgICAgICAvLyB3ZWJw5Zu+54mHCiAgICAgICAgJ2ltYWdlL3N2Zyt4bWwnOiAnc3ZnJywKICAgICAgICAvLyBzdmfnn6Lph4/lm74KICAgICAgICAnaW1hZ2UvdGlmZic6ICd0aWZmJyAvLyB0aWZm5Zu+54mHCiAgICAgIH07CgogICAgICAvLyDmmL7npLrmlK/mjIHnmoTmlofku7bmoLzlvI/mj5DnpLoKICAgICAgY29uc3Qgc3VwcG9ydGVkRm9ybWF0cyA9ICfmlK/mjIHnmoTmlofku7bmoLzlvI86IHR4dCwgcGRmLCBkb2MsIGRvY3gsIG1kLCB4bHMsIHhsc3gsIGNzdiDlkozluLjop4Hlm77niYfmoLzlvI8nOwoKICAgICAgLy8g5qOA5p+l5q+P5Liq5paH5Lu2CiAgICAgIGNvbnN0IHZhbGlkRmlsZXMgPSBbXTsKICAgICAgbGV0IGhhc0ludmFsaWRGaWxlID0gZmFsc2U7CgogICAgICAvLyDmnInmlYjnmoTmlofku7bmianlsZXlkI3liJfooajvvIjkuI3ljLrliIblpKflsI/lhpnvvIkKICAgICAgY29uc3QgdmFsaWRFeHRlbnNpb25zID0gWyd0eHQnLCAncGRmJywgJ2RvYycsICdkb2N4JywgJ21kJywgJ3hscycsICd4bHN4JywgJ2NzdicsICdqcGcnLCAnanBlZycsICdwbmcnLCAnZ2lmJywgJ2JtcCcsICd3ZWJwJywgJ3N2ZycsICd0aWZmJ107CiAgICAgIEFycmF5LmZyb20oZmlsZXMpLmZvckVhY2goZmlsZSA9PiB7CiAgICAgICAgY29uc3QgZXh0ID0gZ2V0RXh0KGZpbGUubmFtZSkudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCBpc1ZhbGlkRXh0ZW5zaW9uID0gdmFsaWRFeHRlbnNpb25zLmluY2x1ZGVzKGV4dCk7CgogICAgICAgIC8vIOajgOafpU1JTUXnsbvlnovmiJbmianlsZXlkI3mmK/lkKbmnInmlYgKICAgICAgICBpZiAoYWxsb3dlZFR5cGVzW2ZpbGUudHlwZV0gfHwgaXNWYWxpZEV4dGVuc2lvbikgewogICAgICAgICAgY29uc3QgaWQgPSBmaWxlLm5hbWUgKyAnXycgKyBmaWxlLnNpemUgKyAnXycgKyBEYXRlLm5vdygpICsgTWF0aC5yYW5kb20oKTsKICAgICAgICAgIGlmIChmaWxlLnR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJykpIHsKICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGV2ID0+IHsKICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVzLnZhbHVlLnB1c2goewogICAgICAgICAgICAgICAgaWQsCiAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsCiAgICAgICAgICAgICAgICB0eXBlOiBmaWxlLnR5cGUsCiAgICAgICAgICAgICAgICB1cmw6IGV2LnRhcmdldC5yZXN1bHQsCiAgICAgICAgICAgICAgICBzaXplOiBmb3JtYXRTaXplKGZpbGUuc2l6ZSksCiAgICAgICAgICAgICAgICBleHQsCiAgICAgICAgICAgICAgICBsYWJlbDogZ2V0RmlsZUxhYmVsKGZpbGUudHlwZSwgZXh0KSwKICAgICAgICAgICAgICAgIGJnOiBnZXRGaWxlQmcoZXh0KSwKICAgICAgICAgICAgICAgIHJhd0ZpbGU6IGZpbGUsCiAgICAgICAgICAgICAgICBwcm9ncmVzczogMCwKICAgICAgICAgICAgICAgIHN0YXR1czogJ3JlYWR5JwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIOiHquWKqOS4iuS8oAogICAgICAgICAgICAgIHVwbG9hZEZpbGVBbmRHZXRJZChzZWxlY3RlZEZpbGVzLnZhbHVlW3NlbGVjdGVkRmlsZXMudmFsdWUubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMudmFsdWUucHVzaCh7CiAgICAgICAgICAgICAgaWQsCiAgICAgICAgICAgICAgbmFtZTogZmlsZS5uYW1lLAogICAgICAgICAgICAgIHR5cGU6IGZpbGUudHlwZSwKICAgICAgICAgICAgICB1cmwsCiAgICAgICAgICAgICAgc2l6ZTogZm9ybWF0U2l6ZShmaWxlLnNpemUpLAogICAgICAgICAgICAgIGV4dCwKICAgICAgICAgICAgICBsYWJlbDogZ2V0RmlsZUxhYmVsKGZpbGUudHlwZSwgZXh0KSwKICAgICAgICAgICAgICBiZzogZ2V0RmlsZUJnKGV4dCksCiAgICAgICAgICAgICAgcmF3RmlsZTogZmlsZSwKICAgICAgICAgICAgICBwcm9ncmVzczogMCwKICAgICAgICAgICAgICBzdGF0dXM6ICdyZWFkeScKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIOiHquWKqOS4iuS8oAogICAgICAgICAgICB1cGxvYWRGaWxlQW5kR2V0SWQoc2VsZWN0ZWRGaWxlcy52YWx1ZVtzZWxlY3RlZEZpbGVzLnZhbHVlLmxlbmd0aCAtIDFdKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhbGlkRmlsZXMucHVzaChzZWxlY3RlZEZpbGVzLnZhbHVlW3NlbGVjdGVkRmlsZXMudmFsdWUubGVuZ3RoIC0gMV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoYXNJbnZhbGlkRmlsZSA9IHRydWU7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoYOS4jeaUr+aMgeeahOaWh+S7tuexu+WeizogJHtmaWxlLm5hbWV9YCk7CiAgICAgICAgICBjb25zb2xlLndhcm4oYOaWh+S7tuexu+Wei+aLkue7nTogJHtmaWxlLm5hbWV9LCBNSU1FOiAke2ZpbGUudHlwZX0sIOaJqeWxleWQjTogJHtleHR9YCk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIOWcqOacieS4jeaUr+aMgeaWh+S7tuexu+Wei+aXtuaYvuekuuaUr+aMgeeahOagvOW8j+S/oeaBrwogICAgICBpZiAoaGFzSW52YWxpZEZpbGUpIHsKICAgICAgICBFbE1lc3NhZ2UuaW5mbyhzdXBwb3J0ZWRGb3JtYXRzKTsKICAgICAgfQoKICAgICAgLy8g5aaC5p6c5YWo6YOo5paH5Lu26YO95piv5pyJ5pWI55qE77yM5pi+56S65oiQ5Yqf5LiK5Lyg5o+Q56S6CiAgICAgIGlmICh2YWxpZEZpbGVzLmxlbmd0aCA+IDAgJiYgdmFsaWRGaWxlcy5sZW5ndGggPT09IGZpbGVzLmxlbmd0aCkgewogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKGDlt7Lmt7vliqAke3ZhbGlkRmlsZXMubGVuZ3RofeS4quaWh+S7tmApOwogICAgICB9CiAgICB9OwogICAgY29uc3QgcmVtb3ZlRmlsZSA9IGlkeCA9PiB7CiAgICAgIHNlbGVjdGVkRmlsZXMudmFsdWUuc3BsaWNlKGlkeCwgMSk7CiAgICB9OwoKICAgIC8vIG1hcmtlZOmFjee9ru+8muihqOagvOW4pui+ueahhivku6PnoIHlnZfnvo7ljJYr5aSN5Yi25oyJ6ZKuCiAgICBjb25zdCByZW5kZXJlciA9IG5ldyBtYXJrZWQuUmVuZGVyZXIoKTsKICAgIHJlbmRlcmVyLnRhYmxlID0gZnVuY3Rpb24gKGhlYWRlciwgYm9keSkgewogICAgICByZXR1cm4gYDx0YWJsZSBjbGFzcz0ib3BlbndlYnVpLW1kLXRhYmxlIj48dGhlYWQ+JHtoZWFkZXJ9PC90aGVhZD48dGJvZHk+JHtib2R5fTwvdGJvZHk+PC90YWJsZT5gOwogICAgfTsKICAgIHJlbmRlcmVyLmNvZGUgPSBmdW5jdGlvbiAoY29kZSwgaW5mb3N0cmluZywgZXNjYXBlZCkgewogICAgICBjb25zdCBjb2RlSWQgPSAnY29kZS0nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpOwogICAgICBsZXQgbGFuZyA9IChpbmZvc3RyaW5nIHx8ICcnKS5zcGxpdCgvXHMrLylbMF07CiAgICAgIGxldCBsYW5nTGFiZWwgPSBsYW5nID8gbGFuZyA6ICdjb2RlJzsKICAgICAgbGV0IGxhbmdDbGFzcyA9IGxhbmcgPyBgbGFuZ3VhZ2UtJHtsYW5nfWAgOiAnJzsKICAgICAgcmV0dXJuIGAKICAgICAgICA8ZGl2IGNsYXNzPSJvcGVud2VidWktbWQtY29kZS1ibG9jay1iZWF1dHkiPgogICAgICAgICAgPGRpdiBjbGFzcz0ib3BlbndlYnVpLW1kLWNvZGUtdG9vbGJhciI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJvcGVud2VidWktbWQtY29kZS1sYW5nIj4ke2xhbmdMYWJlbH08L3NwYW4+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im9wZW53ZWJ1aS1jb3B5LWJ0biIgZGF0YS1jbGlwYm9hcmQtdGFyZ2V0PSIjJHtjb2RlSWR9IiB0aXRsZT0i5aSN5Yi25Luj56CBIj7lpI3liLY8L2J1dHRvbj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPHByZSBjbGFzcz0ib3BlbndlYnVpLW1kLXByZSI+PGNvZGUgaWQ9IiR7Y29kZUlkfSIgY2xhc3M9IiR7bGFuZ0NsYXNzfSI+JHtlc2NhcGVkID8gY29kZSA6IGVzY2FwZUh0bWwoY29kZSl9PC9jb2RlPjwvcHJlPgogICAgICAgIDwvZGl2PgogICAgICBgOwogICAgfTsKICAgIG1hcmtlZC5zZXRPcHRpb25zKHsKICAgICAgYnJlYWtzOiB0cnVlLAogICAgICBnZm06IHRydWUsCiAgICAgIGhlYWRlcklkczogZmFsc2UsCiAgICAgIG1hbmdsZTogZmFsc2UsCiAgICAgIHJlbmRlcmVyCiAgICB9KTsKICAgIGNvbnN0IGhhbmRsZUF2YXRhckVycm9yID0gZSA9PiB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WktOWDj+WKoOi9veWksei0pTonLCBlLnRhcmdldC5zcmMpOwogICAgICBlLnRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICB1c2VyQXZhdGFyVXJsLnZhbHVlID0gbnVsbDsgLy8g6YeN572u5Li6bnVsbO+8jOaYvuekuum7mOiupOWktOWDjwogICAgfTsKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QgJiYgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVud2VidWktY29weS1idG4nKSkgewogICAgICAgICAgY29uc3QgY29kZUlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWNsaXBib2FyZC10YXJnZXQnKS5yZXBsYWNlKCcjJywgJycpOwogICAgICAgICAgY29uc3QgY29kZUVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb2RlSWQpOwogICAgICAgICAgaWYgKGNvZGVFbGVtKSB7CiAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGNvZGVFbGVtLmlubmVyVGV4dCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgZS50YXJnZXQuaW5uZXJUZXh0ID0gJ+W3suWkjeWItic7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBlLnRhcmdldC5pbm5lclRleHQgPSAn5aSN5Yi2JzsKICAgICAgICAgICAgICB9LCAxMjAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIOiOt+WPlueUqOaIt+WktOWDjwogICAgICBnZXRVc2VySW5mbygpOwoKICAgICAgLy8g6I635Y+W6IGK5aSp5Lya6K+d5YiX6KGoCiAgICAgIGZldGNoQ2hhdFNlc3Npb25zKCk7CgogICAgICAvLyDmt7vliqDpobXpnaLljbjovb3ml7bnmoTmuIXnkIYKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsICgpID0+IHsKICAgICAgICBpZiAoY3VycmVudFJlcXVlc3RDb250cm9sbGVyLnZhbHVlKSB7CiAgICAgICAgICBjdXJyZW50UmVxdWVzdENvbnRyb2xsZXIudmFsdWUuYWJvcnQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICBpbnB1dCwKICAgICAgbWVzc2FnZXMsCiAgICAgIHNlbmRNc2csCiAgICAgIGNoYXRCb2R5LAogICAgICBmaWxlSW5wdXQsCiAgICAgIHRyaWdnZXJGaWxlSW5wdXQsCiAgICAgIGhhbmRsZUZpbGVVcGxvYWQsCiAgICAgIHNlbGVjdGVkRmlsZXMsCiAgICAgIHJlbW92ZUZpbGUsCiAgICAgIFVwbG9hZEZpbGxlZCwKICAgICAgRG9jdW1lbnQsCiAgICAgIENsb3NlLAogICAgICBDaGVjaywKICAgICAgbG9hZGluZywKICAgICAgcHJvY2Vzc2luZ0ZpbGVzLAogICAgICBjbGVhckNoYXQsCiAgICAgIHNob3dDb250ZXh0QmFyLAogICAgICBjaGF0SWQsCiAgICAgIHVzZXJBdmF0YXJVcmwsCiAgICAgIGhhbmRsZUF2YXRhckVycm9yLAogICAgICBzZWFyY2hNZXRob2QsCiAgICAgIGNoYXRNb2RlLAogICAgICByZXRyaWV2YWxTY29wZSwKICAgICAgLy8g5Y+z5L6n6Z2i5p2/55u45YWzCiAgICAgIHJpZ2h0UGFuZWxDb2xsYXBzZWQsCiAgICAgIGNoYXRTZXNzaW9ucywKICAgICAgc3dpdGNoQ2hhdFNlc3Npb24sCiAgICAgIGZvcm1hdFRpbWUKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["ref","nextTick","computed","onMounted","watch","UploadFilled","Document","Close","Check","Delete","DataAnalysis","Cpu","MagicStick","ChatLineSquare","Fold","Expand","request","marked","ElMessage","ElTooltip","aiChatWithDocumentsStream","getAIChatSessions","getAIChatSession","formatSize","size","toFixed","getExt","name","arr","split","length","toLowerCase","getFileLabel","type","ext","ext_lower","startsWith","includes","toUpperCase","getFileBg","escapeHtml","html","replace","m","formatTime","dateTimeStr","date","Date","getMonth","getDate","getHours","toString","padStart","getMinutes","components","setup","input","messages","role","content","rawContent","chatBody","fileInput","selectedFiles","loading","processingFiles","value","some","file","status","chatId","showContextBar","userAvatarUrl","searchMethod","chatMode","retrievalScope","currentRequestController","rightPanelCollapsed","chatSessions","fetchChatSessions","res","data","Array","isArray","results","error","console","switchChatSession","sessionId","map","msg","newChatId","getUserInfo","url","method","log","avatarUrl","avatar","findAvatar","obj","key","result","baseUrl","window","location","origin","scrollToBottom","scrollTop","scrollHeight","uploadFileAndGetId","formData","FormData","append","rawFile","progress","smoothTimer","lastProgress","uploadFinished","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","fakeProgress","setInterval","clearInterval","documentId","id","pollDocumentStatus","Error","message","interval","min","setTimeout","e","clearChat","sendMsg","trim","warning","abort","userMsg","push","fileMsg","files","f","assistantMsg","streaming","currentInput","currentDocumentIds","docId","filter","Boolean","requestData","chat_id","document_ids","search_method","chunk","lastMsg","triggerFileInput","click","handleFileUpload","target","allowedTypes","supportedFormats","validFiles","hasInvalidFile","validExtensions","from","forEach","isValidExtension","now","random","reader","FileReader","onload","ev","label","bg","readAsDataURL","URL","createObjectURL","warn","info","success","removeFile","idx","splice","renderer","Renderer","table","header","body","code","infostring","escaped","codeId","substr","lang","langLabel","langClass","setOptions","breaks","gfm","headerIds","mangle","handleAvatarError","src","style","display","document","addEventListener","classList","contains","getAttribute","codeElem","getElementById","navigator","clipboard","writeText","innerText","then"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue"],"sourcesContent":["<template>\n  <div class=\"openwebui-chat-root\">\n    <div class=\"openwebui-chat-window\">\n      <div class=\"openwebui-chat-header\">\n        <span class=\"openwebui-title\">智慧办公助手</span>\n        <el-button type=\"link\" size=\"small\" @click=\"clearChat\" class=\"clear-chat-btn\">\n          <el-icon><Delete /></el-icon> 新对话\n        </el-button>\n      </div>\n      \n      <div class=\"openwebui-chat-container\">\n        <div class=\"openwebui-chat-body\" ref=\"chatBody\">\n          <div v-for=\"(msg, idx) in messages\" :key=\"idx\" :class=\"['openwebui-msg', msg.role]\">\n            <template v-if=\"msg.role==='assistant'\">\n              <div class=\"openwebui-avatar ai-avatar left-avatar\">\n                <svg viewBox=\"0 0 40 40\" width=\"36\" height=\"36\"><circle cx=\"20\" cy=\"20\" r=\"20\" fill=\"#2f54eb\"/><text x=\"50%\" y=\"55%\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"20\" font-family=\"Arial\" dy=\".3em\">🤖</text></svg>\n              </div>\n            </template>\n            <template v-if=\"msg.role==='user'\">\n              <div class=\"openwebui-avatar user-avatar right-avatar\">\n                <img v-if=\"userAvatarUrl\" :src=\"userAvatarUrl\" class=\"user-avatar-img\" alt=\"用户头像\" @error=\"handleAvatarError\" />\n                <svg v-else viewBox=\"0 0 40 40\" width=\"36\" height=\"36\"><circle cx=\"20\" cy=\"20\" r=\"20\" fill=\"#bbb\"/><text x=\"50%\" y=\"55%\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"20\" font-family=\"Arial\" dy=\".3em\">🧑</text></svg>\n              </div>\n            </template>\n            <div class=\"openwebui-msg-bubble\">\n              <template v-if=\"msg.type === 'text'\">\n                <span v-if=\"msg.role==='user'\">{{ msg.content }}</span>\n                <span v-else v-html=\"msg.content\"></span>\n                <span v-if=\"msg.streaming\" class=\"openwebui-cursor\"></span>\n                <div v-if=\"msg.source === 'knowledge_base'\" class=\"source-tag knowledge-base-tag\">\n                  <el-icon><DataAnalysis /></el-icon> 知识库\n                </div>\n                <div v-if=\"msg.source === 'general_ai'\" class=\"source-tag general-ai-tag\">\n                  <el-icon><Cpu /></el-icon> AI大模型\n                </div>\n              </template>\n              <template v-else-if=\"msg.type === 'file'\">\n                <div class=\"file-bubble-nest file-bubble-vertical\">\n                  <div v-for=\"file in msg.files\" :key=\"file.name + file.size\" class=\"file-message-card\">\n                    <div class=\"file-icon-area\">\n                      <img v-if=\"file.ext==='csv'\" src=\"https://cdn.jsdelivr.net/gh/file-icons/icons/svg/csv.svg\" class=\"file-icon-img\" />\n                      <el-icon v-else><Document /></el-icon>\n                    </div>\n                    <div class=\"file-info-area\">\n                      <div class=\"file-name\">{{ file.name }}</div>\n                      <div class=\"file-meta\">{{ file.ext.toUpperCase() }} · {{ file.size }}</div>\n                    </div>\n                  </div>\n                  <div class=\"file-desc-text\" v-if=\"msg.content\">{{ msg.content }}</div>\n                </div>\n              </template>\n            </div>\n          </div>\n        </div>\n        \n        <!-- 右侧面板 - 包含模式切换和历史记录 -->\n        <div class=\"openwebui-right-panel\" :class=\"{'collapsed': rightPanelCollapsed}\">\n          <div class=\"right-panel-header\">\n            <!-- 模式切换按钮 -->\n            <div class=\"right-panel-mode-controls\">\n              <el-radio-group v-model=\"chatMode\" size=\"default\">\n                <el-radio-button label=\"agent\">\n                  <el-icon><MagicStick /></el-icon> AI助手\n                </el-radio-button>\n                <el-radio-button label=\"knowledge_base\">\n                  <el-icon><DataAnalysis /></el-icon> 知识库\n                </el-radio-button>\n              </el-radio-group>\n            </div>\n            \n            <!-- 展开/收起按钮 -->\n            <el-button \n              circle\n              @click=\"rightPanelCollapsed = !rightPanelCollapsed\"\n              :title=\"rightPanelCollapsed ? '展开' : '收起'\"\n              class=\"collapse-button\"\n            >\n              <el-icon :size=\"16\">\n                <Expand v-if=\"!rightPanelCollapsed\" />\n                <Fold v-else />\n              </el-icon>\n            </el-button>\n          </div>\n          \n          <!-- 历史记录内容 -->\n          <div class=\"history-container\">\n            <h3 class=\"history-title\">历史记录</h3>\n            <div class=\"history-list\">\n              <div \n                v-for=\"(session, index) in chatSessions\" \n                :key=\"session.id\"\n                class=\"history-item\"\n                :class=\"{'active': session.id === chatId}\"\n                @click=\"switchChatSession(session.id)\"\n              >\n                <div class=\"history-item-icon\">\n                  <el-icon><ChatLineSquare /></el-icon>\n                </div>\n                <div class=\"history-item-content\">\n                  <div class=\"history-item-title\">{{ session.title || `对话 ${index + 1}` }}</div>\n                  <div class=\"history-item-time\">{{ formatTime(session.created_at) }}</div>\n                </div>\n              </div>\n              <div v-if=\"chatSessions.length === 0\" class=\"history-empty\">\n                暂无历史记录\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"openwebui-chat-footer\">\n        <!-- 预览区放在footer顶部 -->\n        <div v-if=\"selectedFiles.length\" class=\"openwebui-file-preview-bar\">\n          <div v-for=\"(file, idx) in selectedFiles\" :key=\"file.id\" class=\"openwebui-file-card\">\n            <div class=\"openwebui-file-thumb\">\n              <img v-if=\"file.type.startsWith('image/')\" :src=\"file.url\" class=\"openwebui-file-img\" />\n              <div v-else class=\"openwebui-file-icon\" :style=\"{background: file.bg}\">\n                <el-icon v-if=\"file.ext==='pdf'\"><Document /></el-icon>\n                <el-icon v-else-if=\"file.ext==='csv' || file.ext==='xls' || file.ext==='xlsx'\"><Document /></el-icon>\n                <el-icon v-else><Document /></el-icon>\n              </div>\n            </div>\n            <div class=\"openwebui-file-info\">\n              <div class=\"openwebui-file-name\" :title=\"file.name\">{{ file.name }}</div>\n              <div class=\"openwebui-file-meta\">{{ file.label }} · {{ file.size }}</div>\n              <!-- 添加进度条显示 -->\n              <el-progress \n                v-if=\"file.status !== 'completed'\" \n                :percentage=\"file.progress\" \n                :status=\"file.status === 'failed' ? 'exception' : ''\" \n                :stroke-width=\"4\"\n                class=\"openwebui-file-progress\" />\n              <div v-else class=\"openwebui-file-status completed\">\n                <el-icon><Check /></el-icon> 处理完成\n              </div>\n            </div>\n            <el-icon class=\"openwebui-file-remove\" @click=\"removeFile(idx)\"><Close /></el-icon>\n          </div>\n        </div>\n        <!-- 输入区 -->\n        <div class=\"openwebui-input-area\">\n          <input type=\"file\" ref=\"fileInput\" style=\"display:none\" @change=\"handleFileUpload\" multiple \n               accept=\".txt,.pdf,.doc,.docx,.md,.xls,.xlsx,.csv,.jpg,.jpeg,.png,.gif,.bmp,.webp,.svg,.tiff\" />\n          <el-tooltip\n            content=\"文档: txt, pdf, doc, docx, md&#10;表格: xls, xlsx, csv&#10;图片: jpg, jpeg, png, gif, bmp, webp, svg, tiff\"\n            placement=\"top\"\n            popper-class=\"openwebui-upload-tooltip\"\n            :open-delay=\"200\"\n          >\n            <el-button class=\"openwebui-upload-btn\" @click=\"triggerFileInput\" title=\"上传文件/图片\" :disabled=\"loading\">\n              <el-icon><UploadFilled /></el-icon>\n            </el-button>\n          </el-tooltip>\n          <el-input\n            v-model=\"input\"\n            placeholder=\"请输入您的问题...\"\n            @keyup.enter=\"sendMsg\"\n            class=\"openwebui-input\"\n            :disabled=\"loading || processingFiles\"\n          />\n          <el-button type=\"primary\" @click=\"sendMsg\" class=\"openwebui-send-btn\" :loading=\"loading\" :disabled=\"processingFiles\">\n            {{ loading ? '生成中' : (processingFiles ? '处理中' : '发送') }}\n          </el-button>\n        </div>\n        <div class=\"openwebui-options-area\" v-if=\"chatMode === 'knowledge_base'\">\n            <el-radio-group v-model=\"searchMethod\" size=\"small\">\n              <el-radio-button label=\"local\">局部检索</el-radio-button>\n              <el-radio-button label=\"global\">全局检索</el-radio-button>\n              <el-radio-button label=\"basic\">基础检索</el-radio-button>\n            </el-radio-group>\n        </div>\n        <div class=\"openwebui-footer-hint\">\n          支持文档、表格、图片等多种格式文件\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, nextTick, computed, onMounted, watch } from 'vue'\nimport { UploadFilled, Document, Close, Check, Delete, DataAnalysis, Cpu, MagicStick, ChatLineSquare, Fold, Expand } from '@element-plus/icons-vue'\nimport request from '@/utils/request'\nimport { marked } from 'marked'\nimport { ElMessage, ElTooltip } from 'element-plus'\nimport { aiChatWithDocumentsStream, getAIChatSessions, getAIChatSession } from '@/api/ai'\n\nfunction formatSize(size) {\n  if (size < 1024) return size + 'B';\n  if (size < 1024*1024) return (size/1024).toFixed(1) + 'KB';\n  return (size/1024/1024).toFixed(1) + 'MB';\n}\nfunction getExt(name) {\n  const arr = name.split('.');\n  return arr.length > 1 ? arr[arr.length-1].toLowerCase() : '';\n}\nfunction getFileLabel(type, ext) {\n  const ext_lower = ext.toLowerCase();\n  if (type.startsWith('image/')) return '图片';\n  if (ext_lower === 'pdf') return 'PDF';\n  if (['csv','xls','xlsx'].includes(ext_lower)) return '表格';\n  if (['doc','docx'].includes(ext_lower)) return '文档';\n  if (ext_lower === 'md') return 'Markdown';\n  if (ext_lower === 'txt') return '文本';\n  return ext_lower.toUpperCase();\n}\nfunction getFileBg(ext) {\n  const ext_lower = ext.toLowerCase();\n  if (ext_lower === 'pdf') return '#f87171'; // 红色\n  if (['csv','xls','xlsx'].includes(ext_lower)) return '#34d399'; // 绿色\n  if (['doc','docx'].includes(ext_lower)) return '#60a5fa'; // 蓝色\n  if (ext_lower === 'md') return '#a78bfa'; // 紫色\n  if (ext_lower === 'txt') return '#fbbf24'; // 黄色\n  return '#a5b4fc'; // 默认淡紫色\n}\nfunction escapeHtml(html) {\n  return html.replace(/[&<>\"']/g, function(m) {\n    return ({\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#39;'\n    })[m];\n  });\n}\n\n// 格式化日期时间\nfunction formatTime(dateTimeStr) {\n  if (!dateTimeStr) return '';\n  const date = new Date(dateTimeStr);\n  return `${date.getMonth() + 1}月${date.getDate()}日 ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;\n}\n\nexport default {\n  name: 'Dashboard',\n  components: { \n    UploadFilled, Document, Close, Check, Delete, ElTooltip, \n    DataAnalysis, Cpu, MagicStick, ChatLineSquare, Fold, Expand \n  },\n  setup() {\n    const input = ref('')\n    const messages = ref([\n      { \n        role: 'assistant', \n        content: '您好，我是您的AI助手，有什么可以帮您？', \n        rawContent: '您好，我是您的AI助手，有什么可以帮您？',\n        type: 'text' \n      }\n    ])\n    const chatBody = ref(null)\n    const fileInput = ref(null)\n    const selectedFiles = ref([])\n    const loading = ref(false)\n    const processingFiles = computed(() => {\n      return selectedFiles.value.some(file => file.status !== 'completed' && file.status !== 'failed');\n    })\n    const chatId = ref(null) // 存储当前聊天ID，用于维持对话上下文\n    const showContextBar = computed(() => chatId.value !== null)\n    const userAvatarUrl = ref(null) // 存储用户头像URL\n    const searchMethod = ref('local') // 新增：搜索方法, 默认为local\n    const chatMode = ref('agent') // agent 或 knowledge_base\n    const retrievalScope = ref('local') // 'local', 'global', or 'basic'\n    \n    // 添加变量来存储当前请求的控制器\n    const currentRequestController = ref(null);\n    \n    // 右侧面板相关状态\n    const rightPanelCollapsed = ref(false);\n    const chatSessions = ref([]);\n    \n    // 获取聊天会话列表\n    const fetchChatSessions = async () => {\n      try {\n        const res = await getAIChatSessions();\n        if (res.data && Array.isArray(res.data)) {\n          chatSessions.value = res.data;\n        } else if (res.data && res.data.results && Array.isArray(res.data.results)) {\n          chatSessions.value = res.data.results;\n        }\n      } catch (error) {\n        console.error('获取聊天会话列表失败:', error);\n      }\n    };\n    \n    // 切换聊天会话\n    const switchChatSession = async (sessionId) => {\n      if (sessionId === chatId.value) return;\n      \n      try {\n        loading.value = true;\n        const res = await getAIChatSession(sessionId);\n        if (res.data) {\n          chatId.value = sessionId;\n          // 加载聊天历史\n          if (res.data.messages && Array.isArray(res.data.messages)) {\n            messages.value = res.data.messages.map(msg => {\n              return {\n                role: msg.role,\n                content: msg.content,\n                rawContent: msg.content,\n                type: msg.type || 'text'\n              }\n            });\n          }\n        }\n      } catch (error) {\n        console.error('获取聊天会话详情失败:', error);\n        ElMessage.error('切换聊天会话失败');\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 监听聊天ID变化，更新会话列表\n    watch(chatId, (newChatId) => {\n      if (newChatId) {\n        fetchChatSessions();\n      }\n    });\n\n    // 获取用户信息\n    const getUserInfo = async () => {\n      try {\n        const res = await request({\n          url: '/api/auth/users/me/',\n          method: 'get'\n        })\n        console.log('用户信息完整响应:', res)\n\n        // 尝试从响应的不同位置获取头像URL\n        let avatarUrl = null\n        if (res.data && res.data.data && res.data.data.avatar) {\n          avatarUrl = res.data.data.avatar\n        } else if (res.data && res.data.avatar) {\n          avatarUrl = res.data.avatar\n        } else if (res.data) {\n          // 遍历res.data查找avatar字段\n          const findAvatar = (obj) => {\n            if (!obj || typeof obj !== 'object') return null\n            \n            if ('avatar' in obj) return obj.avatar\n            \n            // 递归搜索所有子对象\n            for (const key in obj) {\n              if (typeof obj[key] === 'object') {\n                const result = findAvatar(obj[key])\n                if (result) return result\n              }\n            }\n            return null\n          }\n          \n          avatarUrl = findAvatar(res.data)\n        }\n\n        console.log('找到的头像URL:', avatarUrl)\n        \n        if (avatarUrl) {\n          // 如果是相对路径，添加基础URL\n          if (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data:')) {\n            // 确保媒体URL正确拼接\n            const baseUrl = window.location.origin\n            if (avatarUrl.startsWith('/')) {\n              userAvatarUrl.value = `${baseUrl}${avatarUrl}`\n            } else {\n              userAvatarUrl.value = `${baseUrl}/${avatarUrl}`\n            }\n          } else {\n            userAvatarUrl.value = avatarUrl\n          }\n          console.log('处理后的用户头像URL:', userAvatarUrl.value)\n        } else {\n          console.log('用户信息中没有找到头像:', res.data)\n        }\n      } catch (error) {\n        console.error('获取用户信息失败:', error)\n      }\n    }\n    \n    const scrollToBottom = () => {\n      nextTick(() => {\n        if (chatBody.value) chatBody.value.scrollTop = chatBody.value.scrollHeight\n      })\n    }\n    \n    const uploadFileAndGetId = async (file) => {\n      const formData = new FormData()\n      formData.append('file', file.rawFile)\n      try {\n        // 标记文件为上传中\n        file.progress = 0;\n        file.status = 'pending';\n        let smoothTimer = null;\n        let lastProgress = 0;\n        let uploadFinished = false;\n        const res = await request({\n          url: '/api/ai/documents/upload/',\n          method: 'post',\n          data: formData,\n          onUploadProgress: (progressEvent) => {\n            const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n            if (percentCompleted < 100) {\n              file.progress = percentCompleted;\n              lastProgress = percentCompleted;\n            } else {\n              // 上传瞬间完成，平滑递增到95%\n              if (!uploadFinished) {\n                uploadFinished = true;\n                let fakeProgress = lastProgress;\n                smoothTimer = setInterval(() => {\n                  fakeProgress += 3;\n                  if (fakeProgress >= 95) {\n                    fakeProgress = 95;\n                    clearInterval(smoothTimer);\n                  }\n                  file.progress = fakeProgress;\n                }, 20);\n              }\n            }\n          }\n        })\n        // 上传完成后，状态改为处理中，不重置进度条\n        if (smoothTimer) clearInterval(smoothTimer);\n        if (file.progress < 95) file.progress = 95;\n        file.status = 'processing';\n        file.documentId = res.data.id;\n        pollDocumentStatus(file);\n        return res.data.id;\n      } catch (error) {\n        file.status = 'failed';\n        console.error('文件上传失败:', error);\n        throw new Error(`上传文件 ${file.name} 失败: ${error.message || '服务器错误'}`);\n      }\n    }\n    \n    // 轮询文档处理状态\n    const pollDocumentStatus = async (file, interval = 1000) => {\n      if (!file.documentId) return;\n      \n      try {\n        const res = await request({\n          url: `/api/ai/documents/${file.documentId}/`,\n          method: 'get'\n        });\n        \n        if (res.data.status === 'completed') {\n          file.progress = 100;\n          file.status = 'completed';\n          return;\n        } else if (res.data.status === 'failed') {\n          file.status = 'failed';\n          file.progress = 0;\n          return;\n        } else if (res.data.status === 'processing') {\n          // 处理中，增加进度（仅在小于95时递增）\n          if (file.progress < 95) {\n            file.progress = Math.min(file.progress + 5, 95);\n          }\n        }\n        \n        // 继续轮询\n        setTimeout(() => pollDocumentStatus(file, interval), interval);\n      } catch (e) {\n        // 出错时，继续轮询，但不更新进度\n        setTimeout(() => pollDocumentStatus(file, interval), interval);\n      }\n    }\n    \n    const clearChat = () => {\n      // 清空对话历史，开始新的对话\n      chatId.value = null;\n      messages.value = [\n        { \n          role: 'assistant', \n          content: '您好，我是您的AI助手，有什么可以帮您？', \n          rawContent: '您好，我是您的AI助手，有什么可以帮您？',\n          type: 'text' \n        }\n      ];\n      // 清空选择的文件\n      selectedFiles.value = [];\n      // 刷新历史记录\n      fetchChatSessions();\n    }\n    \n    // 发送消息\n    function sendMsg() {\n      if (!input.value.trim() && selectedFiles.value.length === 0) {\n        ElMessage.warning('请输入内容或上传文件');\n        return;\n      }\n      \n      // 如果还有文件在处理中，不允许发送\n      if (processingFiles.value) {\n        ElMessage.warning('文件正在处理中，请稍候再试');\n        return;\n      }\n      \n      // 如果有上一个请求正在进行，先取消它\n      if (currentRequestController.value) {\n        currentRequestController.value.abort();\n        currentRequestController.value = null;\n      }\n      \n      // 添加用户消息到列表\n      const userMsg = {\n        role: 'user',\n        content: input.value,\n        type: 'text'\n      };\n      messages.value.push(userMsg);\n      \n      // 如果有文件，添加文件消息\n      if (selectedFiles.value.length > 0) {\n        const fileMsg = {\n          role: 'user',\n          content: `上传了${selectedFiles.value.length}个文件`,\n          type: 'file',\n          files: selectedFiles.value.map(f => ({\n            name: f.name,\n            size: f.size,\n            ext: f.ext\n          }))\n        };\n        messages.value.push(fileMsg);\n      }\n      \n      // 添加空的助手消息，用于流式更新\n      const assistantMsg = {\n        role: 'assistant',\n        content: '',\n        type: 'text',\n        streaming: true\n      };\n      messages.value.push(assistantMsg);\n      \n      // 清空输入框和文件列表\n      const currentInput = input.value;\n      input.value = '';\n      \n      // 存储当前已经上传的文件ID\n      const currentDocumentIds = selectedFiles.value.map(f => f.docId).filter(Boolean);\n      selectedFiles.value = [];\n      \n      // 滚动到底部\n      scrollToBottom();\n      \n      // 设置加载状态\n      loading.value = true;\n      \n      // 准备请求参数\n      const requestData = {\n        message: currentInput,\n        chat_id: chatId.value,\n        document_ids: currentDocumentIds,\n        chatMode: chatMode.value,\n        search_method: searchMethod.value\n      };\n      \n      // 使用流式API进行请求\n      currentRequestController.value = aiChatWithDocumentsStream(\n        requestData,\n        // 数据块处理回调\n        (chunk, newChatId) => {\n          // 流式更新最后一条消息的内容\n          const lastMsg = messages.value[messages.value.length - 1];\n          if (lastMsg && lastMsg.role === 'assistant' && lastMsg.streaming) {\n            // 存储原始文本内容\n            if (!lastMsg.rawContent) {\n              lastMsg.rawContent = '';\n            }\n            // 累积原始文本\n            lastMsg.rawContent += chunk;\n            \n            // 使用marked库将Markdown格式转换为HTML（一次性转换整个内容）\n            lastMsg.content = marked(lastMsg.rawContent);\n            \n            // 滚动到底部以显示新内容\n            scrollToBottom();\n          }\n          \n          // 如果响应中包含新的聊天ID，更新chatId\n          if (newChatId && !chatId.value) {\n            chatId.value = newChatId;\n          }\n        },\n        // 完成回调\n        (newChatId) => {\n          // 更新最后一条消息，移除streaming标记\n          const lastMsg = messages.value[messages.value.length - 1];\n          if (lastMsg && lastMsg.role === 'assistant') {\n            lastMsg.streaming = false;\n            \n            // 确保最后一次完整的Markdown渲染\n            if (lastMsg.rawContent) {\n              lastMsg.content = marked(lastMsg.rawContent);\n            }\n          }\n          \n          // 设置chatId（如果响应中有新的）\n          if (newChatId) {\n            chatId.value = newChatId;\n          }\n          \n          // 清除loading状态\n          loading.value = false;\n          currentRequestController.value = null;\n        },\n        // 错误回调\n        (error) => {\n          console.error('流式请求出错:', error);\n          \n          // 更新最后一条消息，显示错误\n          const lastMsg = messages.value[messages.value.length - 1];\n          if (lastMsg && lastMsg.role === 'assistant') {\n            lastMsg.content = '抱歉，响应生成过程中出现错误，请稍后重试。';\n            lastMsg.streaming = false;\n          }\n          \n          // 清除loading状态\n          loading.value = false;\n          currentRequestController.value = null;\n          \n          // 显示错误消息\n          ElMessage.error('请求出错: ' + (error.message || '未知错误'));\n        }\n      );\n    }\n    \n    const triggerFileInput = () => {\n      if (fileInput.value) fileInput.value.value = '';\n      fileInput.value && fileInput.value.click()\n    }\n    \n    const handleFileUpload = (e) => {\n      const files = e.target.files\n      if (!files || !files.length) return\n      \n      // 支持的文件类型配置\n      const allowedTypes = {\n        // 文档类型\n        'text/plain': 'txt',                          // txt文件\n        'application/pdf': 'pdf',                     // pdf文件\n        'application/msword': 'doc',                  // doc文件\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx', // docx文件\n        'text/markdown': 'md',                        // markdown文件\n        'text/x-markdown': 'md',                      // markdown文件变体\n        \n        // 表格类型\n        'text/csv': 'csv',                            // csv文件\n        'application/csv': 'csv',                     // csv文件另一种MIME\n        'application/vnd.ms-excel': 'xls',            // xls文件\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'xlsx', // xlsx文件\n        \n        // 图片类型\n        'image/jpeg': 'jpg',                          // jpg/jpeg图片\n        'image/png': 'png',                           // png图片\n        'image/gif': 'gif',                           // gif图片\n        'image/bmp': 'bmp',                           // bmp图片\n        'image/webp': 'webp',                         // webp图片\n        'image/svg+xml': 'svg',                       // svg矢量图\n        'image/tiff': 'tiff'                          // tiff图片\n      };\n      \n      // 显示支持的文件格式提示\n      const supportedFormats = '支持的文件格式: txt, pdf, doc, docx, md, xls, xlsx, csv 和常见图片格式';\n      \n      // 检查每个文件\n      const validFiles = [];\n      let hasInvalidFile = false;\n      \n      // 有效的文件扩展名列表（不区分大小写）\n      const validExtensions = ['txt', 'pdf', 'doc', 'docx', 'md', 'xls', 'xlsx', 'csv', \n                              'jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n      \n      Array.from(files).forEach(file => {\n        const ext = getExt(file.name).toLowerCase();\n        const isValidExtension = validExtensions.includes(ext);\n        \n        // 检查MIME类型或扩展名是否有效\n        if (allowedTypes[file.type] || isValidExtension) {\n          const id = file.name + '_' + file.size + '_' + Date.now() + Math.random()\n          if (file.type.startsWith('image/')) {\n            const reader = new FileReader()\n            reader.onload = (ev) => {\n              selectedFiles.value.push({\n                id,\n                name: file.name,\n                type: file.type,\n                url: ev.target.result,\n                size: formatSize(file.size),\n                ext,\n                label: getFileLabel(file.type, ext),\n                bg: getFileBg(ext),\n                rawFile: file,\n                progress: 0,\n                status: 'ready'\n              })\n              // 自动上传\n              uploadFileAndGetId(selectedFiles.value[selectedFiles.value.length - 1])\n            }\n            reader.readAsDataURL(file)\n          } else {\n            const url = URL.createObjectURL(file)\n            selectedFiles.value.push({\n              id,\n              name: file.name,\n              type: file.type,\n              url,\n              size: formatSize(file.size),\n              ext,\n              label: getFileLabel(file.type, ext),\n              bg: getFileBg(ext),\n              rawFile: file,\n              progress: 0,\n              status: 'ready'\n            })\n            // 自动上传\n            uploadFileAndGetId(selectedFiles.value[selectedFiles.value.length - 1])\n          }\n          validFiles.push(selectedFiles.value[selectedFiles.value.length - 1])\n        } else {\n          hasInvalidFile = true;\n          ElMessage.error(`不支持的文件类型: ${file.name}`);\n          console.warn(`文件类型拒绝: ${file.name}, MIME: ${file.type}, 扩展名: ${ext}`);\n        }\n      })\n      \n      // 在有不支持文件类型时显示支持的格式信息\n      if (hasInvalidFile) {\n        ElMessage.info(supportedFormats);\n      }\n      \n      // 如果全部文件都是有效的，显示成功上传提示\n      if (validFiles.length > 0 && validFiles.length === files.length) {\n        ElMessage.success(`已添加${validFiles.length}个文件`);\n      }\n    }\n    \n    const removeFile = (idx) => {\n      selectedFiles.value.splice(idx, 1)\n    }\n\n    // marked配置：表格带边框+代码块美化+复制按钮\n    const renderer = new marked.Renderer();\n    renderer.table = function(header, body) {\n      return `<table class=\"openwebui-md-table\"><thead>${header}</thead><tbody>${body}</tbody></table>`;\n    };\n    renderer.code = function(code, infostring, escaped) {\n      const codeId = 'code-' + Math.random().toString(36).substr(2, 9);\n      let lang = (infostring || '').split(/\\s+/)[0];\n      let langLabel = lang ? lang : 'code';\n      let langClass = lang ? `language-${lang}` : '';\n      return `\n        <div class=\"openwebui-md-code-block-beauty\">\n          <div class=\"openwebui-md-code-toolbar\">\n            <span class=\"openwebui-md-code-lang\">${langLabel}</span>\n            <button class=\"openwebui-copy-btn\" data-clipboard-target=\"#${codeId}\" title=\"复制代码\">复制</button>\n          </div>\n          <pre class=\"openwebui-md-pre\"><code id=\"${codeId}\" class=\"${langClass}\">${escaped ? code : escapeHtml(code)}</code></pre>\n        </div>\n      `;\n    };\n    marked.setOptions({\n      breaks: true,\n      gfm: true,\n      headerIds: false,\n      mangle: false,\n      renderer\n    })\n\n    const handleAvatarError = (e) => {\n      console.error('头像加载失败:', e.target.src)\n      e.target.style.display = 'none'\n      userAvatarUrl.value = null // 重置为null，显示默认头像\n    }\n\n    onMounted(() => {\n      document.body.addEventListener('click', function(e) {\n        if (e.target.classList && e.target.classList.contains('openwebui-copy-btn')) {\n          const codeId = e.target.getAttribute('data-clipboard-target').replace('#', '');\n          const codeElem = document.getElementById(codeId);\n          if (codeElem) {\n            navigator.clipboard.writeText(codeElem.innerText).then(() => {\n              e.target.innerText = '已复制';\n              setTimeout(() => { e.target.innerText = '复制'; }, 1200);\n            });\n          }\n        }\n      });\n      \n      // 获取用户头像\n      getUserInfo();\n      \n      // 获取聊天会话列表\n      fetchChatSessions();\n      \n      // 添加页面卸载时的清理\n      window.addEventListener('beforeunload', () => {\n        if (currentRequestController.value) {\n          currentRequestController.value.abort();\n        }\n      });\n    });\n\n    return {\n      input, \n      messages, \n      sendMsg, \n      chatBody, \n      fileInput, \n      triggerFileInput, \n      handleFileUpload, \n      selectedFiles, \n      removeFile, \n      UploadFilled, \n      Document, \n      Close, \n      Check,\n      loading, \n      processingFiles,\n      clearChat,\n      showContextBar,\n      chatId,\n      userAvatarUrl,\n      handleAvatarError,\n      searchMethod,\n      chatMode,\n      retrievalScope,\n      // 右侧面板相关\n      rightPanelCollapsed,\n      chatSessions,\n      switchChatSession,\n      formatTime\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\nhtml, body {\n  width: 100vw;\n  height: 100vh;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n.openwebui-chat-root {\n  width: 100%;\n  height: 100%;\n  min-height: 0;\n  min-width: 0;\n  background: var(--bg-color);\n  display: flex;\n  align-items: stretch;\n  justify-content: stretch;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n.openwebui-chat-window {\n  width: 100%;\n  height: 100%;\n  min-height: 0;\n  background: var(--bg-color);\n  border-radius: 0;\n  box-shadow: none;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  margin: 0;\n}\n.openwebui-chat-header {\n  height: 56px;\n  background: var(--bg-color-secondary);\n  display: flex;\n  align-items: center;\n  padding: 0 24px;\n  font-size: 18px;\n  font-weight: 600;\n  border-bottom: 1px solid var(--border-color);\n  flex-shrink: 0;\n  justify-content: space-between;\n  color: var(--text-color);\n}\n.header-center-controls {\n  display: flex;\n  gap: 16px;\n  align-items: center;\n}\n.openwebui-title {\n  color: var(--primary-color);\n}\n.clear-chat-btn {\n  color: var(--text-color-secondary);\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 14px;\n  font-weight: normal;\n}\n.clear-chat-btn:hover {\n  color: var(--primary-color);\n}\n.openwebui-file-preview-bar {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  gap: 12px;\n  padding: 12px 0 8px 0;\n  background: transparent;\n  border-bottom: none;\n  overflow-x: auto;\n  min-height: 64px;\n  z-index: 3;\n}\n.openwebui-file-card {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background: var(--bg-color-secondary);\n  border-radius: 14px;\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.04);\n  padding: 8px 16px 8px 8px;\n  min-width: 160px;\n  max-width: 240px;\n  position: relative;\n  color: var(--text-color);\n}\n.openwebui-file-thumb {\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  background: var(--bg-color-tertiary);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  margin-right: 10px;\n}\n.openwebui-file-img {\n  width: 40px;\n  height: 40px;\n  object-fit: cover;\n  border-radius: 8px;\n}\n.openwebui-file-icon {\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #fff;\n  font-size: 22px;\n}\n.openwebui-file-info {\n  flex: 1;\n  min-width: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.openwebui-file-name {\n  font-size: 14px;\n  color: var(--text-color);\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 120px;\n}\n.openwebui-file-meta {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n  margin-top: 2px;\n}\n.openwebui-file-progress {\n  margin-top: 4px;\n  width: 100%;\n}\n.openwebui-file-status.completed {\n  color: var(--success-color);\n}\n.openwebui-file-remove {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  color: var(--text-color-tertiary);\n  font-size: 16px;\n  cursor: pointer;\n  transition: color 0.2s;\n}\n.openwebui-file-remove:hover {\n  color: var(--error-color);\n}\n.openwebui-chat-container {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  position: relative;\n}\n.openwebui-chat-body {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0 16px 12px 16px;\n  background: var(--bg-color);\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  max-height: calc(100vh - 200px);\n  height: calc(100vh - 200px);\n  flex-shrink: 1;\n  scrollbar-width: thin;\n  width: auto;\n  transition: all 0.3s ease;\n}\n.openwebui-msg {\n  display: flex;\n  align-items: flex-end;\n  margin-bottom: 16px;\n  flex-direction: row;\n  justify-content: flex-start;\n}\n.openwebui-msg.user {\n  flex-direction: row-reverse;\n  justify-content: flex-end;\n  align-items: flex-end;\n  margin-left: auto;\n  margin-right: 0;\n}\n.openwebui-msg.assistant {\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: flex-end;\n  margin-right: auto;\n  margin-left: 0;\n}\n.openwebui-msg-bubble {\n  max-width: 70%;\n  padding: 12px 18px;\n  border-radius: 16px;\n  font-size: 15px;\n  line-height: 1.7;\n  background: var(--bg-color-secondary);\n  color: var(--text-color);\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.04);\n  position: relative;\n  word-break: break-all;\n  overflow-wrap: break-word;\n  margin-top: 4px;\n  margin-bottom: 0;\n  margin-left: 0;\n  margin-right: 0;\n}\n.openwebui-msg.user .openwebui-msg-bubble {\n  background: var(--primary-color);\n  color: #fff;\n  border-bottom-right-radius: 4px;\n  margin-right: 8px;\n  margin-left: auto;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble {\n  background: var(--bg-color-secondary);\n  color: var(--text-color);\n  border-bottom-left-radius: 4px;\n  margin-left: 8px;\n  margin-right: auto;\n}\n.openwebui-avatar {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  margin-bottom: auto;\n}\n.left-avatar {\n  margin-right: 8px;\n}\n.right-avatar {\n  margin-left: 8px;\n}\n.user-avatar-img {\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  object-fit: cover;\n  overflow: hidden;\n  display: block;\n  background-color: #f0f2f5;\n}\n.openwebui-user-label {\n  font-weight: bold;\n  margin-right: 4px;\n}\n.openwebui-ai-label {\n  font-weight: bold;\n  color: #2f54eb;\n  margin-right: 4px;\n}\n.openwebui-chat-footer {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  padding: 0 16px 12px 16px;\n  background: var(--bg-color);\n  border-top: 1px solid var(--border-color);\n  margin: 0;\n  flex-shrink: 0;\n  box-shadow: 0 -2px 16px 0 rgba(var(--primary-color-rgb),0.03);\n  z-index: 2;\n}\n.openwebui-input-area {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n.openwebui-input {\n  flex: 1;\n  margin-right: 12px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n}\n.openwebui-send-btn {\n  min-width: 72px;\n  height: 40px;\n  font-size: 16px;\n  font-weight: 500;\n  border-radius: 8px;\n}\n.openwebui-upload-btn {\n  margin-right: 8px;\n  font-size: 20px;\n  background: var(--bg-color-tertiary);\n  border: 1px solid var(--border-color);\n  color: var(--primary-color);\n  cursor: pointer;\n  border-radius: 8px;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: border 0.2s, box-shadow 0.2s;\n}\n.openwebui-upload-btn:hover {\n  border: 1.5px solid var(--primary-color);\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.08);\n}\n.openwebui-img-preview {\n  max-width: 180px;\n  max-height: 120px;\n  border-radius: 8px;\n  display: block;\n  margin: 4px 0;\n  box-shadow: 0 2px 8px rgba(47,84,235,0.08);\n}\n.openwebui-file-link {\n  color: var(--primary-color);\n  text-decoration: underline;\n  word-break: break-all;\n}\n.openwebui-cursor {\n  display: inline-block;\n  width: 8px;\n  height: 16px;\n  background: var(--primary-color);\n  margin-left: 2px;\n  vertical-align: middle;\n  animation: blink 0.8s infinite;\n}\n\n@keyframes blink {\n  0% { opacity: 1; }\n  50% { opacity: 0; }\n  100% { opacity: 1; }\n}\n\n.file-bubble-nest {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n.file-bubble-vertical {\n  justify-content: flex-start;\n  align-items: flex-start;\n}\n.file-message-card {\n  display: flex;\n  align-items: center;\n  background: var(--bg-color-secondary);\n  border-radius: 12px;\n  padding: 8px 16px;\n  margin-bottom: 0;\n  min-width: 180px;\n  max-width: 320px;\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.04);\n  color: var(--text-color);\n}\n.file-icon-area {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 12px;\n}\n.file-icon-img {\n  width: 32px;\n  height: 32px;\n}\n.file-info-area {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.file-name {\n  font-size: 15px;\n  font-weight: 500;\n  color: var(--text-color);\n  margin-bottom: 2px;\n  word-break: break-all;\n}\n.file-meta {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n}\n.file-desc-text {\n  margin-top: 8px;\n  font-size: 15px;\n  color: var(--text-color);\n  background: transparent;\n  border-radius: 8px;\n  padding: 0 2px;\n  display: inline-block;\n  word-break: break-all;\n}\n.openwebui-context-bar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 24px;\n  background-color: var(--bg-color-tertiary);\n  border-bottom: 1px solid var(--border-color);\n  font-size: 14px;\n  color: var(--text-color-secondary);\n}\n.context-info {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n.context-icon {\n  color: var(--primary-color);\n  font-size: 16px;\n}\n.source-tag {\n  font-size: 10px;\n  color: #888;\n  margin-top: 8px;\n  display: inline-flex;\n  align-items: center;\n  padding: 2px 6px;\n  border-radius: 4px;\n  .el-icon {\n    margin-right: 4px;\n  }\n}\n.knowledge-base-tag {\n  background-color: #e8f5e9; /* Light green */\n  color: #2e7d32;\n}\n.general-ai-tag {\n  background-color: #e3f2fd; /* Light blue */\n  color: #1565c0;\n}\n\n/* 右侧面板样式 */\n.openwebui-right-panel {\n  width: 280px;\n  height: 100%;\n  background: var(--bg-color-secondary);\n  border-left: 1px solid var(--border-color);\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s ease;\n  overflow: hidden;\n}\n\n.openwebui-right-panel.collapsed {\n  width: 50px;\n}\n\n.right-panel-header {\n  padding: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid var(--border-color);\n  transition: padding 0.3s ease, border-color 0.3s ease;\n}\n\n.collapsed .right-panel-header {\n  justify-content: center;\n  padding-left: 0;\n  padding-right: 0;\n  border-bottom-color: transparent;\n}\n\n.right-panel-mode-controls {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  overflow: hidden;\n  transition: opacity 0.3s;\n}\n\n.collapsed .right-panel-mode-controls {\n  opacity: 0;\n  width: 0;\n  pointer-events: none;\n}\n\n.collapse-button {\n  margin-left: 8px;\n  background-color: var(--bg-color);\n  border: 1px solid var(--border-color);\n  color: var(--text-color);\n  transition: all 0.2s ease;\n}\n\n.collapse-button:hover {\n  border-color: var(--primary-color);\n  color: var(--primary-color);\n  transform: scale(1.1);\n  box-shadow: 0 0 8px rgba(var(--primary-color-rgb), 0.2);\n}\n\n.collapsed .collapse-button {\n  margin-left: 0;\n}\n\n.history-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 12px;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n}\n\n.collapsed .history-container {\n  display: none;\n}\n\n.history-title {\n  font-size: 16px;\n  margin: 0 0 12px 0;\n  color: var(--text-color);\n  transition: opacity 0.2s, height 0.3s ease, margin 0.3s ease, padding 0.3s ease;\n  height: 19px;\n  line-height: 1.2;\n  overflow: hidden;\n}\n\n.collapsed .history-title {\n  opacity: 0;\n  height: 0;\n  margin: 0;\n  padding: 0;\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.history-item {\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border-radius: 8px;\n  background: var(--bg-color);\n  cursor: pointer;\n  transition: background 0.2s, padding 0.3s ease;\n  overflow: hidden;\n}\n\n.collapsed .history-item {\n  justify-content: center;\n  padding: 10px 0;\n}\n\n.history-item:hover {\n  background: var(--bg-color-tertiary);\n}\n\n.history-item.active {\n  background: var(--primary-color);\n  color: white;\n}\n\n.history-item-icon {\n  margin-right: 12px;\n  color: inherit;\n  transition: margin 0.3s ease;\n}\n\n.collapsed .history-item-icon {\n  margin-right: 0;\n}\n\n.history-item-content {\n  flex: 1;\n  min-width: 0;\n  transition: opacity 0.3s;\n}\n\n.collapsed .history-item-content {\n  opacity: 0;\n  width: 0;\n}\n\n.history-item-title {\n  font-size: 14px;\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.history-item-time {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n  margin-top: 2px;\n}\n\n.history-item.active .history-item-time {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.history-empty {\n  text-align: center;\n  padding: 20px 0;\n  color: var(--text-color-secondary);\n  font-size: 14px;\n}\n</style>\n\n<style>\n.openwebui-md-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin: 8px 0;\n  background: var(--bg-color-secondary);\n  font-size: 15px;\n}\n.openwebui-md-table th, .openwebui-md-table td {\n  border: 1px solid var(--border-color);\n  padding: 6px 12px;\n  text-align: left;\n  color: var(--text-color);\n  background: var(--bg-color-secondary);\n}\n.openwebui-md-table th {\n  background: var(--bg-color-tertiary);\n  font-weight: 600;\n  color: var(--text-color-secondary);\n}\n/* 代码块美化和复制按钮 */\n.openwebui-md-code-block-beauty {\n  position: relative;\n  background: var(--bg-color-tertiary);\n  border-radius: 12px;\n  margin: 18px 0;\n  box-shadow: 0 4px 16px var(--shadow-color);\n  overflow: hidden;\n  border: 1px solid var(--border-color);\n}\n.openwebui-md-code-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: var(--bg-color-secondary);\n  border-bottom: 1px solid var(--border-color);\n  height: 36px;\n  padding: 0 14px;\n}\n.openwebui-md-code-lang {\n  font-size: 13px;\n  color: var(--text-color-tertiary);\n  font-family: 'JetBrains Mono', 'Fira Mono', 'Consolas', monospace;\n  user-select: none;\n}\n.openwebui-copy-btn {\n  background: var(--bg-color-tertiary);\n  border: 1px solid var(--border-color);\n  color: var(--primary-color);\n  border-radius: 6px;\n  font-size: 13px;\n  padding: 2px 12px;\n  cursor: pointer;\n  z-index: 2;\n  transition: background 0.2s, border 0.2s, color 0.2s;\n  outline: none;\n  margin-left: 8px;\n}\n.openwebui-copy-btn:hover {\n  background: var(--primary-color);\n  color: #fff;\n  border: 1px solid var(--primary-color);\n}\n.openwebui-md-pre {\n  margin: 0;\n  padding: 16px 18px;\n  background: var(--bg-color-tertiary);\n  border-radius: 0 0 12px 12px;\n  overflow-x: auto;\n  font-family: 'JetBrains Mono', 'Fira Mono', 'Consolas', monospace;\n  font-size: 15px;\n  line-height: 1.7;\n  color: var(--text-color);\n  min-height: 40px;\n}\n@media (max-width: 600px) {\n  .openwebui-md-pre {\n    font-size: 13px;\n    padding: 12px 6px;\n  }\n  .openwebui-md-code-block-beauty {\n    margin: 12px 0;\n  }\n}\n</style>\n\n<style>\n.openwebui-footer-hint {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n  text-align: center;\n  padding-top: 8px;\n  user-select: none;\n  width: 100%;\n}\n</style>\n\n<style>\n.openwebui-upload-tooltip {\n  max-width: 300px !important;\n  background: var(--bg-color-secondary) !important;\n  color: var(--text-color) !important;\n  border: 1px solid var(--primary-color) !important;\n  border-radius: 8px !important;\n  box-shadow: 0 4px 12px rgba(var(--primary-color-rgb), 0.2) !important;\n  padding: 10px 14px !important;\n  font-size: 13px !important;\n  line-height: 1.6 !important;\n  white-space: pre-wrap; /* For newline in content */\n}\n\n.openwebui-upload-tooltip .el-popper__arrow::before {\n  border-color: var(--primary-color) !important;\n  background: var(--bg-color-secondary) !important;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.openwebui-options-area {\n  display: flex;\n  justify-content: center;\n  padding-top: 8px;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}