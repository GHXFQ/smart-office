{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\CompanyManagement.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\CompanyManagement.vue","mtime":1750381695852},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVmLCBvbk1vdW50ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgYWRtaW5BcGkgZnJvbSAnQC9hcGkvYWRtaW4nOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCB9IGZyb20gJ2VsZW1lbnQtcGx1cyc7CgovLyBTaW1wbGUgZGVib3VuY2UgZnVuY3Rpb24KZnVuY3Rpb24gZGVib3VuY2UoZm4sIGRlbGF5KSB7CiAgbGV0IHRpbWVvdXRJRCA9IG51bGw7CiAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7CiAgICBjbGVhclRpbWVvdXQodGltZW91dElEKTsKICAgIHRpbWVvdXRJRCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICBmbiguLi5hcmdzKTsKICAgIH0sIGRlbGF5KTsKICB9Owp9CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ29tcGFueU1hbmFnZW1lbnQnLAogIHNldHVwKCkgewogICAgY29uc3QgY29tcGFuaWVzID0gcmVmKFtdKTsKICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcmVmKCcnKTsKICAgIGNvbnN0IGlzTW9kYWxPcGVuID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGN1cnJlbnRJdGVtID0gcmVmKHt9KTsKICAgIGNvbnN0IGZldGNoQ29tcGFuaWVzID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICAgIHNlYXJjaDogc2VhcmNoUXVlcnkudmFsdWUKICAgICAgICB9OwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYWRtaW5BcGkuZ2V0Q29tcGFuaWVzKHBhcmFtcyk7CiAgICAgICAgY29tcGFuaWVzLnZhbHVlID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRzOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIuiOt+WPluWFrOWPuOWIl+ihqOWksei0pToiLCBlcnJvcik7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBkZWJvdW5jZWRGZXRjaENvbXBhbmllcyA9IGRlYm91bmNlKGZldGNoQ29tcGFuaWVzLCAzMDApOwogICAgY29uc3Qgb3Blbk1vZGFsID0gKGl0ZW0gPSB7fSkgPT4gewogICAgICBjdXJyZW50SXRlbS52YWx1ZSA9IHsKICAgICAgICAuLi5pdGVtCiAgICAgIH07CiAgICAgIGlzTW9kYWxPcGVuLnZhbHVlID0gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBjbG9zZU1vZGFsID0gKCkgPT4gewogICAgICBpc01vZGFsT3Blbi52YWx1ZSA9IGZhbHNlOwogICAgICBjdXJyZW50SXRlbS52YWx1ZSA9IHt9OwogICAgfTsKICAgIGNvbnN0IHNhdmVJdGVtID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGlmIChjdXJyZW50SXRlbS52YWx1ZS5pZCkgewogICAgICAgICAgYXdhaXQgYWRtaW5BcGkudXBkYXRlQ29tcGFueShjdXJyZW50SXRlbS52YWx1ZS5pZCwgY3VycmVudEl0ZW0udmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhd2FpdCBhZG1pbkFwaS5jcmVhdGVDb21wYW55KGN1cnJlbnRJdGVtLnZhbHVlKTsKICAgICAgICB9CiAgICAgICAgY2xvc2VNb2RhbCgpOwogICAgICAgIGZldGNoQ29tcGFuaWVzKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigi5L+d5a2Y5YWs5Y+45aSx6LSlOiIsIGVycm9yKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGNvbmZpcm1EZWxldGUgPSBpdGVtID0+IHsKICAgICAgRWxNZXNzYWdlQm94LmNvbmZpcm0oYOehruWumuimgeWIoOmZpOWFrOWPuOOAkCR7aXRlbS5uYW1lfeOAkeWQl++8n+WIoOmZpOWQju+8jOivpeWFrOWPuOS4i+eahOaJgOacieeUqOaIt+WSjOmDqOmXqOS/oeaBr+mDveWwhuS4ouWkse+8jOatpOaTjeS9nOS4jeWPr+aBouWkjeOAgmAsICfkuKXph43orablkYonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrprliKDpmaQnLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgY2VudGVyOiB0cnVlCiAgICAgIH0pLnRoZW4oYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCBhZG1pbkFwaS5kZWxldGVDb21wYW55KGl0ZW0uaWQpOwogICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+WFrOWPuOWIoOmZpOaIkOWKnycpOwogICAgICAgICAgZmV0Y2hDb21wYW5pZXMoKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliKDpmaTlpLHotKXvvIzor7fnqI3lkI7ph43or5UnKTsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuWIoOmZpOWFrOWPuOWksei0pToiLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+W3suWPlua2iOWIoOmZpCcpOwogICAgICB9KTsKICAgIH07CiAgICBvbk1vdW50ZWQoZmV0Y2hDb21wYW5pZXMpOwogICAgcmV0dXJuIHsKICAgICAgY29tcGFuaWVzLAogICAgICBzZWFyY2hRdWVyeSwKICAgICAgaXNNb2RhbE9wZW4sCiAgICAgIGN1cnJlbnRJdGVtLAogICAgICBmZXRjaENvbXBhbmllcywKICAgICAgZGVib3VuY2VkRmV0Y2hDb21wYW5pZXMsCiAgICAgIG9wZW5Nb2RhbCwKICAgICAgY2xvc2VNb2RhbCwKICAgICAgc2F2ZUl0ZW0sCiAgICAgIGNvbmZpcm1EZWxldGUKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["ref","onMounted","adminApi","ElMessage","ElMessageBox","debounce","fn","delay","timeoutID","args","clearTimeout","setTimeout","name","setup","companies","searchQuery","isModalOpen","currentItem","fetchCompanies","params","search","value","response","getCompanies","data","results","error","console","debouncedFetchCompanies","openModal","item","closeModal","saveItem","id","updateCompany","createCompany","confirmDelete","confirm","confirmButtonText","cancelButtonText","type","center","then","deleteCompany","success","catch","info"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\CompanyManagement.vue"],"sourcesContent":["<template>\n  <div class=\"management-container\">\n    <div class=\"header\">\n      <h2>公司管理</h2>\n      <div class=\"actions\">\n        <input \n          type=\"text\" \n          placeholder=\"搜索公司...\" \n          class=\"search-input\"\n          v-model=\"searchQuery\"\n          @input=\"debouncedFetchCompanies\" \n        />\n        <button class=\"btn-primary\" @click=\"openModal()\">添加公司</button>\n      </div>\n    </div>\n    <div class=\"table-container\">\n      <table>\n        <thead>\n          <tr>\n            <th>序号</th>\n            <th>公司名称</th>\n            <th>行业</th>\n            <th>规模</th>\n            <th>地址</th>\n            <th>操作</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"(company, index) in companies\" :key=\"company.id\">\n            <td>{{ index + 1 }}</td>\n            <td>{{ company.name }}</td>\n            <td>{{ company.industry }}</td>\n            <td>{{ company.size }}</td>\n            <td>{{ company.address }}</td>\n            <td class=\"action-buttons\">\n              <button class=\"btn-edit\" @click=\"openModal(company)\">编辑</button>\n              <button class=\"btn-delete\" @click=\"confirmDelete(company)\">删除</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <!-- 添加/编辑模态框 -->\n    <div v-if=\"isModalOpen\" class=\"modal-overlay\">\n      <div class=\"modal-content\">\n        <h3>{{ currentItem.id ? '编辑公司' : '添加公司' }}</h3>\n        <form @submit.prevent=\"saveItem\">\n          <div class=\"form-group\">\n            <label>公司名称:</label>\n            <input type=\"text\" v-model=\"currentItem.name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label>行业:</label>\n            <input type=\"text\" v-model=\"currentItem.industry\" required />\n          </div>\n          <div class=\"form-group\">\n            <label>规模:</label>\n            <input type=\"text\" v-model=\"currentItem.size\" required />\n          </div>\n          <div class=\"form-group\">\n            <label>地址:</label>\n            <input type=\"text\" v-model=\"currentItem.address\" required />\n          </div>\n           <div class=\"form-group\">\n            <label>网站:</label>\n            <input type=\"text\" v-model=\"currentItem.website\" required />\n          </div>\n           <div class=\"form-group\">\n            <label>联系电话:</label>\n            <input type=\"tel\" v-model=\"currentItem.phone\" required />\n          </div>\n          <div class=\"form-actions\">\n            <button type=\"submit\" class=\"btn-primary\">保存</button>\n            <button type=\"button\" @click=\"closeModal\" class=\"btn-secondary\">取消</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue';\nimport adminApi from '@/api/admin';\nimport { ElMessage, ElMessageBox } from 'element-plus';\n\n// Simple debounce function\nfunction debounce(fn, delay) {\n  let timeoutID = null;\n  return function(...args) {\n    clearTimeout(timeoutID);\n    timeoutID = setTimeout(() => {\n      fn(...args);\n    }, delay);\n  };\n}\n\nexport default {\n  name: 'CompanyManagement',\n  setup() {\n    const companies = ref([]);\n    const searchQuery = ref('');\n    const isModalOpen = ref(false);\n    const currentItem = ref({});\n\n    const fetchCompanies = async () => {\n      try {\n        const params = { search: searchQuery.value };\n        const response = await adminApi.getCompanies(params);\n        companies.value = response.data.results;\n      } catch (error) {\n        console.error(\"获取公司列表失败:\", error);\n      }\n    };\n\n    const debouncedFetchCompanies = debounce(fetchCompanies, 300);\n\n    const openModal = (item = {}) => {\n      currentItem.value = { ...item };\n      isModalOpen.value = true;\n    };\n\n    const closeModal = () => {\n      isModalOpen.value = false;\n      currentItem.value = {};\n    };\n\n    const saveItem = async () => {\n      try {\n        if (currentItem.value.id) {\n          await adminApi.updateCompany(currentItem.value.id, currentItem.value);\n        } else {\n          await adminApi.createCompany(currentItem.value);\n        }\n        closeModal();\n        fetchCompanies();\n      } catch (error) {\n        console.error(\"保存公司失败:\", error);\n      }\n    };\n\n    const confirmDelete = (item) => {\n      ElMessageBox.confirm(\n        `确定要删除公司【${item.name}】吗？删除后，该公司下的所有用户和部门信息都将丢失，此操作不可恢复。`,\n        '严重警告',\n        {\n          confirmButtonText: '确定删除',\n          cancelButtonText: '取消',\n          type: 'error',\n          center: true,\n        }\n      ).then(async () => {\n        try {\n          await adminApi.deleteCompany(item.id);\n          ElMessage.success('公司删除成功');\n          fetchCompanies();\n        } catch (error) {\n          ElMessage.error('删除失败，请稍后重试');\n          console.error(\"删除公司失败:\", error);\n        }\n      }).catch(() => {\n        ElMessage.info('已取消删除');\n      });\n    };\n\n    onMounted(fetchCompanies);\n\n    return {\n      companies,\n      searchQuery,\n      isModalOpen,\n      currentItem,\n      fetchCompanies,\n      debouncedFetchCompanies,\n      openModal,\n      closeModal,\n      saveItem,\n      confirmDelete,\n    };\n  },\n};\n</script>\n\n<style scoped>\n@import './shared-styles.css';\n</style> \n "],"mappings":"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","ignoreList":[]}]}