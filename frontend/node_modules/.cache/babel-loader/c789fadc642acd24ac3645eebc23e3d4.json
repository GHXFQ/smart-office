{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue","mtime":1748076730822},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748076840894},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgeyByZWYsIGNvbXB1dGVkLCB3YXRjaCwgb25Nb3VudGVkIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlUm91dGUsIHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCB9IGZyb20gJ2VsZW1lbnQtcGx1cyc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IGdldERvY3VtZW50cywgZ2V0RG9jdW1lbnREZXRhaWwsIGNyZWF0ZURvY3VtZW50LCB1cGRhdGVEb2N1bWVudCwgZGVsZXRlRG9jdW1lbnQgYXMgYXBpRGVsZXRlRG9jdW1lbnQsIHNoYXJlRG9jdW1lbnQgYXMgYXBpU2hhcmVEb2N1bWVudCwgZ2V0UmVsYXRlZERvY3VtZW50cywgZ2VuZXJhdGVSZWxhdGVkRG9jdW1lbnRzLCBnZXRUZXh0Q29tcGxldGlvbiB9IGZyb20gJ0AvYXBpL3NtYXJ0ZG9jJzsKaW1wb3J0IHsgRG9jdW1lbnQsIFBsdXMsIENpcmNsZUNoZWNrLCBEb3dubG9hZCwgTW9yZSwgU2VhcmNoLCBBcnJvd0xlZnQsIEFycm93UmlnaHQsIFNoYXJlIGFzIFNoYXJlSWNvbiwgUmVmcmVzaCB9IGZyb20gJ0BlbGVtZW50LXBsdXMvaWNvbnMtdnVlJzsKaW1wb3J0IHsgUXVpbGxFZGl0b3IgfSBmcm9tICdAdnVldXAvdnVlLXF1aWxsJzsKaW1wb3J0ICdAdnVldXAvdnVlLXF1aWxsL2Rpc3QvdnVlLXF1aWxsLnNub3cuY3NzJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgY29tcG9uZW50czogewogICAgRG9jdW1lbnQsCiAgICBQbHVzLAogICAgQ2lyY2xlQ2hlY2ssCiAgICBEb3dubG9hZCwKICAgIE1vcmUsCiAgICBTZWFyY2gsCiAgICBBcnJvd0xlZnQsCiAgICBBcnJvd1JpZ2h0LAogICAgU2hhcmVJY29uLAogICAgUXVpbGxFZGl0b3IsCiAgICBSZWZyZXNoCiAgfSwKICBzZXR1cCgpIHsKICAgIGNvbnN0IHJvdXRlID0gdXNlUm91dGUoKTsKICAgIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpOwoKICAgIC8vIOeKtuaAgeaVsOaNrgogICAgY29uc3QgZG9jdW1lbnRzID0gcmVmKFtdKTsKICAgIGNvbnN0IGN1cnJlbnREb2MgPSByZWYobnVsbCk7CiAgICBjb25zdCBkb2N1bWVudENoYW5nZWQgPSByZWYoZmFsc2UpOwogICAgY29uc3QgaXNEb2NMaXN0Q29sbGFwc2VkID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGlzQXNzaXN0YW50Q29sbGFwc2VkID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGFjdGl2ZUFzc2lzdGFudFRhYiA9IHJlZignY29udGV4dCcpOwogICAgY29uc3Qgc2VhcmNoUXVlcnkgPSByZWYoJycpOwogICAgY29uc3QgZG9jVHlwZUZpbHRlciA9IHJlZignJyk7CiAgICBjb25zdCBzb3J0T3B0aW9uID0gcmVmKCd1cGRhdGUnKTsKICAgIGNvbnN0IG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzaGFyZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZGVsZXRlRGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBrbm93bGVkZ2VRdWVyeSA9IHJlZignJyk7CiAgICBjb25zdCByZWxhdGVkRG9jdW1lbnRzID0gcmVmKFtdKTsKICAgIGNvbnN0IHNlbGVjdGVkVXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgYXZhaWxhYmxlVXNlcnMgPSByZWYoW10pOwoKICAgIC8vIOe8lui+keWZqOeKtuaAgQogICAgY29uc3QgcXVpbGxSZWYgPSByZWYobnVsbCk7CiAgICBjb25zdCBjdXJyZW50U2VsZWN0aW9uID0gcmVmKG51bGwpOyAvLyDkv53lrZjlvZPliY3lhYnmoIfpgInmi6kKICAgIGNvbnN0IGxhc3RDdXJzb3JDaGFuZ2UgPSByZWYoRGF0ZS5ub3coKSk7IC8vIOWFieagh+S4iuasoeWPmOWMlueahOaXtumXtOaIswogICAgY29uc3QgY3VycmVudENvbXBsZXRpb25TdWdnZXN0aW9uID0gcmVmKCcnKTsgLy8g5b2T5YmN6KGl5YWo5bu66K6uCiAgICBjb25zdCBjb21wbGV0aW9uT3ZlcmxheSA9IHJlZihudWxsKTsgLy8g6KGl5YWo5rWu5bGC5byV55SoCiAgICBjb25zdCBpc1JlcXVlc3RpbmdDb21wbGV0aW9uID0gcmVmKGZhbHNlKTsgLy8g5piv5ZCm5q2j5Zyo6K+35rGC6KGl5YWoCiAgICBjb25zdCBjb21wbGV0aW9uRGVib3VuY2VUaW1lciA9IHJlZihudWxsKTsgLy8g6KGl5YWo6Ziy5oqW5a6a5pe25ZmoCgogICAgLy8g5Yqg6L2954q25oCBCiAgICBjb25zdCBzYXZlTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBjcmVhdGVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNoYXJlTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBkZWxldGVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHJlbGF0ZWRMb2FkaW5nID0gcmVmKGZhbHNlKTsKCiAgICAvLyDooajljZXmlbDmja4KICAgIGNvbnN0IG5ld0RvY3VtZW50Rm9ybSA9IHJlZih7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdHlwZTogJycKICAgIH0pOwoKICAgIC8vIOihqOWNlemqjOivgeinhOWImQogICAgY29uc3QgZG9jdW1lbnRGb3JtUnVsZXMgPSB7CiAgICAgIHRpdGxlOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmlofmoaPmoIfpopgnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgbWluOiAyLAogICAgICAgIG1heDogNTAsCiAgICAgICAgbWVzc2FnZTogJ+agh+mimOmVv+W6pumhu+WcqDLliLA1MOS4quWtl+espuS5i+mXtCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dCiAgICB9OwogICAgY29uc3QgZG9jdW1lbnRGb3JtUmVmID0gcmVmKG51bGwpOwoKICAgIC8vIOe8lui+keWZqOmFjee9rgogICAgY29uc3QgZWRpdG9yT3B0aW9ucyA9IHsKICAgICAgcGxhY2Vob2xkZXI6ICcgJywKICAgICAgbW9kdWxlczogewogICAgICAgIHRvb2xiYXI6IFtbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdzdHJpa2UnXSwgWydibG9ja3F1b3RlJywgJ2NvZGUtYmxvY2snXSwgW3sKICAgICAgICAgICdoZWFkZXInOiAxCiAgICAgICAgfSwgewogICAgICAgICAgJ2hlYWRlcic6IDIKICAgICAgICB9XSwgW3sKICAgICAgICAgICdsaXN0JzogJ29yZGVyZWQnCiAgICAgICAgfSwgewogICAgICAgICAgJ2xpc3QnOiAnYnVsbGV0JwogICAgICAgIH1dLCBbewogICAgICAgICAgJ3NjcmlwdCc6ICdzdWInCiAgICAgICAgfSwgewogICAgICAgICAgJ3NjcmlwdCc6ICdzdXBlcicKICAgICAgICB9XSwgW3sKICAgICAgICAgICdpbmRlbnQnOiAnLTEnCiAgICAgICAgfSwgewogICAgICAgICAgJ2luZGVudCc6ICcrMScKICAgICAgICB9XSwgW3sKICAgICAgICAgICdkaXJlY3Rpb24nOiAncnRsJwogICAgICAgIH1dLCBbewogICAgICAgICAgJ3NpemUnOiBbJ3NtYWxsJywgZmFsc2UsICdsYXJnZScsICdodWdlJ10KICAgICAgICB9XSwgW3sKICAgICAgICAgICdoZWFkZXInOiBbMSwgMiwgMywgNCwgNSwgNiwgZmFsc2VdCiAgICAgICAgfV0sIFt7CiAgICAgICAgICAnY29sb3InOiBbXQogICAgICAgIH0sIHsKICAgICAgICAgICdiYWNrZ3JvdW5kJzogW10KICAgICAgICB9XSwgW3sKICAgICAgICAgICdmb250JzogW10KICAgICAgICB9XSwgW3sKICAgICAgICAgICdhbGlnbic6IFtdCiAgICAgICAgfV0sIFsnY2xlYW4nXSwgWydsaW5rJywgJ2ltYWdlJ11dCiAgICAgIH0KICAgIH07CgogICAgLy8g6K6h566X5bGe5oCnCiAgICBjb25zdCBmaWx0ZXJlZERvY3VtZW50cyA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgbGV0IHJlc3VsdCA9IFsuLi5kb2N1bWVudHMudmFsdWVdOwoKICAgICAgLy8g5pCc57Si562b6YCJCiAgICAgIGlmIChzZWFyY2hRdWVyeS52YWx1ZSkgewogICAgICAgIGNvbnN0IHF1ZXJ5ID0gc2VhcmNoUXVlcnkudmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgICByZXN1bHQgPSByZXN1bHQuZmlsdGVyKGRvYyA9PiBkb2MudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgZG9jLnR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkpOwogICAgICB9CgogICAgICAvLyDnsbvlnovnrZvpgIkKICAgICAgaWYgKGRvY1R5cGVGaWx0ZXIudmFsdWUpIHsKICAgICAgICBjb25zdCB0eXBlRmlsdGVyID0gZG9jVHlwZUZpbHRlci52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoZG9jID0+IGRvYy50eXBlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModHlwZUZpbHRlcikpOwogICAgICB9CgogICAgICAvLyDmjpLluo8KICAgICAgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgcmVzdWx0LnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIudXBkYXRlX3RpbWUpIC0gbmV3IERhdGUoYS51cGRhdGVfdGltZSkpOwogICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICdjcmVhdGUnKSB7CiAgICAgICAgcmVzdWx0LnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIuY3JlYXRlX3RpbWUpIC0gbmV3IERhdGUoYS5jcmVhdGVfdGltZSkpOwogICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICduYW1lLWFzYycpIHsKICAgICAgICByZXN1bHQuc29ydCgoYSwgYikgPT4gYS50aXRsZS5sb2NhbGVDb21wYXJlKGIudGl0bGUpKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSk7CgogICAgLy8g5pa55rOVCiAgICBjb25zdCBmZXRjaERvY3VtZW50cyA9IGFzeW5jICgpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50cygpOwogICAgICAgIGRvY3VtZW50cy52YWx1ZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5paH5qGj5YiX6KGo5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign6I635Y+W5paH5qGj5YiX6KGo5aSx6LSlJyk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBmZXRjaERvY3VtZW50RGV0YWlsID0gYXN5bmMgaWQgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0RG9jdW1lbnREZXRhaWwoaWQpOwogICAgICAgIC8vIOajgOafpeaYr+WQpuiOt+WPluWIsOacieaViOeahOaWh+aho+aVsOaNrgogICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBjdXJyZW50RG9jLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgIC8vIOiOt+WPluebuOWFs+aWh+ahowogICAgICAgICAgZmV0Y2hSZWxhdGVkRG9jdW1lbnRzKGlkKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfmlofmoaPkuI3lrZjlnKjmiJbmlbDmja7ml6DmlYgnKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5paH5qGj6K+m5oOF5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcihlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCA/ICfmlofmoaPkuI3lrZjlnKgnIDogJ+iOt+WPluaWh+aho+ivpuaDheWksei0pScpOwogICAgICAgIC8vIOi/lOWbnuWIsOaWh+aho+WIl+ihqOmhtQogICAgICAgIHJvdXRlci5wdXNoKCcvc21hcnRkb2MnKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHNlbGVjdERvY3VtZW50ID0gYXN5bmMgaWQgPT4gewogICAgICAvLyDlpoLmnpzlvZPliY3mlofmoaPlt7Lkv67mlLnvvIzmj5DnpLrkv53lrZgKICAgICAgaWYgKGRvY3VtZW50Q2hhbmdlZC52YWx1ZSAmJiBjdXJyZW50RG9jLnZhbHVlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGF3YWl0IEVsTWVzc2FnZUJveC5jb25maXJtKCflvZPliY3mlofmoaPlt7Lkv67mlLnkvYbmnKrkv53lrZjvvIzmmK/lkKbkv53lrZjmm7TmlLnvvJ8nLCAn5L+d5a2Y5o+Q56S6JywgewogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+S/neWtmCcsCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICfkuI3kv53lrZgnLAogICAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICAgIH0pOwogICAgICAgICAgYXdhaXQgc2F2ZURvY3VtZW50KCk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIC8vIOeUqOaIt+mAieaLqeS4jeS/neWtmO+8jOe7p+e7reWIh+aNouaWh+ahowogICAgICAgICAgY29uc29sZS5sb2coJ+eUqOaIt+mAieaLqeS4jeS/neWtmCcpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8g5pu05paw6Lev55Sx5Lul5Y+N5pig5paw6YCJ5Lit55qE5paH5qGjCiAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnU21hcnREb2NEZXRhaWwnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgaWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHNhdmVEb2N1bWVudCA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8ICFkb2N1bWVudENoYW5nZWQudmFsdWUpIHJldHVybjsKICAgICAgc2F2ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IHVwZGF0ZURvY3VtZW50KGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHRpdGxlOiBjdXJyZW50RG9jLnZhbHVlLnRpdGxlLAogICAgICAgICAgdHlwZTogY3VycmVudERvYy52YWx1ZS50eXBlLAogICAgICAgICAgY29udGVudDogY3VycmVudERvYy52YWx1ZS5jb250ZW50CiAgICAgICAgfSk7CiAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gZmFsc2U7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+S/neWtmOaIkOWKnycpOwoKICAgICAgICAvLyDliLfmlrDnm7jlhbPmlofmoaMKICAgICAgICByZWZyZXNoUmVsYXRlZERvY3VtZW50cygpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOaWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+S/neWtmOaWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHNhdmVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCB0b2dnbGVEb2NMaXN0ID0gKCkgPT4gewogICAgICBpc0RvY0xpc3RDb2xsYXBzZWQudmFsdWUgPSAhaXNEb2NMaXN0Q29sbGFwc2VkLnZhbHVlOwogICAgfTsKICAgIGNvbnN0IHRvZ2dsZUFzc2lzdGFudCA9ICgpID0+IHsKICAgICAgaXNBc3Npc3RhbnRDb2xsYXBzZWQudmFsdWUgPSAhaXNBc3Npc3RhbnRDb2xsYXBzZWQudmFsdWU7CiAgICB9OwogICAgY29uc3Qgb25FZGl0b3JDaGFuZ2UgPSAoKSA9PiB7CiAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3Qgb3Blbk5ld0RvY3VtZW50RGlhbG9nID0gKCkgPT4gewogICAgICBuZXdEb2N1bWVudEZvcm0udmFsdWUgPSB7CiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIHR5cGU6ICcnCiAgICAgIH07CiAgICAgIG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3QgY3JlYXRlTmV3RG9jdW1lbnQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghZG9jdW1lbnRGb3JtUmVmLnZhbHVlKSByZXR1cm47CiAgICAgIGF3YWl0IGRvY3VtZW50Rm9ybVJlZi52YWx1ZS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY3JlYXRlRG9jdW1lbnQoewogICAgICAgICAgICAgIHRpdGxlOiBuZXdEb2N1bWVudEZvcm0udmFsdWUudGl0bGUsCiAgICAgICAgICAgICAgdHlwZTogbmV3RG9jdW1lbnRGb3JtLnZhbHVlLnR5cGUgfHwgJ+mAmueUqCcsCiAgICAgICAgICAgICAgY29udGVudDogJycKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPliJvlu7rmiJDlip8nKTsKICAgICAgICAgICAgbmV3RG9jdW1lbnREaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CgogICAgICAgICAgICAvLyDliLfmlrDmlofmoaPliJfooajlubbmiZPlvIDmlrDmlofmoaMKICAgICAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5pZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliJvlu7rmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yib5bu65paH5qGj5aSx6LSlJyk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgICBjb25zdCBzaGFyZURvY3VtZW50ID0gKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKCiAgICAgIC8vIOWcqOWunumZhemhueebruS4re+8jOi/memHjOW6lOivpeS7jkFQSeiOt+WPluWPr+eUqOeUqOaIt+WIl+ihqAogICAgICBhdmFpbGFibGVVc2Vycy52YWx1ZSA9IFt7CiAgICAgICAgaWQ6IDEsCiAgICAgICAgdXNlcm5hbWU6ICflvKDkuIknCiAgICAgIH0sIHsKICAgICAgICBpZDogMiwKICAgICAgICB1c2VybmFtZTogJ+adjuWbmycKICAgICAgfSwgewogICAgICAgIGlkOiAzLAogICAgICAgIHVzZXJuYW1lOiAn546L5LqUJwogICAgICB9XTsKICAgICAgc2VsZWN0ZWRVc2Vycy52YWx1ZSA9IFtdOwogICAgICBzaGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKICAgIGNvbnN0IGNvbmZpcm1TaGFyZSA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8IHNlbGVjdGVkVXNlcnMudmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+ivt+mAieaLqeiHs+WwkeS4gOS4queUqOaItycpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFwaVNoYXJlRG9jdW1lbnQoY3VycmVudERvYy52YWx1ZS5pZCwgc2VsZWN0ZWRVc2Vycy52YWx1ZSk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+WIhuS6q+aIkOWKnycpOwogICAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuS6q+aWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIhuS6q+aWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHNoYXJlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZGVsZXRlRG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSkgcmV0dXJuOwogICAgICBkZWxldGVEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBjb25maXJtRGVsZXRlID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgZGVsZXRlTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgYXBpRGVsZXRlRG9jdW1lbnQoY3VycmVudERvYy52YWx1ZS5pZCk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+WIoOmZpOaIkOWKnycpOwogICAgICAgIGRlbGV0ZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgLy8g6L+U5Zue5Yiw5paH5qGj5YiX6KGo6aG1CiAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOaWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOaWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGRlbGV0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGZldGNoUmVsYXRlZERvY3VtZW50cyA9IGFzeW5jIGlkID0+IHsKICAgICAgaWYgKCFpZCAmJiAhY3VycmVudERvYy52YWx1ZSkgcmV0dXJuOwogICAgICBjb25zdCBkb2NJZCA9IGlkIHx8IGN1cnJlbnREb2MudmFsdWUuaWQ7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRSZWxhdGVkRG9jdW1lbnRzKGRvY0lkKTsKICAgICAgICByZWxhdGVkRG9jdW1lbnRzLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bnm7jlhbPmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCByZWZyZXNoUmVsYXRlZERvY3VtZW50cyA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlKSByZXR1cm47CiAgICAgIHJlbGF0ZWRMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlUmVsYXRlZERvY3VtZW50cyhjdXJyZW50RG9jLnZhbHVlLmlkKTsKICAgICAgICByZWxhdGVkRG9jdW1lbnRzLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5bey5Yi35paw55u45YWz5paH5qGjJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yi35paw55u45YWz5paH5qGj5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yi35paw55u45YWz5paH5qGj5aSx6LSlJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgcmVsYXRlZExvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IG9wZW5SZWxhdGVkRG9jdW1lbnQgPSBkb2MgPT4gewogICAgICAvLyDojrflj5bmlofmoaNJROW5tuaJk+W8gAogICAgICBjb25zdCBkb2NJZCA9IGRvYy5yZWxhdGVkX2RvY3VtZW50X2lkOwogICAgICBpZiAoZG9jSWQpIHsKICAgICAgICBzZWxlY3REb2N1bWVudChkb2NJZCk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBleHBvcnREb2N1bWVudCA9ICgpID0+IHsKICAgICAgRWxNZXNzYWdlLmluZm8oJ+WvvOWHuuaWh+aho+WKn+iDveaaguacquWunueOsCcpOwogICAgfTsKICAgIGNvbnN0IHByaW50RG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIEVsTWVzc2FnZS5pbmZvKCfmiZPljbDmlofmoaPlip/og73mmoLmnKrlrp7njrAnKTsKICAgIH07CiAgICBjb25zdCBhZGRDb2xsYWJvcmF0b3IgPSAoKSA9PiB7CiAgICAgIEVsTWVzc2FnZS5pbmZvKCfmt7vliqDljY/kvZzogIXlip/og73mmoLmnKrlrp7njrAnKTsKICAgIH07CiAgICBjb25zdCB2aWV3SGlzdG9yeSA9ICgpID0+IHsKICAgICAgRWxNZXNzYWdlLmluZm8oJ+afpeeci+WOhuWPsueJiOacrOWKn+iDveaaguacquWunueOsCcpOwogICAgfTsKICAgIGNvbnN0IGFwcGx5U21hcnRBY3Rpb24gPSBhY3Rpb24gPT4gewogICAgICBFbE1lc3NhZ2UuaW5mbyhg5pm66IO95pON5L2cIiR7YWN0aW9ufSLlip/og73mmoLmnKrlrp7njrBgKTsKICAgIH07CgogICAgLy8g6Ziy5oqW5pCc57SiCiAgICBjb25zdCBkZWJvdW5jZWRTZWFyY2ggPSBfLmRlYm91bmNlKCgpID0+IHsKICAgICAgLy8g5pCc57Si6YC76L6R5bey6YCa6L+H6K6h566X5bGe5oCn5aSE55CGCiAgICB9LCAzMDApOwogICAgY29uc3QgZm9ybWF0RGF0ZSA9IGRhdGVTdHJpbmcgPT4gewogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7CiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CgogICAgICAvLyDlkIzkuIDlpKnmmL7npLrml7bpl7QKICAgICAgaWYgKGRhdGUudG9EYXRlU3RyaW5nKCkgPT09IG5vdy50b0RhdGVTdHJpbmcoKSkgewogICAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygnemgtQ04nLCB7CiAgICAgICAgICBob3VyOiAnMi1kaWdpdCcsCiAgICAgICAgICBtaW51dGU6ICcyLWRpZ2l0JwogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyDmmKjlpKkKICAgICAgY29uc3QgeWVzdGVyZGF5ID0gbmV3IERhdGUobm93KTsKICAgICAgeWVzdGVyZGF5LnNldERhdGUobm93LmdldERhdGUoKSAtIDEpOwogICAgICBpZiAoZGF0ZS50b0RhdGVTdHJpbmcoKSA9PT0geWVzdGVyZGF5LnRvRGF0ZVN0cmluZygpKSB7CiAgICAgICAgcmV0dXJuICfmmKjlpKknOwogICAgICB9CgogICAgICAvLyDkuIDlkajlhoXmmL7npLrmmJ/mnJ8KICAgICAgY29uc3Qgd2Vla0RheXMgPSBbJ+WRqOaXpScsICflkajkuIAnLCAn5ZGo5LqMJywgJ+WRqOS4iScsICflkajlm5snLCAn5ZGo5LqUJywgJ+WRqOWFrSddOwogICAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGgucm91bmQoKG5vdyAtIGRhdGUpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTsKICAgICAgaWYgKGRpZmZEYXlzIDwgNykgewogICAgICAgIHJldHVybiB3ZWVrRGF5c1tkYXRlLmdldERheSgpXTsKICAgICAgfQoKICAgICAgLy8g5YW25LuW5oOF5Ya15pi+56S65pel5pyfCiAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnemgtQ04nLCB7CiAgICAgICAgbW9udGg6ICdudW1lcmljJywKICAgICAgICBkYXk6ICdudW1lcmljJwogICAgICB9KTsKICAgIH07CgogICAgLy8g55uR5ZCs6Lev55Sx5Y+Y5YyWCiAgICB3YXRjaCgoKSA9PiByb3V0ZS5wYXJhbXMuaWQsIG5ld0lkID0+IHsKICAgICAgaWYgKG5ld0lkKSB7CiAgICAgICAgLy8g5qOA5p+lSUTmmK/lkKbkuLrmnInmlYjlgLwKICAgICAgICBpZiAoaXNOYU4oTnVtYmVyKG5ld0lkKSkpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5pWI55qE5paH5qGjSUQnKTsKICAgICAgICAgIHJvdXRlci5wdXNoKCcvc21hcnRkb2MnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZmV0Y2hEb2N1bWVudERldGFpbChuZXdJZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudERvYy52YWx1ZSA9IG51bGw7CiAgICAgIH0KICAgIH0sIHsKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9KTsKCiAgICAvLyDoh6rliqjkv53lrZjlip/og70KICAgIHNldEludGVydmFsKCgpID0+IHsKICAgICAgaWYgKGRvY3VtZW50Q2hhbmdlZC52YWx1ZSAmJiBjdXJyZW50RG9jLnZhbHVlICYmICFzYXZlTG9hZGluZy52YWx1ZSkgewogICAgICAgIHNhdmVEb2N1bWVudCgpOwogICAgICB9CiAgICB9LCA2MDAwMCk7IC8vIOavj+WIhumSn+iHquWKqOS/neWtmOS4gOasoQoKICAgIC8vIOeUn+WRveWRqOacn+mSqeWtkAogICAgb25Nb3VudGVkKCgpID0+IHsKICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKCiAgICAgIC8vIOS7jui3r+eUseiOt+WPluaWh+aho0lECiAgICAgIGNvbnN0IGRvY0lkID0gcm91dGUucGFyYW1zLmlkOwogICAgICBpZiAoZG9jSWQpIHsKICAgICAgICBmZXRjaERvY3VtZW50RGV0YWlsKGRvY0lkKTsKICAgICAgfQoKICAgICAgLy8g5bu26L+f6K6+572u57yW6L6R5Zmo5LqL5Lu255uR5ZCsCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHNldHVwUXVpbGxFZGl0b3IoKTsKICAgICAgfSwgMTAwMCk7CiAgICB9KTsKCiAgICAvLyDorr7nva5RdWlsbOe8lui+keWZqOWPiuS6i+S7tuebkeWQrAogICAgY29uc3Qgc2V0dXBRdWlsbEVkaXRvciA9ICgpID0+IHsKICAgICAgLy8g6I635Y+WUXVpbGzlrp7kvosKICAgICAgY29uc3QgcXVpbGxJbnN0YW5jZSA9IHF1aWxsUmVmLnZhbHVlICYmIHF1aWxsUmVmLnZhbHVlLmdldFF1aWxsID8gcXVpbGxSZWYudmFsdWUuZ2V0UXVpbGwoKSA6IG51bGw7CiAgICAgIGlmICghcXVpbGxJbnN0YW5jZSkgewogICAgICAgIGNvbnNvbGUud2Fybign5pyq6IO96I635Y+WUXVpbGzlrp7kvovvvIzml6Dms5Xorr7nva7kuovku7bnm5HlkKwnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ1vooaXlhajosIPor5VdIOaIkOWKn+iOt+WPllF1aWxs5a6e5L6L77yM6K6+572u5LqL5Lu255uR5ZCsJyk7CgogICAgICAvLyDnm5HlkKzlhYnmoIfkvY3nva7lj5jljJYKICAgICAgcXVpbGxJbnN0YW5jZS5vbignc2VsZWN0aW9uLWNoYW5nZScsIChyYW5nZSwgb2xkUmFuZ2UsIHNvdXJjZSkgPT4gewogICAgICAgIGlmIChyYW5nZSkgewogICAgICAgICAgLy8g5L+d5a2Y5b2T5YmN6YCJ5oup6IyD5Zu0CiAgICAgICAgICBjdXJyZW50U2VsZWN0aW9uLnZhbHVlID0gcmFuZ2U7CiAgICAgICAgICBsYXN0Q3Vyc29yQ2hhbmdlLnZhbHVlID0gRGF0ZS5ub3coKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdb6KGl5YWo6LCD6K+VXSDlhYnmoIfkvY3nva7lt7Lmm7TmlrA6JywgcmFuZ2UuaW5kZXgsIHJhbmdlLmxlbmd0aCk7CgogICAgICAgICAgLy8g6ZqQ6JeP5b2T5YmN6KGl5YWo5bu66K6uCiAgICAgICAgICBoaWRlQ29tcGxldGlvblN1Z2dlc3Rpb24oKTsKCiAgICAgICAgICAvLyDpmLLmipbor7fmsYLmlrDnmoTooaXlhajlu7rorq4KICAgICAgICAgIGlmIChjb21wbGV0aW9uRGVib3VuY2VUaW1lci52YWx1ZSkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoY29tcGxldGlvbkRlYm91bmNlVGltZXIudmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgY29tcGxldGlvbkRlYm91bmNlVGltZXIudmFsdWUgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgcmVxdWVzdENvbXBsZXRpb25TdWdnZXN0aW9uKCk7CiAgICAgICAgICB9LCA2MDApOyAvLyDlhYnmoIflgZznlZk2MDBtc+WQjuiHquWKqOivt+axguihpeWFqAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDnlKjmiLfpgInlj5bkuobkuIDmrrXmlofmnKzvvIzmuIXpmaTku7vkvZXooaXlhajlu7rorq4KICAgICAgICAgIGhpZGVDb21wbGV0aW9uU3VnZ2VzdGlvbigpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICAvLyDnm5HlkKzmlofmnKzlj5jljJYKICAgICAgcXVpbGxJbnN0YW5jZS5vbigndGV4dC1jaGFuZ2UnLCAoZGVsdGEsIG9sZERlbHRhLCBzb3VyY2UpID0+IHsKICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwoKICAgICAgICAvLyDpmpDol4/lvZPliY3ooaXlhajlu7rorq4KICAgICAgICBoaWRlQ29tcGxldGlvblN1Z2dlc3Rpb24oKTsKCiAgICAgICAgLy8g6Ziy5oqW6K+35rGC5paw55qE6KGl5YWo5bu66K6uCiAgICAgICAgaWYgKGNvbXBsZXRpb25EZWJvdW5jZVRpbWVyLnZhbHVlKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoY29tcGxldGlvbkRlYm91bmNlVGltZXIudmFsdWUpOwogICAgICAgIH0KICAgICAgICBjb21wbGV0aW9uRGVib3VuY2VUaW1lci52YWx1ZSA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVxdWVzdENvbXBsZXRpb25TdWdnZXN0aW9uKCk7CiAgICAgICAgfSwgNjAwKTsgLy8g5paH5pys5Y+Y5YyW5ZCONjAwbXPoh6rliqjor7fmsYLooaXlhagKICAgICAgfSk7CgogICAgICAvLyDnm5HlkKxUYWLplK4KICAgICAgY29uc3QgcXVpbGxFZGl0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucXVpbGwtZWRpdG9yIC5xbC1lZGl0b3InKTsKICAgICAgaWYgKHF1aWxsRWRpdG9yKSB7CiAgICAgICAgcXVpbGxFZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFzeW5jIGUgPT4gewogICAgICAgICAgLy8g5peg6K665L2V5pe25oyJ5LiLVGFi77yM6YO96KaB6Zi75q2i6buY6K6k6KGM5Li6CiAgICAgICAgICBpZiAoZS5rZXkgPT09ICdUYWInKSB7CiAgICAgICAgICAgIC8vIOeri+WNs+mYu+atoum7mOiupFRhYumUruihjOS4ugogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIGlmIChjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUpIHsKICAgICAgICAgICAgICBhY2NlcHRDb21wbGV0aW9uU3VnZ2VzdGlvbigpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIOWmguaenOayoeacieihpeWFqOW7uuiuru+8jOWPr+S7peaJi+WKqOivt+axguS4gOasoQogICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVRhYkNvbXBsZXRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyDmt7vliqDml6Xlv5fku6Xnoa7orqRUYWLplK7mmK/lkKbooqvmraPnoa7lpITnkIYKICAgICAgICAgICAgY29uc29sZS5sb2coJ1vooaXlhajosIPor5VdIFRhYumUruiiq+WkhOeQhu+8jOmYu+atouS6hum7mOiupOihjOS4uicpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykgewogICAgICAgICAgICAvLyBFc2NhcGXplK7lj5bmtojlvZPliY3ooaXlhajlu7rorq4KICAgICAgICAgICAgaGlkZUNvbXBsZXRpb25TdWdnZXN0aW9uKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgY2FwdHVyZTogdHJ1ZQogICAgICAgIH0pOyAvLyDkvb/nlKjmjZXojrfpmLbmrrXku6Xnoa7kv53miJHku6znmoTlpITnkIblhYjkuo7lhbbku5blpITnkIYKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oJ+acquaJvuWIsCAucXVpbGwtZWRpdG9yIC5xbC1lZGl0b3IgRE9NJyk7CiAgICAgIH0KICAgIH07CgogICAgLy8g6K+35rGC6KGl5YWo5bu66K6uCiAgICBjb25zdCByZXF1ZXN0Q29tcGxldGlvblN1Z2dlc3Rpb24gPSBhc3luYyAoKSA9PiB7CiAgICAgIC8vIOWmguaenOato+WcqOivt+axguS4re+8jOWImeS4jemHjeWkjeivt+axggogICAgICBpZiAoaXNSZXF1ZXN0aW5nQ29tcGxldGlvbi52YWx1ZSkgcmV0dXJuOwoKICAgICAgLy8g5aaC5p6c57yW6L6R5Zmo5LiN5Y+v6KeB5oiW6aG16Z2i5LiN5Zyo5rS75Yqo54q25oCB77yM5LiN6K+35rGC6KGl5YWoCiAgICAgIGlmIChkb2N1bWVudC5oaWRkZW4pIHJldHVybjsKCiAgICAgIC8vIOiOt+WPllF1aWxs5a6e5L6LCiAgICAgIGNvbnN0IHF1aWxsSW5zdGFuY2UgPSBxdWlsbFJlZi52YWx1ZSAmJiBxdWlsbFJlZi52YWx1ZS5nZXRRdWlsbCA/IHF1aWxsUmVmLnZhbHVlLmdldFF1aWxsKCkgOiBudWxsOwogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UpIHJldHVybjsKCiAgICAgIC8vIOiOt+WPluW9k+WJjeWFieagh+S9jee9rgogICAgICBsZXQgc2VsZWN0aW9uID0gY3VycmVudFNlbGVjdGlvbi52YWx1ZTsKICAgICAgaWYgKCFzZWxlY3Rpb24pIHsKICAgICAgICBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGlmICghc2VsZWN0aW9uKSByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOiusOW9leihpeWFqOivt+axgu+8jOmBv+WFjeefreaXtumXtOWGheWkmuasoeivt+axggogICAgICBpc1JlcXVlc3RpbmdDb21wbGV0aW9uLnZhbHVlID0gdHJ1ZTsKICAgICAgY29uc3QgY3Vyc29yUG9zID0gc2VsZWN0aW9uLmluZGV4OwogICAgICBjb25zdCBmdWxsVGV4dCA9IHF1aWxsSW5zdGFuY2UuZ2V0VGV4dCgpOyAvLyDojrflj5blrozmlbTmlofmnKwKCiAgICAgIC8vIOiOt+WPluS4iuS4i+aWhwogICAgICBjb25zdCBjb250ZXh0QmVmb3JlID0gZ2V0Q29udGV4dEJlZm9yZShmdWxsVGV4dCwgY3Vyc29yUG9zKTsKICAgICAgY29uc3QgY29udGV4dEFmdGVyID0gZ2V0Q29udGV4dEFmdGVyKGZ1bGxUZXh0LCBjdXJzb3JQb3MpOwoKICAgICAgLy8g5aaC5p6c5LiK5LiL5paH6L+H5bCR77yM5LiN6L+b6KGM6KGl5YWoCiAgICAgIGlmIChjb250ZXh0QmVmb3JlLmxlbmd0aCA8IDUpIHsKICAgICAgICBpc1JlcXVlc3RpbmdDb21wbGV0aW9uLnZhbHVlID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIF9yZXNwb25zZSRkYXRhOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0VGV4dENvbXBsZXRpb24oewogICAgICAgICAgY29udGVudDogZnVsbFRleHQsCiAgICAgICAgICBjdXJzb3JfcG9zOiBjdXJzb3JQb3MsCiAgICAgICAgICBjb250ZXh0X2JlZm9yZTogY29udGV4dEJlZm9yZSwKICAgICAgICAgIGNvbnRleHRfYWZ0ZXI6IGNvbnRleHRBZnRlciwKICAgICAgICAgIG1heF90b2tlbnM6IDY0CiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgY29tcGxldGlvbiA9IChyZXNwb25zZSA9PT0gbnVsbCB8fCByZXNwb25zZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9yZXNwb25zZSRkYXRhID0gcmVzcG9uc2UuZGF0YSkgPT09IG51bGwgfHwgX3Jlc3BvbnNlJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXNwb25zZSRkYXRhLmNvbXBsZXRpb24pIHx8ICcnOwogICAgICAgIGlmIChjb21wbGV0aW9uKSB7CiAgICAgICAgICBjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUgPSBjb21wbGV0aW9uOwogICAgICAgICAgc2hvd0NvbXBsZXRpb25TdWdnZXN0aW9uKGN1cnNvclBvcyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdb6KGl5YWo6LCD6K+VXSDor7fmsYJBSeihpeWFqOW7uuiuruWksei0pScsIGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaXNSZXF1ZXN0aW5nQ29tcGxldGlvbi52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIC8vIOaYvuekuuihpeWFqOW7uuiuriAtIOmHjeaWsOWunueOsOS4uuS9v+eUqOWGheiBlOagt+W8jwogICAgY29uc3Qgc2hvd0NvbXBsZXRpb25TdWdnZXN0aW9uID0gY3Vyc29yUG9zID0+IHsKICAgICAgaWYgKCFjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUpIHJldHVybjsKICAgICAgY29uc3QgcXVpbGxJbnN0YW5jZSA9IHF1aWxsUmVmLnZhbHVlICYmIHF1aWxsUmVmLnZhbHVlLmdldFF1aWxsID8gcXVpbGxSZWYudmFsdWUuZ2V0UXVpbGwoKSA6IG51bGw7CiAgICAgIGlmICghcXVpbGxJbnN0YW5jZSkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIC8vIOWcqOWFieagh+WkhOaPkuWFpeW4puagt+W8j+eahOaWh+acrAogICAgICAgIHF1aWxsSW5zdGFuY2UuaW5zZXJ0VGV4dChjdXJzb3JQb3MsIGN1cnJlbnRDb21wbGV0aW9uU3VnZ2VzdGlvbi52YWx1ZSwgewogICAgICAgICAgJ2NvbG9yJzogJyM4ZThlOGUnLAogICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAnI2Y3ZjdmNycsCiAgICAgICAgICAnZ2hvc3QtY29tcGxldGlvbic6IHRydWUgLy8g6Ieq5a6a5LmJ5bGe5oCn77yM5L6/5LqO6K+G5YirCiAgICAgICAgfSk7CgogICAgICAgIC8vIOS/neaMgeWFieagh+WcqOWOn+adpeS9jee9ruS4jeWPmAogICAgICAgIHF1aWxsSW5zdGFuY2Uuc2V0U2VsZWN0aW9uKGN1cnNvclBvcywgMCk7CiAgICAgICAgY29uc29sZS5sb2coJ1vooaXlhajosIPor5VdIOaYvuekuuW5veeBteaWh+acrOihpeWFqDonLCBjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUpOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdb6KGl5YWo6LCD6K+VXSDmmL7npLrooaXlhajlu7rorq7lpLHotKU6JywgZXJyKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDpmpDol4/ooaXlhajlu7rorq4KICAgIGNvbnN0IGhpZGVDb21wbGV0aW9uU3VnZ2VzdGlvbiA9ICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBxdWlsbEluc3RhbmNlID0gcXVpbGxSZWYudmFsdWUgJiYgcXVpbGxSZWYudmFsdWUuZ2V0UXVpbGwgPyBxdWlsbFJlZi52YWx1ZS5nZXRRdWlsbCgpIDogbnVsbDsKICAgICAgICBpZiAoIXF1aWxsSW5zdGFuY2UpIHJldHVybjsKCiAgICAgICAgLy8g5om+5Yiw5omA5pyJZ2hvc3QtY29tcGxldGlvbuWxnuaAp+eahOaWh+acrOW5tuenu+mZpAogICAgICAgIGNvbnN0IGNvbnRlbnRzID0gcXVpbGxJbnN0YW5jZS5nZXRDb250ZW50cygpLm9wczsKICAgICAgICBsZXQgaW5kZXggPSAwOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29udGVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IG9wID0gY29udGVudHNbaV07CiAgICAgICAgICBjb25zdCBsZW5ndGggPSBvcC5pbnNlcnQgPyBTdHJpbmcob3AuaW5zZXJ0KS5sZW5ndGggOiAxOwoKICAgICAgICAgIC8vIOajgOafpeaYr+WQpuaciWdob3N0LWNvbXBsZXRpb27lsZ7mgKcKICAgICAgICAgIGlmIChvcC5hdHRyaWJ1dGVzICYmIG9wLmF0dHJpYnV0ZXNbJ2dob3N0LWNvbXBsZXRpb24nXSkgewogICAgICAgICAgICAvLyDliKDpmaTov5nmrrXmlofmnKwKICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS5kZWxldGVUZXh0KGluZGV4LCBsZW5ndGgpOwogICAgICAgICAgICBicmVhazsgLy8g5LiA6Iis5Y+q5pyJ5LiA5q615bm954G15paH5pysCiAgICAgICAgICB9CiAgICAgICAgICBpbmRleCArPSBsZW5ndGg7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCdb6KGl5YWo6LCD6K+VXSDmuIXpmaTlub3ngbXmlofmnKzooaXlhagnKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW+ihpeWFqOiwg+ivlV0g6ZqQ6JeP6KGl5YWo5bu66K6u5aSx6LSlOicsIGVycik7CiAgICAgIH0KICAgICAgY3VycmVudENvbXBsZXRpb25TdWdnZXN0aW9uLnZhbHVlID0gJyc7CiAgICB9OwoKICAgIC8vIOaOpeWPl+ihpeWFqOW7uuiurgogICAgY29uc3QgYWNjZXB0Q29tcGxldGlvblN1Z2dlc3Rpb24gPSAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudENvbXBsZXRpb25TdWdnZXN0aW9uLnZhbHVlKSByZXR1cm47CiAgICAgIGNvbnN0IHF1aWxsSW5zdGFuY2UgPSBxdWlsbFJlZi52YWx1ZSAmJiBxdWlsbFJlZi52YWx1ZS5nZXRRdWlsbCA/IHF1aWxsUmVmLnZhbHVlLmdldFF1aWxsKCkgOiBudWxsOwogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UpIHJldHVybjsKICAgICAgY29uc3Qgc2VsZWN0aW9uID0gY3VycmVudFNlbGVjdGlvbi52YWx1ZSB8fCBxdWlsbEluc3RhbmNlLmdldFNlbGVjdGlvbigpOwogICAgICBpZiAoIXNlbGVjdGlvbikgcmV0dXJuOwogICAgICBjb25zdCBjdXJzb3JQb3MgPSBzZWxlY3Rpb24uaW5kZXg7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5om+5Yiw5bm954G15paH5pys5bm25pu/5o2i5Li65pmu6YCa5paH5pysCiAgICAgICAgY29uc3QgY29udGVudHMgPSBxdWlsbEluc3RhbmNlLmdldENvbnRlbnRzKCkub3BzOwogICAgICAgIGxldCBpbmRleCA9IDA7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3Qgb3AgPSBjb250ZW50c1tpXTsKICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IG9wLmluc2VydCA/IFN0cmluZyhvcC5pbnNlcnQpLmxlbmd0aCA6IDE7CgogICAgICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJZ2hvc3QtY29tcGxldGlvbuWxnuaApwogICAgICAgICAgaWYgKG9wLmF0dHJpYnV0ZXMgJiYgb3AuYXR0cmlidXRlc1snZ2hvc3QtY29tcGxldGlvbiddKSB7CiAgICAgICAgICAgIC8vIOWIoOmZpOW5veeBteaWh+acrAogICAgICAgICAgICBxdWlsbEluc3RhbmNlLmRlbGV0ZVRleHQoaW5kZXgsIGxlbmd0aCk7CgogICAgICAgICAgICAvLyDmj5LlhaXmma7pgJrmlofmnKwKICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS5pbnNlcnRUZXh0KGluZGV4LCBjdXJyZW50Q29tcGxldGlvblN1Z2dlc3Rpb24udmFsdWUpOwoKICAgICAgICAgICAgLy8g5bCG5YWJ5qCH56e75Yiw6KGl5YWo5paH5pys5pyr5bC+CiAgICAgICAgICAgIHF1aWxsSW5zdGFuY2Uuc2V0U2VsZWN0aW9uKGluZGV4ICsgY3VycmVudENvbXBsZXRpb25TdWdnZXN0aW9uLnZhbHVlLmxlbmd0aCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgaW5kZXggKz0gbGVuZ3RoOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygnW+ihpeWFqOiwg+ivlV0g5o6l5Y+X6KGl5YWo5bu66K6uOicsIGN1cnJlbnRDb21wbGV0aW9uU3VnZ2VzdGlvbi52YWx1ZSk7CgogICAgICAgIC8vIOmHjee9ruW9k+WJjeihpeWFqOW7uuiurgogICAgICAgIGN1cnJlbnRDb21wbGV0aW9uU3VnZ2VzdGlvbi52YWx1ZSA9ICcnOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdb6KGl5YWo6LCD6K+VXSDmjqXlj5fooaXlhajlu7rorq7lpLHotKU6JywgZXJyKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDlpITnkIZUYWLplK7ooaXlhaggLSDnjrDlnKjlj6rkvZzkuLrlpIfnlKjmlrnmoYgKICAgIGNvbnN0IGhhbmRsZVRhYkNvbXBsZXRpb24gPSBhc3luYyAoKSA9PiB7CiAgICAgIC8vIOWmguaenOW9k+WJjeacieihpeWFqOW7uuiuru+8jOS8mOWFiOaOpeWPl+WugwogICAgICBpZiAoY3VycmVudENvbXBsZXRpb25TdWdnZXN0aW9uLnZhbHVlKSB7CiAgICAgICAgYWNjZXB0Q29tcGxldGlvblN1Z2dlc3Rpb24oKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOiOt+WPllF1aWxs5a6e5L6LCiAgICAgIGNvbnN0IHF1aWxsSW5zdGFuY2UgPSBxdWlsbFJlZi52YWx1ZSAmJiBxdWlsbFJlZi52YWx1ZS5nZXRRdWlsbCA/IHF1aWxsUmVmLnZhbHVlLmdldFF1aWxsKCkgOiBudWxsOwogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ+acquiOt+WPluWIsFF1aWxs5a6e5L6LJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyDojrflj5bmnIDmlrDlhYnmoIfkvY3nva4KICAgICAgbGV0IHNlbGVjdGlvbiA9IGN1cnJlbnRTZWxlY3Rpb24udmFsdWU7CiAgICAgIGlmICghc2VsZWN0aW9uKSB7CiAgICAgICAgc2VsZWN0aW9uID0gcXVpbGxJbnN0YW5jZS5nZXRTZWxlY3Rpb24oKTsKICAgICAgICBpZiAoIXNlbGVjdGlvbikgewogICAgICAgICAgY29uc29sZS53YXJuKCfmnKrojrflj5bliLDlhYnmoIfkvY3nva4nKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgY3Vyc29yUG9zID0gc2VsZWN0aW9uLmluZGV4OwogICAgICBjb25zdCBmdWxsVGV4dCA9IHF1aWxsSW5zdGFuY2UuZ2V0VGV4dCgpOyAvLyDojrflj5blrozmlbTmlofmnKwKCiAgICAgIC8vIOiOt+WPluWFieagh+WJjeWQjueahOS4iuS4i+aWhwogICAgICBjb25zdCBjb250ZXh0QmVmb3JlID0gZ2V0Q29udGV4dEJlZm9yZShmdWxsVGV4dCwgY3Vyc29yUG9zKTsKICAgICAgY29uc3QgY29udGV4dEFmdGVyID0gZ2V0Q29udGV4dEFmdGVyKGZ1bGxUZXh0LCBjdXJzb3JQb3MpOwogICAgICBjb25zb2xlLmxvZygnW+ihpeWFqOiwg+ivlV0gVGFi6Kem5Y+R77yM5b2T5YmN5YWJ5qCH5L2N572u77yaJywgY3Vyc29yUG9zKTsKICAgICAgY29uc29sZS5sb2coJ1vooaXlhajosIPor5VdIOWFieagh+WJjeS4iuS4i+aWh++8micsIGNvbnRleHRCZWZvcmUpOwogICAgICBjb25zb2xlLmxvZygnW+ihpeWFqOiwg+ivlV0g5YWJ5qCH5ZCO5LiK5LiL5paH77yaJywgY29udGV4dEFmdGVyKTsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgX3Jlc3BvbnNlJGRhdGEyOwogICAgICAgIC8vIOaYvuekuuWKoOi9veeKtuaAgQogICAgICAgIEVsTWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiAnQUnooaXlhajkuK0uLi4nLAogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICB9KTsKCiAgICAgICAgLy8g5L2/55So5bCB6KOFQVBJ6LCD55SoCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRUZXh0Q29tcGxldGlvbih7CiAgICAgICAgICBjb250ZW50OiBmdWxsVGV4dCwKICAgICAgICAgIGN1cnNvcl9wb3M6IGN1cnNvclBvcywKICAgICAgICAgIGNvbnRleHRfYmVmb3JlOiBjb250ZXh0QmVmb3JlLAogICAgICAgICAgY29udGV4dF9hZnRlcjogY29udGV4dEFmdGVyLAogICAgICAgICAgbWF4X3Rva2VuczogNjQKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygnW+ihpeWFqOiwg+ivlV0g5ZCO56uv5ZON5bqU77yaJywgcmVzcG9uc2UpOwogICAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSAocmVzcG9uc2UgPT09IG51bGwgfHwgcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfcmVzcG9uc2UkZGF0YTIgPSByZXNwb25zZS5kYXRhKSA9PT0gbnVsbCB8fCBfcmVzcG9uc2UkZGF0YTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXNwb25zZSRkYXRhMi5jb21wbGV0aW9uKSB8fCAnJzsKICAgICAgICBpZiAoY29tcGxldGlvbikgewogICAgICAgICAgcXVpbGxJbnN0YW5jZS5pbnNlcnRUZXh0KGN1cnNvclBvcywgY29tcGxldGlvbik7CiAgICAgICAgICBxdWlsbEluc3RhbmNlLnNldFNlbGVjdGlvbihjdXJzb3JQb3MgKyBjb21wbGV0aW9uLmxlbmd0aCk7CiAgICAgICAgICBjb25zb2xlLmxvZygnW+ihpeWFqOiwg+ivlV0g6KGl5YWo5paH5pys5bey5o+S5YWl77yaJywgY29tcGxldGlvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybignW+ihpeWFqOiwg+ivlV0g5ZCO56uv5peg6KGl5YWo5paH5pys6L+U5ZueJyk7CiAgICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn5pyq6IO96I635Y+W6KGl5YWo5YaF5a65JywKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1vooaXlhajosIPor5VdIEFJ6KGl5YWo5aSx6LSlJywgZXJyKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ0FJ6KGl5YWo5aSx6LSl77yM6K+356iN5ZCO6YeN6K+VJyk7CiAgICAgIH0KICAgIH07CgogICAgLy8g6I635Y+W5YWJ5qCH5YmN55qE5pm66IO95LiK5LiL5paHCiAgICBjb25zdCBnZXRDb250ZXh0QmVmb3JlID0gKHRleHQsIGN1cnNvclBvcywgbWF4Q2hhcnMgPSAyMDApID0+IHsKICAgICAgLy8g5LuO5YWJ5qCH5L2N572u5ZCR5YmN6I635Y+W5paH5pysCiAgICAgIGNvbnN0IGJlZm9yZVRleHQgPSB0ZXh0LnN1YnN0cmluZyhNYXRoLm1heCgwLCBjdXJzb3JQb3MgLSBtYXhDaGFycyksIGN1cnNvclBvcyk7CgogICAgICAvLyDlsJ3or5Xmj5Dlj5blvZPliY3mrrXokL3miJbmm7TmnInmhI/kuYnnmoTkuIrkuIvmlocKICAgICAgY29uc3QgcGFyYWdyYXBoRGVsaW1pdGVycyA9IFsnXG5cbicsICdcbiddOwogICAgICBmb3IgKGNvbnN0IGRlbGltaXRlciBvZiBwYXJhZ3JhcGhEZWxpbWl0ZXJzKSB7CiAgICAgICAgY29uc3QgbGFzdERlbGltaXRlclBvcyA9IGJlZm9yZVRleHQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTsKICAgICAgICBpZiAobGFzdERlbGltaXRlclBvcyAhPT0gLTEgJiYgYmVmb3JlVGV4dC5sZW5ndGggLSBsYXN0RGVsaW1pdGVyUG9zID4gMTApIHsKICAgICAgICAgIHJldHVybiBiZWZvcmVUZXh0LnN1YnN0cmluZyhsYXN0RGVsaW1pdGVyUG9zICsgZGVsaW1pdGVyLmxlbmd0aCk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyDoi6XmsqHmib7liLDmrrXokL3liIbpmpTnrKbvvIzov5Tlm57lrozmlbTkuIrkuIvmlocKICAgICAgcmV0dXJuIGJlZm9yZVRleHQ7CiAgICB9OwoKICAgIC8vIOiOt+WPluWFieagh+WQjueahOaZuuiDveS4iuS4i+aWhwogICAgY29uc3QgZ2V0Q29udGV4dEFmdGVyID0gKHRleHQsIGN1cnNvclBvcywgbWF4Q2hhcnMgPSAyMDApID0+IHsKICAgICAgLy8g5LuO5YWJ5qCH5L2N572u5ZCR5ZCO6I635Y+W5paH5pysCiAgICAgIGNvbnN0IGFmdGVyVGV4dCA9IHRleHQuc3Vic3RyaW5nKGN1cnNvclBvcywgTWF0aC5taW4odGV4dC5sZW5ndGgsIGN1cnNvclBvcyArIG1heENoYXJzKSk7CgogICAgICAvLyDlsJ3or5Xmj5Dlj5blvZPliY3lj6XlrZDmiJbmrrXokL3nmoTnu5PmnZ8KICAgICAgY29uc3QgcGFyYWdyYXBoRGVsaW1pdGVycyA9IFsnXG5cbicsICdcbicsICcuICcsICc/ICcsICchICddOwogICAgICBmb3IgKGNvbnN0IGRlbGltaXRlciBvZiBwYXJhZ3JhcGhEZWxpbWl0ZXJzKSB7CiAgICAgICAgY29uc3QgbmV4dERlbGltaXRlclBvcyA9IGFmdGVyVGV4dC5pbmRleE9mKGRlbGltaXRlcik7CiAgICAgICAgaWYgKG5leHREZWxpbWl0ZXJQb3MgIT09IC0xICYmIG5leHREZWxpbWl0ZXJQb3MgPiAxMCkgewogICAgICAgICAgcmV0dXJuIGFmdGVyVGV4dC5zdWJzdHJpbmcoMCwgbmV4dERlbGltaXRlclBvcyArIGRlbGltaXRlci5sZW5ndGgpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8g6Iul5rKh5om+5Yiw5q616JC95YiG6ZqU56ym77yM6L+U5Zue5a6M5pW05LiK5LiL5paHCiAgICAgIHJldHVybiBhZnRlclRleHQ7CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgZG9jdW1lbnRzLAogICAgICBjdXJyZW50RG9jLAogICAgICBkb2N1bWVudENoYW5nZWQsCiAgICAgIGlzRG9jTGlzdENvbGxhcHNlZCwKICAgICAgaXNBc3Npc3RhbnRDb2xsYXBzZWQsCiAgICAgIGFjdGl2ZUFzc2lzdGFudFRhYiwKICAgICAgc2VhcmNoUXVlcnksCiAgICAgIGRvY1R5cGVGaWx0ZXIsCiAgICAgIHNvcnRPcHRpb24sCiAgICAgIGZpbHRlcmVkRG9jdW1lbnRzLAogICAgICBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUsCiAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZSwKICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZSwKICAgICAga25vd2xlZGdlUXVlcnksCiAgICAgIHJlbGF0ZWREb2N1bWVudHMsCiAgICAgIHNlbGVjdGVkVXNlcnMsCiAgICAgIGF2YWlsYWJsZVVzZXJzLAogICAgICBzYXZlTG9hZGluZywKICAgICAgY3JlYXRlTG9hZGluZywKICAgICAgc2hhcmVMb2FkaW5nLAogICAgICBkZWxldGVMb2FkaW5nLAogICAgICByZWxhdGVkTG9hZGluZywKICAgICAgbmV3RG9jdW1lbnRGb3JtLAogICAgICBkb2N1bWVudEZvcm1SdWxlcywKICAgICAgZG9jdW1lbnRGb3JtUmVmLAogICAgICBlZGl0b3JPcHRpb25zLAogICAgICBmZXRjaERvY3VtZW50cywKICAgICAgZmV0Y2hEb2N1bWVudERldGFpbCwKICAgICAgc2VsZWN0RG9jdW1lbnQsCiAgICAgIHNhdmVEb2N1bWVudCwKICAgICAgdG9nZ2xlRG9jTGlzdCwKICAgICAgdG9nZ2xlQXNzaXN0YW50LAogICAgICBvbkVkaXRvckNoYW5nZSwKICAgICAgb3Blbk5ld0RvY3VtZW50RGlhbG9nLAogICAgICBjcmVhdGVOZXdEb2N1bWVudCwKICAgICAgc2hhcmVEb2N1bWVudCwKICAgICAgY29uZmlybVNoYXJlLAogICAgICBkZWxldGVEb2N1bWVudCwKICAgICAgY29uZmlybURlbGV0ZSwKICAgICAgZmV0Y2hSZWxhdGVkRG9jdW1lbnRzLAogICAgICByZWZyZXNoUmVsYXRlZERvY3VtZW50cywKICAgICAgb3BlblJlbGF0ZWREb2N1bWVudCwKICAgICAgZXhwb3J0RG9jdW1lbnQsCiAgICAgIHByaW50RG9jdW1lbnQsCiAgICAgIGFkZENvbGxhYm9yYXRvciwKICAgICAgdmlld0hpc3RvcnksCiAgICAgIGFwcGx5U21hcnRBY3Rpb24sCiAgICAgIGRlYm91bmNlZFNlYXJjaCwKICAgICAgZm9ybWF0RGF0ZSwKICAgICAgcXVpbGxSZWYsCiAgICAgIGN1cnJlbnRTZWxlY3Rpb24sCiAgICAgIGxhc3RDdXJzb3JDaGFuZ2UsCiAgICAgIGN1cnJlbnRDb21wbGV0aW9uU3VnZ2VzdGlvbiwKICAgICAgY29tcGxldGlvbk92ZXJsYXksCiAgICAgIGlzUmVxdWVzdGluZ0NvbXBsZXRpb24sCiAgICAgIGNvbXBsZXRpb25EZWJvdW5jZVRpbWVyCiAgICB9OwogIH0KfTs="},{"version":3,"names":["ref","computed","watch","onMounted","useRoute","useRouter","ElMessage","ElMessageBox","_","getDocuments","getDocumentDetail","createDocument","updateDocument","deleteDocument","apiDeleteDocument","shareDocument","apiShareDocument","getRelatedDocuments","generateRelatedDocuments","getTextCompletion","Document","Plus","CircleCheck","Download","More","Search","ArrowLeft","ArrowRight","Share","ShareIcon","Refresh","QuillEditor","name","components","setup","route","router","documents","currentDoc","documentChanged","isDocListCollapsed","isAssistantCollapsed","activeAssistantTab","searchQuery","docTypeFilter","sortOption","newDocumentDialogVisible","shareDialogVisible","deleteDialogVisible","knowledgeQuery","relatedDocuments","selectedUsers","availableUsers","quillRef","currentSelection","lastCursorChange","Date","now","currentCompletionSuggestion","completionOverlay","isRequestingCompletion","completionDebounceTimer","saveLoading","createLoading","shareLoading","deleteLoading","relatedLoading","newDocumentForm","title","type","documentFormRules","required","message","trigger","min","max","documentFormRef","editorOptions","placeholder","modules","toolbar","filteredDocuments","result","value","query","toLowerCase","filter","doc","includes","typeFilter","sort","a","b","update_time","create_time","localeCompare","fetchDocuments","response","data","error","console","fetchDocumentDetail","id","fetchRelatedDocuments","Error","status","push","selectDocument","confirm","confirmButtonText","cancelButtonText","saveDocument","log","params","content","success","refreshRelatedDocuments","toggleDocList","toggleAssistant","onEditorChange","openNewDocumentDialog","createNewDocument","validate","valid","username","confirmShare","length","warning","confirmDelete","docId","openRelatedDocument","related_document_id","exportDocument","info","printDocument","addCollaborator","viewHistory","applySmartAction","action","debouncedSearch","debounce","formatDate","dateString","date","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","weekDays","diffDays","Math","round","getDay","toLocaleDateString","month","day","newId","isNaN","Number","immediate","setInterval","setTimeout","setupQuillEditor","quillInstance","getQuill","warn","on","range","oldRange","source","index","hideCompletionSuggestion","clearTimeout","requestCompletionSuggestion","delta","oldDelta","quillEditor","document","querySelector","addEventListener","e","key","preventDefault","stopPropagation","acceptCompletionSuggestion","handleTabCompletion","capture","hidden","selection","getSelection","cursorPos","fullText","getText","contextBefore","getContextBefore","contextAfter","getContextAfter","_response$data","cursor_pos","context_before","context_after","max_tokens","completion","showCompletionSuggestion","err","insertText","setSelection","contents","getContents","ops","i","op","insert","String","attributes","deleteText","_response$data2","duration","text","maxChars","beforeText","substring","paragraphDelimiters","delimiter","lastDelimiterPos","lastIndexOf","afterText","nextDelimiterPos","indexOf"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue"],"sourcesContent":["<template>\n  <div class=\"smart-doc-container\">\n    <!-- 文档列表侧边栏 -->\n    <div class=\"sidebar\" :class=\"{ 'collapsed': isDocListCollapsed }\">\n      <!-- 侧边栏头部 -->\n      <div class=\"sidebar-header\">\n        <h4 v-if=\"!isDocListCollapsed\">我的文档</h4>\n        <div class=\"toggle-btn\" @click=\"toggleDocList\">\n          <el-icon><ArrowLeft v-if=\"!isDocListCollapsed\" /><ArrowRight v-else /></el-icon>\n        </div>\n      </div>\n\n      <!-- 展开状态的文档列表 -->\n      <div class=\"sidebar-content\" v-show=\"!isDocListCollapsed\">\n        <!-- 搜索和筛选区域 -->\n        <div class=\"search-area\">\n          <el-input\n            placeholder=\"搜索文档...\"\n            v-model=\"searchQuery\"\n            clearable\n            @input=\"debouncedSearch\"\n          >\n            <template #prefix>\n              <el-icon><Search /></el-icon>\n            </template>\n          </el-input>\n          <div class=\"filter-options\">\n            <el-input v-model=\"docTypeFilter\" placeholder=\"文档类型\" size=\"small\" clearable />\n            <el-select v-model=\"sortOption\" placeholder=\"排序\" size=\"small\">\n              <el-option label=\"最近更新\" value=\"update\" />\n              <el-option label=\"最近创建\" value=\"create\" />\n              <el-option label=\"名称升序\" value=\"name-asc\" />\n            </el-select>\n          </div>\n        </div>\n\n        <!-- 文档列表区域 -->\n        <el-scrollbar class=\"document-list-scrollbar\">\n          <div class=\"document-list\">\n            <div \n              v-for=\"doc in filteredDocuments\" \n              :key=\"doc.id\" \n              class=\"doc-item\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <div class=\"doc-icon\">\n                <el-icon><Document /></el-icon>\n              </div>\n              <div class=\"doc-info\">\n                <h5>{{ doc.title }}</h5>\n                <div class=\"doc-meta\">\n                  <span>{{ doc.type }}</span>\n                  <span>{{ formatDate(doc.update_time) }}</span>\n                </div>\n              </div>\n            </div>\n            \n            <div v-if=\"filteredDocuments.length === 0\" class=\"empty-state\">\n              <!-- 移除暂无文档的显示 -->\n            </div>\n          </div>\n        </el-scrollbar>\n\n        <!-- 创建按钮区域 -->\n        <div class=\"action-buttons\">\n          <el-button type=\"primary\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon> 新建文档\n          </el-button>\n        </div>\n      </div>\n\n      <!-- 折叠状态的文档图标列表 -->\n      <div class=\"collapsed-sidebar\" v-if=\"isDocListCollapsed\">\n        <el-tooltip content=\"新建文档\" placement=\"right\">\n          <div class=\"icon-btn create-btn\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon>\n          </div>\n        </el-tooltip>\n        \n        <div class=\"recent-docs\">\n          <el-tooltip \n            v-for=\"doc in filteredDocuments.slice(0, 5)\" \n            :key=\"doc.id\" \n            :content=\"doc.title\"\n            placement=\"right\"\n          >\n            <div \n              class=\"icon-btn doc-btn\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <el-icon><Document /></el-icon>\n            </div>\n          </el-tooltip>\n        </div>\n      </div>\n    </div>\n\n    <!-- 主内容区域 -->\n    <div class=\"main-content\">\n      <!-- 文档内容显示区域 -->\n      <div class=\"document-content\">\n        <template v-if=\"currentDoc\">\n          <!-- 文档标题和操作栏 -->\n          <div class=\"document-header\">\n            <div class=\"doc-info-area\">\n              <div class=\"doc-title-label\">标题：</div>\n              <div class=\"doc-title\">\n                <el-input \n                  v-model=\"currentDoc.title\"\n                  placeholder=\"文档标题\"\n                  size=\"large\"\n                  @change=\"documentChanged = true\"\n                />\n              </div>\n              <div class=\"doc-type-label\">类型：</div>\n              <div class=\"doc-type-selector\">\n                <el-input \n                  v-model=\"currentDoc.type\" \n                  placeholder=\"输入文档类型\"\n                  size=\"default\"\n                  @change=\"documentChanged = true\"\n                />\n              </div>\n            </div>\n            <div class=\"doc-actions\">\n              <el-tooltip content=\"保存文档\" placement=\"bottom\">\n                <el-button \n                  circle\n                  :disabled=\"!documentChanged\" \n                  :loading=\"saveLoading\"\n                  @click=\"saveDocument\"\n                >\n                  <el-icon><CircleCheck /></el-icon>\n                </el-button>\n              </el-tooltip>\n              <el-tooltip content=\"分享文档\" placement=\"bottom\">\n                <el-button circle @click=\"shareDocument\"><el-icon><ShareIcon /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"导出文档\" placement=\"bottom\">\n                <el-button circle @click=\"exportDocument\"><el-icon><Download /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"更多操作\" placement=\"bottom\">\n                <el-dropdown trigger=\"click\">\n                  <el-button circle><el-icon><More /></el-icon></el-button>\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                      <el-dropdown-item @click=\"printDocument\">打印文档</el-dropdown-item>\n                      <el-dropdown-item @click=\"addCollaborator\">添加协作者</el-dropdown-item>\n                      <el-dropdown-item @click=\"viewHistory\">查看历史版本</el-dropdown-item>\n                      <el-dropdown-item divided @click=\"deleteDocument\" class=\"text-red-500\">删除文档</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </el-tooltip>\n            </div>\n          </div>\n          \n          <!-- 编辑器区域 -->\n          <div class=\"editor-area\">\n            <QuillEditor\n              ref=\"quillRef\"\n              v-model:content=\"currentDoc.content\"\n              :options=\"editorOptions\"\n              contentType=\"html\"\n              theme=\"snow\"\n              class=\"quill-editor\"\n              @textChange=\"onEditorChange\"\n              placeholder=\" \"\n            />\n          </div>\n        </template>\n        \n        <!-- 无文档时的提示 -->\n        <div v-else class=\"empty-doc-state\">\n          <el-empty description=\"请选择或创建一个文档\">\n            <el-button type=\"primary\" @click=\"openNewDocumentDialog\">新建文档</el-button>\n          </el-empty>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 智能助手面板 -->\n    <div class=\"assistant-panel\" :class=\"{ 'collapsed': isAssistantCollapsed }\">\n      <div class=\"assistant-header\">\n        <h5 v-if=\"!isAssistantCollapsed\">智能助手</h5>\n        <div class=\"toggle-btn\" @click=\"toggleAssistant\">\n          <el-icon><ArrowRight v-if=\"!isAssistantCollapsed\" /><ArrowLeft v-else /></el-icon>\n        </div>\n      </div>\n      \n      <div class=\"assistant-body\" v-show=\"!isAssistantCollapsed\">\n        <el-tabs v-model=\"activeAssistantTab\">\n          <!-- 上下文感知标签页 -->\n          <el-tab-pane label=\"上下文感知\" name=\"context\">\n            <div class=\"assistant-content\">\n              <div class=\"context-header\">\n              <h6>相关文档</h6>\n                <el-button type=\"primary\" size=\"small\" @click=\"refreshRelatedDocuments\" :loading=\"relatedLoading\">\n                  <el-icon><Refresh /></el-icon> 刷新\n                </el-button>\n              </div>\n              <div class=\"related-docs\">\n                <el-empty v-if=\"relatedDocuments.length === 0\" description=\"暂无相关文档\" />\n                <div \n                  v-for=\"doc in relatedDocuments\" \n                  :key=\"doc.id\" \n                  class=\"related-doc-item\"\n                  @click=\"openRelatedDocument(doc)\"\n                >\n                  <div class=\"doc-title\">{{ doc.title }}</div>\n                  <div class=\"doc-source\">来源: {{ doc.source }} (相关度: {{ (doc.relevance_score * 100).toFixed(0) }}%)</div>\n                </div>\n              </div>\n              \n              <h6>建议操作</h6>\n              <div class=\"suggested-actions\">\n                <el-button size=\"small\" @click=\"applySmartAction('整合相关邮件内容')\">\n                  整合相关邮件内容\n                </el-button>\n                <el-button size=\"small\" @click=\"applySmartAction('引用会议记录')\">\n                  引用会议记录\n                </el-button>\n                <el-button size=\"small\" @click=\"applySmartAction('查找专业内容')\">\n                  查找专业内容\n                </el-button>\n              </div>\n            </div>\n          </el-tab-pane>\n          \n          <!-- 专业知识标签页 -->\n          <el-tab-pane label=\"专业知识\" name=\"knowledge\">\n            <div class=\"assistant-content knowledge-tab\">\n              <el-input\n                v-model=\"knowledgeQuery\"\n                placeholder=\"搜索专业知识...\"\n                class=\"mb-4\"\n              >\n                <template #suffix>\n                  <el-button :icon=\"Search\" circle />\n                </template>\n              </el-input>\n              \n              <el-empty description=\"专业知识功能暂未实现\" />\n            </div>\n          </el-tab-pane>\n          \n          <!-- 决策树标签页 -->\n          <el-tab-pane label=\"决策树\" name=\"decision\">\n            <div class=\"assistant-content decision-tab\">\n              <el-empty description=\"决策树功能暂未实现\" />\n            </div>\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n    </div>\n\n    <!-- 创建新文档对话框 -->\n    <el-dialog\n      v-model=\"newDocumentDialogVisible\"\n      title=\"新建智能文档\"\n      width=\"35%\"\n    >\n      <el-form \n        :model=\"newDocumentForm\" \n        label-width=\"80px\" \n        :rules=\"documentFormRules\"\n        ref=\"documentFormRef\"\n      >\n        <el-form-item label=\"文档标题\" prop=\"title\">\n          <el-input v-model=\"newDocumentForm.title\" placeholder=\"请输入文档标题\" />\n        </el-form-item>\n        <el-form-item label=\"文档类型\">\n          <el-input v-model=\"newDocumentForm.type\" placeholder=\"请输入文档类型\" />\n          <div class=\"form-tip\">如果未填写，默认为通用类型</div>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"newDocumentDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"createNewDocument\" :loading=\"createLoading\">\n            创建\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 分享文档对话框 -->\n    <el-dialog\n      v-model=\"shareDialogVisible\"\n      title=\"分享文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您即将分享文档: <strong>{{ currentDoc.title }}</strong></p>\n        <el-form label-width=\"120px\" class=\"mt-4\">\n          <el-form-item label=\"选择用户\">\n            <el-select\n              v-model=\"selectedUsers\"\n              multiple\n              placeholder=\"请选择用户\"\n              style=\"width: 100%\"\n            >\n              <el-option\n                v-for=\"user in availableUsers\"\n                :key=\"user.id\"\n                :label=\"user.username\"\n                :value=\"user.id\"\n              />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"shareDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"confirmShare\" :loading=\"shareLoading\">\n            分享\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 删除确认对话框 -->\n    <el-dialog\n      v-model=\"deleteDialogVisible\"\n      title=\"删除文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您确定要删除文档 <strong>{{ currentDoc.title }}</strong> 吗?</p>\n        <p class=\"warning-text\">此操作不可撤销!</p>\n        </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"deleteDialogVisible = false\">取消</el-button>\n          <el-button type=\"danger\" @click=\"confirmDelete\" :loading=\"deleteLoading\">\n            删除\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, watch, onMounted } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport _ from 'lodash'\nimport { \n  getDocuments, \n  getDocumentDetail, \n  createDocument, \n  updateDocument,\n  deleteDocument as apiDeleteDocument,\n  shareDocument as apiShareDocument,\n  getRelatedDocuments,\n  generateRelatedDocuments,\n  getTextCompletion\n} from '@/api/smartdoc'\nimport { Document, Plus, CircleCheck, Download, More, Search, ArrowLeft, ArrowRight, Share as ShareIcon, Refresh } from '@element-plus/icons-vue'\nimport { QuillEditor } from '@vueup/vue-quill'\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\n\nexport default {\n  name: 'SmartDocDetail',\n  components: {\n    Document, Plus, CircleCheck, Download, More, \n    Search, ArrowLeft, ArrowRight, ShareIcon, QuillEditor, Refresh\n  },\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    \n    // 状态数据\n    const documents = ref([])\n    const currentDoc = ref(null)\n    const documentChanged = ref(false)\n    const isDocListCollapsed = ref(false)\n    const isAssistantCollapsed = ref(false)\n    const activeAssistantTab = ref('context')\n    const searchQuery = ref('')\n    const docTypeFilter = ref('')\n    const sortOption = ref('update')\n    const newDocumentDialogVisible = ref(false)\n    const shareDialogVisible = ref(false)\n    const deleteDialogVisible = ref(false)\n    const knowledgeQuery = ref('')\n    const relatedDocuments = ref([])\n    const selectedUsers = ref([])\n    const availableUsers = ref([])\n    \n    // 编辑器状态\n    const quillRef = ref(null)\n    const currentSelection = ref(null) // 保存当前光标选择\n    const lastCursorChange = ref(Date.now()) // 光标上次变化的时间戳\n    const currentCompletionSuggestion = ref('') // 当前补全建议\n    const completionOverlay = ref(null) // 补全浮层引用\n    const isRequestingCompletion = ref(false) // 是否正在请求补全\n    const completionDebounceTimer = ref(null) // 补全防抖定时器\n    \n    // 加载状态\n    const saveLoading = ref(false)\n    const createLoading = ref(false)\n    const shareLoading = ref(false)\n    const deleteLoading = ref(false)\n    const relatedLoading = ref(false)\n    \n    // 表单数据\n    const newDocumentForm = ref({\n        title: '',\n      type: ''\n    })\n    \n    // 表单验证规则\n    const documentFormRules = {\n      title: [\n        { required: true, message: '请输入文档标题', trigger: 'blur' },\n        { min: 2, max: 50, message: '标题长度须在2到50个字符之间', trigger: 'blur' }\n      ]\n    }\n    \n    const documentFormRef = ref(null)\n    \n    // 编辑器配置\n    const editorOptions = {\n      placeholder: ' ',\n        modules: {\n          toolbar: [\n            ['bold', 'italic', 'underline', 'strike'],\n            ['blockquote', 'code-block'],\n          [{ 'header': 1 }, { 'header': 2 }],\n          [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n          [{ 'script': 'sub' }, { 'script': 'super' }],\n          [{ 'indent': '-1' }, { 'indent': '+1' }],\n          [{ 'direction': 'rtl' }],\n          [{ 'size': ['small', false, 'large', 'huge'] }],\n          [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n          [{ 'color': [] }, { 'background': [] }],\n          [{ 'font': [] }],\n          [{ 'align': [] }],\n            ['clean'],\n          ['link', 'image']\n        ]\n      }\n    }\n    \n    // 计算属性\n    const filteredDocuments = computed(() => {\n      let result = [...documents.value]\n      \n      // 搜索筛选\n      if (searchQuery.value) {\n        const query = searchQuery.value.toLowerCase()\n        result = result.filter(doc => \n          doc.title.toLowerCase().includes(query) || \n          doc.type.toLowerCase().includes(query)\n        )\n      }\n      \n      // 类型筛选\n      if (docTypeFilter.value) {\n        const typeFilter = docTypeFilter.value.toLowerCase()\n        result = result.filter(doc => \n          doc.type.toLowerCase().includes(typeFilter)\n        )\n      }\n      \n      // 排序\n      if (sortOption.value === 'update') {\n        result.sort((a, b) => new Date(b.update_time) - new Date(a.update_time))\n      } else if (sortOption.value === 'create') {\n        result.sort((a, b) => new Date(b.create_time) - new Date(a.create_time))\n      } else if (sortOption.value === 'name-asc') {\n        result.sort((a, b) => a.title.localeCompare(b.title))\n      }\n      \n      return result\n    })\n    \n    // 方法\n    const fetchDocuments = async () => {\n      try {\n        const response = await getDocuments()\n        documents.value = response.data\n      } catch (error) {\n        console.error('获取文档列表失败', error)\n        ElMessage.error('获取文档列表失败')\n      }\n    }\n    \n    const fetchDocumentDetail = async (id) => {\n      try {\n        const response = await getDocumentDetail(id)\n        // 检查是否获取到有效的文档数据\n        if (response && response.data) {\n          currentDoc.value = response.data\n          documentChanged.value = false\n          \n          // 获取相关文档\n          fetchRelatedDocuments(id)\n        } else {\n          throw new Error('文档不存在或数据无效')\n        }\n      } catch (error) {\n        console.error('获取文档详情失败', error)\n        ElMessage.error(error.response && error.response.status === 404 ? '文档不存在' : '获取文档详情失败')\n        // 返回到文档列表页\n        router.push('/smartdoc')\n      }\n    }\n    \n    const selectDocument = async (id) => {\n      // 如果当前文档已修改，提示保存\n      if (documentChanged.value && currentDoc.value) {\n        try {\n          await ElMessageBox.confirm(\n            '当前文档已修改但未保存，是否保存更改？',\n            '保存提示',\n            {\n              confirmButtonText: '保存',\n              cancelButtonText: '不保存',\n              type: 'warning'\n            }\n          )\n          await saveDocument()\n        } catch (error) {\n          // 用户选择不保存，继续切换文档\n          console.log('用户选择不保存')\n        }\n      }\n      \n      // 更新路由以反映新选中的文档\n      router.push({ name: 'SmartDocDetail', params: { id } })\n    }\n    \n    const saveDocument = async () => {\n      if (!currentDoc.value || !documentChanged.value) return\n      \n      saveLoading.value = true\n      try {\n        await updateDocument(currentDoc.value.id, {\n          title: currentDoc.value.title,\n          type: currentDoc.value.type,\n          content: currentDoc.value.content\n        })\n        \n        documentChanged.value = false\n        ElMessage.success('文档保存成功')\n        \n        // 刷新相关文档\n        refreshRelatedDocuments()\n      } catch (error) {\n        console.error('保存文档失败', error)\n        ElMessage.error('保存文档失败')\n      } finally {\n        saveLoading.value = false\n      }\n    }\n    \n    const toggleDocList = () => {\n      isDocListCollapsed.value = !isDocListCollapsed.value\n    }\n    \n    const toggleAssistant = () => {\n      isAssistantCollapsed.value = !isAssistantCollapsed.value\n    }\n    \n    const onEditorChange = () => {\n      documentChanged.value = true\n    }\n    \n    const openNewDocumentDialog = () => {\n      newDocumentForm.value = { title: '', type: '' }\n      newDocumentDialogVisible.value = true\n    }\n    \n    const createNewDocument = async () => {\n      if (!documentFormRef.value) return\n      \n      await documentFormRef.value.validate(async (valid) => {\n        if (valid) {\n          createLoading.value = true\n          try {\n            const response = await createDocument({\n              title: newDocumentForm.value.title,\n              type: newDocumentForm.value.type || '通用',\n              content: ''\n            })\n            \n            ElMessage.success('文档创建成功')\n            newDocumentDialogVisible.value = false\n            \n            // 刷新文档列表并打开新文档\n            await fetchDocuments()\n            router.push({ name: 'SmartDocDetail', params: { id: response.data.id } })\n      } catch (error) {\n            console.error('创建文档失败', error)\n            ElMessage.error('创建文档失败')\n          } finally {\n            createLoading.value = false\n          }\n        }\n      })\n    }\n    \n    const shareDocument = () => {\n      if (!currentDoc.value) return\n      \n      // 在实际项目中，这里应该从API获取可用用户列表\n      availableUsers.value = [\n        { id: 1, username: '张三' },\n        { id: 2, username: '李四' },\n        { id: 3, username: '王五' }\n      ]\n      selectedUsers.value = []\n      shareDialogVisible.value = true\n    }\n    \n    const confirmShare = async () => {\n      if (!currentDoc.value || selectedUsers.value.length === 0) {\n        ElMessage.warning('请选择至少一个用户')\n        return\n      }\n      \n      shareLoading.value = true\n      try {\n        await apiShareDocument(currentDoc.value.id, selectedUsers.value)\n        ElMessage.success('文档分享成功')\n        shareDialogVisible.value = false\n      } catch (error) {\n        console.error('分享文档失败', error)\n        ElMessage.error('分享文档失败')\n      } finally {\n        shareLoading.value = false\n      }\n    }\n    \n    const deleteDocument = () => {\n      if (!currentDoc.value) return\n      \n      deleteDialogVisible.value = true\n    }\n    \n    const confirmDelete = async () => {\n      if (!currentDoc.value) return\n      \n      deleteLoading.value = true\n      try {\n        await apiDeleteDocument(currentDoc.value.id)\n        ElMessage.success('文档删除成功')\n        deleteDialogVisible.value = false\n        \n        // 返回到文档列表页\n        router.push('/smartdoc')\n      } catch (error) {\n        console.error('删除文档失败', error)\n        ElMessage.error('删除文档失败')\n      } finally {\n        deleteLoading.value = false\n      }\n    }\n    \n    const fetchRelatedDocuments = async (id) => {\n      if (!id && !currentDoc.value) return\n      \n      const docId = id || currentDoc.value.id\n      \n      try {\n        const response = await getRelatedDocuments(docId)\n        relatedDocuments.value = response.data\n      } catch (error) {\n        console.error('获取相关文档失败', error)\n      }\n    }\n    \n    const refreshRelatedDocuments = async () => {\n      if (!currentDoc.value) return\n      \n      relatedLoading.value = true\n      try {\n        const response = await generateRelatedDocuments(currentDoc.value.id)\n        relatedDocuments.value = response.data\n        ElMessage.success('已刷新相关文档')\n      } catch (error) {\n        console.error('刷新相关文档失败', error)\n        ElMessage.error('刷新相关文档失败')\n      } finally {\n        relatedLoading.value = false\n      }\n    }\n    \n    const openRelatedDocument = (doc) => {\n      // 获取文档ID并打开\n      const docId = doc.related_document_id\n      if (docId) {\n        selectDocument(docId)\n      }\n    }\n    \n    const exportDocument = () => {\n      ElMessage.info('导出文档功能暂未实现')\n    }\n    \n    const printDocument = () => {\n      ElMessage.info('打印文档功能暂未实现')\n    }\n    \n    const addCollaborator = () => {\n      ElMessage.info('添加协作者功能暂未实现')\n    }\n    \n    const viewHistory = () => {\n      ElMessage.info('查看历史版本功能暂未实现')\n    }\n    \n    const applySmartAction = (action) => {\n      ElMessage.info(`智能操作\"${action}\"功能暂未实现`)\n    }\n    \n    // 防抖搜索\n    const debouncedSearch = _.debounce(() => {\n      // 搜索逻辑已通过计算属性处理\n    }, 300)\n    \n    const formatDate = (dateString) => {\n      const date = new Date(dateString)\n      const now = new Date()\n      \n      // 同一天显示时间\n      if (date.toDateString() === now.toDateString()) {\n        return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n      }\n      \n      // 昨天\n      const yesterday = new Date(now)\n      yesterday.setDate(now.getDate() - 1)\n      if (date.toDateString() === yesterday.toDateString()) {\n        return '昨天'\n      }\n      \n      // 一周内显示星期\n      const weekDays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n      const diffDays = Math.round((now - date) / (1000 * 60 * 60 * 24))\n      if (diffDays < 7) {\n        return weekDays[date.getDay()]\n      }\n      \n      // 其他情况显示日期\n      return date.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' })\n    }\n    \n    // 监听路由变化\n    watch(() => route.params.id, (newId) => {\n      if (newId) {\n        // 检查ID是否为有效值\n        if (isNaN(Number(newId))) {\n          ElMessage.error('无效的文档ID')\n          router.push('/smartdoc')\n          return\n        }\n        fetchDocumentDetail(newId)\n      } else {\n        currentDoc.value = null\n      }\n    }, { immediate: true })\n    \n    // 自动保存功能\n    setInterval(() => {\n      if (documentChanged.value && currentDoc.value && !saveLoading.value) {\n        saveDocument()\n      }\n    }, 60000) // 每分钟自动保存一次\n    \n    // 生命周期钩子\n    onMounted(() => {\n      fetchDocuments()\n      \n      // 从路由获取文档ID\n      const docId = route.params.id\n      if (docId) {\n        fetchDocumentDetail(docId)\n      }\n      \n      // 延迟设置编辑器事件监听\n      setTimeout(() => {\n        setupQuillEditor()\n      }, 1000)\n    })\n    \n    // 设置Quill编辑器及事件监听\n    const setupQuillEditor = () => {\n      // 获取Quill实例\n      const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n      if (!quillInstance) {\n        console.warn('未能获取Quill实例，无法设置事件监听')\n        return\n      }\n      \n      console.log('[补全调试] 成功获取Quill实例，设置事件监听')\n      \n      // 监听光标位置变化\n      quillInstance.on('selection-change', (range, oldRange, source) => {\n        if (range) {\n          // 保存当前选择范围\n          currentSelection.value = range\n          lastCursorChange.value = Date.now()\n          console.log('[补全调试] 光标位置已更新:', range.index, range.length)\n          \n          // 隐藏当前补全建议\n          hideCompletionSuggestion()\n          \n          // 防抖请求新的补全建议\n          if (completionDebounceTimer.value) {\n            clearTimeout(completionDebounceTimer.value)\n          }\n          \n          completionDebounceTimer.value = setTimeout(() => {\n            requestCompletionSuggestion()\n          }, 600) // 光标停留600ms后自动请求补全\n        } else {\n          // 用户选取了一段文本，清除任何补全建议\n          hideCompletionSuggestion()\n        }\n      })\n      \n      // 监听文本变化\n      quillInstance.on('text-change', (delta, oldDelta, source) => {\n        documentChanged.value = true\n        \n        // 隐藏当前补全建议\n        hideCompletionSuggestion()\n        \n        // 防抖请求新的补全建议\n        if (completionDebounceTimer.value) {\n          clearTimeout(completionDebounceTimer.value)\n        }\n        \n        completionDebounceTimer.value = setTimeout(() => {\n          requestCompletionSuggestion()\n        }, 600) // 文本变化后600ms自动请求补全\n      })\n      \n      // 监听Tab键\n      const quillEditor = document.querySelector('.quill-editor .ql-editor')\n      if (quillEditor) {\n        quillEditor.addEventListener('keydown', async (e) => {\n          // 无论何时按下Tab，都要阻止默认行为\n          if (e.key === 'Tab') {\n            // 立即阻止默认Tab键行为\n            e.preventDefault()\n            e.stopPropagation()\n            \n            if (currentCompletionSuggestion.value) {\n              acceptCompletionSuggestion()\n            } else {\n              // 如果没有补全建议，可以手动请求一次\n              await handleTabCompletion()\n            }\n            // 添加日志以确认Tab键是否被正确处理\n            console.log('[补全调试] Tab键被处理，阻止了默认行为')\n            return false\n          } else if (e.key === 'Escape') {\n            // Escape键取消当前补全建议\n            hideCompletionSuggestion()\n          }\n        }, { capture: true }) // 使用捕获阶段以确保我们的处理先于其他处理\n      } else {\n        console.warn('未找到 .quill-editor .ql-editor DOM')\n      }\n    }\n    \n    // 请求补全建议\n    const requestCompletionSuggestion = async () => {\n      // 如果正在请求中，则不重复请求\n      if (isRequestingCompletion.value) return\n      \n      // 如果编辑器不可见或页面不在活动状态，不请求补全\n      if (document.hidden) return\n      \n      // 获取Quill实例\n      const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n      if (!quillInstance) return\n      \n      // 获取当前光标位置\n      let selection = currentSelection.value\n      if (!selection) {\n        selection = quillInstance.getSelection()\n        if (!selection) return\n      }\n      \n      // 记录补全请求，避免短时间内多次请求\n      isRequestingCompletion.value = true\n      \n      const cursorPos = selection.index\n      const fullText = quillInstance.getText() // 获取完整文本\n      \n      // 获取上下文\n      const contextBefore = getContextBefore(fullText, cursorPos)\n      const contextAfter = getContextAfter(fullText, cursorPos)\n      \n      // 如果上下文过少，不进行补全\n      if (contextBefore.length < 5) {\n        isRequestingCompletion.value = false\n        return\n      }\n      \n      try {\n        const response = await getTextCompletion({\n          content: fullText,\n          cursor_pos: cursorPos,\n          context_before: contextBefore,\n          context_after: contextAfter,\n          max_tokens: 64\n        })\n        \n        const completion = response?.data?.completion || ''\n        \n        if (completion) {\n          currentCompletionSuggestion.value = completion\n          showCompletionSuggestion(cursorPos)\n        }\n      } catch (err) {\n        console.error('[补全调试] 请求AI补全建议失败', err)\n      } finally {\n        isRequestingCompletion.value = false\n      }\n    }\n    \n    // 显示补全建议 - 重新实现为使用内联样式\n    const showCompletionSuggestion = (cursorPos) => {\n      if (!currentCompletionSuggestion.value) return\n      \n      const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n      if (!quillInstance) return\n      \n      try {\n        // 在光标处插入带样式的文本\n        quillInstance.insertText(\n          cursorPos, \n          currentCompletionSuggestion.value, \n          {\n            'color': '#8e8e8e',\n            'background-color': '#f7f7f7',\n            'ghost-completion': true // 自定义属性，便于识别\n          }\n        );\n        \n        // 保持光标在原来位置不变\n        quillInstance.setSelection(cursorPos, 0)\n        \n        console.log('[补全调试] 显示幽灵文本补全:', currentCompletionSuggestion.value)\n      } catch (err) {\n        console.error('[补全调试] 显示补全建议失败:', err)\n      }\n    }\n    \n    // 隐藏补全建议\n    const hideCompletionSuggestion = () => {\n      if (!currentCompletionSuggestion.value) return\n      \n      try {\n        const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n        if (!quillInstance) return\n        \n        // 找到所有ghost-completion属性的文本并移除\n        const contents = quillInstance.getContents().ops;\n        let index = 0;\n        \n        for (let i = 0; i < contents.length; i++) {\n          const op = contents[i];\n          const length = op.insert ? String(op.insert).length : 1;\n          \n          // 检查是否有ghost-completion属性\n          if (op.attributes && op.attributes['ghost-completion']) {\n            // 删除这段文本\n            quillInstance.deleteText(index, length);\n            break; // 一般只有一段幽灵文本\n          }\n          \n          index += length;\n        }\n        \n        console.log('[补全调试] 清除幽灵文本补全')\n      } catch (err) {\n        console.error('[补全调试] 隐藏补全建议失败:', err)\n      }\n      \n      currentCompletionSuggestion.value = ''\n    }\n    \n    // 接受补全建议\n    const acceptCompletionSuggestion = () => {\n      if (!currentCompletionSuggestion.value) return\n      \n      const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n      if (!quillInstance) return\n      \n      const selection = currentSelection.value || quillInstance.getSelection()\n      if (!selection) return\n      \n      const cursorPos = selection.index\n      \n      try {\n        // 找到幽灵文本并替换为普通文本\n        const contents = quillInstance.getContents().ops;\n        let index = 0;\n        \n        for (let i = 0; i < contents.length; i++) {\n          const op = contents[i];\n          const length = op.insert ? String(op.insert).length : 1;\n          \n          // 检查是否有ghost-completion属性\n          if (op.attributes && op.attributes['ghost-completion']) {\n            // 删除幽灵文本\n            quillInstance.deleteText(index, length);\n            \n            // 插入普通文本\n            quillInstance.insertText(index, currentCompletionSuggestion.value);\n            \n            // 将光标移到补全文本末尾\n            quillInstance.setSelection(index + currentCompletionSuggestion.value.length);\n            break;\n          }\n          \n          index += length;\n        }\n        \n        console.log('[补全调试] 接受补全建议:', currentCompletionSuggestion.value)\n        \n        // 重置当前补全建议\n        currentCompletionSuggestion.value = ''\n      } catch (err) {\n        console.error('[补全调试] 接受补全建议失败:', err)\n      }\n    }\n    \n    // 处理Tab键补全 - 现在只作为备用方案\n    const handleTabCompletion = async () => {\n      // 如果当前有补全建议，优先接受它\n      if (currentCompletionSuggestion.value) {\n        acceptCompletionSuggestion()\n        return\n      }\n      \n      // 获取Quill实例\n      const quillInstance = quillRef.value && quillRef.value.getQuill ? quillRef.value.getQuill() : null\n      if (!quillInstance) {\n        console.warn('未获取到Quill实例')\n        return\n      }\n      \n      // 获取最新光标位置\n      let selection = currentSelection.value\n      if (!selection) {\n        selection = quillInstance.getSelection()\n        if (!selection) {\n          console.warn('未获取到光标位置')\n          return\n        }\n      }\n      \n      const cursorPos = selection.index\n      const fullText = quillInstance.getText() // 获取完整文本\n      \n      // 获取光标前后的上下文\n      const contextBefore = getContextBefore(fullText, cursorPos)\n      const contextAfter = getContextAfter(fullText, cursorPos)\n      \n      console.log('[补全调试] Tab触发，当前光标位置：', cursorPos)\n      console.log('[补全调试] 光标前上下文：', contextBefore)\n      console.log('[补全调试] 光标后上下文：', contextAfter)\n      \n      try {\n        // 显示加载状态\n        ElMessage({\n          message: 'AI补全中...',\n          type: 'info',\n          duration: 1000\n        })\n        \n        // 使用封装API调用\n        const response = await getTextCompletion({\n          content: fullText,\n          cursor_pos: cursorPos,\n          context_before: contextBefore,\n          context_after: contextAfter,\n          max_tokens: 64\n        })\n        \n        console.log('[补全调试] 后端响应：', response)\n        \n        const completion = response?.data?.completion || ''\n        \n        if (completion) {\n          quillInstance.insertText(cursorPos, completion)\n          quillInstance.setSelection(cursorPos + completion.length)\n          console.log('[补全调试] 补全文本已插入：', completion)\n        } else {\n          console.warn('[补全调试] 后端无补全文本返回')\n          ElMessage({\n            message: '未能获取补全内容',\n            type: 'warning'\n          })\n        }\n      } catch (err) {\n        console.error('[补全调试] AI补全失败', err)\n        ElMessage.error('AI补全失败，请稍后重试')\n      }\n    }\n    \n    // 获取光标前的智能上下文\n    const getContextBefore = (text, cursorPos, maxChars = 200) => {\n      // 从光标位置向前获取文本\n      const beforeText = text.substring(Math.max(0, cursorPos - maxChars), cursorPos)\n      \n      // 尝试提取当前段落或更有意义的上下文\n      const paragraphDelimiters = ['\\n\\n', '\\n']\n      for (const delimiter of paragraphDelimiters) {\n        const lastDelimiterPos = beforeText.lastIndexOf(delimiter)\n        if (lastDelimiterPos !== -1 && beforeText.length - lastDelimiterPos > 10) {\n          return beforeText.substring(lastDelimiterPos + delimiter.length)\n        }\n      }\n      \n      // 若没找到段落分隔符，返回完整上下文\n      return beforeText\n    }\n    \n    // 获取光标后的智能上下文\n    const getContextAfter = (text, cursorPos, maxChars = 200) => {\n      // 从光标位置向后获取文本\n      const afterText = text.substring(cursorPos, Math.min(text.length, cursorPos + maxChars))\n      \n      // 尝试提取当前句子或段落的结束\n      const paragraphDelimiters = ['\\n\\n', '\\n', '. ', '? ', '! ']\n      for (const delimiter of paragraphDelimiters) {\n        const nextDelimiterPos = afterText.indexOf(delimiter)\n        if (nextDelimiterPos !== -1 && nextDelimiterPos > 10) {\n          return afterText.substring(0, nextDelimiterPos + delimiter.length)\n        }\n      }\n      \n      // 若没找到段落分隔符，返回完整上下文\n      return afterText\n    }\n    \n    return {\n      documents,\n      currentDoc,\n      documentChanged,\n      isDocListCollapsed,\n      isAssistantCollapsed,\n      activeAssistantTab,\n      searchQuery,\n      docTypeFilter,\n      sortOption,\n      filteredDocuments,\n      newDocumentDialogVisible,\n      shareDialogVisible,\n      deleteDialogVisible,\n      knowledgeQuery,\n      relatedDocuments,\n      selectedUsers,\n      availableUsers,\n      saveLoading,\n      createLoading,\n      shareLoading,\n      deleteLoading,\n      relatedLoading,\n      newDocumentForm,\n      documentFormRules,\n      documentFormRef,\n      editorOptions,\n      fetchDocuments,\n      fetchDocumentDetail,\n      selectDocument,\n      saveDocument,\n      toggleDocList,\n      toggleAssistant,\n      onEditorChange,\n      openNewDocumentDialog,\n      createNewDocument,\n      shareDocument,\n      confirmShare,\n      deleteDocument,\n      confirmDelete,\n      fetchRelatedDocuments,\n      refreshRelatedDocuments,\n      openRelatedDocument,\n      exportDocument,\n      printDocument,\n      addCollaborator,\n      viewHistory,\n      applySmartAction,\n      debouncedSearch,\n      formatDate,\n      quillRef,\n      currentSelection,\n      lastCursorChange,\n      currentCompletionSuggestion,\n      completionOverlay,\n      isRequestingCompletion,\n      completionDebounceTimer\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n/* 修改整体布局，调整侧边栏和主内容区域的宽度比例 */\n.smart-doc-container {\n  display: flex;\n  height: 100%;\n  overflow: hidden;\n  background-color: #fff;\n}\n\n/* 编辑器容器需要相对定位 */\n:deep(.quill-editor .ql-container) {\n  position: relative;\n}\n\n.sidebar {\n  width: 240px;\n  height: 100%;\n  border-right: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  transition: width 0.3s;\n}\n\n.sidebar.collapsed {\n  width: 50px;\n}\n\n.sidebar-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.sidebar-header h4 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.toggle-btn {\n  cursor: pointer;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n}\n\n.toggle-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.sidebar-content {\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 48px);\n  overflow: hidden;\n}\n\n.search-area {\n  padding: 12px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.filter-options {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.document-list-scrollbar {\n  flex: 1;\n  padding: 8px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.document-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.doc-item {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.doc-item:hover {\n  background-color: #f5f7fa;\n}\n\n.doc-item.active {\n  background-color: #ecf5ff;\n}\n\n.doc-icon {\n  margin-right: 12px;\n  color: #409eff;\n}\n\n.doc-info {\n  flex: 1;\n  overflow: hidden;\n}\n\n.doc-info h5 {\n  margin: 0 0 4px 0;\n  font-size: 14px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.doc-meta {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n  color: #909399;\n}\n\n.action-buttons {\n  padding: 12px;\n  border-top: 1px solid #f0f0f0;\n}\n\n.action-buttons .el-button {\n  width: 100%;\n}\n\n.collapsed-sidebar {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 12px 0;\n  gap: 12px;\n  height: calc(100% - 48px);\n  overflow-y: auto;\n}\n\n.icon-btn {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.icon-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.icon-btn.doc-btn.active {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.create-btn {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.recent-docs {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n  align-items: center;\n}\n\n/* 主内容区域样式 */\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  min-width: 0;\n  height: 100%;\n  background-color: #f6f6f6;\n  position: relative;\n}\n\n.document-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: visible;\n  background-color: #f6f6f6;\n  height: 100%;\n}\n\n/* 文档标题和类型标签样式 */\n.doc-title-label, .doc-type-label {\n  font-size: 14px;\n  font-weight: 600;\n  color: #606266;\n  white-space: nowrap;\n}\n\n.document-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 24px;\n  background-color: #fff;\n  border-bottom: 1px solid #e6e6e6;\n  height: 68px;\n  box-sizing: border-box;\n  width: 100%;\n  z-index: 5;\n}\n\n.doc-info-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.doc-title {\n  width: 300px;\n}\n\n.doc-type-selector {\n  width: 150px;\n}\n\n.doc-actions {\n  display: flex;\n  gap: 8px;\n  z-index: 6; /* 确保操作按钮在最上层 */\n}\n\n.editor-area {\n  flex: 1;\n  padding: 24px;\n  overflow: visible;\n  background-color: #fff;\n  height: calc(100% - 68px);\n  position: relative;\n}\n\n.quill-editor {\n  height: 100%;\n  overflow-y: auto;\n}\n\n:deep(.ql-container) {\n  font-size: 16px;\n  height: auto;\n  min-height: 300px;\n}\n\n:deep(.ql-toolbar) {\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n}\n\n:deep(.ql-editor) {\n  min-height: calc(100vh - 250px);\n}\n\n.empty-doc-state {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #fff;\n}\n\n/* 智能助手面板样式 */\n.assistant-panel {\n  width: 240px;\n  height: 100%;\n  border-left: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s;\n}\n\n.assistant-panel.collapsed {\n  width: 50px;\n}\n\n.assistant-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.assistant-header h5 {\n  margin: 0;\n  font-size: 14px;\n  font-weight: 600;\n}\n\n.assistant-body {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 48px);\n}\n\n.assistant-content {\n  padding: 12px;\n  overflow-y: auto;\n  height: 100%;\n}\n\n.assistant-content h6 {\n  font-size: 14px;\n  margin: 12px 0 8px 0;\n  font-weight: 600;\n}\n\n.related-docs {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.related-doc-item {\n  padding: 8px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n}\n\n.doc-title {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.doc-source {\n  font-size: 12px;\n  color: #909399;\n  margin-top: 4px;\n}\n\n.suggested-actions {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.knowledge-items {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.knowledge-item {\n  border: 1px solid #ebeef5;\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.term-header {\n  display: flex;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background-color: #f5f7fa;\n  cursor: pointer;\n  font-weight: 500;\n}\n\n.term-explanation {\n  padding: 8px 12px;\n  font-size: 13px;\n  line-height: 1.5;\n  color: #606266;\n}\n\n.more-link {\n  text-align: right;\n  margin-top: 4px;\n}\n\n.decision-tree {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.decision-actions {\n  margin-top: 12px;\n}\n\n.empty-state {\n  padding: 20px;\n  text-align: center;\n}\n\n.context-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.warning-text {\n  color: #f56c6c;\n  font-weight: 500;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}