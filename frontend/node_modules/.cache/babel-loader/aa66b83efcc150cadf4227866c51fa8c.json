{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Index.vue","mtime":1747456826463},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1746431728000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3Iuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5kZWxldGUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuaGFzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLnNpemUuanMiOwppbXBvcnQgeyByZWYsIGNvbXB1dGVkLCBuZXh0VGljaywgb25Nb3VudGVkLCBvbkJlZm9yZVVubW91bnQsIHdhdGNoIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgRWxNZXNzYWdlLCBFbE1lc3NhZ2VCb3ggfSBmcm9tICdlbGVtZW50LXBsdXMnOwppbXBvcnQgeyBTZWFyY2gsIFBob25lLCBWaWRlb0NhbWVyYSwgSW5mb0ZpbGxlZCwgRG9jdW1lbnQsIFBpY3R1cmVGaWxsZWQsIEZvbGRlck9wZW5lZCwgTWljcm9waG9uZSwgUG9zaXRpb24sIENoYXREb3RTcXVhcmUsIFJlYWRpbmcsIFVzZXJGaWxsZWQsIENoYXRMaW5lU3F1YXJlLCBSZWZyZXNoIH0gZnJvbSAnQGVsZW1lbnQtcGx1cy9pY29ucy12dWUnOwppbXBvcnQgeyBnZXRDaGF0U2Vzc2lvbnMsIGdldENoYXRTZXNzaW9uLCBzZW5kVGV4dE1lc3NhZ2UsIHNlbmRGaWxlTWVzc2FnZSwgc2VuZEltYWdlTWVzc2FnZSwgc2VuZEtub3dsZWRnZU1lc3NhZ2UsIGRvd25sb2FkTWVzc2FnZUZpbGUgfSBmcm9tICdAL2FwaS9jaGF0JzsKaW1wb3J0IHsgZ2V0S25vd2xlZGdlTGlzdCB9IGZyb20gJ0AvYXBpL2tub3dsZWRnZSc7CmltcG9ydCB7IHVzZVJvdXRlIH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2hhdCcsCiAgc2V0dXAoKSB7CiAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgICBjb25zdCBjdXJyZW50VXNlciA9IGNvbXB1dGVkKCgpID0+IHN0b3JlLmdldHRlcnMudXNlcik7CgogICAgLy8g5re75Yqg5pys5Zyw55So5oi35pWw5o2u5a2Y5YKoCiAgICBjb25zdCB1c2VySW5mbyA9IHJlZihudWxsKTsKICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcmVmKCcnKTsKICAgIGNvbnN0IGFjdGl2ZVRhYiA9IHJlZigwKTsKICAgIGNvbnN0IHNlbGVjdGVkQ29udGFjdCA9IHJlZihudWxsKTsKICAgIGNvbnN0IG1lc3NhZ2VJbnB1dCA9IHJlZignJyk7CiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gcmVmKG51bGwpOwogICAgY29uc3QgZmlsZUlucHV0ID0gcmVmKG51bGwpOwogICAgY29uc3QgaW1hZ2VJbnB1dCA9IHJlZihudWxsKTsKICAgIGNvbnN0IG1lc3NhZ2VzID0gcmVmKFtdKTsKICAgIGNvbnN0IGxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgY2hhdFNlc3Npb25zID0gcmVmKFtdKTsKICAgIGNvbnN0IGN1cnJlbnRDaGF0SWQgPSByZWYobnVsbCk7CgogICAgLy8g55+l6K+G5bqT55u45YWzCiAgICBjb25zdCBrbm93bGVkZ2VEaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGtub3dsZWRnZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3Qga25vd2xlZGdlTGlzdCA9IHJlZihbXSk7CiAgICBjb25zdCBzZWxlY3RlZEtub3dsZWRnZSA9IHJlZihudWxsKTsKCiAgICAvLyDmoIfnrb7pobUKICAgIGNvbnN0IHRhYnMgPSByZWYoWyfmnIDov5HogYrlpKknLCAn5ZCM5LqLJywgJ+e+pOe7hCddKTsKCiAgICAvLyDogZTns7vkurrliJfooagKICAgIGNvbnN0IGNvbnRhY3RzID0gcmVmKFtdKTsKCiAgICAvLyDlvZPliY3pgInkuK3nmoTogZTns7vkuroKICAgIGNvbnN0IGN1cnJlbnRDb250YWN0ID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBpZiAoc2VsZWN0ZWRDb250YWN0LnZhbHVlID09PSBudWxsKSByZXR1cm4ge307CiAgICAgIHJldHVybiBjb250YWN0cy52YWx1ZS5maW5kKGMgPT4gYy5pZCA9PT0gc2VsZWN0ZWRDb250YWN0LnZhbHVlKSB8fCB7fTsKICAgIH0pOwoKICAgIC8vIOWuieWFqOWcsOiOt+WPlueUqOaIt0lE77yM6YG/5YWN5qih5p2/5Lit55qEbnVsbOmUmeivrwogICAgY29uc3QgdXNlcklkID0gY29tcHV0ZWQoKCkgPT4gewogICAgICB2YXIgX3VzZXJJbmZvJHZhbHVlOwogICAgICByZXR1cm4gKChfdXNlckluZm8kdmFsdWUgPSB1c2VySW5mby52YWx1ZSkgPT09IG51bGwgfHwgX3VzZXJJbmZvJHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdXNlckluZm8kdmFsdWUuaWQpIHx8IG51bGw7CiAgICB9KTsKCiAgICAvLyDmoLnmja7mkJzntKLov4fmu6TogZTns7vkuroKICAgIGNvbnN0IGZpbHRlcmVkQ29udGFjdHMgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIGlmICghc2VhcmNoUXVlcnkudmFsdWUpIHJldHVybiBjb250YWN0cy52YWx1ZTsKICAgICAgcmV0dXJuIGNvbnRhY3RzLnZhbHVlLmZpbHRlcihjb250YWN0ID0+IGNvbnRhY3QubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFF1ZXJ5LnZhbHVlLnRvTG93ZXJDYXNlKCkpKTsKICAgIH0pOwoKICAgIC8vIOi3r+eUsQogICAgY29uc3Qgcm91dGUgPSB1c2VSb3V0ZSgpOwoKICAgIC8vIOWumuS5ieS4gOS4qnJlZnJlc2hJbnRlcnZhbOeahOW8leeUqO+8jOS7peS+v+WcqOe7hOS7tuWNuOi9veaXtua4hemZpAogICAgbGV0IHJlZnJlc2hJbnRlcnZhbCA9IG51bGw7CgogICAgLy8g57uE5Lu25Y246L295pe25riF6Zmk5a6a5pe25ZmoCiAgICBvbkJlZm9yZVVubW91bnQoKCkgPT4gewogICAgICBpZiAocmVmcmVzaEludGVydmFsKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbChyZWZyZXNoSW50ZXJ2YWwpOwogICAgICB9CiAgICB9KTsKCiAgICAvLyDojrflj5blvZPliY3nlKjmiLfkv6Hmga8KICAgIGNvbnN0IGZldGNoQ3VycmVudFVzZXIgPSBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+iOt+WPluW9k+WJjeeUqOaIt+S/oeaBry4uLicpOwoKICAgICAgICAvLyDmo4Dmn6Vsb2NhbFN0b3JhZ2XkuK3mmK/lkKbmnIl0b2tlbgogICAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7CiAgICAgICAgaWYgKCF0b2tlbikgewogICAgICAgICAgY29uc29sZS53YXJuKCfmnKzlnLDlrZjlgqjkuK3msqHmnInmib7liLDorqTor4F0b2tlbicpOwogICAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+acqueZu+W9leaIlueZu+W9leW3sui/h+acn++8jOivt+mHjeaWsOeZu+W9lScpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICcvYXBpL2F1dGgvdXNlcnMvbWUvJywKICAgICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygn6I635Y+W55So5oi35L+h5oGv5ZON5bqUOicsIHJlc3BvbnNlKTsKCiAgICAgICAgLy8g5qOA5p+l5ZON5bqU5qC85byP5bm26I635Y+W55So5oi35pWw5o2uCiAgICAgICAgbGV0IHVzZXJEYXRhID0gbnVsbDsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmlkKSB7CiAgICAgICAgICAvLyDnm7TmjqXku45kYXRh5a2X5q616I635Y+W55So5oi35pWw5o2uCiAgICAgICAgICB1c2VyRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBjb25zb2xlLmxvZygn5LuOZGF0YeWtl+auteiOt+WPlueUqOaIt+aVsOaNrjonLCB1c2VyRGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEuZGF0YSAmJiByZXNwb25zZS5kYXRhLmRhdGEuaWQpIHsKICAgICAgICAgIC8vIOS7juW1jOWll2RhdGHlrZfmrrXojrflj5bnlKjmiLfmlbDmja4KICAgICAgICAgIHVzZXJEYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2coJ+S7juW1jOWll2RhdGHlrZfmrrXojrflj5bnlKjmiLfmlbDmja46JywgdXNlckRhdGEpOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuaWQpIHsKICAgICAgICAgIC8vIOebtOaOpeWTjeW6lOWwseaYr+eUqOaIt+aVsOaNrgogICAgICAgICAgdXNlckRhdGEgPSByZXNwb25zZTsKICAgICAgICAgIGNvbnNvbGUubG9nKCfnm7TmjqXojrflj5bnlKjmiLfmlbDmja46JywgdXNlckRhdGEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bnlKjmiLfkv6Hmga/lk43lupTmoLzlvI/lvILluLg6JywgcmVzcG9uc2UpOwogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfnlKjmiLfkv6Hmga/moLzlvI/lvILluLgnKTsKICAgICAgICB9CiAgICAgICAgaWYgKCF1c2VyRGF0YSB8fCAhdXNlckRhdGEuaWQpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPlueahOeUqOaIt+aVsOaNruaXoOaViDonLCB1c2VyRGF0YSk7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOeUqOaIt+aVsOaNricpOwogICAgICAgIH0KCiAgICAgICAgLy8g5LiN5L2/55So5pyq5a6a5LmJ55qEbXV0YXRpb27vvIzogIzmmK/nm7TmjqXmm7TmlrDmnKzlnLDnirbmgIEKICAgICAgICB1c2VySW5mby52YWx1ZSA9IHVzZXJEYXRhOwoKICAgICAgICAvLyDkv53lrZjliLBsb2NhbFN0b3JhZ2Xku6Xkvr/mjIHkuYXljJYKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcicsIEpTT04uc3RyaW5naWZ5KHVzZXJEYXRhKSk7CiAgICAgICAgY29uc29sZS5sb2coJ+eUqOaIt+aVsOaNruW3suabtOaWsDonLCB1c2VySW5mby52YWx1ZSk7CiAgICAgICAgcmV0dXJuIHVzZXJEYXRhOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluW9k+WJjeeUqOaIt+S/oeaBr+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfojrflj5bnlKjmiLfkv6Hmga/lpLHotKU6ICcgKyAoZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJykpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9OwoKICAgIC8vIOWKoOi9veiBiuWkqeS8muivneWIl+ihqAogICAgY29uc3QgbG9hZENoYXRTZXNzaW9ucyA9IGFzeW5jICgpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygn5q2j5Zyo5Yqg6L296IGK5aSp5Lya6K+d5YiX6KGoLi4uJyk7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRDaGF0U2Vzc2lvbnMoKTsKICAgICAgICBjb25zb2xlLmxvZygn6I635Y+W6IGK5aSp5Lya6K+d5ZON5bqUOicsIHJlc3BvbnNlKTsKCiAgICAgICAgLy8g56Gu5L+d5oiR5Lus5pyJ5ZON5bqU5pWw5o2uCiAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W6IGK5aSp5Lya6K+d6L+U5Zue56m65ZON5bqUJyk7CiAgICAgICAgICBjb250YWN0cy52YWx1ZSA9IFtdOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgZGF0YTsKICAgICAgICBpZiAocmVzcG9uc2Uuc3VjY2VzcyAmJiByZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIGNvbnNvbGUubG9nKCfkvb/nlKjljIXoo4XmoLzlvI/nmoTogYrlpKnmlbDmja46JywgZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRhdGEgPSByZXNwb25zZTsKICAgICAgICAgIGNvbnNvbGUubG9nKCfkvb/nlKjnm7TmjqXov5Tlm57nmoTogYrlpKnmlbDmja46JywgZGF0YSk7CiAgICAgICAgfQoKICAgICAgICAvLyDovazmjaLmlbDmja7moLzlvI8KICAgICAgICBjaGF0U2Vzc2lvbnMudmFsdWUgPSBkYXRhOwoKICAgICAgICAvLyDmnoTlu7rogZTns7vkurrliJfooagKICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEucmVzdWx0cykpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCflpITnkIbliIbpobXmlbDmja7nu5PmnoQsIOWFseacieS8muivneaVsDonLCBkYXRhLnJlc3VsdHMubGVuZ3RoKTsKICAgICAgICAgIC8vIOWkhOeQhuWIhumhteaVsOaNrue7k+aehAogICAgICAgICAgY29udGFjdHMudmFsdWUgPSBkYXRhLnJlc3VsdHMubWFwKHNlc3Npb24gPT4gewogICAgICAgICAgICAvLyDmib7liLDlr7nmlrnnlKjmiLfvvIjpnZ7lvZPliY3nlKjmiLfvvIkKICAgICAgICAgICAgbGV0IG90aGVyUGFydGljaXBhbnQgPSBudWxsOwogICAgICAgICAgICBpZiAoc2Vzc2lvbi5wYXJ0aWNpcGFudHMgJiYgQXJyYXkuaXNBcnJheShzZXNzaW9uLnBhcnRpY2lwYW50cykpIHsKICAgICAgICAgICAgICBpZiAodXNlckluZm8udmFsdWUgJiYgdXNlckluZm8udmFsdWUuaWQpIHsKICAgICAgICAgICAgICAgIG90aGVyUGFydGljaXBhbnQgPSBzZXNzaW9uLnBhcnRpY2lwYW50cy5maW5kKHAgPT4gcC51c2VyICYmIHAudXNlci5pZCAhPT0gdXNlckluZm8udmFsdWUuaWQpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmsqHmnInlvZPliY3nlKjmiLfkv6Hmga/vvIzkvb/nlKjnrKzkuIDkuKrlj4LkuI7ogIUKICAgICAgICAgICAgICAgIG90aGVyUGFydGljaXBhbnQgPSBzZXNzaW9uLnBhcnRpY2lwYW50c1swXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOWmguaenOaYr+e+pOiBiu+8jOS9v+eUqOe+pOiBiuS/oeaBrwogICAgICAgICAgICBpZiAoc2Vzc2lvbi5pc19ncm91cCkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBpZDogc2Vzc2lvbi5pZCwKICAgICAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udGl0bGUgfHwgJ+e+pOiBiicsCiAgICAgICAgICAgICAgICBpbml0aWFsOiAoc2Vzc2lvbi50aXRsZSB8fCAn576k6IGKJylbMF0sCiAgICAgICAgICAgICAgICBhdmF0YXI6ICcnLAogICAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHNlc3Npb24uaWQpLAogICAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IHNlc3Npb24ubGFzdF9tZXNzYWdlLmNvbnRlbnQgOiAnJywKICAgICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICAgIHVucmVhZDogc2Vzc2lvbi51bnJlYWRfY291bnQsCiAgICAgICAgICAgICAgICBpc0dyb3VwOiB0cnVlCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5Y2V6IGK77yM5L2/55So5a+55pa55L+h5oGvCiAgICAgICAgICAgIGlmIChvdGhlclBhcnRpY2lwYW50KSB7CiAgICAgICAgICAgICAgY29uc3QgdXNlciA9IG90aGVyUGFydGljaXBhbnQudXNlcjsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgaWQ6IHNlc3Npb24uaWQsCiAgICAgICAgICAgICAgICBuYW1lOiAoKHVzZXIuZmlyc3RfbmFtZSB8fCAnJykgKyAnICcgKyAodXNlci5sYXN0X25hbWUgfHwgJycpKS50cmltKCkgfHwgdXNlci51c2VybmFtZSB8fCAn5pyq5ZG95ZCN6IGU57O75Lq6JywKICAgICAgICAgICAgICAgIGluaXRpYWw6ICh1c2VyLmZpcnN0X25hbWUgfHwgdXNlci51c2VybmFtZSB8fCAn5pyq5ZG95ZCN6IGU57O75Lq6JylbMF0sCiAgICAgICAgICAgICAgICBhdmF0YXI6IHVzZXIuYXZhdGFyIHx8ICcnLAogICAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHVzZXIuaWQpLAogICAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IHNlc3Npb24ubGFzdF9tZXNzYWdlLmNvbnRlbnQgOiAnJywKICAgICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICAgIHVucmVhZDogc2Vzc2lvbi51bnJlYWRfY291bnQsCiAgICAgICAgICAgICAgICBpc0dyb3VwOiBmYWxzZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOWmguaenOayoeacieWFtuS7luWPguS4juiAhe+8iOeQhuiuuuS4iuS4jeW6lOivpeWPkeeUn++8iQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGlkOiBzZXNzaW9uLmlkLAogICAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udGl0bGUgfHwgJ+iBiuWkqScsCiAgICAgICAgICAgICAgaW5pdGlhbDogKHNlc3Npb24udGl0bGUgfHwgJ+iBiuWkqScpWzBdLAogICAgICAgICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHNlc3Npb24uaWQpLAogICAgICAgICAgICAgIHN0YXR1czogJ29ubGluZScsCiAgICAgICAgICAgICAgbGFzdE1lc3NhZ2U6IHNlc3Npb24ubGFzdF9tZXNzYWdlID8gc2Vzc2lvbi5sYXN0X21lc3NhZ2UuY29udGVudCA6ICcnLAogICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICB1bnJlYWQ6IHNlc3Npb24udW5yZWFkX2NvdW50LAogICAgICAgICAgICAgIGlzR3JvdXA6IHNlc3Npb24uaXNfZ3JvdXAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5aSE55CG6Z2e5YiG6aG15pWw5o2u57uT5p6ELCDlhbHmnInkvJror53mlbA6JywgZGF0YS5sZW5ndGgpOwogICAgICAgICAgLy8g5aSE55CG6Z2e5YiG6aG15pWw5o2u57uT5p6ECiAgICAgICAgICBjb250YWN0cy52YWx1ZSA9IGRhdGEubWFwKHNlc3Npb24gPT4gewogICAgICAgICAgICAvLyDmib7liLDlr7nmlrnnlKjmiLfvvIjpnZ7lvZPliY3nlKjmiLfvvIkKICAgICAgICAgICAgbGV0IG90aGVyUGFydGljaXBhbnQgPSBudWxsOwogICAgICAgICAgICBpZiAoc2Vzc2lvbi5wYXJ0aWNpcGFudHMgJiYgQXJyYXkuaXNBcnJheShzZXNzaW9uLnBhcnRpY2lwYW50cykpIHsKICAgICAgICAgICAgICBpZiAodXNlckluZm8udmFsdWUgJiYgdXNlckluZm8udmFsdWUuaWQpIHsKICAgICAgICAgICAgICAgIG90aGVyUGFydGljaXBhbnQgPSBzZXNzaW9uLnBhcnRpY2lwYW50cy5maW5kKHAgPT4gcC51c2VyICYmIHAudXNlci5pZCAhPT0gdXNlckluZm8udmFsdWUuaWQpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmsqHmnInlvZPliY3nlKjmiLfkv6Hmga/vvIzkvb/nlKjnrKzkuIDkuKrlj4LkuI7ogIUKICAgICAgICAgICAgICAgIG90aGVyUGFydGljaXBhbnQgPSBzZXNzaW9uLnBhcnRpY2lwYW50c1swXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOWmguaenOaYr+e+pOiBiu+8jOS9v+eUqOe+pOiBiuS/oeaBrwogICAgICAgICAgICBpZiAoc2Vzc2lvbi5pc19ncm91cCkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBpZDogc2Vzc2lvbi5pZCwKICAgICAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udGl0bGUgfHwgJ+e+pOiBiicsCiAgICAgICAgICAgICAgICBpbml0aWFsOiAoc2Vzc2lvbi50aXRsZSB8fCAn576k6IGKJylbMF0sCiAgICAgICAgICAgICAgICBhdmF0YXI6ICcnLAogICAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHNlc3Npb24uaWQpLAogICAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IHNlc3Npb24ubGFzdF9tZXNzYWdlLmNvbnRlbnQgOiAnJywKICAgICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICAgIHVucmVhZDogc2Vzc2lvbi51bnJlYWRfY291bnQsCiAgICAgICAgICAgICAgICBpc0dyb3VwOiB0cnVlCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5Y2V6IGK77yM5L2/55So5a+55pa55L+h5oGvCiAgICAgICAgICAgIGlmIChvdGhlclBhcnRpY2lwYW50KSB7CiAgICAgICAgICAgICAgY29uc3QgdXNlciA9IG90aGVyUGFydGljaXBhbnQudXNlcjsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgaWQ6IHNlc3Npb24uaWQsCiAgICAgICAgICAgICAgICBuYW1lOiAoKHVzZXIuZmlyc3RfbmFtZSB8fCAnJykgKyAnICcgKyAodXNlci5sYXN0X25hbWUgfHwgJycpKS50cmltKCkgfHwgdXNlci51c2VybmFtZSB8fCAn5pyq5ZG95ZCN6IGU57O75Lq6JywKICAgICAgICAgICAgICAgIGluaXRpYWw6ICh1c2VyLmZpcnN0X25hbWUgfHwgdXNlci51c2VybmFtZSB8fCAn5pyq5ZG95ZCN6IGU57O75Lq6JylbMF0sCiAgICAgICAgICAgICAgICBhdmF0YXI6IHVzZXIuYXZhdGFyIHx8ICcnLAogICAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHVzZXIuaWQpLAogICAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IHNlc3Npb24ubGFzdF9tZXNzYWdlLmNvbnRlbnQgOiAnJywKICAgICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICAgIHVucmVhZDogc2Vzc2lvbi51bnJlYWRfY291bnQsCiAgICAgICAgICAgICAgICBpc0dyb3VwOiBmYWxzZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOWmguaenOayoeacieWFtuS7luWPguS4juiAhe+8iOeQhuiuuuS4iuS4jeW6lOivpeWPkeeUn++8iQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGlkOiBzZXNzaW9uLmlkLAogICAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udGl0bGUgfHwgJ+iBiuWkqScsCiAgICAgICAgICAgICAgaW5pdGlhbDogKHNlc3Npb24udGl0bGUgfHwgJ+iBiuWkqScpWzBdLAogICAgICAgICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKHNlc3Npb24uaWQpLAogICAgICAgICAgICAgIHN0YXR1czogJ29ubGluZScsCiAgICAgICAgICAgICAgbGFzdE1lc3NhZ2U6IHNlc3Npb24ubGFzdF9tZXNzYWdlID8gc2Vzc2lvbi5sYXN0X21lc3NhZ2UuY29udGVudCA6ICcnLAogICAgICAgICAgICAgIGxhc3RUaW1lOiBzZXNzaW9uLmxhc3RfbWVzc2FnZSA/IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24ubGFzdF9tZXNzYWdlLmNyZWF0ZWRfYXQpIDogZm9ybWF0TWVzc2FnZVRpbWUoc2Vzc2lvbi51cGRhdGVkX2F0KSwKICAgICAgICAgICAgICB1bnJlYWQ6IHNlc3Npb24udW5yZWFkX2NvdW50LAogICAgICAgICAgICAgIGlzR3JvdXA6IHNlc3Npb24uaXNfZ3JvdXAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlpoLmnpzmsqHmnInmnInmlYjmlbDmja4KICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluiBiuWkqeS8muivneagvOW8j+W8guW4uOaIluS4uuepujonLCBkYXRhKTsKICAgICAgICAgIGNvbnRhY3RzLnZhbHVlID0gW107CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCflpITnkIblkI7nmoTogZTns7vkurrliJfooag6JywgY29udGFjdHMudmFsdWUpOwoKICAgICAgICAvLyDlpoLmnpzmnInmnKror7vmtojmga/vvIzmjInmnKror7vmlbDph4/mjpLluo8KICAgICAgICBpZiAoY29udGFjdHMudmFsdWUubGVuZ3RoID4gMCkgewogICAgICAgICAgY29udGFjdHMudmFsdWUuc29ydCgoYSwgYikgPT4gYi51bnJlYWQgLSBhLnVucmVhZCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veiBiuWkqeS8muivneWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3ogYrlpKnkvJror53lpLHotKU6ICcgKyAoZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJykpOwogICAgICAgIGNvbnRhY3RzLnZhbHVlID0gW107CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgbG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIC8vIOWKoOi9veiBiuWkqea2iOaBrwogICAgY29uc3QgbG9hZENoYXRNZXNzYWdlcyA9IGFzeW5jIGNoYXRJZCA9PiB7CiAgICAgIGlmICghY2hhdElkKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5peg5rOV5Yqg6L295raI5oGvOiBjaGF0SWTkuLrnqbonKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZyhg5q2j5Zyo5Yqg6L296IGK5aSp5Lya6K+dICR7Y2hhdElkfSDnmoTmtojmga8uLi5gKTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldENoYXRTZXNzaW9uKGNoYXRJZCk7CiAgICAgICAgY29uc29sZS5sb2coJ+iBiuWkqeS8muivneivpuaDheWTjeW6lDonLCByZXNwb25zZSk7CiAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W6IGK5aSp5Lya6K+d6K+m5oOF6L+U5Zue56m65ZON5bqUJyk7CiAgICAgICAgICBtZXNzYWdlcy52YWx1ZSA9IFtdOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8g5aSE55CG5LiN5ZCM55qE5ZON5bqU5qC85byPCiAgICAgICAgbGV0IG1lc3NhZ2VEYXRhID0gW107CiAgICAgICAgbGV0IHNlc3Npb25EYXRhID0gbnVsbDsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLm1lc3NhZ2VzKSB7CiAgICAgICAgICAvLyDmoIflh4bmoLzlvI/vvJrlk43lupTnm7TmjqXljIXlkKttZXNzYWdlc+Wtl+autQogICAgICAgICAgbWVzc2FnZURhdGEgPSByZXNwb25zZS5kYXRhLm1lc3NhZ2VzOwogICAgICAgICAgc2Vzc2lvbkRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2coJ+agh+WHhuagvOW8j+a2iOaBr+aVsOaNru+8jOa2iOaBr+aVsOmHjzonLCBtZXNzYWdlRGF0YS5sZW5ndGgpOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5kYXRhLm1lc3NhZ2VzKSB7CiAgICAgICAgICAvLyDljIXoo4XmoLzlvI/vvJp7c3VjY2VzczogdHJ1ZSwgZGF0YToge21lc3NhZ2VzOiBbLi4uXX19CiAgICAgICAgICBtZXNzYWdlRGF0YSA9IHJlc3BvbnNlLmRhdGEuZGF0YS5tZXNzYWdlczsKICAgICAgICAgIHNlc3Npb25EYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgY29uc29sZS5sb2coJ+WMheijheagvOW8j+a2iOaBr+aVsOaNru+8jOa2iOaBr+aVsOmHjzonLCBtZXNzYWdlRGF0YS5sZW5ndGgpOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UubWVzc2FnZXMpIHsKICAgICAgICAgIC8vIOebtOaOpei/lOWbnuagvOW8jzoge21lc3NhZ2VzOiBbLi4uXX0KICAgICAgICAgIG1lc3NhZ2VEYXRhID0gcmVzcG9uc2UubWVzc2FnZXM7CiAgICAgICAgICBzZXNzaW9uRGF0YSA9IHJlc3BvbnNlOwogICAgICAgICAgY29uc29sZS5sb2coJ+ebtOaOpei/lOWbnuagvOW8j+a2iOaBr+aVsOaNru+8jOa2iOaBr+aVsOmHjzonLCBtZXNzYWdlRGF0YS5sZW5ndGgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oJ+aXoOazleivhuWIq+eahOa2iOaBr+aVsOaNruagvOW8jzonLCByZXNwb25zZSk7CiAgICAgICAgICBjb25zb2xlLmxvZygn5bCd6K+V5qOA5p+l5piv5ZCm5pyJ5YW25LuW5Y+v6IO955qE5raI5oGv5a2X5q61Li4uJyk7CgogICAgICAgICAgLy8g5bCd6K+V5p+l5om+5YW25LuW5Y+v6IO955qE5raI5oGv5a2X5q61CiAgICAgICAgICBjb25zdCBwb3NzaWJsZU1lc3NhZ2VGaWVsZHMgPSBbJ21lc3NhZ2UnLCAnY2hhdF9tZXNzYWdlcycsICdjaGF0cycsICdjb250ZW50J107CiAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIHBvc3NpYmxlTWVzc2FnZUZpZWxkcykgewogICAgICAgICAgICBpZiAocmVzcG9uc2VbZmllbGRdICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2VbZmllbGRdKSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDmib7liLDlj6/og73nmoTmtojmga/lrZfmrrUgJHtmaWVsZH3vvIzkvb/nlKjmraTlrZfmrrXmlbDmja5gKTsKICAgICAgICAgICAgICBtZXNzYWdlRGF0YSA9IHJlc3BvbnNlW2ZpZWxkXTsKICAgICAgICAgICAgICBzZXNzaW9uRGF0YSA9IHJlc3BvbnNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YVtmaWVsZF0gJiYgQXJyYXkuaXNBcnJheShyZXNwb25zZS5kYXRhW2ZpZWxkXSkpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg5ZyoZGF0YeWtl+auteS4reaJvuWIsOWPr+iDveeahOa2iOaBr+Wtl+autSAke2ZpZWxkfe+8jOS9v+eUqOatpOWtl+auteaVsOaNrmApOwogICAgICAgICAgICAgIG1lc3NhZ2VEYXRhID0gcmVzcG9uc2UuZGF0YVtmaWVsZF07CiAgICAgICAgICAgICAgc2Vzc2lvbkRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobWVzc2FnZURhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybign5pyq5om+5Yiw5Lu75L2V5raI5oGv5pWw5o2u77yM5L2/55So56m65pWw57uEJyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyDorrDlvZXkvJror53lkozmtojmga/mlbDmja4KICAgICAgICBjb25zb2xlLmxvZygn5aSE55CG5ZCO55qE5Lya6K+d5pWw5o2uOicsIHNlc3Npb25EYXRhKTsKICAgICAgICBjb25zb2xlLmxvZygn5aSE55CG5ZCO55qE5raI5oGv5pWw5o2uOicsIG1lc3NhZ2VEYXRhKTsKCiAgICAgICAgLy8g5aaC5p6c5Lya6K+d5LiN5Zyo6IGU57O75Lq65YiX6KGo5Lit77yM5re75Yqg5a6DCiAgICAgICAgaWYgKHNlc3Npb25EYXRhICYmICFjb250YWN0cy52YWx1ZS5zb21lKGMgPT4gYy5pZCA9PT0gcGFyc2VJbnQoY2hhdElkKSkpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfkvJror53kuI3lnKjogZTns7vkurrliJfooajkuK3vvIzmt7vliqDlroM6Jywgc2Vzc2lvbkRhdGEpOwoKICAgICAgICAgIC8vIOWIm+W7uuS4tOaXtuiBlOezu+S6uuWvueixoQogICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IHNlc3Npb25EYXRhOwogICAgICAgICAgLy8g5om+5Yiw5a+55pa555So5oi377yI6Z2e5b2T5YmN55So5oi377yJCiAgICAgICAgICBsZXQgb3RoZXJQYXJ0aWNpcGFudCA9IG51bGw7CgogICAgICAgICAgLy8g56Gu5L+dIHNlc3Npb24ucGFydGljaXBhbnRzIOWtmOWcqOS4lOaYr+aVsOe7hAogICAgICAgICAgaWYgKHNlc3Npb24ucGFydGljaXBhbnRzICYmIEFycmF5LmlzQXJyYXkoc2Vzc2lvbi5wYXJ0aWNpcGFudHMpICYmIHNlc3Npb24ucGFydGljaXBhbnRzLmxlbmd0aCA+IDAgJiYgdXNlckluZm8udmFsdWUpIHsKICAgICAgICAgICAgb3RoZXJQYXJ0aWNpcGFudCA9IHNlc3Npb24ucGFydGljaXBhbnRzLmZpbmQocCA9PiBwLnVzZXIgJiYgcC51c2VyLmlkICE9PSB1c2VySW5mby52YWx1ZS5pZCk7CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgdGVtcENvbnRhY3QgPSBudWxsOwoKICAgICAgICAgIC8vIOWmguaenOaYr+e+pOiBiu+8jOS9v+eUqOe+pOiBiuS/oeaBrwogICAgICAgICAgaWYgKHNlc3Npb24uaXNfZ3JvdXApIHsKICAgICAgICAgICAgdGVtcENvbnRhY3QgPSB7CiAgICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGNoYXRJZCksCiAgICAgICAgICAgICAgbmFtZTogc2Vzc2lvbi50aXRsZSB8fCAn576k6IGKJywKICAgICAgICAgICAgICBpbml0aWFsOiAoc2Vzc2lvbi50aXRsZSB8fCAn576k6IGKJylbMF0sCiAgICAgICAgICAgICAgYXZhdGFyOiAnJywKICAgICAgICAgICAgICBjb2xvcjogZ2V0UmFuZG9tQ29sb3IocGFyc2VJbnQoY2hhdElkKSksCiAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICBsYXN0TWVzc2FnZTogc2Vzc2lvbi5sYXN0X21lc3NhZ2UgPyBzZXNzaW9uLmxhc3RfbWVzc2FnZS5jb250ZW50IDogJycsCiAgICAgICAgICAgICAgbGFzdFRpbWU6IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24udXBkYXRlZF9hdCksCiAgICAgICAgICAgICAgdW5yZWFkOiAwLAogICAgICAgICAgICAgIGlzR3JvdXA6IHRydWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgLy8g5Y2V6IGK77yM5L2/55So5a+55pa55L+h5oGvCiAgICAgICAgICB9IGVsc2UgaWYgKG90aGVyUGFydGljaXBhbnQgJiYgb3RoZXJQYXJ0aWNpcGFudC51c2VyKSB7CiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBvdGhlclBhcnRpY2lwYW50LnVzZXI7CiAgICAgICAgICAgIHRlbXBDb250YWN0ID0gewogICAgICAgICAgICAgIGlkOiBwYXJzZUludChjaGF0SWQpLAogICAgICAgICAgICAgIG5hbWU6ICgodXNlci5maXJzdF9uYW1lIHx8ICcnKSArICcgJyArICh1c2VyLmxhc3RfbmFtZSB8fCAnJykpLnRyaW0oKSB8fCB1c2VyLnVzZXJuYW1lIHx8ICfmnKrlkb3lkI3ogZTns7vkuronLAogICAgICAgICAgICAgIGluaXRpYWw6ICh1c2VyLmZpcnN0X25hbWUgfHwgdXNlci51c2VybmFtZSB8fCAn5pyq5ZG95ZCN6IGU57O75Lq6JylbMF0sCiAgICAgICAgICAgICAgYXZhdGFyOiB1c2VyLmF2YXRhciB8fCAnJywKICAgICAgICAgICAgICBjb2xvcjogZ2V0UmFuZG9tQ29sb3IodXNlci5pZCksCiAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICBsYXN0TWVzc2FnZTogc2Vzc2lvbi5sYXN0X21lc3NhZ2UgPyBzZXNzaW9uLmxhc3RfbWVzc2FnZS5jb250ZW50IDogJycsCiAgICAgICAgICAgICAgbGFzdFRpbWU6IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24udXBkYXRlZF9hdCksCiAgICAgICAgICAgICAgdW5yZWFkOiAwLAogICAgICAgICAgICAgIGlzR3JvdXA6IGZhbHNlCiAgICAgICAgICAgIH07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDlpoLmnpzml6Dms5Xmib7liLDlr7nmlrnkv6Hmga/vvIzkvb/nlKjpu5jorqTlgLwKICAgICAgICAgICAgdGVtcENvbnRhY3QgPSB7CiAgICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGNoYXRJZCksCiAgICAgICAgICAgICAgbmFtZTogc2Vzc2lvbi50aXRsZSB8fCAn6IGK5aSpJywKICAgICAgICAgICAgICBpbml0aWFsOiAoc2Vzc2lvbi50aXRsZSB8fCAn6IGK5aSpJylbMF0sCiAgICAgICAgICAgICAgYXZhdGFyOiAnJywKICAgICAgICAgICAgICBjb2xvcjogZ2V0UmFuZG9tQ29sb3IocGFyc2VJbnQoY2hhdElkKSksCiAgICAgICAgICAgICAgc3RhdHVzOiAnb25saW5lJywKICAgICAgICAgICAgICBsYXN0TWVzc2FnZTogJycsCiAgICAgICAgICAgICAgbGFzdFRpbWU6IGZvcm1hdE1lc3NhZ2VUaW1lKHNlc3Npb24udXBkYXRlZF9hdCksCiAgICAgICAgICAgICAgdW5yZWFkOiAwLAogICAgICAgICAgICAgIGlzR3JvdXA6IHNlc3Npb24uaXNfZ3JvdXAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyDmt7vliqDkuLTml7bogZTns7vkurrliLDliJfooagKICAgICAgICAgIGlmICh0ZW1wQ29udGFjdCkgewogICAgICAgICAgICBjb250YWN0cy52YWx1ZS51bnNoaWZ0KHRlbXBDb250YWN0KTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+a3u+WKoOS4tOaXtuiBlOezu+S6ujonLCB0ZW1wQ29udGFjdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyDmm7TmlrDnu4Tku7bmlbDmja4KICAgICAgICBtZXNzYWdlcy52YWx1ZSA9IG1lc3NhZ2VEYXRhIHx8IFtdOwogICAgICAgIGN1cnJlbnRDaGF0SWQudmFsdWUgPSBwYXJzZUludChjaGF0SWQpOwogICAgICAgIHNlbGVjdGVkQ29udGFjdC52YWx1ZSA9IHBhcnNlSW50KGNoYXRJZCk7CgogICAgICAgIC8vIOa7muWKqOWIsOW6lemDqAogICAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHNjcm9sbFRvQm90dG9tKCk7CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L295Lya6K+d6K+m5oOF5aSx6LSlOicsIGVycm9yKTsKICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJ+WKoOi9veiBiuWkqea2iOaBr+Wksei0pSc7CiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICBjb25zdCBzdGF0dXMgPSBlcnJvci5yZXNwb25zZS5zdGF0dXM7CiAgICAgICAgICBpZiAoc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ+iBiuWkqeS8muivneS4jeWtmOWcqOaIluW3suiiq+WIoOmZpCc7CiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gNDAzKSB7CiAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICfml6DmnYPorr/pl67mraTogYrlpKnkvJror50nOwogICAgICAgICAgfSBlbHNlIGlmIChlcnJvci5yZXNwb25zZS5kYXRhICYmIGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSkgewogICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2U7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlKSB7CiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlOwogICAgICAgIH0KICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgICAgICBtZXNzYWdlcy52YWx1ZSA9IFtdOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyDliLfmlrDogYrlpKnkvJror53liJfooagKICAgIGNvbnN0IHJlZnJlc2hDaGF0U2Vzc2lvbnMgPSBhc3luYyAoKSA9PiB7CiAgICAgIGF3YWl0IGxvYWRDaGF0U2Vzc2lvbnMoKTsKCiAgICAgIC8vIOWmguaenOacieW9k+WJjeiBiuWkqUlE77yM56Gu5L+d6YCJ5Lit5q2j56Gu55qE6IGU57O75Lq6CiAgICAgIGlmIChjdXJyZW50Q2hhdElkLnZhbHVlKSB7CiAgICAgICAgY29uc3QgY29udGFjdCA9IGNvbnRhY3RzLnZhbHVlLmZpbmQoYyA9PiBjLmlkID09PSBjdXJyZW50Q2hhdElkLnZhbHVlKTsKICAgICAgICBpZiAoY29udGFjdCkgewogICAgICAgICAgc2VsZWN0ZWRDb250YWN0LnZhbHVlID0gY29udGFjdC5pZDsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8g56Gu5L+d5raI5oGv5a655Zmo5rua5Yqo5Yiw5bqV6YOoCiAgICBjb25zdCBzY3JvbGxUb0JvdHRvbSA9ICgpID0+IHsKICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXIudmFsdWUpIHsKICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnZhbHVlLnNjcm9sbFRvcCA9IG1lc3NhZ2VDb250YWluZXIudmFsdWUuc2Nyb2xsSGVpZ2h0OwogICAgICB9CiAgICB9OwoKICAgIC8vIOWcqOmAieaLqeiBlOezu+S6uuWQju+8jOa7muWKqOWIsOW6lemDqAogICAgY29uc3Qgc2VsZWN0Q29udGFjdCA9IGFzeW5jIGNvbnRhY3QgPT4gewogICAgICBpZiAoc2VsZWN0ZWRDb250YWN0LnZhbHVlID09PSBjb250YWN0LmlkKSByZXR1cm47CiAgICAgIHNlbGVjdGVkQ29udGFjdC52YWx1ZSA9IGNvbnRhY3QuaWQ7CiAgICAgIGN1cnJlbnRDaGF0SWQudmFsdWUgPSBjb250YWN0LmlkOwoKICAgICAgLy8g5Yqg6L295Lya6K+d5raI5oGvCiAgICAgIGF3YWl0IGxvYWRDaGF0TWVzc2FnZXMoY29udGFjdC5pZCk7CgogICAgICAvLyDnrYnlvoVET03mm7TmlrDlkI7mu5rliqjliLDlupXpg6gKICAgICAgYXdhaXQgbmV4dFRpY2soKTsKICAgICAgc2Nyb2xsVG9Cb3R0b20oKTsKCiAgICAgIC8vIOa4heepuui+k+WFpeahhgogICAgICBtZXNzYWdlSW5wdXQudmFsdWUgPSAnJzsKICAgIH07CgogICAgLy8g5Zyo5raI5oGv5YiX6KGo5pu05paw5ZCO77yM5rua5Yqo5Yiw5bqV6YOoCiAgICB3YXRjaChtZXNzYWdlcywgKCkgPT4gewogICAgICBuZXh0VGljaygoKSA9PiB7CiAgICAgICAgc2Nyb2xsVG9Cb3R0b20oKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICAvLyDlj5HpgIHmtojmga8KICAgIGNvbnN0IHNlbmRNZXNzYWdlID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIW1lc3NhZ2VJbnB1dC52YWx1ZS50cmltKCkgfHwgIWN1cnJlbnRDaGF0SWQudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICAvLyDmo4Dmn6XlvZPliY3nlKjmiLfkv6Hmga/mmK/lkKblrZjlnKgKICAgICAgICBpZiAoIXVzZXJJbmZvLnZhbHVlIHx8ICF1c2VySW5mby52YWx1ZS5pZCkgewogICAgICAgICAgY29uc29sZS5sb2coJ+W9k+WJjeeUqOaIt+S/oeaBr+S4jeWtmOWcqO+8jOWwneivlemHjeaWsOiOt+WPli4uLicpOwogICAgICAgICAgLy8g5bCd6K+V6YeN5paw6I635Y+W55So5oi35L+h5oGvCiAgICAgICAgICBjb25zdCB1c2VyRGF0YSA9IGF3YWl0IGZldGNoQ3VycmVudFVzZXIoKTsKICAgICAgICAgIGlmICghdXNlckRhdGEgfHwgIXVzZXJEYXRhLmlkKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcign5peg5rOV6I635Y+W5b2T5YmN55So5oi35L+h5oGv77yM6K+35Yi35paw6aG16Z2i6YeN6K+VJyk7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygn5oiQ5Yqf6I635Y+W55So5oi35L+h5oGvOicsIHVzZXJEYXRhKTsKICAgICAgICB9CgogICAgICAgIC8vIOWIm+W7uuS4tOaXtua2iOaBr+WvueixoQogICAgICAgIC8vIOWGjeasoeajgOafpeeUqOaIt+S/oeaBr+aYr+WQpuW3suabtOaWsAogICAgICAgIGlmICghdXNlckluZm8udmFsdWUgfHwgIXVzZXJJbmZvLnZhbHVlLmlkKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+eUqOaIt+S/oeaBr+acquabtOaWsO+8jOivt+WIt+aWsOmhtemdoumHjeivlScpOwogICAgICAgIH0KCiAgICAgICAgLy8g6K6w5b2V5b2T5YmN5Lya6K+dSUQKICAgICAgICBjb25zb2xlLmxvZygn5b2T5YmN5Lya6K+dSUQ6JywgY3VycmVudENoYXRJZC52YWx1ZSwgJ+exu+WeizonLCB0eXBlb2YgY3VycmVudENoYXRJZC52YWx1ZSk7CiAgICAgICAgY29uc3QgdGVtcE1lc3NhZ2UgPSB7CiAgICAgICAgICBpZDogJ3RlbXAtJyArIERhdGUubm93KCksCiAgICAgICAgICBjb250ZW50OiBtZXNzYWdlSW5wdXQudmFsdWUudHJpbSgpLAogICAgICAgICAgc2VuZGVyOiB7CiAgICAgICAgICAgIGlkOiB1c2VySW5mby52YWx1ZS5pZCwKICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJJbmZvLnZhbHVlLnVzZXJuYW1lIHx8ICfnlKjmiLcnLAogICAgICAgICAgICBmaXJzdF9uYW1lOiB1c2VySW5mby52YWx1ZS5maXJzdF9uYW1lIHx8ICcnLAogICAgICAgICAgICBsYXN0X25hbWU6IHVzZXJJbmZvLnZhbHVlLmxhc3RfbmFtZSB8fCAnJwogICAgICAgICAgfSwKICAgICAgICAgIG1lc3NhZ2VfdHlwZTogJ3RleHQnLAogICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLAogICAgICAgICAgaXNfdGVtcDogdHJ1ZQogICAgICAgIH07CgogICAgICAgIC8vIOWFiOWwhuS4tOaXtua2iOaBr+a3u+WKoOWIsOWIl+ihqOS4rQogICAgICAgIG1lc3NhZ2VzLnZhbHVlLnB1c2godGVtcE1lc3NhZ2UpOwoKICAgICAgICAvLyDmuIXnqbrovpPlhaXmoYYKICAgICAgICBjb25zdCBtZXNzYWdlQ29weSA9IG1lc3NhZ2VJbnB1dC52YWx1ZTsKICAgICAgICBtZXNzYWdlSW5wdXQudmFsdWUgPSAnJzsKCiAgICAgICAgLy8g5rua5Yqo5Yiw5bqV6YOoCiAgICAgICAgYXdhaXQgbmV4dFRpY2soKTsKICAgICAgICBzY3JvbGxUb0JvdHRvbSgpOwoKICAgICAgICAvLyDor6bnu4borrDlvZXlj5HpgIHkv6Hmga8KICAgICAgICBjb25zb2xlLmxvZygn5YeG5aSH5Y+R6YCB5raI5oGv5Yiw5pyN5Yqh5Zmo77yM5Lya6K+dSUQ6JywgY3VycmVudENoYXRJZC52YWx1ZSwgJ+a2iOaBr+WGheWuuTonLCBtZXNzYWdlQ29weSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIOWPkemAgea2iOaBr+WIsOacjeWKoeWZqAogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzZW5kVGV4dE1lc3NhZ2UoY3VycmVudENoYXRJZC52YWx1ZSwgbWVzc2FnZUNvcHkpOwogICAgICAgICAgY29uc29sZS5sb2coJ+WPkemAgea2iOaBr+WTjeW6lDonLCByZXNwb25zZSk7CgogICAgICAgICAgLy8g6YCC5bqU5LiN5ZCM55qE5ZON5bqU5qC85byPCiAgICAgICAgICBsZXQgbWVzc2FnZURhdGEgPSBudWxsOwogICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN1Y2Nlc3MgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAvLyDmoIflh4bljIXoo4XmoLzlvI86IHtzdWNjZXNzOiB0cnVlLCBkYXRhOiB7fX0KICAgICAgICAgICAgbWVzc2FnZURhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5pZCkgewogICAgICAgICAgICAvLyDljIXlkKtJROeahERSRuagvOW8jwogICAgICAgICAgICBtZXNzYWdlRGF0YSA9IHJlc3BvbnNlOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5jaGF0KSB7CiAgICAgICAgICAgIC8vIOaWsEFQSeagvOW8jzoge2NoYXQsIGNvbnRlbnQsIG1lc3NhZ2VfdHlwZSwgZmlsZSwgLi4ufQogICAgICAgICAgICAvLyDmnoTpgKDlrozmlbTnmoTmtojmga/lr7nosaEKICAgICAgICAgICAgbWVzc2FnZURhdGEgPSB7CiAgICAgICAgICAgICAgaWQ6IHJlc3BvbnNlLmlkIHx8ICdtc2ctJyArIERhdGUubm93KCksCiAgICAgICAgICAgICAgY29udGVudDogcmVzcG9uc2UuY29udGVudCwKICAgICAgICAgICAgICBtZXNzYWdlX3R5cGU6IHJlc3BvbnNlLm1lc3NhZ2VfdHlwZSwKICAgICAgICAgICAgICBmaWxlOiByZXNwb25zZS5maWxlLAogICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IHJlc3BvbnNlLmNyZWF0ZWRfYXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLAogICAgICAgICAgICAgIHNlbmRlcjogewogICAgICAgICAgICAgICAgaWQ6IHVzZXJJbmZvLnZhbHVlLmlkLAogICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJJbmZvLnZhbHVlLnVzZXJuYW1lIHx8ICfnlKjmiLcnLAogICAgICAgICAgICAgICAgZmlyc3RfbmFtZTogdXNlckluZm8udmFsdWUuZmlyc3RfbmFtZSB8fCAnJywKICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogdXNlckluZm8udmFsdWUubGFzdF9uYW1lIHx8ICcnCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCfml6Dms5Xor4bliKvnmoTmtojmga/lk43lupTmoLzlvI86JywgcmVzcG9uc2UpOwogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WPkemAgea2iOaBr+WTjeW6lOagvOW8j+W8guW4uCcpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIOeUqOacjeWKoeWZqOi/lOWbnueahOa2iOaBr+abv+aNouS4tOaXtua2iOaBrwogICAgICAgICAgY29uc3QgdGVtcEluZGV4ID0gbWVzc2FnZXMudmFsdWUuZmluZEluZGV4KG0gPT4gbS5pZCA9PT0gdGVtcE1lc3NhZ2UuaWQpOwogICAgICAgICAgaWYgKHRlbXBJbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgbWVzc2FnZXMudmFsdWUuc3BsaWNlKHRlbXBJbmRleCwgMSwgbWVzc2FnZURhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWVzc2FnZXMudmFsdWUucHVzaChtZXNzYWdlRGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8g5pu05paw6IGU57O75Lq65pyA5paw5raI5oGvCiAgICAgICAgICBjb25zdCBjb250YWN0SW5kZXggPSBjb250YWN0cy52YWx1ZS5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBzZWxlY3RlZENvbnRhY3QudmFsdWUpOwogICAgICAgICAgaWYgKGNvbnRhY3RJbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgY29udGFjdHMudmFsdWVbY29udGFjdEluZGV4XS5sYXN0TWVzc2FnZSA9IG1lc3NhZ2VDb3B5OwogICAgICAgICAgICBjb250YWN0cy52YWx1ZVtjb250YWN0SW5kZXhdLmxhc3RUaW1lID0gZm9ybWF0TWVzc2FnZVRpbWUobmV3IERhdGUoKSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8g5YaN5qyh5rua5Yqo5Yiw5bqV6YOoCiAgICAgICAgICBhd2FpdCBuZXh0VGljaygpOwogICAgICAgICAgc2Nyb2xsVG9Cb3R0b20oKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgLy8g6K+m57uG6K6w5b2V5Y+R6YCB5raI5oGv6ZSZ6K+vCiAgICAgICAgICBjb25zb2xlLmVycm9yKCflj5HpgIHmtojmga9BUEnosIPnlKjlpLHotKU6JywgZXJyb3IpOwogICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+mUmeivr+eKtuaAgeeggTonLCBlcnJvci5yZXNwb25zZS5zdGF0dXMpOwogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfplJnor6/or6bmg4U6JywgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+ivt+axglVSTDonLCBlcnJvci5yZXNwb25zZS5jb25maWcudXJsKTsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign6K+35rGC5pa55rOVOicsIGVycm9yLnJlc3BvbnNlLmNvbmZpZy5tZXRob2QpOwogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfor7fmsYLmlbDmja46JywgZXJyb3IucmVzcG9uc2UuY29uZmlnLmRhdGEpOwogICAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgICAgICAvLyA0MDTplJnor6/lpITnkIYKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBUEnnq6/ngrnkuI3lrZjlnKjvvIzmo4Dmn6VVUkzphY3nva7mmK/lkKbmraPnoa4nKTsKICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+a2iOaBr+WPkemAgeWksei0pTogQVBJ56uv54K55LiN5a2Y5Zyo77yM6K+36IGU57O7566h55CG5ZGYJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7IC8vIOWwhumUmeivr+S8oOmAkue7meWklumDqGNhdGNoCiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93IGVycm9yOyAvLyDlsIbplJnor6/kvKDpgJLnu5nlpJbpg6hjYXRjaAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCflj5HpgIHmtojmga/lpLHotKU6JywgZXJyb3IpOwoKICAgICAgICAvLyDnp7vpmaTkuLTml7bmtojmga8KICAgICAgICBtZXNzYWdlcy52YWx1ZSA9IG1lc3NhZ2VzLnZhbHVlLmZpbHRlcihtID0+ICFtLmlzX3RlbXApOwoKICAgICAgICAvLyDlsIbmtojmga/lhoXlrrnmlL7lm57ovpPlhaXmoYYKICAgICAgICBtZXNzYWdlSW5wdXQudmFsdWUgPSBlcnJvci5zYXZlZE1lc3NhZ2UgfHwgbWVzc2FnZUlucHV0LnZhbHVlOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Y+R6YCB5raI5oGv5aSx6LSl77yM6K+36YeN6K+VJyk7CiAgICAgIH0KICAgIH07CgogICAgLy8g5omT5byA5paH5Lu25LiK5LygCiAgICBjb25zdCBvcGVuRmlsZVVwbG9hZCA9ICgpID0+IHsKICAgICAgZmlsZUlucHV0LnZhbHVlLmNsaWNrKCk7CiAgICB9OwoKICAgIC8vIOaJk+W8gOWbvueJh+S4iuS8oAogICAgY29uc3Qgb3BlbkltYWdlVXBsb2FkID0gKCkgPT4gewogICAgICBpbWFnZUlucHV0LnZhbHVlLmNsaWNrKCk7CiAgICB9OwoKICAgIC8vIOWkhOeQhuaWh+S7tuS4iuS8oAogICAgY29uc3QgaGFuZGxlRmlsZVVwbG9hZCA9IGFzeW5jIGV2ZW50ID0+IHsKICAgICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKICAgICAgaWYgKCFmaWxlIHx8ICFjdXJyZW50Q2hhdElkLnZhbHVlKSByZXR1cm47CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgc2VuZEZpbGVNZXNzYWdlKGN1cnJlbnRDaGF0SWQudmFsdWUsIGDlj5HpgIHmlofku7Y6ICR7ZmlsZS5uYW1lfWAsIGZpbGUpOwoKICAgICAgICAvLyDph43mlrDliqDovb3mtojmga8KICAgICAgICBsb2FkQ2hhdE1lc3NhZ2VzKGN1cnJlbnRDaGF0SWQudmFsdWUpOwoKICAgICAgICAvLyDmuIXnqbrmlofku7bovpPlhaUKICAgICAgICBldmVudC50YXJnZXQudmFsdWUgPSAnJzsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCflj5HpgIHmlofku7blpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Y+R6YCB5paH5Lu25aSx6LSlJyk7CiAgICAgIH0KICAgIH07CgogICAgLy8g5aSE55CG5Zu+54mH5LiK5LygCiAgICBjb25zdCBoYW5kbGVJbWFnZVVwbG9hZCA9IGFzeW5jIGV2ZW50ID0+IHsKICAgICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKICAgICAgaWYgKCFmaWxlIHx8ICFjdXJyZW50Q2hhdElkLnZhbHVlKSByZXR1cm47CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgc2VuZEltYWdlTWVzc2FnZShjdXJyZW50Q2hhdElkLnZhbHVlLCBg5Y+R6YCB5Zu+54mHYCwgZmlsZSk7CgogICAgICAgIC8vIOmHjeaWsOWKoOi9vea2iOaBrwogICAgICAgIGxvYWRDaGF0TWVzc2FnZXMoY3VycmVudENoYXRJZC52YWx1ZSk7CgogICAgICAgIC8vIOa4heepuuaWh+S7tui+k+WFpQogICAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9ICcnOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WPkemAgeWbvueJh+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCflj5HpgIHlm77niYflpLHotKUnKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDmiZPlvIDnn6Xor4blupPlr7nor53moYYKICAgIGNvbnN0IG9wZW5Lbm93bGVkZ2VEaWFsb2cgPSBhc3luYyAoKSA9PiB7CiAgICAgIGtub3dsZWRnZURpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgICBhd2FpdCBsb2FkS25vd2xlZGdlTGlzdCgpOwogICAgfTsKCiAgICAvLyDliqDovb3nn6Xor4blupPliJfooagKICAgIGNvbnN0IGxvYWRLbm93bGVkZ2VMaXN0ID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGtub3dsZWRnZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGEKICAgICAgICB9ID0gYXdhaXQgZ2V0S25vd2xlZGdlTGlzdCgpOwogICAgICAgIGtub3dsZWRnZUxpc3QudmFsdWUgPSBkYXRhOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veefpeivhuW6k+WIl+ihqOWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliqDovb3nn6Xor4blupPliJfooajlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBrbm93bGVkZ2VMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgLy8g6YCJ5oup55+l6K+G5bqT5paH5Lu2CiAgICBjb25zdCBzZWxlY3RLbm93bGVkZ2UgPSByb3cgPT4gewogICAgICBzZWxlY3RlZEtub3dsZWRnZS52YWx1ZSA9IHJvdzsKICAgIH07CgogICAgLy8g5YiG5Lqr55+l6K+G5bqT5paH5Lu2CiAgICBjb25zdCBzaGFyZUtub3dsZWRnZSA9IGFzeW5jIGtub3dsZWRnZSA9PiB7CiAgICAgIGlmICghY3VycmVudENoYXRJZC52YWx1ZSkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IHNlbmRLbm93bGVkZ2VNZXNzYWdlKGN1cnJlbnRDaGF0SWQudmFsdWUsIGDliIbkuqvnn6Xor4blupPmlofku7Y6ICR7a25vd2xlZGdlLnRpdGxlfWAsIGtub3dsZWRnZS5pZCk7CgogICAgICAgIC8vIOWFs+mXreWvueivneahhgogICAgICAgIGtub3dsZWRnZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgLy8g6YeN5paw5Yqg6L295raI5oGvCiAgICAgICAgbG9hZENoYXRNZXNzYWdlcyhjdXJyZW50Q2hhdElkLnZhbHVlKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfliIbkuqvnn6Xor4blupPmlofku7blpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5YiG5Lqr55+l6K+G5bqT5paH5Lu25aSx6LSlJyk7CiAgICAgIH0KICAgIH07CgogICAgLy8g5LiL6L295paH5Lu2CiAgICBjb25zdCBkb3dubG9hZEZpbGUgPSBhc3luYyBtZXNzYWdlID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRvd25sb2FkTWVzc2FnZUZpbGUobWVzc2FnZS5pZCk7CgogICAgICAgIC8vIOWIm+W7uuS4i+i9vemTvuaOpQogICAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtyZXNwb25zZS5kYXRhXSkpOwogICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgbGluay5ocmVmID0gdXJsOwogICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIG1lc3NhZ2UuZmlsZV9uYW1lIHx8ICdkb3dubG9hZCcpOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgbGluay5jbGljaygpOwogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5LiL6L295paH5Lu25aSx6LSlOicsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+S4i+i9veaWh+S7tuWksei0pScpOwogICAgICB9CiAgICB9OwoKICAgIC8vIOafpeeci+efpeivhuW6k+aWh+S7tgogICAgY29uc3Qgdmlld0tub3dsZWRnZSA9IG1lc3NhZ2UgPT4gewogICAgICBpZiAobWVzc2FnZS5rbm93bGVkZ2VfZGV0YWlsKSB7CiAgICAgICAgLy8g5Y+v5Lul6Lez6L2s5Yiw55+l6K+G5bqT6K+m5oOF6aG16Z2iCiAgICAgICAgRWxNZXNzYWdlQm94LmFsZXJ0KGDmoIfpopg6ICR7bWVzc2FnZS5rbm93bGVkZ2VfZGV0YWlsLnRpdGxlfTxicj7mj4/ov7A6ICR7bWVzc2FnZS5rbm93bGVkZ2VfZGV0YWlsLmRlc2NyaXB0aW9uIHx8ICfml6AnfWAsICfnn6Xor4blupPmlofku7YnLCB7CiAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKCiAgICAvLyDojrflj5blj5HpgIHogIXpopzoibIKICAgIGNvbnN0IGdldFNlbmRlckNvbG9yID0gc2VuZGVyID0+IHsKICAgICAgcmV0dXJuIGdldFJhbmRvbUNvbG9yKHNlbmRlci5pZCk7CiAgICB9OwoKICAgIC8vIOiOt+WPluWPkemAgeiAhemmluWtl+avjQogICAgY29uc3QgZ2V0U2VuZGVySW5pdGlhbCA9IHNlbmRlciA9PiB7CiAgICAgIHJldHVybiAoc2VuZGVyLmZpcnN0X25hbWUgfHwgc2VuZGVyLnVzZXJuYW1lKVswXTsKICAgIH07CgogICAgLy8g5qC55o2uSUTnlJ/miJDpmo/mnLrpopzoibIKICAgIGNvbnN0IGdldFJhbmRvbUNvbG9yID0gaWQgPT4gewogICAgICBjb25zdCBjb2xvcnMgPSBbJyMwMDdiZmYnLCAnIzI4YTc0NScsICcjZGMzNTQ1JywgJyNmZDdlMTQnLCAnIzZmNDJjMScsICcjMjBjOTk3JywgJyMxN2EyYjgnLCAnIzZjNzU3ZCddOwoKICAgICAgLy8g5L2/55SoSUTkvZzkuLrntKLlvJXvvIznoa7kv53lkIzkuIDnlKjmiLfpopzoibLkuIDoh7QKICAgICAgY29uc3QgaW5kZXggPSB0eXBlb2YgaWQgPT09ICdudW1iZXInID8gaWQgJSBjb2xvcnMubGVuZ3RoIDogMDsKICAgICAgcmV0dXJuIGNvbG9yc1tpbmRleF07CiAgICB9OwoKICAgIC8vIOagvOW8j+WMlua2iOaBr+aXtumXtAogICAgY29uc3QgZm9ybWF0TWVzc2FnZVRpbWUgPSB0aW1lc3RhbXAgPT4gewogICAgICBpZiAoIXRpbWVzdGFtcCkgcmV0dXJuICcnOwogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGltZXN0YW1wKTsKICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsKICAgICAgY29uc3QgZGlmZiA9IG5vdyAtIGRhdGU7CgogICAgICAvLyDku4rlpKnlhoXnmoTmtojmga/mmL7npLrml7bpl7QKICAgICAgaWYgKGRpZmYgPCAyNCAqIDYwICogNjAgKiAxMDAwKSB7CiAgICAgICAgY29uc3QgaG91cnMgPSBkYXRlLmdldEhvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgICAgcmV0dXJuIGAke2hvdXJzfToke21pbnV0ZXN9YDsKICAgICAgfQoKICAgICAgLy8g5LiA5ZGo5YaF55qE5raI5oGv5pi+56S65pif5pyf5YegCiAgICAgIGlmIChkaWZmIDwgNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApIHsKICAgICAgICBjb25zdCBkYXlzID0gWyflkajml6UnLCAn5ZGo5LiAJywgJ+WRqOS6jCcsICflkajkuIknLCAn5ZGo5ZubJywgJ+WRqOS6lCcsICflkajlha0nXTsKICAgICAgICByZXR1cm4gZGF5c1tkYXRlLmdldERheSgpXTsKICAgICAgfQoKICAgICAgLy8g5pu05pep55qE5raI5oGv5pi+56S65pel5pyfCiAgICAgIHJldHVybiBgJHtkYXRlLmdldE1vbnRoKCkgKyAxfeaciCR7ZGF0ZS5nZXREYXRlKCl95pelYDsKICAgIH07CgogICAgLy8g5qC85byP5YyW5pel5pyfCiAgICBjb25zdCBmb3JtYXREYXRlID0gdGltZXN0YW1wID0+IHsKICAgICAgaWYgKCF0aW1lc3RhbXApIHJldHVybiAnJzsKICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7CiAgICAgIHJldHVybiBgJHtkYXRlLmdldEZ1bGxZZWFyKCl9LSR7KGRhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0tJHtkYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDsKICAgIH07CgogICAgLy8g5qC85byP5YyW5paH5Lu25aSn5bCPCiAgICBjb25zdCBmb3JtYXRGaWxlU2l6ZSA9IHNpemVJbktCID0+IHsKICAgICAgaWYgKHNpemVJbktCIDwgMTAyNCkgewogICAgICAgIHJldHVybiBgJHtzaXplSW5LQn0gS0JgOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgJHsoc2l6ZUluS0IgLyAxMDI0KS50b0ZpeGVkKDIpfSBNQmA7CiAgICAgIH0KICAgIH07CgogICAgLy8g6I635Y+W54q25oCB5paH5a2XCiAgICBjb25zdCBnZXRTdGF0dXNUZXh0ID0gc3RhdHVzID0+IHsKICAgICAgY29uc3Qgc3RhdHVzTWFwID0gewogICAgICAgICdvbmxpbmUnOiAn5Zyo57q/JywKICAgICAgICAnb2ZmbGluZSc6ICfnprvnur8nLAogICAgICAgICdidXN5JzogJ+W/meeijCcsCiAgICAgICAgJ2F3YXknOiAn56a75byAJwogICAgICB9OwogICAgICByZXR1cm4gc3RhdHVzTWFwW3N0YXR1c10gfHwgc3RhdHVzOwogICAgfTsKCiAgICAvLyDmt7vliqDlvLrliLbliLfmlrDmlrnms5UKICAgIGNvbnN0IGZvcmNlUmVmcmVzaCA9IGFzeW5jICgpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBFbE1lc3NhZ2UuaW5mbygn5q2j5Zyo5by65Yi25Yi35paw5pWw5o2uLi4uJyk7CgogICAgICAgIC8vIOmHjeaWsOiOt+WPlueUqOaIt+S/oeaBrwogICAgICAgIGNvbnN0IHVzZXJEYXRhID0gYXdhaXQgZmV0Y2hDdXJyZW50VXNlcigpOwogICAgICAgIGlmICghdXNlckRhdGEpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5rOV6I635Y+W55So5oi35L+h5oGv77yM6K+35bCd6K+V6YeN5paw55m75b2VJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyDph43mlrDliqDovb3ogYrlpKnkvJror50KICAgICAgICBhd2FpdCBsb2FkQ2hhdFNlc3Npb25zKCk7CiAgICAgICAgaWYgKGNvbnRhY3RzLnZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+acquaJvuWIsOS7u+S9leiBiuWkqeS8muivne+8jOaCqOWPr+iDvei/mOayoeacieW8gOWni+S7u+S9leWvueivnScpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5Yi35paw5oiQ5Yqf77yB5om+5YiwICcgKyBjb250YWN0cy52YWx1ZS5sZW5ndGggKyAnIOS4quiBiuWkqeS8muivnScpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCflvLrliLbliLfmlrDlpLHotKU6JywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yi35paw5aSx6LSlOiAnICsgKGVycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivrycpKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDot6/nlLHnm7jlhbPmk43kvZwKICAgIG9uTW91bnRlZChhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5YWI5Yqg6L2955So5oi35pWw5o2uCiAgICAgICAgY29uc3QgdXNlckRhdGEgPSBhd2FpdCBmZXRjaEN1cnJlbnRVc2VyKCk7CgogICAgICAgIC8vIOWmguaenOiOt+WPlueUqOaIt+S/oeaBr+Wksei0pe+8jOaYvuekuumUmeivr+W5tui/lOWbngogICAgICAgIGlmICghdXNlckRhdGEpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5peg5rOV5Yqg6L2955So5oi35L+h5oGv77yM6K+35Yi35paw6aG16Z2i6YeN6K+VJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCfnu4Tku7bmjILovb3ml7bojrflj5bnmoTnlKjmiLfkv6Hmga86JywgdXNlckRhdGEpOwoKICAgICAgICAvLyDnoa7kv53nlKjmiLfmlbDmja7lt7Lnu4/mm7TmlrAKICAgICAgICBpZiAoIXVzZXJJbmZvLnZhbHVlIHx8ICF1c2VySW5mby52YWx1ZS5pZCkgewogICAgICAgICAgY29uc29sZS5lcnJvcign55So5oi35pWw5o2u5pyq5q2j56Gu5Yqg6L29OicsIHVzZXJJbmZvLnZhbHVlKTsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign55So5oi35pWw5o2u5Yqg6L295byC5bi477yM6K+35Yi35paw6aG16Z2i6YeN6K+VJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCflvZPliY3nlKjmiLfmlbDmja7lt7LmraPnoa7liqDovb06JywgdXNlckluZm8udmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgLy8g5YaN5Yqg6L296IGK5aSp5Lya6K+d5YiX6KGoCiAgICAgICAgYXdhaXQgbG9hZENoYXRTZXNzaW9ucygpOwoKICAgICAgICAvLyDmo4Dmn6VVUkzlj4LmlbDkuK3mmK/lkKbmnInkvJror51JRAogICAgICAgIGNvbnN0IHNlc3Npb25JZCA9IHJvdXRlLnF1ZXJ5LnNlc3Npb24gfHwgcm91dGUucXVlcnkuaWQ7CiAgICAgICAgaWYgKHNlc3Npb25JZCkgewogICAgICAgICAgLy8g5p+l5om+5a+55bqU55qE6IGU57O75Lq6CiAgICAgICAgICBjb25zdCBmb3VuZENvbnRhY3QgPSBjb250YWN0cy52YWx1ZS5maW5kKGMgPT4gYy5pZCA9PT0gcGFyc2VJbnQoc2Vzc2lvbklkKSk7CiAgICAgICAgICBpZiAoZm91bmRDb250YWN0KSB7CiAgICAgICAgICAgIC8vIOmAieS4reivpeiBlOezu+S6ugogICAgICAgICAgICBzZWxlY3RlZENvbnRhY3QudmFsdWUgPSBmb3VuZENvbnRhY3QuaWQ7CiAgICAgICAgICAgIC8vIOWKoOi9veiBiuWkqeiusOW9lQogICAgICAgICAgICBhd2FpdCBsb2FkQ2hhdE1lc3NhZ2VzKHNlc3Npb25JZCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDlpoLmnpzmnKrmib7liLDlr7nlupTogZTns7vkurrvvIzlsJ3or5Xnm7TmjqXliqDovb3kvJror50KICAgICAgICAgICAgY29uc29sZS5sb2coJ+mAmui/h0lE55u05o6l5Yqg6L296IGK5aSp5Lya6K+dOicsIHNlc3Npb25JZCk7CiAgICAgICAgICAgIGF3YWl0IGxvYWRDaGF0TWVzc2FnZXMoc2Vzc2lvbklkKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIOiuvue9ruWumuaXtuWIt+aWsAogICAgICAgIHJlZnJlc2hJbnRlcnZhbCA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChzZWxlY3RlZENvbnRhY3QudmFsdWUpIHsKICAgICAgICAgICAgYXdhaXQgbG9hZENoYXRNZXNzYWdlcyhzZWxlY3RlZENvbnRhY3QudmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgYXdhaXQgbG9hZENoYXRTZXNzaW9ucygpOwogICAgICAgIH0sIDMwMDAwKTsKCiAgICAgICAgLy8g5Yid5aeL5rua5Yqo5Yiw5bqV6YOoCiAgICAgICAgYXdhaXQgbmV4dFRpY2soKTsKICAgICAgICBzY3JvbGxUb0JvdHRvbSgpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIneWni+WMluiBiuWkqee7hOS7tuWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliJ3lp4vljJbogYrlpKnnu4Tku7blpLHotKU6ICcgKyBlcnJvci5tZXNzYWdlKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gewogICAgICBzZWFyY2hRdWVyeSwKICAgICAgYWN0aXZlVGFiLAogICAgICBzZWxlY3RlZENvbnRhY3QsCiAgICAgIHRhYnMsCiAgICAgIGNvbnRhY3RzLAogICAgICBjdXJyZW50Q29udGFjdCwKICAgICAgZmlsdGVyZWRDb250YWN0cywKICAgICAgbWVzc2FnZXMsCiAgICAgIG1lc3NhZ2VJbnB1dCwKICAgICAgbWVzc2FnZUNvbnRhaW5lciwKICAgICAgZmlsZUlucHV0LAogICAgICBpbWFnZUlucHV0LAogICAgICBjdXJyZW50VXNlciwKICAgICAgdXNlckluZm8sCiAgICAgIHVzZXJJZCwKICAgICAga25vd2xlZGdlRGlhbG9nVmlzaWJsZSwKICAgICAga25vd2xlZGdlTG9hZGluZywKICAgICAga25vd2xlZGdlTGlzdCwKICAgICAgbG9hZGluZywKICAgICAgLy8g5Zu+5qCHCiAgICAgIFNlYXJjaCwKICAgICAgUGhvbmUsCiAgICAgIFZpZGVvQ2FtZXJhLAogICAgICBJbmZvRmlsbGVkLAogICAgICBEb2N1bWVudCwKICAgICAgUGljdHVyZUZpbGxlZCwKICAgICAgRm9sZGVyT3BlbmVkLAogICAgICBNaWNyb3Bob25lLAogICAgICBQb3NpdGlvbiwKICAgICAgQ2hhdERvdFNxdWFyZSwKICAgICAgUmVhZGluZywKICAgICAgVXNlckZpbGxlZCwKICAgICAgQ2hhdExpbmVTcXVhcmUsCiAgICAgIFJlZnJlc2gsCiAgICAgIC8vIOaWueazlQogICAgICBzZW5kTWVzc2FnZSwKICAgICAgZ2V0U3RhdHVzVGV4dCwKICAgICAgc2VsZWN0Q29udGFjdCwKICAgICAgb3BlbkZpbGVVcGxvYWQsCiAgICAgIG9wZW5JbWFnZVVwbG9hZCwKICAgICAgaGFuZGxlRmlsZVVwbG9hZCwKICAgICAgaGFuZGxlSW1hZ2VVcGxvYWQsCiAgICAgIG9wZW5Lbm93bGVkZ2VEaWFsb2csCiAgICAgIHNlbGVjdEtub3dsZWRnZSwKICAgICAgc2hhcmVLbm93bGVkZ2UsCiAgICAgIGRvd25sb2FkRmlsZSwKICAgICAgdmlld0tub3dsZWRnZSwKICAgICAgZ2V0U2VuZGVyQ29sb3IsCiAgICAgIGdldFNlbmRlckluaXRpYWwsCiAgICAgIGZvcm1hdE1lc3NhZ2VUaW1lLAogICAgICBmb3JtYXREYXRlLAogICAgICBmb3JtYXRGaWxlU2l6ZSwKICAgICAgcmVmcmVzaENoYXRTZXNzaW9ucywKICAgICAgZm9yY2VSZWZyZXNoCiAgICB9OwogIH0KfTs="},{"version":3,"names":["ref","computed","nextTick","onMounted","onBeforeUnmount","watch","useStore","ElMessage","ElMessageBox","Search","Phone","VideoCamera","InfoFilled","Document","PictureFilled","FolderOpened","Microphone","Position","ChatDotSquare","Reading","UserFilled","ChatLineSquare","Refresh","getChatSessions","getChatSession","sendTextMessage","sendFileMessage","sendImageMessage","sendKnowledgeMessage","downloadMessageFile","getKnowledgeList","useRoute","request","name","setup","store","currentUser","getters","user","userInfo","searchQuery","activeTab","selectedContact","messageInput","messageContainer","fileInput","imageInput","messages","loading","chatSessions","currentChatId","knowledgeDialogVisible","knowledgeLoading","knowledgeList","selectedKnowledge","tabs","contacts","currentContact","value","find","c","id","userId","_userInfo$value","filteredContacts","filter","contact","toLowerCase","includes","route","refreshInterval","clearInterval","fetchCurrentUser","console","log","token","localStorage","getItem","warn","warning","response","url","method","userData","data","error","Error","setItem","JSON","stringify","message","loadChatSessions","success","Array","isArray","results","length","map","session","otherParticipant","participants","p","is_group","title","initial","avatar","color","getRandomColor","status","lastMessage","last_message","content","lastTime","formatMessageTime","created_at","updated_at","unread","unread_count","isGroup","first_name","last_name","trim","username","sort","a","b","loadChatMessages","chatId","messageData","sessionData","possibleMessageFields","field","some","parseInt","tempContact","unshift","scrollToBottom","errorMessage","refreshChatSessions","scrollTop","scrollHeight","selectContact","sendMessage","tempMessage","Date","now","sender","message_type","toISOString","is_temp","push","messageCopy","chat","file","tempIndex","findIndex","m","splice","contactIndex","config","savedMessage","openFileUpload","click","openImageUpload","handleFileUpload","event","target","files","handleImageUpload","openKnowledgeDialog","loadKnowledgeList","selectKnowledge","row","shareKnowledge","knowledge","downloadFile","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","file_name","body","appendChild","removeChild","viewKnowledge","knowledge_detail","alert","description","dangerouslyUseHTMLString","confirmButtonText","getSenderColor","getSenderInitial","colors","index","timestamp","date","diff","hours","getHours","toString","padStart","minutes","getMinutes","days","getDay","getMonth","getDate","formatDate","getFullYear","formatFileSize","sizeInKB","toFixed","getStatusText","statusMap","forceRefresh","info","sessionId","query","foundContact","setInterval"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\chat\\Index.vue"],"sourcesContent":["<template>\n  <div class=\"chat-container\">\n        <el-card class=\"chat-card\">\n          <div class=\"chat-header-actions\" v-if=\"loading\">\n            <el-alert\n              title=\"...\"\n              type=\"info\"\n              :closable=\"false\"\n              show-icon\n            />\n          </div>\n          <div class=\"chat-layout\">\n            <!--  -->\n            <div class=\"chat-sidebar\">\n              <!--  -->\n              <div class=\"search-box\">\n                <div class=\"search-header\">\n                  <el-input \n                    v-model=\"searchQuery\" \n                    placeholder=\"...\"\n                    clearable\n                    :prefix-icon=\"Search\"\n                  ></el-input>\n                  <el-button circle size=\"small\" @click=\"refreshChatSessions\" title=\"\">\n                    <el-icon><Refresh /></el-icon>\n                  </el-button>\n                </div>\n              </div>\n              \n              <!--  -->\n              <div class=\"chat-tabs\">\n                <div \n                  v-for=\"(tab, index) in tabs\" \n                  :key=\"index\"\n                  class=\"chat-tab\"\n                  :class=\"{'active': activeTab === index}\"\n                  @click=\"activeTab = index\"\n                >\n                  {{ tab }}\n                </div>\n              </div>\n              \n              <!--  -->\n              <div class=\"contacts-list\">\n                <div \n                  v-for=\"(contact, index) in filteredContacts\" \n              :key=\"contact.id || index\"\n                  class=\"contact-item\"\n              :class=\"{'active': selectedContact === contact.id}\"\n              @click=\"selectContact(contact)\"\n                >\n                  <div class=\"contact-avatar\">\n                    <div \n                      v-if=\"!contact.avatar\" \n                      class=\"avatar\" \n                      :style=\"{backgroundColor: contact.color}\"\n                    >\n                      <span class=\"avatar-initial\">{{ contact.initial }}</span>\n                    </div>\n                    <img v-else :src=\"contact.avatar\" alt=\"avatar\" class=\"avatar\" />\n                    <div \n                      class=\"contact-status\" \n                      :class=\"'status-' + contact.status\"\n                    ></div>\n                  </div>\n                  <div class=\"contact-info\">\n                    <div class=\"contact-name\">\n                      <span>{{ contact.name }}</span>\n                      <span class=\"time\">{{ contact.lastTime }}</span>\n                    </div>\n                    <div class=\"contact-message\">\n                      <span>{{ contact.lastMessage }}</span>\n                      <el-badge \n                        v-if=\"contact.unread\" \n                        :value=\"contact.unread\" \n                        class=\"message-badge\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n            <!--  -->\n            <div v-if=\"!loading && filteredContacts.length === 0\" class=\"empty-contacts\">\n              <el-empty \n                description=\"\" \n                :image-size=\"100\"\n              >\n                <template #image>\n                  <el-icon :size=\"64\" class=\"empty-icon\"><UserFilled /></el-icon>\n                </template>\n              </el-empty>\n            </div>\n\n            <!--  -->\n            <div v-if=\"loading\" class=\"loading-container\">\n              <el-skeleton :rows=\"5\" animated />\n            </div>\n              </div>\n            </div>\n            \n            <!--  -->\n            <div class=\"chat-content\">\n              <!--  -->\n              <div class=\"chat-header\" v-if=\"selectedContact !== null\">\n                <div class=\"contact-avatar\">\n                  <div \n                v-if=\"!currentContact.avatar\" \n                    class=\"avatar\" \n                :style=\"{backgroundColor: currentContact.color}\"\n                  >\n                <span class=\"avatar-initial\">{{ currentContact.initial || '?' }}</span>\n                  </div>\n                  <img \n                    v-else \n                :src=\"currentContact.avatar\" \n                    alt=\"avatar\" \n                    class=\"avatar\" \n                  />\n                  <div \n                    class=\"contact-status\" \n                :class=\"'status-' + (currentContact.status || 'online')\"\n                  ></div>\n                </div>\n                <div class=\"contact-info\">\n              <h6>{{ currentContact.name || '' }}</h6>\n              <p>{{ getStatusText(currentContact.status || 'online') }}</p>\n                </div>\n                <div class=\"chat-actions\">\n                  <el-tooltip content=\"\" placement=\"bottom\">\n                    <el-button circle>\n                      <el-icon><Phone /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                  <el-tooltip content=\"\" placement=\"bottom\">\n                    <el-button circle>\n                      <el-icon><VideoCamera /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                  <el-tooltip content=\"\" placement=\"bottom\">\n                    <el-button circle>\n                      <el-icon><InfoFilled /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                </div>\n              </div>\n              \n              <!--  -->\n              <div class=\"chat-messages\" v-if=\"selectedContact !== null\" ref=\"messageContainer\">\n                <!--  -->\n                <template v-if=\"messages.length > 0\">\n                  <div \n                    v-for=\"(message, index) in messages\" \n                    :key=\"message.id || index\"\n                    class=\"message\"\n                    :class=\"message.sender.id === userId ? 'message-sent' : 'message-received'\"\n                  >\n                    <div class=\"message-container\">\n                      <div v-if=\"message.sender.id !== userId\" class=\"message-avatar\">\n                        <div \n                          class=\"avatar small\" \n                          :style=\"{backgroundColor: getSenderColor(message.sender)}\"\n                        >\n                          <span class=\"avatar-initial\">{{ getSenderInitial(message.sender) }}</span>\n                        </div>\n                      </div>\n                      <div class=\"message-content-wrapper\">\n                        <div \n                          class=\"message-content\"\n                          :class=\"message.sender.id === userId ? 'sent' : 'received'\"\n                        >\n                          <span v-if=\"message.message_type === 'text'\">{{ message.content }}</span>\n                      \n                          <div v-else-if=\"message.message_type === 'image'\" class=\"message-image\">\n                            <img :src=\"message.file\" alt=\"image\" />\n                          </div>\n                      \n                          <div v-else-if=\"message.message_type === 'file'\" class=\"message-file\" @click=\"downloadFile(message)\">\n                            <el-icon><Document /></el-icon>\n                            <span>{{ message.file_name }}</span>\n                            <span class=\"file-size\">{{ formatFileSize(message.file_size) }}</span>\n                          </div>\n                      \n                          <div v-else-if=\"message.message_type === 'knowledge'\" class=\"message-knowledge\" @click=\"viewKnowledge(message)\">\n                            <el-icon><Reading /></el-icon>\n                            <div class=\"knowledge-info\">\n                              <div class=\"knowledge-title\">{{ message.knowledge_detail.title }}</div>\n                              <div class=\"knowledge-desc\">{{ message.knowledge_detail.description }}</div>\n                            </div>\n                          </div>\n                        </div>\n                        <div class=\"message-time\">{{ formatMessageTime(message.created_at) }}</div>\n                      </div>\n                    </div>\n                  </div>\n                </template>\n                \n                <!--  -->\n                <template v-else-if=\"!loading\">\n                  <div class=\"empty-messages\">\n                    <el-empty description=\"\">\n                      <template #image>\n                        <el-icon :size=\"64\" class=\"empty-icon\"><ChatLineSquare /></el-icon>\n                      </template>\n                      <p></p>\n                    </el-empty>\n                  </div>\n                </template>\n                \n                <!--  -->\n                <template v-else>\n                  <div class=\"loading-messages\">\n                    <el-skeleton :rows=\"3\" animated />\n                    <el-skeleton style=\"margin-top: 20px\" :rows=\"2\" animated />\n                    <div style=\"text-align: right; margin-top: 20px\">\n                      <el-skeleton :rows=\"2\" animated />\n                    </div>\n                  </div>\n                </template>\n              </div>\n              \n              <!--  -->\n              <div class=\"chat-input\" v-if=\"selectedContact !== null\">\n                <div class=\"chat-tools\">\n                  <el-tooltip content=\"\" placement=\"top\">\n                    <el-button circle @click=\"openImageUpload\">\n                      <el-icon><PictureFilled /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                  <el-tooltip content=\"\" placement=\"top\">\n                    <el-button circle @click=\"openFileUpload\">\n                      <el-icon><FolderOpened /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                  <el-tooltip content=\"\" placement=\"top\">\n                    <el-button circle @click=\"openKnowledgeDialog\">\n                      <el-icon><Reading /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                  <el-tooltip content=\"\" placement=\"top\">\n                    <el-button circle>\n                      <el-icon><Microphone /></el-icon>\n                    </el-button>\n                  </el-tooltip>\n                </div>\n                <div class=\"input-area\">\n                  <el-input\n                    v-model=\"messageInput\"\n                    type=\"textarea\"\n                    :rows=\"3\"\n                    placeholder=\"...\"\n                    resize=\"none\"\n                    @keyup.enter.prevent=\"sendMessage\"\n                  ></el-input>\n                </div>\n                <div class=\"send-button\">\n                  <el-button type=\"primary\" @click=\"sendMessage\">\n                    <el-icon><Position /></el-icon>\n                    \n                  </el-button>\n                </div>\n              </div>\n              \n              <!--  -->\n              <div class=\"empty-chat\" v-if=\"selectedContact === null\">\n                <div class=\"empty-illustration\">\n                  <el-icon :size=\"64\"><ChatDotSquare /></el-icon>\n                </div>\n                <h4></h4>\n                <p></p>\n              </div>\n            </div>\n          </div>\n        </el-card>\n  \n  <!--  -->\n  <input \n    type=\"file\" \n    ref=\"fileInput\" \n    style=\"display: none\" \n    @change=\"handleFileUpload\" \n  />\n  \n  <!--  -->\n  <input \n    type=\"file\" \n    ref=\"imageInput\" \n    style=\"display: none\" \n    accept=\"image/*\" \n    @change=\"handleImageUpload\" \n  />\n  \n  <!--  -->\n  <el-dialog\n    v-model=\"knowledgeDialogVisible\"\n    title=\"\"\n    width=\"50%\"\n  >\n    <el-table\n      v-loading=\"knowledgeLoading\"\n      :data=\"knowledgeList\"\n      style=\"width: 100%\"\n      @row-click=\"selectKnowledge\"\n    >\n      <el-table-column prop=\"title\" label=\"\"></el-table-column>\n      <el-table-column prop=\"file_type\" label=\"\">\n        <template #default=\"scope\">\n          <el-tag>{{ scope.row.file_type }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"created_at\" label=\"\">\n        <template #default=\"scope\">\n          {{ formatDate(scope.row.created_at) }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"\">\n        <template #default=\"scope\">\n          <el-button type=\"primary\" size=\"small\" @click.stop=\"shareKnowledge(scope.row)\">\n            \n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"knowledgeDialogVisible = false\"></el-button>\n      </span>\n    </template>\n  </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, nextTick, onMounted, onBeforeUnmount, watch } from 'vue'\nimport { useStore } from 'vuex'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { \n  Search, Phone, VideoCamera, InfoFilled, Document, PictureFilled, \n  FolderOpened, Microphone, Position, ChatDotSquare, Reading, UserFilled, ChatLineSquare,\n  Refresh\n} from '@element-plus/icons-vue'\nimport { \n  getChatSessions, \n  getChatSession, \n  sendTextMessage, \n  sendFileMessage,\n  sendImageMessage,\n  sendKnowledgeMessage,\n  downloadMessageFile\n} from '@/api/chat'\nimport { getKnowledgeList } from '@/api/knowledge'\nimport { useRoute } from 'vue-router'\nimport request from '@/utils/request'\n\nexport default {\n  name: 'Chat',\n  setup() {\n    const store = useStore()\n    const currentUser = computed(() => store.getters.user)\n    \n    // \n    const userInfo = ref(null)\n    \n    const searchQuery = ref('')\n    const activeTab = ref(0)\n    const selectedContact = ref(null)\n    const messageInput = ref('')\n    const messageContainer = ref(null)\n    const fileInput = ref(null)\n    const imageInput = ref(null)\n    const messages = ref([])\n    const loading = ref(false)\n    const chatSessions = ref([])\n    const currentChatId = ref(null)\n    \n    // \n    const knowledgeDialogVisible = ref(false)\n    const knowledgeLoading = ref(false)\n    const knowledgeList = ref([])\n    const selectedKnowledge = ref(null)\n    \n    // \n    const tabs = ref(['', '', ''])\n    \n    // \n    const contacts = ref([])\n    \n    // \n    const currentContact = computed(() => {\n      if (selectedContact.value === null) return {}\n      return contacts.value.find(c => c.id === selectedContact.value) || {}\n    })\n    \n    // IDnull\n    const userId = computed(() => {\n      return userInfo.value?.id || null\n    })\n    \n    // \n    const filteredContacts = computed(() => {\n      if (!searchQuery.value) return contacts.value\n      return contacts.value.filter(contact =>\n        contact.name.toLowerCase().includes(searchQuery.value.toLowerCase())\n      )\n    })\n    \n    // \n    const route = useRoute()\n    \n    // refreshInterval\n    let refreshInterval = null\n    \n    // \n    onBeforeUnmount(() => {\n      if (refreshInterval) {\n        clearInterval(refreshInterval)\n      }\n    })\n    \n    // \n    const fetchCurrentUser = async () => {\n      try {\n        console.log('...')\n        \n        // localStoragetoken\n        const token = localStorage.getItem('token')\n        if (!token) {\n          console.warn('token')\n          ElMessage.warning('')\n          return null\n        }\n        \n        const response = await request({\n          url: '/api/auth/users/me/',\n          method: 'get'\n        })\n        \n        console.log(':', response)\n        \n        // \n        let userData = null\n        if (response.data && response.data.id) {\n          // data\n          userData = response.data\n          console.log('data:', userData)\n        } else if (response.data && response.data.data && response.data.data.id) {\n          // data\n          userData = response.data.data\n          console.log('data:', userData)\n        } else if (response.id) {\n          // \n          userData = response\n          console.log(':', userData)\n        } else {\n          console.error(':', response)\n          throw new Error('')\n        }\n        \n        if (!userData || !userData.id) {\n          console.error(':', userData)\n          throw new Error('')\n        }\n        \n        // mutation\n        userInfo.value = userData\n        \n        // localStorage\n        localStorage.setItem('user', JSON.stringify(userData))\n        \n        console.log(':', userInfo.value)\n        return userData\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error(': ' + (error.message || ''))\n        return null\n      }\n    }\n    \n    // \n    const loadChatSessions = async () => {\n      try {\n        loading.value = true\n        console.log('...')\n        \n        const response = await getChatSessions()\n        console.log(':', response)\n        \n        // \n        if (!response) {\n          console.error('')\n          contacts.value = []\n          return\n        }\n        \n        let data\n        if (response.success && response.data) {\n          data = response.data\n          console.log(':', data)\n        } else {\n          data = response\n          console.log(':', data)\n        }\n        \n        // \n        chatSessions.value = data\n        \n        // \n        if (data && Array.isArray(data.results)) {\n          console.log(', :', data.results.length)\n          // \n          contacts.value = data.results.map(session => {\n            // \n            let otherParticipant = null\n            if (session.participants && Array.isArray(session.participants)) {\n              if (userInfo.value && userInfo.value.id) {\n                otherParticipant = session.participants.find(\n                  p => p.user && p.user.id !== userInfo.value.id\n                )\n              } else {\n                // \n                otherParticipant = session.participants[0]\n              }\n            }\n            \n            // \n            if (session.is_group) {\n              return {\n                id: session.id,\n                name: session.title || '',\n                initial: (session.title || '')[0],\n                avatar: '',\n                color: getRandomColor(session.id),\n                status: 'online',\n                lastMessage: session.last_message ? session.last_message.content : '',\n                lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n                unread: session.unread_count,\n                isGroup: true\n              }\n            }\n            \n            // \n            if (otherParticipant) {\n              const user = otherParticipant.user\n              return {\n                id: session.id,\n                name: ((user.first_name || '') + ' ' + (user.last_name || '')).trim() || user.username || '',\n                initial: ((user.first_name || user.username || '')[0]),\n                avatar: user.avatar || '',\n                color: getRandomColor(user.id),\n                status: 'online',\n                lastMessage: session.last_message ? session.last_message.content : '',\n                lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n                unread: session.unread_count,\n                isGroup: false\n              }\n            }\n            \n            // \n            return {\n              id: session.id,\n              name: session.title || '',\n              initial: (session.title || '')[0],\n              avatar: '',\n              color: getRandomColor(session.id),\n              status: 'online',\n              lastMessage: session.last_message ? session.last_message.content : '',\n              lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n              unread: session.unread_count,\n              isGroup: session.is_group\n            }\n          })\n        } else if (data && Array.isArray(data)) {\n          console.log(', :', data.length)\n          // \n          contacts.value = data.map(session => {\n            // \n            let otherParticipant = null\n            if (session.participants && Array.isArray(session.participants)) {\n              if (userInfo.value && userInfo.value.id) {\n                otherParticipant = session.participants.find(\n                  p => p.user && p.user.id !== userInfo.value.id\n                )\n              } else {\n                // \n                otherParticipant = session.participants[0]\n              }\n            }\n            \n            // \n            if (session.is_group) {\n              return {\n                id: session.id,\n                name: session.title || '',\n                initial: (session.title || '')[0],\n                avatar: '',\n                color: getRandomColor(session.id),\n                status: 'online',\n                lastMessage: session.last_message ? session.last_message.content : '',\n                lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n                unread: session.unread_count,\n                isGroup: true\n              }\n            }\n            \n            // \n            if (otherParticipant) {\n              const user = otherParticipant.user\n              return {\n                id: session.id,\n                name: ((user.first_name || '') + ' ' + (user.last_name || '')).trim() || user.username || '',\n                initial: ((user.first_name || user.username || '')[0]),\n                avatar: user.avatar || '',\n                color: getRandomColor(user.id),\n                status: 'online',\n                lastMessage: session.last_message ? session.last_message.content : '',\n                lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n                unread: session.unread_count,\n                isGroup: false\n              }\n            }\n            \n            // \n            return {\n              id: session.id,\n              name: session.title || '',\n              initial: (session.title || '')[0],\n              avatar: '',\n              color: getRandomColor(session.id),\n              status: 'online',\n              lastMessage: session.last_message ? session.last_message.content : '',\n              lastTime: session.last_message ? formatMessageTime(session.last_message.created_at) : formatMessageTime(session.updated_at),\n              unread: session.unread_count,\n              isGroup: session.is_group\n            }\n          })\n        } else {\n          // \n          console.error(':', data)\n          contacts.value = []\n        }\n        \n        console.log(':', contacts.value)\n        \n        // \n        if (contacts.value.length > 0) {\n          contacts.value.sort((a, b) => b.unread - a.unread)\n        }\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error(': ' + (error.message || ''))\n        contacts.value = []\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    // \n    const loadChatMessages = async (chatId) => {\n      if (!chatId) {\n        console.error(': chatId')\n        return\n      }\n      \n      try {\n        loading.value = true\n        console.log(` ${chatId} ...`)\n        \n        const response = await getChatSession(chatId)\n        console.log(':', response)\n        \n        if (!response) {\n          console.error('')\n          messages.value = []\n          return\n        }\n        \n        // \n        let messageData = []\n        let sessionData = null\n        \n        if (response.data && response.data.messages) {\n          // messages\n          messageData = response.data.messages\n          sessionData = response.data\n          console.log(':', messageData.length)\n        } else if (response.data && response.data.data && response.data.data.messages) {\n          // {success: true, data: {messages: [...]}}\n          messageData = response.data.data.messages\n          sessionData = response.data.data\n          console.log(':', messageData.length)\n        } else if (response.messages) {\n          // : {messages: [...]}\n          messageData = response.messages\n          sessionData = response\n          console.log(':', messageData.length)\n        } else {\n          console.warn(':', response)\n          console.log('...')\n          \n          // \n          const possibleMessageFields = ['message', 'chat_messages', 'chats', 'content']\n          for (const field of possibleMessageFields) {\n            if (response[field] && Array.isArray(response[field])) {\n              console.log(` ${field}`)\n              messageData = response[field]\n              sessionData = response\n              break\n            } else if (response.data && response.data[field] && Array.isArray(response.data[field])) {\n              console.log(`data ${field}`)\n              messageData = response.data[field]\n              sessionData = response.data\n              break\n            }\n          }\n          \n          if (messageData.length === 0) {\n            console.warn('')\n          }\n        }\n        \n        // \n        console.log(':', sessionData)\n        console.log(':', messageData)\n        \n        // \n        if (sessionData && !contacts.value.some(c => c.id === parseInt(chatId))) {\n          console.log(':', sessionData)\n          \n          // \n          const session = sessionData\n          // \n          let otherParticipant = null\n          \n          //  session.participants \n          if (session.participants && Array.isArray(session.participants) && session.participants.length > 0 && userInfo.value) {\n            otherParticipant = session.participants.find(p => p.user && p.user.id !== userInfo.value.id)\n          }\n          \n          let tempContact = null\n          \n          // \n          if (session.is_group) {\n            tempContact = {\n              id: parseInt(chatId),\n              name: session.title || '',\n              initial: (session.title || '')[0],\n              avatar: '',\n              color: getRandomColor(parseInt(chatId)),\n              status: 'online',\n              lastMessage: session.last_message ? session.last_message.content : '',\n              lastTime: formatMessageTime(session.updated_at),\n              unread: 0,\n              isGroup: true\n            }\n          // \n          } else if (otherParticipant && otherParticipant.user) {\n            const user = otherParticipant.user\n            tempContact = {\n              id: parseInt(chatId),\n              name: ((user.first_name || '') + ' ' + (user.last_name || '')).trim() || user.username || '',\n              initial: ((user.first_name || user.username || '')[0]),\n              avatar: user.avatar || '',\n              color: getRandomColor(user.id),\n              status: 'online',\n              lastMessage: session.last_message ? session.last_message.content : '',\n              lastTime: formatMessageTime(session.updated_at),\n              unread: 0,\n              isGroup: false\n            }\n          } else {\n            // \n            tempContact = {\n              id: parseInt(chatId),\n              name: session.title || '',\n              initial: (session.title || '')[0],\n              avatar: '',\n              color: getRandomColor(parseInt(chatId)),\n              status: 'online',\n              lastMessage: '',\n              lastTime: formatMessageTime(session.updated_at),\n              unread: 0,\n              isGroup: session.is_group\n            }\n          }\n          \n          // \n          if (tempContact) {\n            contacts.value.unshift(tempContact)\n            console.log(':', tempContact)\n          }\n        }\n        \n        // \n        messages.value = messageData || []\n        currentChatId.value = parseInt(chatId)\n        selectedContact.value = parseInt(chatId)\n        \n        // \n        nextTick(() => {\n          scrollToBottom()\n        })\n      } catch (error) {\n        console.error(':', error)\n        \n        let errorMessage = ''\n        if (error.response) {\n          const status = error.response.status\n          if (status === 404) {\n            errorMessage = ''\n          } else if (status === 403) {\n            errorMessage = ''\n          } else if (error.response.data && error.response.data.message) {\n            errorMessage = error.response.data.message\n          }\n        } else if (error.message) {\n          errorMessage = error.message\n        }\n        \n        ElMessage.error(errorMessage)\n        messages.value = []\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    // \n    const refreshChatSessions = async () => {\n      await loadChatSessions()\n      \n      // ID\n      if (currentChatId.value) {\n        const contact = contacts.value.find(c => c.id === currentChatId.value)\n        if (contact) {\n          selectedContact.value = contact.id\n        }\n      }\n    }\n    \n    // \n    const scrollToBottom = () => {\n      if (messageContainer.value) {\n        messageContainer.value.scrollTop = messageContainer.value.scrollHeight\n      }\n    }\n    \n    // \n    const selectContact = async (contact) => {\n      if (selectedContact.value === contact.id) return\n      \n      selectedContact.value = contact.id\n      currentChatId.value = contact.id\n      \n      // \n      await loadChatMessages(contact.id)\n      \n      // DOM\n      await nextTick()\n      scrollToBottom()\n      \n      // \n      messageInput.value = ''\n    }\n    \n    // \n    watch(messages, () => {\n      nextTick(() => {\n        scrollToBottom()\n      })\n    })\n    \n    // \n    const sendMessage = async () => {\n      if (!messageInput.value.trim() || !currentChatId.value) return\n      \n      try {\n        // \n        if (!userInfo.value || !userInfo.value.id) {\n          console.log('...')\n          // \n          const userData = await fetchCurrentUser()\n          if (!userData || !userData.id) {\n            throw new Error('')\n          }\n          \n          console.log(':', userData)\n        }\n        \n        // \n        // \n        if (!userInfo.value || !userInfo.value.id) {\n          throw new Error('')\n        }\n        \n        // ID\n        console.log('ID:', currentChatId.value, ':', typeof currentChatId.value)\n        \n        const tempMessage = {\n          id: 'temp-' + Date.now(),\n          content: messageInput.value.trim(),\n          sender: {\n            id: userInfo.value.id,\n            username: userInfo.value.username || '',\n            first_name: userInfo.value.first_name || '',\n            last_name: userInfo.value.last_name || ''\n          },\n          message_type: 'text',\n          created_at: new Date().toISOString(),\n          is_temp: true\n        }\n        \n        // \n        messages.value.push(tempMessage)\n        \n        // \n        const messageCopy = messageInput.value\n        messageInput.value = ''\n        \n        // \n        await nextTick()\n        scrollToBottom()\n        \n        // \n        console.log('ID:', currentChatId.value, ':', messageCopy)\n        \n        try {\n          // \n          const response = await sendTextMessage(currentChatId.value, messageCopy)\n          console.log(':', response)\n          \n          // \n          let messageData = null\n          \n          if (response && response.success && response.data) {\n            // : {success: true, data: {}}\n            messageData = response.data\n          } else if (response && response.id) {\n            // IDDRF\n            messageData = response\n          } else if (response && response.chat) {\n            // API: {chat, content, message_type, file, ...}\n            // \n            messageData = {\n              id: response.id || 'msg-' + Date.now(),\n              content: response.content,\n              message_type: response.message_type,\n              file: response.file,\n              created_at: response.created_at || new Date().toISOString(),\n              sender: {\n                id: userInfo.value.id,\n                username: userInfo.value.username || '',\n                first_name: userInfo.value.first_name || '',\n                last_name: userInfo.value.last_name || ''\n              }\n            }\n          } else {\n            console.warn(':', response)\n            throw new Error('')\n          }\n          \n          // \n          const tempIndex = messages.value.findIndex(m => m.id === tempMessage.id)\n          if (tempIndex !== -1) {\n            messages.value.splice(tempIndex, 1, messageData)\n          } else {\n            messages.value.push(messageData)\n          }\n          \n          // \n          const contactIndex = contacts.value.findIndex(c => c.id === selectedContact.value)\n          if (contactIndex !== -1) {\n            contacts.value[contactIndex].lastMessage = messageCopy\n            contacts.value[contactIndex].lastTime = formatMessageTime(new Date())\n          }\n          \n          // \n          await nextTick()\n          scrollToBottom()\n        } catch (error) {\n          // \n          console.error('API:', error)\n          if (error.response) {\n            console.error(':', error.response.status)\n            console.error(':', error.response.data)\n            console.error('URL:', error.response.config.url)\n            console.error(':', error.response.config.method)\n            console.error(':', error.response.config.data)\n            \n            if (error.response.status === 404) {\n              // 404\n              console.error('APIURL')\n              ElMessage.error(': API')\n            } else {\n              throw error  // catch\n            }\n          } else {\n            throw error  // catch\n          }\n        }\n      } catch (error) {\n        console.error(':', error)\n        \n        // \n        messages.value = messages.value.filter(m => !m.is_temp)\n        \n        // \n        messageInput.value = error.savedMessage || messageInput.value\n        \n        ElMessage.error('')\n      }\n    }\n    \n    // \n    const openFileUpload = () => {\n      fileInput.value.click()\n    }\n    \n    // \n    const openImageUpload = () => {\n      imageInput.value.click()\n    }\n    \n    // \n    const handleFileUpload = async (event) => {\n      const file = event.target.files[0]\n      if (!file || !currentChatId.value) return\n      \n      try {\n        await sendFileMessage(\n          currentChatId.value, \n          `: ${file.name}`, \n          file\n        )\n        \n        // \n        loadChatMessages(currentChatId.value)\n        \n        // \n        event.target.value = ''\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      }\n    }\n    \n    // \n    const handleImageUpload = async (event) => {\n      const file = event.target.files[0]\n      if (!file || !currentChatId.value) return\n      \n      try {\n        await sendImageMessage(\n          currentChatId.value, \n          ``, \n          file\n        )\n        \n        // \n        loadChatMessages(currentChatId.value)\n        \n        // \n        event.target.value = ''\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      }\n    }\n    \n    // \n    const openKnowledgeDialog = async () => {\n      knowledgeDialogVisible.value = true\n      await loadKnowledgeList()\n    }\n    \n    // \n    const loadKnowledgeList = async () => {\n      try {\n        knowledgeLoading.value = true\n        const { data } = await getKnowledgeList()\n        knowledgeList.value = data\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      } finally {\n        knowledgeLoading.value = false\n      }\n    }\n    \n    // \n    const selectKnowledge = (row) => {\n      selectedKnowledge.value = row\n    }\n    \n    // \n    const shareKnowledge = async (knowledge) => {\n      if (!currentChatId.value) return\n      \n      try {\n        await sendKnowledgeMessage(\n          currentChatId.value,\n          `: ${knowledge.title}`,\n          knowledge.id\n        )\n        \n        // \n        knowledgeDialogVisible.value = false\n        \n        // \n        loadChatMessages(currentChatId.value)\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      }\n    }\n    \n    // \n    const downloadFile = async (message) => {\n      try {\n        const response = await downloadMessageFile(message.id)\n        \n        // \n        const url = window.URL.createObjectURL(new Blob([response.data]))\n        const link = document.createElement('a')\n        link.href = url\n        link.setAttribute('download', message.file_name || 'download')\n        document.body.appendChild(link)\n        link.click()\n        document.body.removeChild(link)\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error('')\n      }\n    }\n    \n    // \n    const viewKnowledge = (message) => {\n      if (message.knowledge_detail) {\n        // \n        ElMessageBox.alert(\n          `: ${message.knowledge_detail.title}<br>: ${message.knowledge_detail.description || ''}`, \n          '', \n          {\n            dangerouslyUseHTMLString: true,\n            confirmButtonText: ''\n          }\n        )\n      }\n    }\n    \n    // \n    const getSenderColor = (sender) => {\n      return getRandomColor(sender.id)\n    }\n    \n    // \n    const getSenderInitial = (sender) => {\n      return (sender.first_name || sender.username)[0]\n    }\n    \n    // ID\n    const getRandomColor = (id) => {\n      const colors = [\n        '#007bff', '#28a745', '#dc3545', '#fd7e14', \n        '#6f42c1', '#20c997', '#17a2b8', '#6c757d'\n      ]\n      \n      // ID\n      const index = typeof id === 'number' ? id % colors.length : 0\n      return colors[index]\n    }\n    \n    // \n    const formatMessageTime = (timestamp) => {\n      if (!timestamp) return ''\n      \n      const date = new Date(timestamp)\n      const now = new Date()\n      const diff = now - date\n      \n      // \n      if (diff < 24 * 60 * 60 * 1000) {\n      const hours = date.getHours().toString().padStart(2, '0')\n      const minutes = date.getMinutes().toString().padStart(2, '0')\n      return `${hours}:${minutes}`\n      }\n      \n      // \n      if (diff < 7 * 24 * 60 * 60 * 1000) {\n        const days = ['', '', '', '', '', '', '']\n        return days[date.getDay()]\n      }\n      \n      // \n      return `${date.getMonth() + 1}${date.getDate()}`\n    }\n    \n    // \n    const formatDate = (timestamp) => {\n      if (!timestamp) return ''\n      \n      const date = new Date(timestamp)\n      return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`\n    }\n    \n    // \n    const formatFileSize = (sizeInKB) => {\n      if (sizeInKB < 1024) {\n        return `${sizeInKB} KB`\n      } else {\n        return `${(sizeInKB / 1024).toFixed(2)} MB`\n      }\n    }\n    \n    // \n    const getStatusText = (status) => {\n      const statusMap = {\n        'online': '',\n        'offline': '',\n        'busy': '',\n        'away': ''\n      }\n      return statusMap[status] || status\n    }\n    \n    // \n    const forceRefresh = async () => {\n      try {\n        ElMessage.info('...')\n        \n        // \n        const userData = await fetchCurrentUser()\n        \n        if (!userData) {\n          ElMessage.error('')\n          return\n        }\n        \n        // \n        await loadChatSessions()\n        \n        if (contacts.value.length === 0) {\n          ElMessage.warning('')\n        } else {\n          ElMessage.success(' ' + contacts.value.length + ' ')\n        }\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error(': ' + (error.message || ''))\n      }\n    }\n    \n    // \n    onMounted(async () => {\n      try {\n        // \n        const userData = await fetchCurrentUser()\n        \n        // \n        if (!userData) {\n          ElMessage.error('')\n          return\n        }\n        \n        console.log(':', userData)\n        \n        // \n        if (!userInfo.value || !userInfo.value.id) {\n          console.error(':', userInfo.value)\n          ElMessage.error('')\n          return\n        } else {\n          console.log(':', userInfo.value)\n        }\n        \n        // \n        await loadChatSessions()\n        \n        // URLID\n        const sessionId = route.query.session || route.query.id\n        if (sessionId) {\n          // \n          const foundContact = contacts.value.find(c => c.id === parseInt(sessionId))\n          if (foundContact) {\n            // \n            selectedContact.value = foundContact.id\n            // \n            await loadChatMessages(sessionId)\n          } else {\n            // \n            console.log('ID:', sessionId)\n            await loadChatMessages(sessionId)\n          }\n        }\n      \n        // \n        refreshInterval = setInterval(async () => {\n          if (selectedContact.value) {\n            await loadChatMessages(selectedContact.value)\n          }\n          await loadChatSessions()\n        }, 30000)\n        \n        // \n        await nextTick()\n        scrollToBottom()\n      } catch (error) {\n        console.error(':', error)\n        ElMessage.error(': ' + error.message)\n      }\n    })\n    \n    return {\n      searchQuery,\n      activeTab,\n      selectedContact,\n      tabs,\n      contacts,\n      currentContact,\n      filteredContacts,\n      messages,\n      messageInput,\n      messageContainer,\n      fileInput,\n      imageInput,\n      currentUser,\n      userInfo,\n      userId,\n      knowledgeDialogVisible,\n      knowledgeLoading,\n      knowledgeList,\n      loading,\n      // \n      Search,\n      Phone,\n      VideoCamera,\n      InfoFilled,\n      Document,\n      PictureFilled,\n      FolderOpened,\n      Microphone,\n      Position,\n      ChatDotSquare,\n      Reading,\n      UserFilled,\n      ChatLineSquare,\n      Refresh,\n      // \n      sendMessage,\n      getStatusText,\n      selectContact,\n      openFileUpload,\n      openImageUpload,\n      handleFileUpload,\n      handleImageUpload,\n      openKnowledgeDialog,\n      selectKnowledge,\n      shareKnowledge,\n      downloadFile,\n      viewKnowledge,\n      getSenderColor,\n      getSenderInitial,\n      formatMessageTime,\n      formatDate,\n      formatFileSize,\n      refreshChatSessions,\n      forceRefresh\n    }\n  }\n}\n</script>\n\n<style scoped>\n.chat-container {\n  height: calc(100vh - 64px); /*  */\n  width: 100%;\n  padding: 20px;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n\n.chat-card {\n  height: 100%;\n  width: 100%;\n  border-radius: 8px;\n  margin: 0;\n  overflow: hidden;\n}\n\n.chat-card :deep(.el-card__body) {\n  height: 100%;\n  padding: 0;\n}\n\n.chat-layout {\n  display: flex;\n  height: 100%;\n  width: 100%;\n}\n\n/*  */\n.chat-sidebar {\n  width: 280px;\n  border-right: 1px solid #f0f0f0;\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  height: 100%;\n  overflow: hidden;\n}\n\n.search-box {\n  padding: 15px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.chat-tabs {\n  display: flex;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.chat-tab {\n  flex: 1;\n  text-align: center;\n  padding: 12px;\n  cursor: pointer;\n  font-weight: 500;\n  color: #666;\n  transition: all 0.3s ease;\n}\n\n.chat-tab.active {\n  color: var(--el-color-primary);\n  border-bottom: 2px solid var(--el-color-primary);\n}\n\n.contacts-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0;\n}\n\n.contact-item {\n  display: flex;\n  padding: 15px;\n  border-bottom: 1px solid #f5f5f5;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.contact-item:hover {\n  background-color: #f9f9f9;\n}\n\n.contact-item.active {\n  background-color: #f0f7ff;\n}\n\n.contact-avatar {\n  position: relative;\n  margin-right: 12px;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-weight: bold;\n}\n\n.avatar.small {\n  width: 32px;\n  height: 32px;\n  font-size: 12px;\n}\n\n.avatar-initial {\n  font-size: 16px;\n}\n\n.contact-status {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  border: 2px solid white;\n}\n\n.status-online {\n  background-color: #28a745;\n}\n\n.status-offline {\n  background-color: #6c757d;\n}\n\n.status-busy {\n  background-color: #dc3545;\n}\n\n.status-away {\n  background-color: #fd7e14;\n}\n\n.contact-info {\n  flex: 1;\n  overflow: hidden;\n}\n\n.contact-name {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 5px;\n}\n\n.contact-name span {\n  font-weight: 500;\n}\n\n.time {\n  font-size: 12px;\n  color: #999;\n}\n\n.contact-message {\n  display: flex;\n  justify-content: space-between;\n  color: #666;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.message-badge {\n  margin-left: 5px;\n}\n\n/*  */\n.chat-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background-color: #f5f7fa;\n  height: 100%;\n  overflow: hidden;\n}\n\n.chat-header {\n  display: flex;\n  align-items: center;\n  padding: 15px;\n  border-bottom: 1px solid #f0f0f0;\n  background-color: #fff;\n}\n\n.chat-header .contact-info {\n  margin-right: auto;\n}\n\n.chat-header h6 {\n  margin: 0;\n  font-size: 16px;\n}\n\n.chat-header p {\n  margin: 0;\n  font-size: 12px;\n  color: #666;\n}\n\n.chat-actions {\n  display: flex;\n  gap: 10px;\n}\n\n.chat-messages {\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  max-height: calc(100% - 150px); /*  */\n  display: flex;\n  flex-direction: column;\n}\n\n.message {\n  margin-bottom: 20px;\n}\n\n.message-container {\n  display: flex;\n}\n\n.message-sent .message-container {\n  flex-direction: row-reverse;\n}\n\n.message-avatar {\n  margin-right: 10px;\n  flex-shrink: 0;\n}\n\n.message-sent .message-avatar {\n  margin-right: 0;\n  margin-left: 10px;\n}\n\n.message-content-wrapper {\n  max-width: 70%;\n}\n\n.message-content {\n  padding: 12px 15px;\n  border-radius: 18px;\n  position: relative;\n  word-break: break-word;\n}\n\n.message-content.received {\n  background-color: #fff;\n  border-top-left-radius: 4px;\n}\n\n.message-content.sent {\n  background-color: var(--el-color-primary);\n  color: white;\n  border-top-right-radius: 4px;\n}\n\n.message-time {\n  font-size: 12px;\n  color: #999;\n  margin-top: 5px;\n  text-align: right;\n}\n\n.message-sent .message-time {\n  text-align: right;\n}\n\n.message-received .message-time {\n  text-align: left;\n}\n\n.message-image img {\n  max-width: 100%;\n  max-height: 300px;\n  border-radius: 8px;\n}\n\n.message-file {\n  display: flex;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.1);\n  padding: 8px 12px;\n  border-radius: 8px;\n  cursor: pointer;\n}\n\n.message-file .el-icon {\n  font-size: 24px;\n  margin-right: 10px;\n}\n\n.file-size {\n  margin-left: 8px;\n  font-size: 12px;\n  opacity: 0.8;\n}\n\n.message-knowledge {\n  display: flex;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.1);\n  padding: 10px;\n  border-radius: 8px;\n  cursor: pointer;\n}\n\n.message-knowledge .el-icon {\n  font-size: 24px;\n  margin-right: 10px;\n}\n\n.knowledge-info {\n  flex: 1;\n}\n\n.knowledge-title {\n  font-weight: 500;\n  margin-bottom: 5px;\n}\n\n.knowledge-desc {\n  font-size: 12px;\n  opacity: 0.8;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n}\n\n.chat-input {\n  padding: 15px;\n  background-color: #fff;\n  border-top: 1px solid #f0f0f0;\n  display: flex;\n  flex-direction: column;\n  min-height: 150px; /*  */\n}\n\n.chat-tools {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 10px;\n}\n\n.input-area {\n  margin-bottom: 10px;\n  flex: 1;\n}\n\n.send-button {\n  display: flex;\n  justify-content: flex-end;\n}\n\n.empty-chat {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #999;\n}\n\n.empty-illustration {\n  margin-bottom: 20px;\n  color: #ddd;\n}\n\n.empty-chat h4 {\n  margin: 0 0 10px;\n}\n\n.empty-chat p {\n  margin: 0;\n  font-size: 14px;\n}\n\n.empty-contacts {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #999;\n}\n\n.empty-icon {\n  margin-bottom: 20px;\n  color: #ddd;\n}\n\n.empty-contacts h4 {\n  margin: 0 0 10px;\n}\n\n.empty-contacts p {\n  margin: 0;\n  font-size: 14px;\n}\n\n.loading-container {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.empty-messages {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n\n.loading-messages {\n  flex: 1;\n  padding: 20px;\n}\n\n.mt-3 {\n  margin-top: 15px;\n}\n\n.search-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.search-header .el-input {\n  flex: 1;\n}\n\n.chat-header-actions {\n  margin-bottom: 10px;\n}\n\n.refresh-action {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 5px;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}