{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\quill\\modules\\normalizeExternalHTML\\normalizers\\msWord.js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\quill\\modules\\normalizeExternalHTML\\normalizers\\msWord.js","mtime":1751792162081},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZm9yLWVhY2guanMiOwpjb25zdCBpZ25vcmVSZWdleHAgPSAvXGJtc28tbGlzdDpbXjtdKmlnbm9yZS9pOwpjb25zdCBpZFJlZ2V4cCA9IC9cYm1zby1saXN0OlteO10qXGJsKFxkKykvaTsKY29uc3QgaW5kZW50UmVnZXhwID0gL1xibXNvLWxpc3Q6W147XSpcYmxldmVsKFxkKykvaTsKY29uc3QgcGFyc2VMaXN0SXRlbSA9IChlbGVtZW50LCBodG1sKSA9PiB7CiAgY29uc3Qgc3R5bGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnc3R5bGUnKTsKICBjb25zdCBpZE1hdGNoID0gc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLm1hdGNoKGlkUmVnZXhwKTsKICBpZiAoIWlkTWF0Y2gpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBpZCA9IE51bWJlcihpZE1hdGNoWzFdKTsKICBjb25zdCBpbmRlbnRNYXRjaCA9IHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS5tYXRjaChpbmRlbnRSZWdleHApOwogIGNvbnN0IGluZGVudCA9IGluZGVudE1hdGNoID8gTnVtYmVyKGluZGVudE1hdGNoWzFdKSA6IDE7CiAgY29uc3QgdHlwZVJlZ2V4cCA9IG5ldyBSZWdFeHAoYEBsaXN0IGwke2lkfTpsZXZlbCR7aW5kZW50fVxccypcXHtbXlxcfV0qbXNvLWxldmVsLW51bWJlci1mb3JtYXQ6XFxzKihbXFx3LV0rKWAsICdpJyk7CiAgY29uc3QgdHlwZU1hdGNoID0gaHRtbC5tYXRjaCh0eXBlUmVnZXhwKTsKICBjb25zdCB0eXBlID0gdHlwZU1hdGNoICYmIHR5cGVNYXRjaFsxXSA9PT0gJ2J1bGxldCcgPyAnYnVsbGV0JyA6ICdvcmRlcmVkJzsKICByZXR1cm4gewogICAgaWQsCiAgICBpbmRlbnQsCiAgICB0eXBlLAogICAgZWxlbWVudAogIH07Cn07CgovLyBsaXN0IGl0ZW1zIGFyZSByZXByZXNlbnRlZCBhcyBgcGAgdGFncyB3aXRoIHN0eWxlcyBsaWtlIGBtc28tbGlzdDogbDAgbGV2ZWwxYCB3aGVyZToKLy8gMS4gIjAiIGluICJsMCIgbWVhbnMgdGhlIGxpc3QgaXRlbSBpZDsKLy8gMi4gIjEiIGluICJsZXZlbDEiIG1lYW5zIHRoZSBpbmRlbnQgbGV2ZWwsIHN0YXJ0aW5nIGZyb20gMS4KY29uc3Qgbm9ybWFsaXplTGlzdEl0ZW0gPSBkb2MgPT4gewogIGNvbnN0IG1zb0xpc3QgPSBBcnJheS5mcm9tKGRvYy5xdWVyeVNlbGVjdG9yQWxsKCdbc3R5bGUqPW1zby1saXN0XScpKTsKICBjb25zdCBpZ25vcmVkID0gW107CiAgY29uc3Qgb3RoZXJzID0gW107CiAgbXNvTGlzdC5mb3JFYWNoKG5vZGUgPT4gewogICAgY29uc3Qgc2hvdWxkSWdub3JlID0gKG5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnKS5tYXRjaChpZ25vcmVSZWdleHApOwogICAgaWYgKHNob3VsZElnbm9yZSkgewogICAgICBpZ25vcmVkLnB1c2gobm9kZSk7CiAgICB9IGVsc2UgewogICAgICBvdGhlcnMucHVzaChub2RlKTsKICAgIH0KICB9KTsKCiAgLy8gRWFjaCBsaXN0IGl0ZW0gY29udGFpbnMgYSBtYXJrZXIgd3JhcHBlZCB3aXRoICJtc28tbGlzdDogSWdub3JlIi4KICBpZ25vcmVkLmZvckVhY2gobm9kZSA9PiB7CiAgICB2YXIgX25vZGUkcGFyZW50Tm9kZTsKICAgIHJldHVybiAoX25vZGUkcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZSkgPT09IG51bGwgfHwgX25vZGUkcGFyZW50Tm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vZGUkcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsKICB9KTsKCiAgLy8gVGhlIGxpc3Qgc3R5cGUgaXMgbm90IGRlZmluZWQgaW5saW5lIHdpdGggdGhlIHRhZywgaW5zdGVhZCwgaXQncyBpbiB0aGUKICAvLyBzdHlsZSB0YWcgc28gd2UgbmVlZCB0byBwYXNzIHRoZSBodG1sIGFzIGEgc3RyaW5nLgogIGNvbnN0IGh0bWwgPSBkb2MuZG9jdW1lbnRFbGVtZW50LmlubmVySFRNTDsKICBjb25zdCBsaXN0SXRlbXMgPSBvdGhlcnMubWFwKGVsZW1lbnQgPT4gcGFyc2VMaXN0SXRlbShlbGVtZW50LCBodG1sKSkuZmlsdGVyKHBhcnNlZCA9PiBwYXJzZWQpOwogIHdoaWxlIChsaXN0SXRlbXMubGVuZ3RoKSB7CiAgICB2YXIgX2NoaWxkTGlzdEl0ZW1zJDsKICAgIGNvbnN0IGNoaWxkTGlzdEl0ZW1zID0gW107CiAgICBsZXQgY3VycmVudCA9IGxpc3RJdGVtcy5zaGlmdCgpOwogICAgLy8gR3JvdXAgY29udGludW91cyBpdGVtcyBpbnRvIHRoZSBzYW1lIGdyb3VwIChha2EgInVsIikKICAgIHdoaWxlIChjdXJyZW50KSB7CiAgICAgIHZhciBfbGlzdEl0ZW1zJDsKICAgICAgY2hpbGRMaXN0SXRlbXMucHVzaChjdXJyZW50KTsKICAgICAgY3VycmVudCA9IGxpc3RJdGVtcy5sZW5ndGggJiYgKChfbGlzdEl0ZW1zJCA9IGxpc3RJdGVtc1swXSkgPT09IG51bGwgfHwgX2xpc3RJdGVtcyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9saXN0SXRlbXMkLmVsZW1lbnQpID09PSBjdXJyZW50LmVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nICYmCiAgICAgIC8vIERpZmZlcmVudCBpZCBtZWFucyB0aGUgbmV4dCBpdGVtIGRvZXNuJ3QgYmVsb25nIHRvIHRoaXMgZ3JvdXAuCiAgICAgIGxpc3RJdGVtc1swXS5pZCA9PT0gY3VycmVudC5pZCA/IGxpc3RJdGVtcy5zaGlmdCgpIDogbnVsbDsKICAgIH0KICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTsKICAgIGNoaWxkTGlzdEl0ZW1zLmZvckVhY2gobGlzdEl0ZW0gPT4gewogICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgICAgIGxpLnNldEF0dHJpYnV0ZSgnZGF0YS1saXN0JywgbGlzdEl0ZW0udHlwZSk7CiAgICAgIGlmIChsaXN0SXRlbS5pbmRlbnQgPiAxKSB7CiAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdjbGFzcycsIGBxbC1pbmRlbnQtJHtsaXN0SXRlbS5pbmRlbnQgLSAxfWApOwogICAgICB9CiAgICAgIGxpLmlubmVySFRNTCA9IGxpc3RJdGVtLmVsZW1lbnQuaW5uZXJIVE1MOwogICAgICB1bC5hcHBlbmRDaGlsZChsaSk7CiAgICB9KTsKICAgIGNvbnN0IGVsZW1lbnQgPSAoX2NoaWxkTGlzdEl0ZW1zJCA9IGNoaWxkTGlzdEl0ZW1zWzBdKSA9PT0gbnVsbCB8fCBfY2hpbGRMaXN0SXRlbXMkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2hpbGRMaXN0SXRlbXMkLmVsZW1lbnQ7CiAgICBjb25zdCB7CiAgICAgIHBhcmVudE5vZGUKICAgIH0gPSBlbGVtZW50ICE9PSBudWxsICYmIGVsZW1lbnQgIT09IHZvaWQgMCA/IGVsZW1lbnQgOiB7fTsKICAgIGlmIChlbGVtZW50KSB7CiAgICAgIHBhcmVudE5vZGUgPT09IG51bGwgfHwgcGFyZW50Tm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodWwsIGVsZW1lbnQpOwogICAgfQogICAgY2hpbGRMaXN0SXRlbXMuc2xpY2UoMSkuZm9yRWFjaChfcmVmID0+IHsKICAgICAgbGV0IHsKICAgICAgICBlbGVtZW50OiBlCiAgICAgIH0gPSBfcmVmOwogICAgICBwYXJlbnROb2RlID09PSBudWxsIHx8IHBhcmVudE5vZGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG5vcm1hbGl6ZShkb2MpIHsKICBpZiAoZG9jLmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3htbG5zOncnKSA9PT0gJ3VybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOndvcmQnKSB7CiAgICBub3JtYWxpemVMaXN0SXRlbShkb2MpOwogIH0KfQ=="},{"version":3,"names":["ignoreRegexp","idRegexp","indentRegexp","parseListItem","element","html","style","getAttribute","idMatch","match","id","Number","indentMatch","indent","typeRegexp","RegExp","typeMatch","type","normalizeListItem","doc","msoList","Array","from","querySelectorAll","ignored","others","forEach","node","shouldIgnore","push","_node$parentNode","parentNode","removeChild","documentElement","innerHTML","listItems","map","filter","parsed","length","_childListItems$","childListItems","current","shift","_listItems$","nextElementSibling","ul","document","createElement","listItem","li","setAttribute","appendChild","replaceChild","slice","_ref","e","normalize"],"sources":["../../../../src/modules/normalizeExternalHTML/normalizers/msWord.ts"],"sourcesContent":["const ignoreRegexp = /\\bmso-list:[^;]*ignore/i;\nconst idRegexp = /\\bmso-list:[^;]*\\bl(\\d+)/i;\nconst indentRegexp = /\\bmso-list:[^;]*\\blevel(\\d+)/i;\n\nconst parseListItem = (element: Element, html: string) => {\n  const style = element.getAttribute('style');\n  const idMatch = style?.match(idRegexp);\n  if (!idMatch) {\n    return null;\n  }\n  const id = Number(idMatch[1]);\n\n  const indentMatch = style?.match(indentRegexp);\n  const indent = indentMatch ? Number(indentMatch[1]) : 1;\n\n  const typeRegexp = new RegExp(\n    `@list l${id}:level${indent}\\\\s*\\\\{[^\\\\}]*mso-level-number-format:\\\\s*([\\\\w-]+)`,\n    'i',\n  );\n  const typeMatch = html.match(typeRegexp);\n  const type = typeMatch && typeMatch[1] === 'bullet' ? 'bullet' : 'ordered';\n\n  return { id, indent, type, element };\n};\n\n// list items are represented as `p` tags with styles like `mso-list: l0 level1` where:\n// 1. \"0\" in \"l0\" means the list item id;\n// 2. \"1\" in \"level1\" means the indent level, starting from 1.\nconst normalizeListItem = (doc: Document) => {\n  const msoList = Array.from(doc.querySelectorAll('[style*=mso-list]'));\n  const ignored: Element[] = [];\n  const others: Element[] = [];\n  msoList.forEach((node) => {\n    const shouldIgnore = (node.getAttribute('style') || '').match(ignoreRegexp);\n    if (shouldIgnore) {\n      ignored.push(node);\n    } else {\n      others.push(node);\n    }\n  });\n\n  // Each list item contains a marker wrapped with \"mso-list: Ignore\".\n  ignored.forEach((node) => node.parentNode?.removeChild(node));\n\n  // The list stype is not defined inline with the tag, instead, it's in the\n  // style tag so we need to pass the html as a string.\n  const html = doc.documentElement.innerHTML;\n  const listItems = others\n    .map((element) => parseListItem(element, html))\n    .filter((parsed) => parsed);\n\n  while (listItems.length) {\n    const childListItems = [];\n\n    let current = listItems.shift();\n    // Group continuous items into the same group (aka \"ul\")\n    while (current) {\n      childListItems.push(current);\n      current =\n        listItems.length &&\n        listItems[0]?.element === current.element.nextElementSibling &&\n        // Different id means the next item doesn't belong to this group.\n        listItems[0].id === current.id\n          ? listItems.shift()\n          : null;\n    }\n\n    const ul = document.createElement('ul');\n    childListItems.forEach((listItem) => {\n      const li = document.createElement('li');\n      li.setAttribute('data-list', listItem.type);\n      if (listItem.indent > 1) {\n        li.setAttribute('class', `ql-indent-${listItem.indent - 1}`);\n      }\n      li.innerHTML = listItem.element.innerHTML;\n      ul.appendChild(li);\n    });\n\n    const element = childListItems[0]?.element;\n    const { parentNode } = element ?? {};\n    if (element) {\n      parentNode?.replaceChild(ul, element);\n    }\n    childListItems.slice(1).forEach(({ element: e }) => {\n      parentNode?.removeChild(e);\n    });\n  }\n};\n\nexport default function normalize(doc: Document) {\n  if (\n    doc.documentElement.getAttribute('xmlns:w') ===\n    'urn:schemas-microsoft-com:office:word'\n  ) {\n    normalizeListItem(doc);\n  }\n}\n"],"mappings":"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","ignoreList":[]}]}