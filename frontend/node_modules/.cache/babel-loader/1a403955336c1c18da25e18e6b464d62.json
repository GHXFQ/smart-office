{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue","mtime":1750938883714},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5kaWZmZXJlbmNlLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmludGVyc2VjdGlvbi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1kaXNqb2ludC1mcm9tLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmlzLXN1YnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1zdXBlcnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5zeW1tZXRyaWMtZGlmZmVyZW5jZS52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC51bmlvbi52Mi5qcyI7CmltcG9ydCB7IHJlZiwgY29tcHV0ZWQsIHdhdGNoLCBvbk1vdW50ZWQsIG5leHRUaWNrIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlUm91dGUsIHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCwgRWxMb2FkaW5nIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgZ2V0RG9jdW1lbnRzLCBnZXREb2N1bWVudERldGFpbCwgY3JlYXRlRG9jdW1lbnQsIHVwZGF0ZURvY3VtZW50LCBkZWxldGVEb2N1bWVudCBhcyBhcGlEZWxldGVEb2N1bWVudCwgc2hhcmVEb2N1bWVudCBhcyBhcGlTaGFyZURvY3VtZW50LCBleHBhbmRDb250ZW50IGFzIGFwaUV4cGFuZENvbnRlbnQsIHBvbGlzaFRleHQgYXMgYXBpUG9saXNoVGV4dCwgZ3JhbW1hckNoZWNrLCB0cmFuc2xhdGVUZXh0LCBkb2NRYSB9IGZyb20gJ0AvYXBpL3NtYXJ0ZG9jJzsKaW1wb3J0IHsgRG9jdW1lbnQsIFBsdXMsIENpcmNsZUNoZWNrLCBEb3dubG9hZCwgTW9yZSwgU2VhcmNoLCBBcnJvd0xlZnQsIEFycm93UmlnaHQsIFNoYXJlIGFzIFNoYXJlSWNvbiwgRWRpdCwgU3RhckZpbGxlZCwgQ2hhdERvdFJvdW5kLCBRdWVzdGlvbkZpbGxlZCwgQXJyb3dMZWZ0Qm9sZCwgTG9hZGluZyB9IGZyb20gJ0BlbGVtZW50LXBsdXMvaWNvbnMtdnVlJzsKaW1wb3J0IHsgUXVpbGxFZGl0b3IgfSBmcm9tICdAdnVldXAvdnVlLXF1aWxsJzsKaW1wb3J0ICdAdnVldXAvdnVlLXF1aWxsL2Rpc3QvdnVlLXF1aWxsLnNub3cuY3NzJzsKaW1wb3J0IFF1aWxsQmV0dGVyVGFibGUgZnJvbSAncXVpbGwtYmV0dGVyLXRhYmxlJzsKaW1wb3J0ICdxdWlsbC1iZXR0ZXItdGFibGUvZGlzdC9xdWlsbC1iZXR0ZXItdGFibGUuY3NzJzsKaW1wb3J0IHsgbWFya2VkIH0gZnJvbSAnbWFya2VkJzsKaW1wb3J0IHsgbWFya2VkSGlnaGxpZ2h0IH0gZnJvbSAnbWFya2VkLWhpZ2hsaWdodCc7CmltcG9ydCBobGpzIGZyb20gJ2hpZ2hsaWdodC5qcyc7CmltcG9ydCAnaGlnaGxpZ2h0LmpzL3N0eWxlcy9naXRodWIuY3NzJzsgLy8g5a+85YWl5Luj56CB6auY5Lqu5qC35byP6KGoCgovLyDphY3nva5tYXJrZWQKbWFya2VkLnVzZShtYXJrZWRIaWdobGlnaHQoewogIGxhbmdQcmVmaXg6ICdobGpzIGxhbmd1YWdlLScsCiAgaGlnaGxpZ2h0KGNvZGUsIGxhbmcpIHsKICAgIGNvbnN0IGxhbmd1YWdlID0gaGxqcy5nZXRMYW5ndWFnZShsYW5nKSA/IGxhbmcgOiAncGxhaW50ZXh0JzsKICAgIHJldHVybiBobGpzLmhpZ2hsaWdodChjb2RlLCB7CiAgICAgIGxhbmd1YWdlCiAgICB9KS52YWx1ZTsKICB9Cn0pKTsKUXVpbGwucmVnaXN0ZXIoewogICdtb2R1bGVzL2JldHRlci10YWJsZSc6IFF1aWxsQmV0dGVyVGFibGUKfSwgdHJ1ZSk7CgovLyDorr7nva7lronlhajpgInpobkKbWFya2VkLnVzZSh7CiAgZ2ZtOiB0cnVlLAogIGJyZWFrczogdHJ1ZSwKICBwZWRhbnRpYzogZmFsc2UsCiAgc2FuaXRpemU6IGZhbHNlLAogIC8vIG1hcmtlZCB2NC4zLjDkuI3lho3mlK/mjIFzYW5pdGl6ZemAiemhuQogIHNtYXJ0TGlzdHM6IHRydWUsCiAgc21hcnR5cGFudHM6IGZhbHNlCn0pOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NtYXJ0RG9jRGV0YWlsJywKICBjb21wb25lbnRzOiB7CiAgICBEb2N1bWVudCwKICAgIFBsdXMsCiAgICBDaXJjbGVDaGVjaywKICAgIERvd25sb2FkLAogICAgTW9yZSwKICAgIFNlYXJjaCwKICAgIEFycm93TGVmdCwKICAgIEFycm93UmlnaHQsCiAgICBTaGFyZUljb24sCiAgICBRdWlsbEVkaXRvciwKICAgIEVkaXQsCiAgICBTdGFyRmlsbGVkLAogICAgQ2hhdERvdFJvdW5kLAogICAgUXVlc3Rpb25GaWxsZWQsCiAgICBBcnJvd0xlZnRCb2xkLAogICAgTG9hZGluZwogIH0sCiAgc2V0dXAoKSB7CiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTsKICAgIGNvbnN0IHJvdXRlID0gdXNlUm91dGUoKTsKICAgIGNvbnN0IGdvQmFjayA9ICgpID0+IHsKICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgfTsKCiAgICAvLyDnirbmgIHmlbDmja4KICAgIGNvbnN0IGRvY3VtZW50cyA9IHJlZihbXSk7CiAgICBjb25zdCBjdXJyZW50RG9jID0gcmVmKG51bGwpOwogICAgY29uc3QgZG9jdW1lbnRDaGFuZ2VkID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGlzRG9jTGlzdENvbGxhcHNlZCA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBpc0Fzc2lzdGFudENvbGxhcHNlZCA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzZWFyY2hRdWVyeSA9IHJlZignJyk7CiAgICBjb25zdCBkb2NUeXBlRmlsdGVyID0gcmVmKCcnKTsKICAgIGNvbnN0IHNvcnRPcHRpb24gPSByZWYoJ3VwZGF0ZScpOwogICAgY29uc3QgbmV3RG9jdW1lbnREaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNoYXJlRGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBkZWxldGVEaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNlbGVjdGVkVXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgYXZhaWxhYmxlVXNlcnMgPSByZWYoW10pOwogICAgY29uc3QgZG9jdW1lbnRzTG9hZGluZyA9IHJlZih0cnVlKTsgLy8g5paH5qGj5Yqg6L2954q25oCBCgogICAgLy8g5Yqg6L2954q25oCBCiAgICBjb25zdCBzYXZlTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBjcmVhdGVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNoYXJlTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBkZWxldGVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGV4cGFuZExvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgcG9saXNoTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBncmFtbWFyQ2hlY2tMb2FkaW5nID0gcmVmKGZhbHNlKTsKCiAgICAvLyDooajljZXmlbDmja4KICAgIGNvbnN0IG5ld0RvY3VtZW50Rm9ybSA9IHJlZih7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdHlwZTogJycKICAgIH0pOwoKICAgIC8vIOihqOWNlemqjOivgeinhOWImQogICAgY29uc3QgZG9jdW1lbnRGb3JtUnVsZXMgPSB7CiAgICAgIHRpdGxlOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmlofmoaPmoIfpopgnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgbWluOiAyLAogICAgICAgIG1heDogNTAsCiAgICAgICAgbWVzc2FnZTogJ+agh+mimOmVv+W6pumhu+WcqDLliLA1MOS4quWtl+espuS5i+mXtCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dCiAgICB9OwogICAgY29uc3QgZG9jdW1lbnRGb3JtUmVmID0gcmVmKG51bGwpOwogICAgY29uc3QgdXBsb2FkSW1hZ2UgPSBhc3luYyBmaWxlID0+IHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDkvb/nlKhGaWxlUmVhZGVy5bCG5paH5Lu26L2s5o2i5Li6YmFzZTY0CiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGUgPT4gewogICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAvLyDnm7TmjqXov5Tlm55iYXNlNjTmlbDmja7kvZzkuLrlm77niYdVUkwKICAgICAgICAgICAgcmVzb2x2ZSh7CiAgICAgICAgICAgICAgdXJsOiBiYXNlNjREYXRhCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfTsKICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gKCkgPT4gewogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCfmlofku7bor7vlj5blpLHotKUnKSk7CiAgICAgICAgICB9OwogICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Zu+54mH5aSE55CG5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgfQogICAgfTsKCiAgICAvLyDnvJbovpHlmajphY3nva4KICAgIGNvbnN0IGVkaXRvck9wdGlvbnMgPSB7CiAgICAgIHBsYWNlaG9sZGVyOiAnICcsCiAgICAgIG1vZHVsZXM6IHsKICAgICAgICB0b29sYmFyOiB7CiAgICAgICAgICBjb250YWluZXI6IFtbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdzdHJpa2UnXSwgWydibG9ja3F1b3RlJywgJ2NvZGUtYmxvY2snXSwgW3sKICAgICAgICAgICAgJ2hlYWRlcic6IDEKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgJ2hlYWRlcic6IDIKICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnbGlzdCc6ICdvcmRlcmVkJwogICAgICAgICAgfSwgewogICAgICAgICAgICAnbGlzdCc6ICdidWxsZXQnCiAgICAgICAgICB9XSwgW3sKICAgICAgICAgICAgJ3NjcmlwdCc6ICdzdWInCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgICdzY3JpcHQnOiAnc3VwZXInCiAgICAgICAgICB9XSwgW3sKICAgICAgICAgICAgJ2luZGVudCc6ICctMScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgJ2luZGVudCc6ICcrMScKICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnZGlyZWN0aW9uJzogJ3J0bCcKICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnc2l6ZSc6IFsnc21hbGwnLCBmYWxzZSwgJ2xhcmdlJywgJ2h1Z2UnXQogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdoZWFkZXInOiBbMSwgMiwgMywgNCwgNSwgNiwgZmFsc2VdCiAgICAgICAgICB9XSwgW3sKICAgICAgICAgICAgJ2NvbG9yJzogW10KICAgICAgICAgIH0sIHsKICAgICAgICAgICAgJ2JhY2tncm91bmQnOiBbXQogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdmb250JzogW10KICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnYWxpZ24nOiBbXQogICAgICAgICAgfV0sIFsnY2xlYW4nXSwgWydsaW5rJywgJ2ltYWdlJywgJ3RhYmxlJ11dLAogICAgICAgICAgaGFuZGxlcnM6IHsKICAgICAgICAgICAgaW1hZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2ZpbGUnKTsKICAgICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FjY2VwdCcsICdpbWFnZS8qJyk7CiAgICAgICAgICAgICAgaW5wdXQuY2xpY2soKTsKICAgICAgICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBpbnB1dC5maWxlc1swXTsKICAgICAgICAgICAgICAgIGlmICghZmlsZSkgcmV0dXJuOwoKICAgICAgICAgICAgICAgIC8vIOajgOafpeaWh+S7tuWkp+Wwj+WSjOexu+WeiwogICAgICAgICAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IDUgKiAxMDI0ICogMTAyNCkgewogICAgICAgICAgICAgICAgICAvLyA1TULpmZDliLYKICAgICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCflm77niYfkuI3og73otoXov4c1TUInKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIOaUr+aMgeeahOWbvueJh+exu+WeiwogICAgICAgICAgICAgICAgY29uc3Qgc3VwcG9ydGVkVHlwZXMgPSBbJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvcG5nJywgJ2ltYWdlL2dpZicsICdpbWFnZS93ZWJwJ107CiAgICAgICAgICAgICAgICBpZiAoIXN1cHBvcnRlZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHsKICAgICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCflj6rmlK/mjIFKUEfjgIFQTkfjgIFHSUblkoxXRUJQ5qC85byP5Zu+54mHJyk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5pbmZvKCfmraPlnKjlpITnkIblm77niYcuLi4nKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIC8vIOebtOaOpeS8oOmAkuaWh+S7tuWvueixoeiAjOS4jeaYr0Zvcm1EYXRhCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHVwbG9hZEltYWdlKGZpbGUpOwogICAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSByZXMudXJsOwogICAgICAgICAgICAgICAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCfml6DmlYjnmoTlm77niYdVUkwnKTsKCiAgICAgICAgICAgICAgICAgIC8vIOiOt+WPlue8lui+keWZqOWunuS+i+W5tuaPkuWFpeWbvueJhwogICAgICAgICAgICAgICAgICBjb25zdCBxdWlsbCA9IHF1aWxsSW5zdGFuY2UudmFsdWU7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gcXVpbGwuZ2V0U2VsZWN0aW9uKHRydWUpOwogICAgICAgICAgICAgICAgICBxdWlsbC5pbnNlcnRFbWJlZChyYW5nZS5pbmRleCwgJ2ltYWdlJywgdXJsKTsKCiAgICAgICAgICAgICAgICAgIC8vIOagh+iusOaWh+aho+W3suS/ruaUuQogICAgICAgICAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5Zu+54mH5o+S5YWl5oiQ5YqfJyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WbvueJh+WkhOeQhuWksei0pTonLCBlKTsKICAgICAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCflm77niYflpITnkIblpLHotKU6ICcgKyBlLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8g6K6h566X5bGe5oCnCiAgICBjb25zdCBmaWx0ZXJlZERvY3VtZW50cyA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgbGV0IHJlc3VsdCA9IFsuLi5kb2N1bWVudHMudmFsdWVdOwoKICAgICAgLy8g5pCc57Si562b6YCJCiAgICAgIGlmIChzZWFyY2hRdWVyeS52YWx1ZSkgewogICAgICAgIGNvbnN0IHF1ZXJ5ID0gc2VhcmNoUXVlcnkudmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgICByZXN1bHQgPSByZXN1bHQuZmlsdGVyKGRvYyA9PiBkb2MudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgZG9jLnR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkpOwogICAgICB9CgogICAgICAvLyDnsbvlnovnrZvpgIkKICAgICAgaWYgKGRvY1R5cGVGaWx0ZXIudmFsdWUpIHsKICAgICAgICBjb25zdCB0eXBlRmlsdGVyID0gZG9jVHlwZUZpbHRlci52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoZG9jID0+IGRvYy50eXBlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModHlwZUZpbHRlcikpOwogICAgICB9CgogICAgICAvLyDmjpLluo8KICAgICAgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgcmVzdWx0LnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIudXBkYXRlX3RpbWUpIC0gbmV3IERhdGUoYS51cGRhdGVfdGltZSkpOwogICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICdjcmVhdGUnKSB7CiAgICAgICAgcmVzdWx0LnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIuY3JlYXRlX3RpbWUpIC0gbmV3IERhdGUoYS5jcmVhdGVfdGltZSkpOwogICAgICB9IGVsc2UgaWYgKHNvcnRPcHRpb24udmFsdWUgPT09ICduYW1lLWFzYycpIHsKICAgICAgICByZXN1bHQuc29ydCgoYSwgYikgPT4gYS50aXRsZS5sb2NhbGVDb21wYXJlKGIudGl0bGUpKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSk7CgogICAgLy8g5pa55rOVCiAgICBjb25zdCBmZXRjaERvY3VtZW50cyA9IGFzeW5jIChwYWdlID0gMSwgYWxsRG9jcyA9IFtdKSA9PiB7CiAgICAgIGlmIChwYWdlID09PSAxKSB7CiAgICAgICAgZG9jdW1lbnRzTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICBjb25zb2xlLmxvZyhg5byA5aeL6I635Y+W5paH5qGj5YiX6KGoIOesrCR7cGFnZX3pobUuLi5gKTsKICAgICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgbGltaXQ6IDEwMCwKICAgICAgICAgIC8vIOWwneivleivt+axguabtOWkmu+8jOWwveeuoeWQjuerr+WPr+iDveWPquS8mui/lOWbnjEw5p2h77yI6buY6K6kUEFHRV9TSVpF77yJCiAgICAgICAgICBfdDogbmV3IERhdGUoKS5nZXRUaW1lKCkgLy8g5re75Yqg5pe26Ze05oiz77yM56Gu5L+d5LiN5L2/55So57yT5a2YCiAgICAgICAgfTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldERvY3VtZW50cyhwYXJhbXMpOwogICAgICAgIGNvbnNvbGUubG9nKGDmlofmoaPliJfooajlk43lupQo56ysJHtwYWdlfemhtSk6YCwgcmVzcG9uc2UpOwoKICAgICAgICAvLyDlpITnkIbojrflj5bliLDnmoTmlbDmja4KICAgICAgICBsZXQgZG9jc0xpc3QgPSBbLi4uYWxsRG9jc107CiAgICAgICAgbGV0IHRvdGFsQ291bnQgPSAwOwogICAgICAgIGxldCBjdXJyZW50UGFnZURvY3MgPSBbXTsKICAgICAgICBsZXQgaGFzTW9yZSA9IGZhbHNlOwoKICAgICAgICAvLyDlpITnkIbkuI3lkIzmoLzlvI/nmoTlk43lupQKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEpKSB7CiAgICAgICAgICBjdXJyZW50UGFnZURvY3MgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgdG90YWxDb3VudCA9IHJlc3BvbnNlLmNvdW50IHx8IHJlc3BvbnNlLnRvdGFsIHx8IDA7CiAgICAgICAgICBoYXNNb3JlID0gZG9jc0xpc3QubGVuZ3RoICsgY3VycmVudFBhZ2VEb2NzLmxlbmd0aCA8IHRvdGFsQ291bnQ7CiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5yZXN1bHRzICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2UucmVzdWx0cykpIHsKICAgICAgICAgIGN1cnJlbnRQYWdlRG9jcyA9IHJlc3BvbnNlLnJlc3VsdHM7CiAgICAgICAgICB0b3RhbENvdW50ID0gcmVzcG9uc2UuY291bnQgfHwgMDsKICAgICAgICAgIGhhc01vcmUgPSAhIXJlc3BvbnNlLm5leHQ7CiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEucmVzdWx0cyAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEucmVzdWx0cykpIHsKICAgICAgICAgIGN1cnJlbnRQYWdlRG9jcyA9IHJlc3BvbnNlLmRhdGEucmVzdWx0czsKICAgICAgICAgIHRvdGFsQ291bnQgPSByZXNwb25zZS5kYXRhLmNvdW50IHx8IDA7CiAgICAgICAgICBoYXNNb3JlID0gISFyZXNwb25zZS5kYXRhLm5leHQ7CiAgICAgICAgfQoKICAgICAgICAvLyDnoa7kv53kuI3mt7vliqDph43lpI3nmoTmlofmoaMKICAgICAgICBjb25zdCBleGlzdGluZ0lkcyA9IG5ldyBTZXQoZG9jc0xpc3QubWFwKGRvYyA9PiBkb2MuaWQpKTsKICAgICAgICBjb25zdCBuZXdEb2NzID0gY3VycmVudFBhZ2VEb2NzLmZpbHRlcihkb2MgPT4gIWV4aXN0aW5nSWRzLmhhcyhkb2MuaWQpKTsKICAgICAgICBpZiAobmV3RG9jcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBkb2NzTGlzdCA9IFsuLi5kb2NzTGlzdCwgLi4ubmV3RG9jc107CiAgICAgICAgICBjb25zb2xlLmxvZyhg56ysJHtwYWdlfemhtea3u+WKoOS6hiR7bmV3RG9jcy5sZW5ndGh95Liq5paw5paH5qGj77yM5b2T5YmN5YWx5pyJJHtkb2NzTGlzdC5sZW5ndGh95Liq5paH5qGjYCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGDnrKwke3BhZ2V96aG15rKh5pyJ5paw5paH5qGj77yM5Y+v6IO95piv6L6+5Yiw5LqG5pyr5bC+5oiW5Ye6546w5LqG6YeN5aSN5pWw5o2uYCk7CiAgICAgICAgfQoKICAgICAgICAvLyDmm7TmlrDmlofmoaPliJfooagKICAgICAgICBkb2N1bWVudHMudmFsdWUgPSBkb2NzTGlzdDsKCiAgICAgICAgLy8g5aaC5p6c5rKh5pyJ5pu05aSa5pWw5o2u5oiW5bey57uP5Yqg6L295LqG6Laz5aSf5aSa55qE5paH5qGj77yM5YiZ5YGc5q2i6YCS5b2SCiAgICAgICAgaWYgKCFoYXNNb3JlIHx8IGN1cnJlbnRQYWdlRG9jcy5sZW5ndGggPT09IDAgfHwgcGFnZSA+PSA1MCkgewogICAgICAgICAgY29uc29sZS5sb2coYOaWh+aho+WKoOi9veWujOaIkO+8jOWFsSR7ZG9jc0xpc3QubGVuZ3RofeS4quaWh+ahoyR7aGFzTW9yZSA/ICfvvIjkvYbov5jmnInmm7TlpJrvvIknIDogJyd9YCk7CiAgICAgICAgICBkb2N1bWVudHNMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm4gZG9jc0xpc3Q7CiAgICAgICAgfQoKICAgICAgICAvLyDlpoLmnpzmlofmoaPmlbDph4/lpKrlsJHvvIjmr5TlpoLlsI/kuo41MO+8ie+8jOW5tuS4lOacieabtOWkmuaVsOaNru+8jOe7p+e7reWKoOi9veS4i+S4gOmhtQogICAgICAgIGlmIChkb2NzTGlzdC5sZW5ndGggPCAyMDAgJiYgaGFzTW9yZSkgewogICAgICAgICAgY29uc29sZS5sb2coYOW3suiOt+WPliAke2RvY3NMaXN0Lmxlbmd0aH0vJHt0b3RhbENvdW50IHx8ICfmnKrnn6UnfSDkuKrmlofmoaPvvIzliqDovb3kuIvkuIDpobUuLi5gKTsKICAgICAgICAgIC8vIOW7tui/nzEwMG1z6YG/5YWN6K+35rGC6L+H5LqO6aKR57mBCiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7CiAgICAgICAgICAvLyDpgJLlvZLliqDovb3kuIvkuIDpobUKICAgICAgICAgIHJldHVybiBmZXRjaERvY3VtZW50cyhwYWdlICsgMSwgZG9jc0xpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhg5bey5Yqg6L296Laz5aSf55qE5paH5qGjKCR7ZG9jc0xpc3QubGVuZ3RofeS4qinmiJbovr7liLDpmZDliLbvvIzlgZzmraLliqDovb3mm7TlpJpgKTsKICAgICAgICAgIGRvY3VtZW50c0xvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIHJldHVybiBkb2NzTGlzdDsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5paH5qGj5YiX6KGo5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign6I635Y+W5paH5qGj5YiX6KGo5aSx6LSl77yM5bey5Yqg6L296YOo5YiG5pWw5o2uJyk7CiAgICAgICAgZG9jdW1lbnRzTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgIGRvY3VtZW50cy52YWx1ZSA9IGFsbERvY3M7IC8vIOS/neeVmeW3suWKoOi9veeahOaWh+ahowogICAgICAgIHJldHVybiBhbGxEb2NzOwogICAgICB9CiAgICB9OwogICAgY29uc3QgbG9hZGluZyA9IHJlZihmYWxzZSk7CgogICAgLy8g5re75Yqg5LiA5Liq5paH5qGj57yT5a2Y5a+56LGhCiAgICBjb25zdCBkb2N1bWVudENhY2hlID0gcmVmKG5ldyBNYXAoKSk7CiAgICBjb25zdCBzZWxlY3REb2N1bWVudCA9IGFzeW5jIGlkID0+IHsKICAgICAgdmFyIF9jdXJyZW50RG9jJHZhbHVlOwogICAgICBjb25zb2xlLmxvZyhg6YCJ5oup5paH5qGjOiAke2lkfSwg5b2T5YmN5paH5qGjOiAkeyhfY3VycmVudERvYyR2YWx1ZSA9IGN1cnJlbnREb2MudmFsdWUpID09PSBudWxsIHx8IF9jdXJyZW50RG9jJHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY3VycmVudERvYyR2YWx1ZS5pZH1gKTsKCiAgICAgIC8vIOWmguaenOeCueWHu+eahOaYr+W9k+WJjeaWh+aho++8jOS4jeaJp+ihjOS7u+S9leaTjeS9nAogICAgICBpZiAoY3VycmVudERvYy52YWx1ZSAmJiBjdXJyZW50RG9jLnZhbHVlLmlkID09PSBpZCkgewogICAgICAgIGNvbnNvbGUubG9nKCflt7Lnu4/pgInkuK3or6XmlofmoaPvvIzkuI3miafooYzku7vkvZXmk43kvZwnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIOWmguaenOW9k+WJjeaWh+aho+W3suS/ruaUue+8jOaPkOekuuS/neWtmAogICAgICBpZiAoZG9jdW1lbnRDaGFuZ2VkLnZhbHVlICYmIGN1cnJlbnREb2MudmFsdWUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgYXdhaXQgRWxNZXNzYWdlQm94LmNvbmZpcm0oJ+W9k+WJjeaWh+aho+W3suS/ruaUueS9huacquS/neWtmO+8jOaYr+WQpuS/neWtmOabtOaUue+8nycsICfkv53lrZjmj5DnpLonLCB7CiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn5L+d5a2YJywKICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+S4jeS/neWtmCcsCiAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJywKICAgICAgICAgICAgZGlzdGluZ3Vpc2hDYW5jZWxBbmRDbG9zZTogdHJ1ZSAvLyDlhYHorrjljLrliIblj5bmtojlkozlhbPpl60KICAgICAgICAgIH0pOwogICAgICAgICAgYXdhaXQgc2F2ZURvY3VtZW50KCk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIC8vIOeUqOaIt+mAieaLqeS4jeS/neWtmOaIlueCucOX77yM5pKk6ZSA5pys5Zyw5pu05pS577yM5oGi5aSN5Y6f5YaF5a65CiAgICAgICAgICBpZiAoZXJyb3IgPT09ICdjYW5jZWwnIHx8IGVycm9yID09PSAnY2xvc2UnKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50RG9jLnZhbHVlICYmIG9yaWdpbmFsRG9jLnZhbHVlKSB7CiAgICAgICAgICAgICAgY3VycmVudERvYy52YWx1ZS50aXRsZSA9IG9yaWdpbmFsRG9jLnZhbHVlLnRpdGxlOwogICAgICAgICAgICAgIGN1cnJlbnREb2MudmFsdWUudHlwZSA9IG9yaWdpbmFsRG9jLnZhbHVlLnR5cGU7CiAgICAgICAgICAgICAgY3VycmVudERvYy52YWx1ZS5jb250ZW50ID0gb3JpZ2luYWxEb2MudmFsdWUuY29udGVudDsKICAgICAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLy8g55So5oi36YCJ5oup5LiN5L+d5a2Y77yM57un57ut5YiH5o2i5paH5qGjCiAgICAgICAgfQogICAgICB9CgogICAgICAvLyDlv6vpgJ/mmL7npLrnvJPlrZjkuK3nmoTmlofmoaPvvIjlpoLmnpzmnInvvIkKICAgICAgaWYgKGRvY3VtZW50Q2FjaGUudmFsdWUuaGFzKGlkKSkgewogICAgICAgIGNvbnNvbGUubG9nKGDkvb/nlKjnvJPlrZjnmoTmlofmoaPmlbDmja46ICR7aWR9YCk7CiAgICAgICAgY29uc3QgY2FjaGVkRG9jID0gZG9jdW1lbnRDYWNoZS52YWx1ZS5nZXQoaWQpOwoKICAgICAgICAvLyDlhYjorr7nva7lvZPliY3mlofmoaPkuLrnvJPlrZjmlbDmja7vvIzmj5Dpq5jnlKjmiLfkvZPpqowKICAgICAgICBjdXJyZW50RG9jLnZhbHVlID0gY2FjaGVkRG9jOwogICAgICAgIG9yaWdpbmFsRG9jLnZhbHVlID0gewogICAgICAgICAgdGl0bGU6IGNhY2hlZERvYy50aXRsZSB8fCAnJywKICAgICAgICAgIHR5cGU6IGNhY2hlZERvYy50eXBlIHx8ICfpgJrnlKgnLAogICAgICAgICAgY29udGVudDogY2FjaGVkRG9jLmNvbnRlbnQgfHwgJycKICAgICAgICB9OwogICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IGZhbHNlOwogICAgICB9CgogICAgICAvLyDmm7TmlrDot6/nlLHku6Xlj43mmKDmlrDpgInkuK3nmoTmlofmoaMKICAgICAgcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpZAogICAgICAgIH0sCiAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICB9KTsKICAgIH07CgogICAgLy8g6K6w5b2V5Yid5aeL5YaF5a6555So5LqO5a+55q+UCiAgICBjb25zdCBvcmlnaW5hbERvYyA9IHJlZih7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdHlwZTogJycsCiAgICAgIGNvbnRlbnQ6ICcnCiAgICB9KTsKICAgIGNvbnN0IGZldGNoRG9jdW1lbnREZXRhaWwgPSBhc3luYyAoaWQsIHJldHJ5ID0gMCkgPT4gewogICAgICAvLyDlpoLmnpzmmK/lkIzkuIDkuKrmlofmoaPvvIzkuJTlt7LliqDovb3vvIzkuI3ph43lpI3liqDovb0KICAgICAgaWYgKGN1cnJlbnREb2MudmFsdWUgJiYgY3VycmVudERvYy52YWx1ZS5pZCA9PT0gaWQgJiYgIWxvYWRpbmcudmFsdWUpIHsKICAgICAgICBjb25zb2xlLmxvZyhg5paH5qGjICR7aWR9IOW3suWKoOi9ve+8jOS4jemHjeWkjeiOt+WPlmApOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zb2xlLmxvZyhg5q2j5Zyo6I635Y+W5paH5qGj6K+m5oOF77yMSUQ6ICR7aWR9YCk7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXREb2N1bWVudERldGFpbChpZCk7CiAgICAgICAgY29uc29sZS5sb2coJ+aWh+aho+ivpuaDheWTjeW6lDonLCByZXNwb25zZSk7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIC8vIOehruS/neaWh+aho+aVsOaNruWujOaVtAogICAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhLmNvbnRlbnQpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCfmlofmoaPlhoXlrrnkuLrnqbrvvIzorr7nva7kuLrpu5jorqTnqbrlrZfnrKbkuLInKTsKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5jb250ZW50ID0gJyc7CiAgICAgICAgICB9CgogICAgICAgICAgLy8g5L+d5a2Y5paH5qGj5pWw5o2uCiAgICAgICAgICBjdXJyZW50RG9jLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICAvLyDmm7TmlrDnvJPlrZgKICAgICAgICAgIGRvY3VtZW50Q2FjaGUudmFsdWUuc2V0KGlkLCB7CiAgICAgICAgICAgIC4uLnJlc3BvbnNlLmRhdGEKICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIOWmguaenOe8k+WtmOi/h+Wkp++8jOa4heeQhuaXp+e8k+WtmAogICAgICAgICAgaWYgKGRvY3VtZW50Q2FjaGUudmFsdWUuc2l6ZSA+IDIwKSB7CiAgICAgICAgICAgIC8vIOi9rOaNouS4uuaVsOe7hO+8jOS/neeVmeacgOi/keeahDEw5LiqCiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50Q2FjaGUudmFsdWUuZW50cmllcygpKTsKICAgICAgICAgICAgY29uc3QgcmVjZW50RW50cmllcyA9IGVudHJpZXMuc2xpY2UoLTEwKTsKICAgICAgICAgICAgZG9jdW1lbnRDYWNoZS52YWx1ZSA9IG5ldyBNYXAocmVjZW50RW50cmllcyk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8g6K6w5b2V5Yid5aeL5YaF5a65CiAgICAgICAgICBvcmlnaW5hbERvYy52YWx1ZSA9IHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEudGl0bGUgfHwgJycsCiAgICAgICAgICAgIHR5cGU6IHJlc3BvbnNlLmRhdGEudHlwZSB8fCAn6YCa55SoJywKICAgICAgICAgICAgY29udGVudDogcmVzcG9uc2UuZGF0YS5jb250ZW50IHx8ICcnCiAgICAgICAgICB9OwogICAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CgogICAgICAgICAgLy8g5qOA5p+l5pWw5o2u5a6M5pW05oCnCiAgICAgICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUuY29udGVudCkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oJ+aWh+aho+WGheWuueWPr+iDvee8uuWkse+8jOWwneivlemHjeaWsOiOt+WPlicpOwogICAgICAgICAgICAvLyDorr7nva7kuIDkuKrlrprml7blmajvvIzlnKjnvJbovpHlmajliqDovb3lrozmiJDlkI7mo4Dmn6XlhoXlrrkKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHF1aWxsSW5zdGFuY2UudmFsdWUgJiYgKCFjdXJyZW50RG9jLnZhbHVlLmNvbnRlbnQgfHwgY3VycmVudERvYy52YWx1ZS5jb250ZW50LnRyaW0oKSA9PT0gJycpKSB7CiAgICAgICAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn5paH5qGj5YaF5a655Y+v6IO95LiN5a6M5pW077yM6K+35bCd6K+V5Yi35paw6aG16Z2iJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfmlofmoaPkuI3lrZjlnKjmiJbmlbDmja7ml6DmlYgnKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W5paH5qGj6K+m5oOF5aSx6LSlJywgZXJyb3IpOwogICAgICAgIGlmIChyZXRyeSA8IDMpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGDojrflj5bmlofmoaPor6bmg4XlpLHotKXvvIwke3JldHJ5ICsgMX3np5LlkI7ph43or5UuLi5gKTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZmV0Y2hEb2N1bWVudERldGFpbChpZCwgcmV0cnkgKyAxKSwgMTAwMCAqIChyZXRyeSArIDEpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgY29uc29sZS5lcnJvcign5aSa5qyh6YeN6K+V5ZCO6I635Y+W5paH5qGj6K+m5oOF5LuN54S25aSx6LSlJywgZXJyb3IpOwogICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCA/ICfmlofmoaPkuI3lrZjlnKgnIDogZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YSAmJiBlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCA/IGVycm9yLnJlc3BvbnNlLmRhdGEuZGV0YWlsIDogJ+iOt+WPluaWh+aho+ivpuaDheWksei0pSc7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoZXJyb3JNc2cpOwogICAgICAgICAgLy8g5aaC5p6c5pivNDA077yM5a+86Iiq5Zue5paH5qGj5YiX6KGo6aG1CiAgICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIGNvbnN0IHNhdmVEb2N1bWVudCA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8ICFkb2N1bWVudENoYW5nZWQudmFsdWUpIHJldHVybjsKICAgICAgc2F2ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IHVwZGF0ZURvY3VtZW50KGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHRpdGxlOiBjdXJyZW50RG9jLnZhbHVlLnRpdGxlLAogICAgICAgICAgdHlwZTogY3VycmVudERvYy52YWx1ZS50eXBlLAogICAgICAgICAgY29udGVudDogY3VycmVudERvYy52YWx1ZS5jb250ZW50CiAgICAgICAgfSk7CgogICAgICAgIC8vIOS/neWtmOaIkOWKn+WQju+8jOabtOaWsOWOn+Wni+aWh+aho+iusOW9lQogICAgICAgIG9yaWdpbmFsRG9jLnZhbHVlID0gewogICAgICAgICAgdGl0bGU6IGN1cnJlbnREb2MudmFsdWUudGl0bGUsCiAgICAgICAgICB0eXBlOiBjdXJyZW50RG9jLnZhbHVlLnR5cGUsCiAgICAgICAgICBjb250ZW50OiBjdXJyZW50RG9jLnZhbHVlLmNvbnRlbnQKICAgICAgICB9OwogICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IGZhbHNlOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPkv53lrZjmiJDlip8nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfkv53lrZjmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfkv53lrZjmlofmoaPlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBzYXZlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgdG9nZ2xlRG9jTGlzdCA9ICgpID0+IHsKICAgICAgaXNEb2NMaXN0Q29sbGFwc2VkLnZhbHVlID0gIWlzRG9jTGlzdENvbGxhcHNlZC52YWx1ZTsKICAgIH07CiAgICBjb25zdCB0b2dnbGVBc3Npc3RhbnQgPSAoKSA9PiB7CiAgICAgIGlzQXNzaXN0YW50Q29sbGFwc2VkLnZhbHVlID0gIWlzQXNzaXN0YW50Q29sbGFwc2VkLnZhbHVlOwogICAgfTsKICAgIGNvbnN0IG9uRWRpdG9yQ2hhbmdlID0gKCkgPT4gewogICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgfTsKICAgIGNvbnN0IG9wZW5OZXdEb2N1bWVudERpYWxvZyA9ICgpID0+IHsKICAgICAgbmV3RG9jdW1lbnRGb3JtLnZhbHVlID0gewogICAgICAgIHRpdGxlOiAnJywKICAgICAgICB0eXBlOiAnJwogICAgICB9OwogICAgICBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKICAgIGNvbnN0IGNyZWF0ZU5ld0RvY3VtZW50ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWRvY3VtZW50Rm9ybVJlZi52YWx1ZSkgcmV0dXJuOwogICAgICBhd2FpdCBkb2N1bWVudEZvcm1SZWYudmFsdWUudmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNyZWF0ZURvY3VtZW50KHsKICAgICAgICAgICAgICB0aXRsZTogbmV3RG9jdW1lbnRGb3JtLnZhbHVlLnRpdGxlLAogICAgICAgICAgICAgIHR5cGU6IG5ld0RvY3VtZW50Rm9ybS52YWx1ZS50eXBlIHx8ICfpgJrnlKgnLAogICAgICAgICAgICAgIGNvbnRlbnQ6ICcnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5qGj5Yib5bu65oiQ5YqfJyk7CiAgICAgICAgICAgIG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgICAgLy8g5Yi35paw5paH5qGj5YiX6KGo5bm25omT5byA5paw5paH5qGjCiAgICAgICAgICAgIGF3YWl0IGZldGNoRG9jdW1lbnRzKCk7CiAgICAgICAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnU21hcnREb2NEZXRhaWwnLAogICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgaWQ6IHJlc3BvbnNlLmRhdGEuaWQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign5Yib5bu65paH5qGj5aSx6LSlJywgZXJyb3IpOwogICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIm+W7uuaWh+aho+Wksei0pScpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY3JlYXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3Qgc2hhcmVEb2N1bWVudCA9ICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlKSByZXR1cm47CgogICAgICAvLyDlnKjlrp7pmYXpobnnm67kuK3vvIzov5nph4zlupTor6Xku45BUEnojrflj5blj6/nlKjnlKjmiLfliJfooagKICAgICAgYXZhaWxhYmxlVXNlcnMudmFsdWUgPSBbewogICAgICAgIGlkOiAxLAogICAgICAgIHVzZXJuYW1lOiAn5byg5LiJJwogICAgICB9LCB7CiAgICAgICAgaWQ6IDIsCiAgICAgICAgdXNlcm5hbWU6ICfmnY7lm5snCiAgICAgIH0sIHsKICAgICAgICBpZDogMywKICAgICAgICB1c2VybmFtZTogJ+eOi+S6lCcKICAgICAgfV07CiAgICAgIHNlbGVjdGVkVXNlcnMudmFsdWUgPSBbXTsKICAgICAgc2hhcmVEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBjb25maXJtU2hhcmUgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSB8fCBzZWxlY3RlZFVzZXJzLnZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfor7fpgInmi6noh7PlsJHkuIDkuKrnlKjmiLcnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2hhcmVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBhcGlTaGFyZURvY3VtZW50KGN1cnJlbnREb2MudmFsdWUuaWQsIHNlbGVjdGVkVXNlcnMudmFsdWUpOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPliIbkuqvmiJDlip8nKTsKICAgICAgICBzaGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfliIbkuqvmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliIbkuqvmlofmoaPlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGRlbGV0ZURvY3VtZW50ID0gKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3QgY29uZmlybURlbGV0ZSA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlKSByZXR1cm47CiAgICAgIGRlbGV0ZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIC8vIOiusOW9leWwhuimgeWIoOmZpOeahOaWh+aho0lE77yM5L6/5LqO6LCD6K+VCiAgICAgICAgY29uc3QgZGVsZXRlZERvY0lkID0gY3VycmVudERvYy52YWx1ZS5pZDsKCiAgICAgICAgLy8g5omn6KGM5Yig6ZmkQVBJ6LCD55SoCiAgICAgICAgYXdhaXQgYXBpRGVsZXRlRG9jdW1lbnQoZGVsZXRlZERvY0lkKTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5qGj5Yig6Zmk5oiQ5YqfJyk7CiAgICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKGDmlofmoaPlt7LliKDpmaTvvIxJRDogJHtkZWxldGVkRG9jSWR977yM5YeG5aSH6L+U5Zue5YiX6KGo6aG16Z2i5bm25Yi35pawYCk7CgogICAgICAgIC8vIOa4hemZpOWPr+iDveeahOe8k+WtmOaVsOaNrgogICAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICAvLyDnp7vpmaTlj6/og73lrZjlnKjnmoTnm7jlhbPnvJPlrZgKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oYGRvY19jYWNoZV8ke2RlbGV0ZWREb2NJZH1gKTsKICAgICAgICAgICAgLy8g56e76Zmk5paH5qGj5YiX6KGo57yT5a2Y77yM56Gu5L+d5YaN5qyh5Yqg6L295pe26I635Y+W5pyA5paw5pWw5o2uCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGBkb2NfbGlzdF9jYWNoZWApOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfmuIXpmaTmnKzlnLDnvJPlrZjlpLHotKU6JywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyDmuIXpmaTlvZPliY3mlofmoaPnirbmgIHvvIzpgb/lhY3lj6/og73nmoTlhoXlrZjms4TmvI8KICAgICAgICBjdXJyZW50RG9jLnZhbHVlID0gbnVsbDsKCiAgICAgICAgLy8g5L2/55Sod2luZG93LmxvY2F0aW9uLmhyZWbogIzkuI3mmK9yb3V0ZXIucmVwbGFjZe+8jOW8uuWItuaVtOS4qumhtemdouWIt+aWsAogICAgICAgIC8vIOa3u+WKoOaXtumXtOaIs+WPguaVsO+8jOehruS/neS4jei1sOe8k+WtmAogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9zbWFydGRvYz9fcmVmcmVzaD0nICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yig6Zmk5paH5qGj5aSx6LSlJywgZXJyb3IpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yig6Zmk5paH5qGj5aSx6LSlJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgZGVsZXRlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZXhwb3J0RG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIEVsTWVzc2FnZUJveCh7CiAgICAgICAgdGl0bGU6ICflr7zlh7rmlofmoaMnLAogICAgICAgIG1lc3NhZ2U6ICfor7fpgInmi6nlr7zlh7rmoLzlvI8nLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICflr7zlh7rkuLpQREYnLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflr7zlh7rkuLpXb3JkJywKICAgICAgICBjbG9zZU9uQ2xpY2tNb2RhbDogdHJ1ZSwKICAgICAgICBjYWxsYmFjazogYWN0aW9uID0+IHsKICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdjb25maXJtJykgewogICAgICAgICAgICBleHBvcnRUb1BkZigpOwogICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdjYW5jZWwnKSB7CiAgICAgICAgICAgIGV4cG9ydFRvV29yZCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIC8vIOWvvOWHuuS4ulBERgogICAgY29uc3QgZXhwb3J0VG9QZGYgPSAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSB8fCAhY3VycmVudERvYy52YWx1ZS5jb250ZW50KSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmsqHmnInlj6/lr7zlh7rnmoTmlofmoaMnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgZG9jVGl0bGUgPSBjdXJyZW50RG9jLnZhbHVlLnRpdGxlIHx8ICfmnKrlkb3lkI3mlofmoaMnOwogICAgICBjb25zdCBmaWxlbmFtZSA9IGAke2RvY1RpdGxlfS5wZGZgOwogICAgICAvLyDnm7TmjqXlhYvpmoZxdWlsbOe8lui+keWZqOWGheWuuQogICAgICBjb25zdCBlZGl0b3JEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucWwtZWRpdG9yJyk7CiAgICAgIGlmICghZWRpdG9yRG9tKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmnKrmib7liLDnvJbovpHlmajlhoXlrrknKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgY29udGVudEVsZW1lbnQgPSBlZGl0b3JEb20uY2xvbmVOb2RlKHRydWUpOwogICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgIG1hcmdpbjogWzE1LCAxNSwgMTUsIDE1XSwKICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWUsCiAgICAgICAgaW1hZ2U6IHsKICAgICAgICAgIHR5cGU6ICdqcGVnJywKICAgICAgICAgIHF1YWxpdHk6IDAuOTgKICAgICAgICB9LAogICAgICAgIGh0bWwyY2FudmFzOiB7CiAgICAgICAgICBzY2FsZTogMiwKICAgICAgICAgIHVzZUNPUlM6IHRydWUKICAgICAgICB9LAogICAgICAgIGpzUERGOiB7CiAgICAgICAgICB1bml0OiAnbW0nLAogICAgICAgICAgZm9ybWF0OiAnYTQnLAogICAgICAgICAgb3JpZW50YXRpb246ICdwb3J0cmFpdCcKICAgICAgICB9CiAgICAgIH07CiAgICAgIGNvbnN0IGxvYWRpbmcgPSBFbExvYWRpbmcuc2VydmljZSh7CiAgICAgICAgbG9jazogdHJ1ZSwKICAgICAgICB0ZXh0OiAn5q2j5Zyo55Sf5oiQUERGLi4uJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpJwogICAgICB9KTsKICAgICAgaW1wb3J0KCdodG1sMnBkZi5qcycpLnRoZW4oaHRtbDJwZGZNb2R1bGUgPT4gewogICAgICAgIGNvbnN0IGh0bWwycGRmID0gaHRtbDJwZGZNb2R1bGUuZGVmYXVsdDsKICAgICAgICBodG1sMnBkZigpLmZyb20oY29udGVudEVsZW1lbnQpLnNldChvcHRpb25zKS5zYXZlKCkudGhlbigoKSA9PiB7CiAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2VzcygnUERG5a+85Ye65oiQ5YqfJyk7CiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcignUERG5a+85Ye65aSx6LSlOicsIGVycm9yKTsKICAgICAgICAgIGxvYWRpbmcuY2xvc2UoKTsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcignUERG5a+85Ye65aSx6LSlJyk7CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb1odG1sMnBkZi5qc+Wksei0pTonLCBlcnJvcik7CiAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcignUERG5a+85Ye65Yqf6IO95Yqg6L295aSx6LSlJyk7CiAgICAgIH0pOwogICAgfTsKCiAgICAvLyDlr7zlh7rkuLpXb3Jk77yI5L+d55WZ5Zu+54mH77yJCiAgICBjb25zdCBleHBvcnRUb1dvcmQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSB8fCAhY3VycmVudERvYy52YWx1ZS5jb250ZW50KSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmsqHmnInlj6/lr7zlh7rnmoTmlofmoaMnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgZG9jVGl0bGUgPSBjdXJyZW50RG9jLnZhbHVlLnRpdGxlIHx8ICfmnKrlkb3lkI3mlofmoaMnOwogICAgICBjb25zdCBmaWxlbmFtZSA9IGAke2RvY1RpdGxlfS5kb2NgOwogICAgICBjb25zdCBsb2FkaW5nID0gRWxMb2FkaW5nLnNlcnZpY2UoewogICAgICAgIGxvY2s6IHRydWUsCiAgICAgICAgdGV4dDogJ+ato+WcqOeUn+aIkFdvcmTmlofmoaMuLi4nLAogICAgICAgIGJhY2tncm91bmQ6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNyknCiAgICAgIH0pOwogICAgICB0cnkgewogICAgICAgIC8vIOWIm+W7uuS4gOS4quS4tOaXtuaWh+aho+WuueWZqOWkhOeQhuWGheWuuQogICAgICAgIGNvbnN0IGNvbnRlbnRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBjb250ZW50Q29udGFpbmVyLmlubmVySFRNTCA9IGN1cnJlbnREb2MudmFsdWUuY29udGVudDsKICAgICAgICAvLyDkuI3lho3mm7/mjaLlm77niYfkuLrljaDkvY3nrKbvvIznm7TmjqXkv53nlZk8aW1nPuagh+etvgogICAgICAgIC8vIOWIm+W7uuW+rui9r1dvcmTlhbzlrrnnmoRIVE1M5paH5qGjCiAgICAgICAgY29uc3QgbXNXb3JkSHRtbCA9IGAKICAgICAgICAgIDxodG1sIHhtbG5zOm89InVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgCiAgICAgICAgICAgICAgICB4bWxuczp3PSJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTp3b3JkIiAKICAgICAgICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwIj4KICAgICAgICAgIDxoZWFkPgogICAgICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgICAgIDx0aXRsZT4ke2RvY1RpdGxlfTwvdGl0bGU+CiAgICAgICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgICBib2R5IHsgZm9udC1mYW1pbHk6IFNpbVN1biwgQXJpYWwsIHNhbnMtc2VyaWY7IG1hcmdpbjogMWNtOyB9CiAgICAgICAgICAgICAgaW1nIHsgbWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IGF1dG87IH0KICAgICAgICAgICAgICBwIHsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyB9CiAgICAgICAgICAgICAgaDEgeyBmb250LXNpemU6IDE4cHQ7IH0KICAgICAgICAgICAgICBoMiB7IGZvbnQtc2l6ZTogMTZwdDsgfQogICAgICAgICAgICAgIGgzIHsgZm9udC1zaXplOiAxNHB0OyB9CiAgICAgICAgICAgICAgdGFibGUgeyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyB3aWR0aDogMTAwJTsgfQogICAgICAgICAgICAgIHRkLCB0aCB7IGJvcmRlcjogMXB4IHNvbGlkICMwMDA7IHBhZGRpbmc6IDVweDsgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgICAgPC9oZWFkPgogICAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIDxoMT4ke2RvY1RpdGxlfTwvaDE+CiAgICAgICAgICAgICR7Y29udGVudENvbnRhaW5lci5pbm5lckhUTUx9CiAgICAgICAgICA8L2JvZHk+CiAgICAgICAgICA8L2h0bWw+CiAgICAgICAgYDsKICAgICAgICAvLyDkvb/nlKhmaWxlLXNhdmVy5L+d5a2Y5paH5Lu2CiAgICAgICAgY29uc3QgRmlsZVNhdmVyID0gYXdhaXQgaW1wb3J0KCdmaWxlLXNhdmVyJyk7CiAgICAgICAgY29uc3Qgc2F2ZUFzID0gRmlsZVNhdmVyLnNhdmVBcyB8fCBGaWxlU2F2ZXIuZGVmYXVsdDsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW21zV29yZEh0bWxdLCB7CiAgICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vbXN3b3JkJwogICAgICAgIH0pOwogICAgICAgIHNhdmVBcyhibG9iLCBmaWxlbmFtZSk7CiAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCdXb3Jk5paH5qGj5a+85Ye65oiQ5YqfJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignV29yZOWvvOWHuuWksei0pTonLCBlcnJvcik7CiAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICAgIEVsTWVzc2FnZS5lcnJvcihgV29yZOWvvOWHuuWksei0pTogJHtlcnJvci5tZXNzYWdlIHx8ICfmnKrnn6XplJnor68nfWApOwogICAgICB9CiAgICB9OwogICAgY29uc3QgcHJpbnREb2N1bWVudCA9ICgpID0+IHsKICAgICAgRWxNZXNzYWdlLmluZm8oJ+aJk+WNsOaWh+aho+WKn+iDveaaguacquWunueOsCcpOwogICAgfTsKICAgIGNvbnN0IGFkZENvbGxhYm9yYXRvciA9ICgpID0+IHsKICAgICAgRWxNZXNzYWdlLmluZm8oJ+a3u+WKoOWNj+S9nOiAheWKn+iDveaaguacquWunueOsCcpOwogICAgfTsKICAgIGNvbnN0IHZpZXdIaXN0b3J5ID0gKCkgPT4gewogICAgICBFbE1lc3NhZ2UuaW5mbygn5p+l55yL5Y6G5Y+y54mI5pys5Yqf6IO95pqC5pyq5a6e546wJyk7CiAgICB9OwoKICAgIC8vIDEuIOWcqHNldHVw6YeM5Yqg57yT5a2Y5Y+Y6YePCiAgICBjb25zdCBxdWlsbFNlbGVjdGlvbiA9IHJlZihudWxsKTsKICAgIGNvbnN0IHF1aWxsU2VsZWN0ZWRUZXh0ID0gcmVmKCcnKTsKCiAgICAvLyDorqHnrpflsZ7mgKfvvJrliKTmlq3mmK/lkKbmnInmnInmlYjnmoTpgInmi6nmlofmnKzvvIjljrvpmaTnqbrnmb3lrZfnrKblkI7kuI3kuLrnqbrvvIkKICAgIGNvbnN0IGhhc1ZhbGlkU2VsZWN0aW9uID0gY29tcHV0ZWQoKCkgPT4gewogICAgICByZXR1cm4gcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgJiYgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDA7CiAgICB9KTsKCiAgICAvLyAyLiDnm5HlkKxRdWlsbOeahHNlbGVjdGlvbi1jaGFuZ2Xkuovku7YKICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gKHJhbmdlLCBvbGRSYW5nZSwgc291cmNlKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCc9PT0gUXVpbGwgU2VsZWN0aW9uIENoYW5nZSA9PT0nKTsKICAgICAgY29uc29sZS5sb2coJ1JhbmdlOicsIHJhbmdlKTsKICAgICAgY29uc29sZS5sb2coJ09sZCBSYW5nZTonLCBvbGRSYW5nZSk7CiAgICAgIGNvbnNvbGUubG9nKCdTb3VyY2U6Jywgc291cmNlKTsKICAgICAgaWYgKCFxdWlsbEluc3RhbmNlLnZhbHVlKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1F1aWxs5a6e5L6L5LiN5a2Y5ZyoJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyDpmLLmraLlnKjnqIvluo/ljJbmk43kvZzml7bmuIXpmaTpgInmi6nnirbmgIEKICAgICAgaWYgKHNvdXJjZSA9PT0gJ2FwaScgJiYgIXJhbmdlKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FQSeaTjeS9nOWvvOiHtOeahOepuumAieaLqe+8jOW/veeVpScpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAocmFuZ2UgJiYgcmFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IHRleHQgPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFRleHQocmFuZ2UuaW5kZXgsIHJhbmdlLmxlbmd0aCk7CiAgICAgICAgY29uc29sZS5sb2coJ+mAieS4reaWh+acrOmVv+W6pjonLCB0ZXh0Lmxlbmd0aCk7CiAgICAgICAgY29uc29sZS5sb2coJ+mAieS4reaWh+acrOWGheWuuTonLCBKU09OLnN0cmluZ2lmeSh0ZXh0KSk7CiAgICAgICAgY29uc29sZS5sb2coJ+mAieS4reaWh+acrCjmmL7npLopOicsIHRleHQpOwoKICAgICAgICAvLyDkv53lrZjljp/lp4vmlofmnKzvvIzkuI3ov5vooYx0cmlt5aSE55CG77yM56Gu5L+d5LiO5a6e6ZmF6YCJ5oup5LiA6Ie0CiAgICAgICAgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgPSB0ZXh0OwogICAgICAgIHF1aWxsU2VsZWN0aW9uLnZhbHVlID0gewogICAgICAgICAgLi4ucmFuZ2UKICAgICAgICB9OyAvLyDmt7Hmi7fotJ3pgb/lhY3lvJXnlKjpl67popgKCiAgICAgICAgY29uc29sZS5sb2coJ+W3suS/neWtmOmAieaLqeeKtuaAgScpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCfmuIXpmaTpgInmi6nnirbmgIEnKTsKICAgICAgICBxdWlsbFNlbGVjdGVkVGV4dC52YWx1ZSA9ICcnOwogICAgICAgIHF1aWxsU2VsZWN0aW9uLnZhbHVlID0gbnVsbDsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygnPT09IEVuZCBTZWxlY3Rpb24gQ2hhbmdlID09PScpOwogICAgfTsKCiAgICAvLyAxLiDmnIDlpKfplb/luqbluLjph48KICAgIGNvbnN0IE1BWF9BSV9URVhUX0xFTkdUSCA9IDIwMDA7CgogICAgLy8g6L6F5Yqp5Ye95pWw77ya6I635Y+W5b2T5YmN5pyJ5pWI55qE6YCJ5oup5ZKM5a+55bqU5paH5pysCiAgICBjb25zdCBnZXRDdXJyZW50U2VsZWN0aW9uV2l0aFRleHQgPSAoKSA9PiB7CiAgICAgIGlmICghcXVpbGxJbnN0YW5jZS52YWx1ZSkgcmV0dXJuIHsKICAgICAgICBzZWxlY3Rpb246IG51bGwsCiAgICAgICAgdGV4dDogJycKICAgICAgfTsKICAgICAgbGV0IHNlbGVjdGlvbiA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0U2VsZWN0aW9uKCk7CiAgICAgIGxldCB0ZXh0ID0gJyc7CgogICAgICAvLyDlpoLmnpzlvZPliY3mnInpgInmi6nvvIznm7TmjqXkvb/nlKgKICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCkgewogICAgICAgIHRleHQgPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFRleHQoc2VsZWN0aW9uLmluZGV4LCBzZWxlY3Rpb24ubGVuZ3RoKTsKICAgICAgICBjb25zb2xlLmxvZygn5L2/55So5b2T5YmN6YCJ5oupOicsIHsKICAgICAgICAgIHNlbGVjdGlvbiwKICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHRleHQpCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHNlbGVjdGlvbiwKICAgICAgICAgIHRleHQKICAgICAgICB9OwogICAgICB9CgogICAgICAvLyDlpoLmnpzlvZPliY3msqHmnInpgInmi6nvvIzlsJ3or5Xkvb/nlKjnvJPlrZjnmoTpgInmi6nlkozmlofmnKwKICAgICAgaWYgKHF1aWxsU2VsZWN0aW9uLnZhbHVlICYmIHF1aWxsU2VsZWN0aW9uLnZhbHVlLmxlbmd0aCA+IDAgJiYgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUpIHsKICAgICAgICAvLyDpqozor4HnvJPlrZjnmoTpgInmi6nmmK/lkKbku43nhLbmnInmlYgKICAgICAgICBjb25zdCB0ZXh0TGVuZ3RoID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKTsKICAgICAgICBpZiAocXVpbGxTZWxlY3Rpb24udmFsdWUuaW5kZXggKyBxdWlsbFNlbGVjdGlvbi52YWx1ZS5sZW5ndGggPD0gdGV4dExlbmd0aCkgewogICAgICAgICAgLy8g55u05o6l5L2/55So57yT5a2Y55qE5paH5pys77yM6ICM5LiN5piv6YeN5paw6I635Y+W77yM56Gu5L+d5LiA6Ie05oCnCiAgICAgICAgICBzZWxlY3Rpb24gPSBxdWlsbFNlbGVjdGlvbi52YWx1ZTsKICAgICAgICAgIHRleHQgPSBxdWlsbFNlbGVjdGVkVGV4dC52YWx1ZTsKICAgICAgICAgIGNvbnNvbGUubG9nKCfkvb/nlKjnvJPlrZjnmoTpgInmi6nlkozmlofmnKw6JywgewogICAgICAgICAgICBzZWxlY3Rpb24sCiAgICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KHRleHQpCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNlbGVjdGlvbiwKICAgICAgICAgICAgdGV4dAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ+ayoeacieacieaViOeahOmAieaLqScpOwogICAgICByZXR1cm4gewogICAgICAgIHNlbGVjdGlvbjogbnVsbCwKICAgICAgICB0ZXh0OiAnJwogICAgICB9OwogICAgfTsKCiAgICAvLyDkv53mjIHlkJHlkI7lhbzlrrnnmoRnZXRDdXJyZW50U2VsZWN0aW9u5Ye95pWwCiAgICBjb25zdCBnZXRDdXJyZW50U2VsZWN0aW9uID0gKCkgPT4gewogICAgICBjb25zdCByZXN1bHQgPSBnZXRDdXJyZW50U2VsZWN0aW9uV2l0aFRleHQoKTsKICAgICAgcmV0dXJuIHJlc3VsdC5zZWxlY3Rpb247CiAgICB9OwoKICAgIC8vIOi+heWKqeWHveaVsO+8muWuieWFqOWcsOiuvue9rumAieaLqeeKtuaAgQogICAgY29uc3Qgc2FmZVNldFNlbGVjdGlvbiA9IChpbmRleCwgbGVuZ3RoID0gMCwgc291cmNlID0gJ2FwaScpID0+IHsKICAgICAgaWYgKCFxdWlsbEluc3RhbmNlLnZhbHVlKSByZXR1cm47CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgdGV4dExlbmd0aCA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCk7CiAgICAgICAgY29uc3Qgc2FmZUluZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oaW5kZXgsIHRleHRMZW5ndGggLSAxKSk7CiAgICAgICAgY29uc3Qgc2FmZUxlbmd0aCA9IE1hdGgubWF4KDAsIE1hdGgubWluKGxlbmd0aCwgdGV4dExlbmd0aCAtIHNhZmVJbmRleCkpOwogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuc2V0U2VsZWN0aW9uKHNhZmVJbmRleCwgc2FmZUxlbmd0aCwgc291cmNlKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ+iuvue9rumAieaLqeeKtuaAgeWksei0pTonLCBlcnJvcik7CiAgICAgIH0KICAgIH07CgogICAgLy8g5Yi35paw57yW6L6R5Zmo5a6e5L6L55qE5Ye95pWwCiAgICBjb25zdCByZWZyZXNoUXVpbGxFZGl0b3IgPSAoKSA9PiB7CiAgICAgIGlmIChxdWlsbEluc3RhbmNlLnZhbHVlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIOa4hemZpOmAieaLqeeKtuaAgQogICAgICAgICAgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgPSAnJzsKICAgICAgICAgIHF1aWxsU2VsZWN0aW9uLnZhbHVlID0gbnVsbDsKCiAgICAgICAgICAvLyDph43mlrDojrflj5bnhKbngrkKICAgICAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgaWYgKHF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmZvY3VzKCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1F1aWxs57yW6L6R5Zmo5bey5Yi35pawJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oJ+WIt+aWsFF1aWxs57yW6L6R5Zmo5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gMi4gZXhwYW5kQ29udGVudOaWueazleWKoOaIquaWrQogICAgY29uc3QgZXhwYW5kQ29udGVudCA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8IGV4cGFuZExvYWRpbmcudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign57yW6L6R5Zmo5pyq5bCx57uq77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyDkvb/nlKjmlrDnmoTovoXliqnlh73mlbDojrflj5bpgInmi6nlkozmlofmnKwKICAgICAgICBjb25zdCB7CiAgICAgICAgICBzZWxlY3Rpb24sCiAgICAgICAgICB0ZXh0CiAgICAgICAgfSA9IGdldEN1cnJlbnRTZWxlY3Rpb25XaXRoVGV4dCgpOwogICAgICAgIGNvbnNvbGUubG9nKCc9PT0g5omp5YaZ5YaF5a65IC0g6I635Y+W6YCJ5oupID09PScpOwogICAgICAgIGNvbnNvbGUubG9nKCdTZWxlY3Rpb246Jywgc2VsZWN0aW9uKTsKICAgICAgICBjb25zb2xlLmxvZygn5Y6f5aeL5paH5pysOicsIEpTT04uc3RyaW5naWZ5KHRleHQpKTsKICAgICAgICBjb25zb2xlLmxvZygn57yT5a2Y55qE6YCJ5oup5paH5pysOicsIEpTT04uc3RyaW5naWZ5KHF1aWxsU2VsZWN0ZWRUZXh0LnZhbHVlKSk7CiAgICAgICAgbGV0IHNlbGVjdGVkVGV4dCA9IHRleHQudHJpbSgpOwogICAgICAgIGxldCByYW5nZSA9IG51bGw7CiAgICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCAmJiBzZWxlY3RlZFRleHQpIHsKICAgICAgICAgIHJhbmdlID0gewogICAgICAgICAgICAuLi5zZWxlY3Rpb24KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCflpITnkIblkI7nmoTmlofmnKw6JywgSlNPTi5zdHJpbmdpZnkoc2VsZWN0ZWRUZXh0KSk7CiAgICAgICAgY29uc29sZS5sb2coJz09PSBFbmQg5omp5YaZ5YaF5a656I635Y+WID09PScpOwogICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup6KaB5omp5YaZ55qE5paH5pys5YaF5a65Jyk7CiAgICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gTUFYX0FJX1RFWFRfTEVOR1RIKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZyhg6YCJ5Lit5paH5pys6L+H6ZW/77yM5bey6Ieq5Yqo5oiq5pat5Li65YmNJHtNQVhfQUlfVEVYVF9MRU5HVEh95a2XYCk7CiAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UoMCwgTUFYX0FJX1RFWFRfTEVOR1RIKTsKICAgICAgICB9CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOaJqeWGmeWGheWuue+8jOivt+eojeWAmS4uLicpOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpRXhwYW5kQ29udGVudChjdXJyZW50RG9jLnZhbHVlLmlkLCB7CiAgICAgICAgICBzZWxlY3Rpb246IHNlbGVjdGVkVGV4dCwKICAgICAgICAgIGxlbmd0aDogJ21lZGl1bScKICAgICAgICB9KTsKICAgICAgICBzaG93Q29tcGFyZURpYWxvZyh7CiAgICAgICAgICB0aXRsZTogJ+WGheWuueaJqeWGmee7k+aenCcsCiAgICAgICAgICBvcmlnaW5hbDogc2VsZWN0ZWRUZXh0LAogICAgICAgICAgbW9kaWZpZWQ6IHJlc3BvbnNlLmRhdGEuY29udGVudCwKICAgICAgICAgIG9uQXBwbHk6IGZpbmFsQ29udGVudCA9PiB7CiAgICAgICAgICAgIGlmIChyYW5nZSAmJiB0eXBlb2YgcmFuZ2UuaW5kZXggPT09ICdudW1iZXInICYmIHR5cGVvZiByYW5nZS5sZW5ndGggPT09ICdudW1iZXInICYmIHJhbmdlLmluZGV4ID49IDAgJiYgcmFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IHF1aWxsTGVuID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKTsKICAgICAgICAgICAgICBsZXQgaW5zZXJ0UG9zID0gcmFuZ2UuaW5kZXg7CiAgICAgICAgICAgICAgaWYgKGluc2VydFBvcyA+IHF1aWxsTGVuKSBpbnNlcnRQb3MgPSBxdWlsbExlbiAtIDE7CgogICAgICAgICAgICAgIC8vIOS9v+eUqCBBUEkg5rqQ5qCH6K6w77yM6YG/5YWN6Kem5Y+R5LiN5b+F6KaB55qE6YCJ5oup5Y+Y5YyW5LqL5Lu2CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5kZWxldGVUZXh0KGluc2VydFBvcywgcmFuZ2UubGVuZ3RoLCAnYXBpJyk7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5pbnNlcnRUZXh0KGluc2VydFBvcywgZmluYWxDb250ZW50LCAnYXBpJyk7CgogICAgICAgICAgICAgIC8vIOiuvue9ruaWsOeahOmAieaLqeS9jee9rgogICAgICAgICAgICAgIGxldCBzZWxQb3MgPSBpbnNlcnRQb3MgKyBmaW5hbENvbnRlbnQubGVuZ3RoOwogICAgICAgICAgICAgIHNlbFBvcyA9IE1hdGgubWF4KDAsIE1hdGgubWluKHNlbFBvcywgcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSkpOwoKICAgICAgICAgICAgICAvLyDlu7bov5/orr7nva7pgInmi6nvvIznoa7kv53mlofmnKzmj5LlhaXlrozmiJAKICAgICAgICAgICAgICBuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICBzYWZlU2V0U2VsZWN0aW9uKHNlbFBvcywgMCwgJ2FwaScpOwogICAgICAgICAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCflhoXlrrnmianlhpnlt7LlupTnlKgnKTsKICAgICAgICAgICAgICAgIC8vIOWIt+aWsOe8lui+keWZqOWunuS+iwogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgIHJlZnJlc2hRdWlsbEVkaXRvcigpOwogICAgICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+mAieWMuuaXoOaViO+8jOaXoOazleaPkuWFpeWGheWuuScpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW+WGheWuueaJqeWGmV0g5byC5bi4OicsIGVycm9yKTsKICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5YaF5a655omp5YaZ5aSx6LSlOiAnICsgKGVycm9yLnJlc3BvbnNlLmRhdGEuZGV0YWlsIHx8IGVycm9yLm1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCflhoXlrrnmianlhpnlpLHotKXvvIzor7fnqI3lkI7lho3or5UnKTsKICAgICAgICB9CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgZXhwYW5kTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIC8vIDMuIHBvbGlzaFRleHTlkIznkIYKICAgIGNvbnN0IHBvbGlzaFRleHQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSB8fCBwb2xpc2hMb2FkaW5nLnZhbHVlKSByZXR1cm47CiAgICAgIHRyeSB7CiAgICAgICAgcG9saXNoTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgICAgaWYgKCFxdWlsbEluc3RhbmNlLnZhbHVlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+e8lui+keWZqOacquWwsee7qu+8jOivt+eojeWQjuWGjeivlScpOwogICAgICAgICAgcG9saXNoTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8g5L2/55So5paw55qE6L6F5Yqp5Ye95pWw6I635Y+W6YCJ5oup5ZKM5paH5pysCiAgICAgICAgY29uc3QgewogICAgICAgICAgc2VsZWN0aW9uLAogICAgICAgICAgdGV4dAogICAgICAgIH0gPSBnZXRDdXJyZW50U2VsZWN0aW9uV2l0aFRleHQoKTsKICAgICAgICBsZXQgc2VsZWN0ZWRUZXh0ID0gdGV4dC50cmltKCk7CiAgICAgICAgbGV0IHJhbmdlID0gbnVsbDsKICAgICAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5sZW5ndGggPiAwICYmIHNlbGVjdGVkVGV4dCkgewogICAgICAgICAgcmFuZ2UgPSB7CiAgICAgICAgICAgIC4uLnNlbGVjdGlvbgogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgaWYgKCFzZWxlY3RlZFRleHQpIHsKICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCfor7flhYjpgInmi6nopoHmtqboibLnmoTmlofmnKzlhoXlrrknKTsKICAgICAgICAgIHBvbGlzaExvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHNlbGVjdGVkVGV4dC5sZW5ndGggPiBNQVhfQUlfVEVYVF9MRU5HVEgpIHsKICAgICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKGDpgInkuK3mlofmnKzov4fplb/vvIzlt7Loh6rliqjmiKrmlq3kuLrliY0ke01BWF9BSV9URVhUX0xFTkdUSH3lrZdgKTsKICAgICAgICAgIHNlbGVjdGVkVGV4dCA9IHNlbGVjdGVkVGV4dC5zbGljZSgwLCBNQVhfQUlfVEVYVF9MRU5HVEgpOwogICAgICAgIH0KICAgICAgICBFbE1lc3NhZ2UuaW5mbygn5q2j5Zyo5ram6Imy5paH5pys77yM6K+356iN5YCZLi4uJyk7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlQb2xpc2hUZXh0KGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHNlbGVjdGlvbjogc2VsZWN0ZWRUZXh0LAogICAgICAgICAgc3R5bGU6ICdwcm9mZXNzaW9uYWwnCiAgICAgICAgfSk7CiAgICAgICAgc2hvd0NvbXBhcmVEaWFsb2coewogICAgICAgICAgdGl0bGU6ICfmlofmnKzmtqboibLnu5PmnpwnLAogICAgICAgICAgb3JpZ2luYWw6IHNlbGVjdGVkVGV4dCwKICAgICAgICAgIG1vZGlmaWVkOiByZXNwb25zZS5kYXRhLmNvbnRlbnQsCiAgICAgICAgICBvbkFwcGx5OiBmaW5hbENvbnRlbnQgPT4gewogICAgICAgICAgICBpZiAocmFuZ2UgJiYgdHlwZW9mIHJhbmdlLmluZGV4ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgcmFuZ2UubGVuZ3RoID09PSAnbnVtYmVyJyAmJiByYW5nZS5pbmRleCA+PSAwICYmIHJhbmdlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBjb25zdCBxdWlsbExlbiA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCk7CiAgICAgICAgICAgICAgbGV0IGluc2VydFBvcyA9IHJhbmdlLmluZGV4OwogICAgICAgICAgICAgIGlmIChpbnNlcnRQb3MgPiBxdWlsbExlbikgaW5zZXJ0UG9zID0gcXVpbGxMZW4gLSAxOwoKICAgICAgICAgICAgICAvLyDkvb/nlKggQVBJIOa6kOagh+iusO+8jOmBv+WFjeinpuWPkeS4jeW/heimgeeahOmAieaLqeWPmOWMluS6i+S7tgogICAgICAgICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZGVsZXRlVGV4dChpbnNlcnRQb3MsIHJhbmdlLmxlbmd0aCwgJ2FwaScpOwogICAgICAgICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuaW5zZXJ0VGV4dChpbnNlcnRQb3MsIGZpbmFsQ29udGVudCwgJ2FwaScpOwoKICAgICAgICAgICAgICAvLyDorr7nva7mlrDnmoTpgInmi6nkvY3nva4KICAgICAgICAgICAgICBsZXQgc2VsUG9zID0gaW5zZXJ0UG9zICsgZmluYWxDb250ZW50Lmxlbmd0aDsKICAgICAgICAgICAgICBzZWxQb3MgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihzZWxQb3MsIHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCkpKTsKCiAgICAgICAgICAgICAgLy8g5bu26L+f6K6+572u6YCJ5oup77yM56Gu5L+d5paH5pys5o+S5YWl5a6M5oiQCiAgICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICAgICAgc2FmZVNldFNlbGVjdGlvbihzZWxQb3MsIDAsICdhcGknKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5paH5pys5ram6Imy5bey5bqU55SoJyk7CiAgICAgICAgICAgICAgICAvLyDliLfmlrDnvJbovpHlmajlrp7kvosKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICByZWZyZXNoUXVpbGxFZGl0b3IoKTsKICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfpgInljLrml6DmlYjvvIzml6Dms5Xmj5LlhaXlhoXlrrknKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1vmlofmnKzmtqboibJdIOW8guW4uDonLCBlcnJvcik7CiAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aWh+acrOa2puiJsuWksei0pTogJyArIChlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCB8fCBlcnJvci5tZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5paH5pys5ram6Imy5aSx6LSl77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHBvbGlzaExvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyDmt7vliqDmr5TovoPlvLnnqpfnmoTnirbmgIHlj5jph4/lkozmlrnms5UKICAgIGNvbnN0IGNvbXBhcmVEaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGNvbXBhcmVEaWFsb2dEYXRhID0gcmVmKHsKICAgICAgdGl0bGU6ICcnLAogICAgICBvcmlnaW5hbDogJycsCiAgICAgIG1vZGlmaWVkOiAnJywKICAgICAgbW9kaWZpZWRDb250ZW50OiAnJywKICAgICAgb25BcHBseTogKCkgPT4ge30KICAgIH0pOwoKICAgIC8vIOaYvuekuuavlOi+g+W8ueeqlwogICAgY29uc3Qgc2hvd0NvbXBhcmVEaWFsb2cgPSBkYXRhID0+IHsKICAgICAgY29tcGFyZURpYWxvZ0RhdGEudmFsdWUgPSB7CiAgICAgICAgLi4uZGF0YSwKICAgICAgICBtb2RpZmllZENvbnRlbnQ6IGRhdGEubW9kaWZpZWQKICAgICAgfTsKICAgICAgY29tcGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKCiAgICAvLyDlupTnlKjmr5TovoPlvLnnqpfnmoTmm7TmlLkKICAgIGNvbnN0IGFwcGx5Q29tcGFyZUNoYW5nZXMgPSAoKSA9PiB7CiAgICAgIGNvbXBhcmVEaWFsb2dEYXRhLnZhbHVlLm9uQXBwbHkoY29tcGFyZURpYWxvZ0RhdGEudmFsdWUubW9kaWZpZWRDb250ZW50KTsKICAgICAgY29tcGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgIH07CgogICAgLy8g5YWz6Zet5q+U6L6D5by556qXCiAgICBjb25zdCBjbG9zZUNvbXBhcmVEaWFsb2cgPSAoKSA9PiB7CiAgICAgIGNvbXBhcmVEaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CiAgICB9OwoKICAgIC8vIOmYsuaKluaQnOe0ogogICAgY29uc3QgZGVib3VuY2VkU2VhcmNoID0gXy5kZWJvdW5jZSgoKSA9PiB7CiAgICAgIC8vIOaQnOe0oumAu+i+keW3sumAmui/h+iuoeeul+WxnuaAp+WkhOeQhgogICAgfSwgMzAwKTsKICAgIGNvbnN0IGZvcm1hdERhdGUgPSBkYXRlU3RyaW5nID0+IHsKICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpOwogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwoKICAgICAgLy8g5ZCM5LiA5aSp5pi+56S65pe26Ze0CiAgICAgIGlmIChkYXRlLnRvRGF0ZVN0cmluZygpID09PSBub3cudG9EYXRlU3RyaW5nKCkpIHsKICAgICAgICByZXR1cm4gZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoJ3poLUNOJywgewogICAgICAgICAgaG91cjogJzItZGlnaXQnLAogICAgICAgICAgbWludXRlOiAnMi1kaWdpdCcKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8g5pio5aSpCiAgICAgIGNvbnN0IHllc3RlcmRheSA9IG5ldyBEYXRlKG5vdyk7CiAgICAgIHllc3RlcmRheS5zZXREYXRlKG5vdy5nZXREYXRlKCkgLSAxKTsKICAgICAgaWYgKGRhdGUudG9EYXRlU3RyaW5nKCkgPT09IHllc3RlcmRheS50b0RhdGVTdHJpbmcoKSkgewogICAgICAgIHJldHVybiAn5pio5aSpJzsKICAgICAgfQoKICAgICAgLy8g5LiA5ZGo5YaF5pi+56S65pif5pyfCiAgICAgIGNvbnN0IHdlZWtEYXlzID0gWyflkajml6UnLCAn5ZGo5LiAJywgJ+WRqOS6jCcsICflkajkuIknLCAn5ZGo5ZubJywgJ+WRqOS6lCcsICflkajlha0nXTsKICAgICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLnJvdW5kKChub3cgLSBkYXRlKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7CiAgICAgIGlmIChkaWZmRGF5cyA8IDcpIHsKICAgICAgICByZXR1cm4gd2Vla0RheXNbZGF0ZS5nZXREYXkoKV07CiAgICAgIH0KCiAgICAgIC8vIOWFtuS7luaDheWGteaYvuekuuaXpeacnwogICAgICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3poLUNOJywgewogICAgICAgIG1vbnRoOiAnbnVtZXJpYycsCiAgICAgICAgZGF5OiAnbnVtZXJpYycKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIOebkeWQrOi3r+eUseWPmOWMlgogICAgd2F0Y2goKCkgPT4gcm91dGUucGFyYW1zLmlkLCAobmV3SWQsIG9sZElkKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKGDot6/nlLHlj4LmlbBJROWPmOWMljogJHtvbGRJZH0gLT4gJHtuZXdJZH1gKTsKICAgICAgaWYgKG5ld0lkKSB7CiAgICAgICAgLy8g5qOA5p+lSUTmmK/lkKbkuLrmnInmlYjmraPmlbTmlbAKICAgICAgICBjb25zdCBpZE51bSA9IE51bWJlcihuZXdJZCk7CiAgICAgICAgaWYgKGlzTmFOKGlkTnVtKSB8fCBpZE51bSA8PSAwIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGlkTnVtKSkgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfml6DmlYjnmoTmlofmoaNJRCcpOwogICAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8g5aaC5p6cSUTlj5HnlJ/kuoblj5jljJbvvIzph43mlrDojrflj5bmlofmoaMKICAgICAgICBpZiAobmV3SWQgIT09IG9sZElkKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhg5paH5qGjSUTlj5jljJbvvIzojrflj5bmlofmoaPor6bmg4U6ICR7bmV3SWR9YCk7CiAgICAgICAgICAvLyDmo4Dmn6XmmK/lkKblt7LmnInnvJPlrZgKICAgICAgICAgIGlmIChkb2N1bWVudENhY2hlLnZhbHVlLmhhcyhuZXdJZCkpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYOS9v+eUqOe8k+WtmOeahOaWh+aho+aVsOaNrjogJHtuZXdJZH1gKTsKICAgICAgICAgICAgY3VycmVudERvYy52YWx1ZSA9IGRvY3VtZW50Q2FjaGUudmFsdWUuZ2V0KG5ld0lkKTsKICAgICAgICAgICAgb3JpZ2luYWxEb2MudmFsdWUgPSB7CiAgICAgICAgICAgICAgdGl0bGU6IGN1cnJlbnREb2MudmFsdWUudGl0bGUgfHwgJycsCiAgICAgICAgICAgICAgdHlwZTogY3VycmVudERvYy52YWx1ZS50eXBlIHx8ICfpgJrnlKgnLAogICAgICAgICAgICAgIGNvbnRlbnQ6IGN1cnJlbnREb2MudmFsdWUuY29udGVudCB8fCAnJwogICAgICAgICAgICB9OwogICAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgIC8vIOWcqOWQjuWPsOW8guatpeWIt+aWsOaVsOaNrgogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBmZXRjaERvY3VtZW50RGV0YWlsKG5ld0lkKTsKICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIOayoeaciee8k+WtmO+8jOebtOaOpeiOt+WPlgogICAgICAgICAgICBmZXRjaERvY3VtZW50RGV0YWlsKG5ld0lkKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudERvYy52YWx1ZSA9IG51bGw7CiAgICAgIH0KICAgIH0sIHsKICAgICAgaW1tZWRpYXRlOiBmYWxzZQogICAgfSk7IC8vIOiuvuS4umZhbHNl6YG/5YWN6YeN5aSN5Yqg6L29CgogICAgLy8g55uR5ZCscXVlcnnlj4LmlbDlj5jljJbvvIzlpITnkIblvLrliLbliLfmlrAKICAgIHdhdGNoKCgpID0+IHJvdXRlLnF1ZXJ5Ll9yZWZyZXNoLCBuZXdWYWwgPT4gewogICAgICBpZiAobmV3VmFsKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+ajgOa1i+WIsOW8uuWItuWIt+aWsOWPguaVsDonLCBuZXdWYWwpOwogICAgICAgIGNvbnN0IGRvY0lkID0gcm91dGUucGFyYW1zLmlkOwogICAgICAgIGlmIChkb2NJZCkgewogICAgICAgICAgY29uc29sZS5sb2coJ+W8uuWItuWIt+aWsOaWh+aho+ivpuaDhTonLCBkb2NJZCk7CiAgICAgICAgICBmZXRjaERvY3VtZW50RGV0YWlsKGRvY0lkKTsKICAgICAgICB9CiAgICAgICAgLy8g5ZCM5pe25Yi35paw5paH5qGj5YiX6KGoCiAgICAgICAgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgfQogICAgfSk7CgogICAgLy8g6Ieq5Yqo5L+d5a2Y5Yqf6IO9CiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGlmIChkb2N1bWVudENoYW5nZWQudmFsdWUgJiYgY3VycmVudERvYy52YWx1ZSAmJiAhc2F2ZUxvYWRpbmcudmFsdWUpIHsKICAgICAgICBzYXZlRG9jdW1lbnQoKTsKICAgICAgfQogICAgfSwgNjAwMDApOyAvLyDmr4/liIbpkp/oh6rliqjkv53lrZjkuIDmrKEKCiAgICAvLyDnlJ/lkb3lkajmnJ/pkqnlrZAKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIGZldGNoSW5pdGlhbERhdGEoKTsKCiAgICAgIC8vIOebkeWQrOi3r+eUseWPguaVsOWPmOWMlu+8jOW9k0lE5Y+Y5YyW5pe25Yi35paw6aG16Z2i5pWw5o2uCiAgICAgIHdhdGNoKCgpID0+IHJvdXRlLnBhcmFtcy5pZCwgKG5ld0lkLCBvbGRJZCkgPT4gewogICAgICAgIGlmIChuZXdJZCAmJiBuZXdJZCAhPT0gb2xkSWQpIHsKICAgICAgICAgIHJlZnJlc2hEb2N1bWVudERhdGEobmV3SWQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKCiAgICAvLyDmu5rliqjliLDlvZPliY3pgInkuK3nmoTmlofmoaMKICAgIGNvbnN0IHNjcm9sbFRvQWN0aXZlRG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlKSByZXR1cm47CgogICAgICAgIC8vIOafpeaJvuW9k+WJjea/gOa0u+eahOaWh+aho+WFg+e0oAogICAgICAgIGNvbnN0IGFjdGl2ZURvYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kb2MtaXRlbS5hY3RpdmUnKTsKICAgICAgICBpZiAoYWN0aXZlRG9jKSB7CiAgICAgICAgICAvLyDkvb/nlKhzY3JvbGxJbnRvVmlld+a7muWKqOWIsOivpeWFg+e0oAogICAgICAgICAgYWN0aXZlRG9jLnNjcm9sbEludG9WaWV3KHsKICAgICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnLAogICAgICAgICAgICBibG9jazogJ25lYXJlc3QnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5rua5Yqo5Yiw5rS75Yqo5paH5qGj5aSx6LSlOicsIGVycm9yKTsKICAgICAgfQogICAgfTsKCiAgICAvLyDlj6rmnInlhoXlrrnlrp7pmYXlj5jljJbmiY3moIforrDkuLrlt7Lkv67mlLkKICAgIGNvbnN0IG9uVGl0bGVDaGFuZ2UgPSB2YWwgPT4gewogICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB2YWwgIT09IG9yaWdpbmFsRG9jLnZhbHVlLnRpdGxlOwogICAgfTsKICAgIGNvbnN0IG9uVHlwZUNoYW5nZSA9IHZhbCA9PiB7CiAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHZhbCAhPT0gb3JpZ2luYWxEb2MudmFsdWUudHlwZTsKICAgIH07CiAgICBjb25zdCBvbkNvbnRlbnRDaGFuZ2UgPSAoKSA9PiB7CiAgICAgIC8vIOS/ruWkje+8muato+ehruavlOi+g+e8lui+keWZqOWGheWuuQogICAgICBpZiAoY3VycmVudERvYy52YWx1ZSAmJiBvcmlnaW5hbERvYy52YWx1ZSkgewogICAgICAgIC8vIOavlOi+g+W9k+WJjeWGheWuueS4juWOn+Wni+WGheWuueaYr+WQpuecn+eahOS4jeWQjAogICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gY3VycmVudERvYy52YWx1ZS5jb250ZW50OwogICAgICAgIGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IG9yaWdpbmFsRG9jLnZhbHVlLmNvbnRlbnQ7CiAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gY3VycmVudENvbnRlbnQgIT09IG9yaWdpbmFsQ29udGVudDsKICAgICAgfQogICAgICBzY3JvbGxRdWlsbFRvQm90dG9tKCk7CiAgICB9OwoKICAgIC8vIOe8lui+keWZqOWunuS+iwogICAgY29uc3QgcXVpbGxJbnN0YW5jZSA9IHJlZihudWxsKTsKCiAgICAvLyAyLiDnvJbovpHlmahyZWFkeeaXtui1i+WAvAogICAgY29uc3Qgb25FZGl0b3JSZWFkeSA9IHF1aWxsID0+IHsKICAgICAgY29uc29sZS5sb2coJ+e8lui+keWZqOWwsee7qicpOwogICAgICBxdWlsbEluc3RhbmNlLnZhbHVlID0gcXVpbGw7CiAgICAgIHF1aWxsLm9uKCdzZWxlY3Rpb24tY2hhbmdlJywgb25TZWxlY3Rpb25DaGFuZ2UpOwoKICAgICAgLy8g5bu26L+f5omn6KGM77yM56Gu5L+d5bel5YW35qCPRE9N5bey5a6M5YWo5riy5p+TCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIC8vIOS4uuW3peWFt+agj+aMiemSrua3u+WKoOaPkOekugogICAgICAgIGNvbnN0IHRvb2xiYXJUb29sdGlwcyA9IHsKICAgICAgICAgICcucWwtYm9sZCc6ICfliqDnspcgKEN0cmwrQiknLAogICAgICAgICAgJy5xbC1pdGFsaWMnOiAn5pac5L2TIChDdHJsK0kpJywKICAgICAgICAgICcucWwtdW5kZXJsaW5lJzogJ+S4i+WIkue6vyAoQ3RybCtVKScsCiAgICAgICAgICAnLnFsLXN0cmlrZSc6ICfliKDpmaTnur8nLAogICAgICAgICAgJy5xbC1ibG9ja3F1b3RlJzogJ+Wdl+e6p+W8leeUqCcsCiAgICAgICAgICAnLnFsLWNvZGUtYmxvY2snOiAn5Luj56CB5Z2XJywKICAgICAgICAgICcucWwtaGVhZGVyW3ZhbHVlPSIxIl0nOiAn5qCH6aKYMScsCiAgICAgICAgICAnLnFsLWhlYWRlclt2YWx1ZT0iMiJdJzogJ+agh+mimDInLAogICAgICAgICAgJy5xbC1saXN0W3ZhbHVlPSJvcmRlcmVkIl0nOiAn5pyJ5bqP5YiX6KGoJywKICAgICAgICAgICcucWwtbGlzdFt2YWx1ZT0iYnVsbGV0Il0nOiAn5peg5bqP5YiX6KGoJywKICAgICAgICAgICcucWwtc2NyaXB0W3ZhbHVlPSJzdWIiXSc6ICfkuIvmoIcnLAogICAgICAgICAgJy5xbC1zY3JpcHRbdmFsdWU9InN1cGVyIl0nOiAn5LiK5qCHJywKICAgICAgICAgICcucWwtaW5kZW50W3ZhbHVlPSItMSJdJzogJ+WHj+Wwkee8qei/mycsCiAgICAgICAgICAnLnFsLWluZGVudFt2YWx1ZT0iKzEiXSc6ICflop7liqDnvKnov5snLAogICAgICAgICAgJy5xbC1kaXJlY3Rpb24nOiAn5paH5pys5pa55ZCRJywKICAgICAgICAgICcucWwtY2xlYW4nOiAn5riF6Zmk5qC85byPJywKICAgICAgICAgICcucWwtbGluayc6ICfotoXpk77mjqUnLAogICAgICAgICAgJy5xbC1pbWFnZSc6ICflm77niYcnLAogICAgICAgICAgLy8gUGlja2VycyAobGVzcyBzcGVjaWZpYyBzZWxlY3RvcnMpCiAgICAgICAgICAnLnFsLXNpemUnOiAn5a2X5Y+3JywKICAgICAgICAgICcucWwtaGVhZGVyJzogJ+auteiQveagvOW8jycsCiAgICAgICAgICAnLnFsLWNvbG9yJzogJ+Wtl+S9k+minOiJsicsCiAgICAgICAgICAnLnFsLWJhY2tncm91bmQnOiAn6IOM5pmv6aKc6ImyJywKICAgICAgICAgICcucWwtZm9udCc6ICflrZfkvZMnLAogICAgICAgICAgJy5xbC1hbGlnbic6ICflr7npvZDmlrnlvI8nCiAgICAgICAgfTsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgdG9vbGJhciA9IHF1aWxsLmdldE1vZHVsZSgndG9vbGJhcicpLmNvbnRhaW5lcjsKICAgICAgICAgIGlmICghdG9vbGJhcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCLmnKrog73ojrflj5bnvJbovpHlmajlt6XlhbfmoI/lrrnlmajjgIIiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBpbiB0b29sYmFyVG9vbHRpcHMpIHsKICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSB0b29sYmFyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOwogICAgICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGVsID0+IHsKICAgICAgICAgICAgICAvLyDpgb/lhY3opobnm5bmm7TlhbfkvZPpgInmi6nlmajnmoTmj5DnpLoKICAgICAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZSgndGl0bGUnKSkgewogICAgICAgICAgICAgICAgZWwudGl0bGUgPSB0b29sYmFyVG9vbHRpcHNbc2VsZWN0b3JdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuS4uue8lui+keWZqOW3peWFt+agj+a3u+WKoOaPkOekuuaXtuWHuumUmToiLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9LCAyMDApOyAvLyDlu7bov58yMDDmr6vnp5IKICAgIH07CgogICAgLy8g5pm66IO95rua5Yqo5Ye95pWwIC0g6YG/5YWN5bmy5omw5paH5pys6YCJ5oupCiAgICBmdW5jdGlvbiBzY3JvbGxRdWlsbFRvQm90dG9tKCkgewogICAgICBpZiAocXVpbGxJbnN0YW5jZS52YWx1ZSkgewogICAgICAgIC8vIOS/neWtmOW9k+WJjemAieaLqeeKtuaAgQogICAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHF1aWxsSW5zdGFuY2UudmFsdWUucm9vdDsKICAgICAgICBjb250YWluZXIuc2Nyb2xsVG9wID0gY29udGFpbmVyLnNjcm9sbEhlaWdodDsKCiAgICAgICAgLy8g5oGi5aSN6YCJ5oup54q25oCB77yI5aaC5p6c5a2Y5Zyo77yJCiAgICAgICAgaWYgKGN1cnJlbnRTZWxlY3Rpb24gJiYgY3VycmVudFNlbGVjdGlvbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAvLyDkvb/nlKggbmV4dFRpY2sg56Gu5L+d5rua5Yqo5a6M5oiQ5ZCO5YaN5oGi5aSN6YCJ5oupCiAgICAgICAgICBuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5zZXRTZWxlY3Rpb24oY3VycmVudFNlbGVjdGlvbi5pbmRleCwgY3VycmVudFNlbGVjdGlvbi5sZW5ndGgpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgIGNvbnNvbGUud2Fybign5oGi5aSN6YCJ5oup54q25oCB5aSx6LSlOicsIGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25zdCBncmFtbWFyQ2hlY2tUZXh0ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUgfHwgZ3JhbW1hckNoZWNrTG9hZGluZy52YWx1ZSkgcmV0dXJuOwogICAgICB0cnkgewogICAgICAgIGdyYW1tYXJDaGVja0xvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgIGlmICghcXVpbGxJbnN0YW5jZS52YWx1ZSkgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfnvJbovpHlmajmnKrlsLHnu6rvvIzor7fnqI3lkI7lho3or5UnKTsKICAgICAgICAgIGdyYW1tYXJDaGVja0xvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIOS9v+eUqOaWsOeahOi+heWKqeWHveaVsOiOt+WPlumAieaLqeWSjOaWh+acrAogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHNlbGVjdGlvbiwKICAgICAgICAgIHRleHQKICAgICAgICB9ID0gZ2V0Q3VycmVudFNlbGVjdGlvbldpdGhUZXh0KCk7CiAgICAgICAgbGV0IHNlbGVjdGVkVGV4dCA9IHRleHQudHJpbSgpOwogICAgICAgIGxldCByYW5nZSA9IG51bGw7CiAgICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCAmJiBzZWxlY3RlZFRleHQpIHsKICAgICAgICAgIHJhbmdlID0gewogICAgICAgICAgICAuLi5zZWxlY3Rpb24KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup6KaB57qg6ZSZ55qE5paH5pys5YaF5a65Jyk7CiAgICAgICAgICBncmFtbWFyQ2hlY2tMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gTUFYX0FJX1RFWFRfTEVOR1RIKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZyhg6YCJ5Lit5paH5pys6L+H6ZW/77yM5bey6Ieq5Yqo5oiq5pat5Li65YmNJHtNQVhfQUlfVEVYVF9MRU5HVEh95a2XYCk7CiAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UoMCwgTUFYX0FJX1RFWFRfTEVOR1RIKTsKICAgICAgICB9CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOaZuuiDvee6oOmUme+8jOivt+eojeWAmS4uLicpOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ3JhbW1hckNoZWNrKGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHNlbGVjdGlvbjogc2VsZWN0ZWRUZXh0CiAgICAgICAgfSk7CiAgICAgICAgLy8g5Y+q5L+d55WZ5bu66K6u6YOo5YiG77yM5Y676ZmkIuS8mOWMluWQjueahOaWh+acrCLlrZfmoLfvvIzlubblsIZtZOi9rOS4umh0bWwKICAgICAgICBsZXQgc3VnZ2VzdGlvbnMgPSByZXNwb25zZS5zdWdnZXN0aW9ucyB8fCAnJzsKICAgICAgICBzdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLnJlcGxhY2UoL1wqXCrkvJjljJblkI7nmoTmlofmnKxcKlwqWzrvvJpdPyhbXHNcU10qKSQvLCAnJykudHJpbSgpOwogICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zSHRtbCA9IG1hcmtlZC5wYXJzZShzdWdnZXN0aW9ucyk7CgogICAgICAgIC8vIOS7juS/ruato+aWh+acrOS4reWPquaPkOWPluS8mOWMluWQjueahOaWh+acrAogICAgICAgIGxldCBjb3JyZWN0ZWRUZXh0ID0gcmVzcG9uc2UuY29ycmVjdGVkIHx8ICcnOwogICAgICAgIGNvbnN0IG9wdGltaXplZFRleHRNYXRjaCA9IGNvcnJlY3RlZFRleHQubWF0Y2goL+S8mOWMluWQjueahOaWh+acrFs677yaXShbXHNcU10qKS8pOwogICAgICAgIGNvbnN0IGZpbmFsQ29ycmVjdGVkVGV4dCA9IG9wdGltaXplZFRleHRNYXRjaCA/IG9wdGltaXplZFRleHRNYXRjaFsxXS50cmltKCkgOiBjb3JyZWN0ZWRUZXh0OwogICAgICAgIHNob3dDb21wYXJlRGlhbG9nKHsKICAgICAgICAgIHRpdGxlOiAn5pm66IO957qg6ZSZ5bu66K6uJywKICAgICAgICAgIG9yaWdpbmFsOiBzZWxlY3RlZFRleHQsCiAgICAgICAgICBtb2RpZmllZDogZmluYWxDb3JyZWN0ZWRUZXh0LAogICAgICAgICAgLy8g5Y+z5L6n57yW6L6R5Zmo55u05o6l5aGr5LyY5YyW5ZCO5paH5pysCiAgICAgICAgICBzdWdnZXN0aW9uczogc3VnZ2VzdGlvbnNIdG1sLAogICAgICAgICAgLy8gQUnlu7rorq7ljLrlj6rmmL7npLrlu7rorq7vvIzkuJTkuLpodG1sCiAgICAgICAgICBvbkFwcGx5OiBmaW5hbENvbnRlbnQgPT4gewogICAgICAgICAgICBpZiAocmFuZ2UgJiYgdHlwZW9mIHJhbmdlLmluZGV4ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgcmFuZ2UubGVuZ3RoID09PSAnbnVtYmVyJyAmJiByYW5nZS5pbmRleCA+PSAwICYmIHJhbmdlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBjb25zdCBxdWlsbExlbiA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCk7CiAgICAgICAgICAgICAgbGV0IGluc2VydFBvcyA9IHJhbmdlLmluZGV4OwogICAgICAgICAgICAgIGlmIChpbnNlcnRQb3MgPiBxdWlsbExlbikgaW5zZXJ0UG9zID0gcXVpbGxMZW4gLSAxOwoKICAgICAgICAgICAgICAvLyDkvb/nlKggQVBJIOa6kOagh+iusO+8jOmBv+WFjeinpuWPkeS4jeW/heimgeeahOmAieaLqeWPmOWMluS6i+S7tgogICAgICAgICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZGVsZXRlVGV4dChpbnNlcnRQb3MsIHJhbmdlLmxlbmd0aCwgJ2FwaScpOwogICAgICAgICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuaW5zZXJ0VGV4dChpbnNlcnRQb3MsIGZpbmFsQ29udGVudCwgJ2FwaScpOwoKICAgICAgICAgICAgICAvLyDorr7nva7mlrDnmoTpgInmi6nkvY3nva4KICAgICAgICAgICAgICBsZXQgc2VsUG9zID0gaW5zZXJ0UG9zICsgZmluYWxDb250ZW50Lmxlbmd0aDsKICAgICAgICAgICAgICBzZWxQb3MgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihzZWxQb3MsIHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCkpKTsKCiAgICAgICAgICAgICAgLy8g5bu26L+f6K6+572u6YCJ5oup77yM56Gu5L+d5paH5pys5o+S5YWl5a6M5oiQCiAgICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICAgICAgc2FmZVNldFNlbGVjdGlvbihzZWxQb3MsIDAsICdhcGknKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5pm66IO957qg6ZSZ5bey5bqU55SoJyk7CiAgICAgICAgICAgICAgICAvLyDliLfmlrDnvJbovpHlmajlrp7kvosKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICByZWZyZXNoUXVpbGxFZGl0b3IoKTsKICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfpgInljLrml6DmlYjvvIzml6Dms5Xmj5LlhaXlhoXlrrknKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1vmmbrog73nuqDplJldIOW8guW4uDonLCBlcnJvcik7CiAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aZuuiDvee6oOmUmeWksei0pTogJyArIChlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCB8fCBlcnJvci5tZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5pm66IO957qg6ZSZ5aSx6LSl77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIGdyYW1tYXJDaGVja0xvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyDlpJror63oqIDnv7vor5EKICAgIGNvbnN0IHRyYW5zbGF0ZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgdHJhbnNsYXRlSW5wdXQgPSByZWYoJycpOwogICAgY29uc3QgdHJhbnNsYXRlUmVzdWx0ID0gcmVmKCcnKTsKICAgIGNvbnN0IHRyYW5zbGF0ZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgdGFyZ2V0TGFuZyA9IHJlZignZW4nKTsKICAgIGNvbnN0IHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudCA9IHJlZignJyk7CiAgICBjb25zdCBvcGVuVHJhbnNsYXRlRGlhbG9nID0gKCkgPT4gewogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+e8lui+keWZqOacquWwsee7qu+8jOivt+eojeWQjumHjeivlScpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g5L2/55So5paw55qE6L6F5Yqp5Ye95pWw6I635Y+W6YCJ5oup5ZKM5paH5pysCiAgICAgIGNvbnN0IHsKICAgICAgICBzZWxlY3Rpb24sCiAgICAgICAgdGV4dAogICAgICB9ID0gZ2V0Q3VycmVudFNlbGVjdGlvbldpdGhUZXh0KCk7CgogICAgICAvLyDmuIXnqbrml6fmlbDmja4KICAgICAgdHJhbnNsYXRlUmVzdWx0LnZhbHVlID0gJyc7CiAgICAgIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSA9ICcnOwogICAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5sZW5ndGggPiAwKSB7CiAgICAgICAgdHJhbnNsYXRlSW5wdXQudmFsdWUgPSB0ZXh0LnRyaW0oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmFuc2xhdGVJbnB1dC52YWx1ZSA9ICcnOwogICAgICB9CgogICAgICAvLyDmmL7npLrlr7nor53moYYKICAgICAgdHJhbnNsYXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3QgdXNlU2VsZWN0ZWRUZXh0Rm9yVHJhbnNsYXRlID0gKCkgPT4gewogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHJldHVybjsKICAgICAgY29uc3Qgc2VsZWN0aW9uID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRTZWxlY3Rpb24oKTsKICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCkgewogICAgICAgIHRyYW5zbGF0ZUlucHV0LnZhbHVlID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBkb1RyYW5zbGF0ZSA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8ICF0cmFuc2xhdGVJbnB1dC52YWx1ZSkgcmV0dXJuOwogICAgICB0cmFuc2xhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0cmFuc2xhdGVUZXh0KGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHNlbGVjdGlvbjogdHJhbnNsYXRlSW5wdXQudmFsdWUsCiAgICAgICAgICB0YXJnZXRfbGFuZzogdGFyZ2V0TGFuZy52YWx1ZQogICAgICAgIH0pOwogICAgICAgIHRyYW5zbGF0ZVJlc3VsdC52YWx1ZSA9IHJlcy50cmFuc2xhdGVkOwogICAgICAgIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSA9IHJlcy50cmFuc2xhdGVkOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfnv7vor5HlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cmFuc2xhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCByZXBsYWNlU2VsZWN0aW9uV2l0aFRyYW5zbGF0aW9uID0gKCkgPT4gewogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUgfHwgIXRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSkgcmV0dXJuOwoKICAgICAgLy8g5L2/55So6L6F5Yqp5Ye95pWw6I635Y+W5b2T5YmN5pyJ5pWI6YCJ5oupCiAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGdldEN1cnJlbnRTZWxlY3Rpb24oKTsKICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IHF1aWxsTGVuID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKTsKICAgICAgICBsZXQgaW5zZXJ0UG9zID0gc2VsZWN0aW9uLmluZGV4OwogICAgICAgIGlmIChpbnNlcnRQb3MgPiBxdWlsbExlbikgaW5zZXJ0UG9zID0gcXVpbGxMZW4gLSAxOwoKICAgICAgICAvLyDkvb/nlKggQVBJIOa6kOagh+iusO+8jOmBv+WFjeinpuWPkeS4jeW/heimgeeahOmAieaLqeWPmOWMluS6i+S7tgogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZGVsZXRlVGV4dChpbnNlcnRQb3MsIHNlbGVjdGlvbi5sZW5ndGgsICdhcGknKTsKICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmNsaXBib2FyZC5kYW5nZXJvdXNseVBhc3RlSFRNTChpbnNlcnRQb3MsIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSwgJ2FwaScpOwogICAgICAgIGxldCBzZWxQb3MgPSBpbnNlcnRQb3MgKyB0cmFuc2xhdGVNb2RpZmllZENvbnRlbnQudmFsdWUucmVwbGFjZSgvPFtePl0rPi9nLCAnJykubGVuZ3RoOwogICAgICAgIGlmIChzZWxQb3MgPiBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpIC0gMSkgc2VsUG9zID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSAtIDE7CgogICAgICAgIC8vIOW7tui/n+iuvue9rumAieaLqe+8jOehruS/neaWh+acrOaPkuWFpeWujOaIkAogICAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHNhZmVTZXRTZWxlY3Rpb24oc2VsUG9zLCAwLCAnYXBpJyk7CiAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+W3suabv+aNouS4uue/u+ivkeWGheWuuScpOwogICAgICAgICAgdHJhbnNsYXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgLy8g5Yi35paw57yW6L6R5Zmo5a6e5L6LCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgcmVmcmVzaFF1aWxsRWRpdG9yKCk7CiAgICAgICAgICB9LCAxMDApOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOacqumAieS4reWGheWuueaXtuaPkuWFpeWIsOWFieagh+WkhAogICAgICAgIGNvbnN0IGN1cnNvciA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0U2VsZWN0aW9uKHRydWUpOwogICAgICAgIGxldCBpbnNlcnRQb3MgPSBjdXJzb3IgPyBjdXJzb3IuaW5kZXggOiBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpIC0gMTsKICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmluc2VydEVtYmVkKGluc2VydFBvcywgJ3RleHQnLCB0cmFuc2xhdGVNb2RpZmllZENvbnRlbnQudmFsdWUsICdhcGknKTsKICAgICAgICBuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICBzYWZlU2V0U2VsZWN0aW9uKGluc2VydFBvcyArIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZS5yZXBsYWNlKC88W14+XSs+L2csICcnKS5sZW5ndGgsIDAsICdhcGknKTsKICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5bey5o+S5YWl57+76K+R5YaF5a65Jyk7CiAgICAgICAgICB0cmFuc2xhdGVEaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAvLyDliLfmlrDnvJbovpHlmajlrp7kvosKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICByZWZyZXNoUXVpbGxFZGl0b3IoKTsKICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CgogICAgLy8g5pm66IO96Zeu562UCiAgICBjb25zdCBxYURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgcWFRdWVzdGlvbiA9IHJlZignJyk7CiAgICBjb25zdCBxYUFuc3dlciA9IHJlZignJyk7CiAgICBjb25zdCBxYUxvYWRpbmcgPSByZWYoZmFsc2UpOwoKICAgIC8vIOiuoeeul+WxnuaAp++8muWwhk1hcmtkb3du5qC85byP55qE5Zue562U6L2s5o2i5Li6SFRNTAogICAgY29uc3QgcWFBbnN3ZXJIdG1sID0gY29tcHV0ZWQoKCkgPT4gewogICAgICByZXR1cm4gcWFBbnN3ZXIudmFsdWUgPyBtYXJrZWQucGFyc2UocWFBbnN3ZXIudmFsdWUpIDogJyc7CiAgICB9KTsKICAgIGNvbnN0IG9wZW5RYURpYWxvZyA9ICgpID0+IHsKICAgICAgcWFEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgICAgcWFRdWVzdGlvbi52YWx1ZSA9ICcnOwogICAgICBxYUFuc3dlci52YWx1ZSA9ICcnOwogICAgfTsKICAgIGNvbnN0IGRvUWEgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSB8fCAhcWFRdWVzdGlvbi52YWx1ZSkgcmV0dXJuOwogICAgICBxYUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRvY1FhKGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHF1ZXN0aW9uOiBxYVF1ZXN0aW9uLnZhbHVlLAogICAgICAgICAgY29udGV4dDogY3VycmVudERvYy52YWx1ZS5jb250ZW50CiAgICAgICAgfSk7CiAgICAgICAgcWFBbnN3ZXIudmFsdWUgPSByZXMuYW5zd2VyOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfpl67nrZTlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBxYUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyDliLfmlrDmlofmoaPmlbDmja4KICAgIGNvbnN0IHJlZnJlc2hEb2N1bWVudERhdGEgPSBhc3luYyBkb2NJZCA9PiB7CiAgICAgIGxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGlmIChkb2NJZCkgewogICAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudERldGFpbChkb2NJZCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIt+aWsOaWh+aho+aVsOaNruWksei0pTonLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfliLfmlrDmlofmoaPmlbDmja7lpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgLy8g5Yid5aeL5YyW5pWw5o2u5Yqg6L29CiAgICBjb25zdCBmZXRjaEluaXRpYWxEYXRhID0gKCkgPT4gewogICAgICBjb25zb2xlLmxvZygn57uE5Lu25oyC6L2977yM5byA5aeL5Yqg6L295pWw5o2uJyk7CgogICAgICAvLyDojrflj5blvZPliY3mlofmoaNJRAogICAgICBjb25zdCBkb2NJZCA9IHJvdXRlLnBhcmFtcy5pZDsKCiAgICAgIC8vIOWmguaenOacieaWh+aho0lE77yM5LyY5YWI5Yqg6L295paH5qGj6K+m5oOFCiAgICAgIGlmIChkb2NJZCkgewogICAgICAgIGNvbnNvbGUubG9nKCfmnInmlofmoaNJRO+8jOS8mOWFiOWKoOi9veaWh+aho+ivpuaDhTonLCBkb2NJZCk7CiAgICAgICAgZmV0Y2hEb2N1bWVudERldGFpbChkb2NJZCkudGhlbigoKSA9PiB7CiAgICAgICAgICAvLyDmlofmoaPor6bmg4XliqDovb3lrozmiJDlkI7vvIzlvILmraXliqDovb3mlofmoaPliJfooagKICAgICAgICAgIGNvbnNvbGUubG9nKCfmlofmoaPor6bmg4XliqDovb3lrozmiJDvvIzlvIDlp4vliqDovb3mlofmoaPliJfooagnKTsKICAgICAgICAgIGZldGNoRG9jdW1lbnRzKCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgIC8vIOaWh+aho+WIl+ihqOWKoOi9veWujOaIkOWQju+8jOa7muWKqOWIsOW9k+WJjeaWh+ahowogICAgICAgICAgICBjb25zb2xlLmxvZygn5paH5qGj5YiX6KGo5Yqg6L295a6M5oiQJyk7CiAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgICBzY3JvbGxUb0FjdGl2ZURvY3VtZW50KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5rKh5pyJ5paH5qGjSUTvvIzlj6rliqDovb3mlofmoaPliJfooagKICAgICAgICBjb25zb2xlLmxvZygn5rKh5pyJ5paH5qGjSUTvvIzlj6rliqDovb3mlofmoaPliJfooagnKTsKICAgICAgICBmZXRjaERvY3VtZW50cygpOwogICAgICB9CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgZG9jdW1lbnRzLAogICAgICBjdXJyZW50RG9jLAogICAgICBkb2N1bWVudENoYW5nZWQsCiAgICAgIGlzRG9jTGlzdENvbGxhcHNlZCwKICAgICAgaXNBc3Npc3RhbnRDb2xsYXBzZWQsCiAgICAgIHNlYXJjaFF1ZXJ5LAogICAgICBkb2NUeXBlRmlsdGVyLAogICAgICBzb3J0T3B0aW9uLAogICAgICBmaWx0ZXJlZERvY3VtZW50cywKICAgICAgbmV3RG9jdW1lbnREaWFsb2dWaXNpYmxlLAogICAgICBzaGFyZURpYWxvZ1Zpc2libGUsCiAgICAgIGRlbGV0ZURpYWxvZ1Zpc2libGUsCiAgICAgIHNlbGVjdGVkVXNlcnMsCiAgICAgIGF2YWlsYWJsZVVzZXJzLAogICAgICBzYXZlTG9hZGluZywKICAgICAgY3JlYXRlTG9hZGluZywKICAgICAgc2hhcmVMb2FkaW5nLAogICAgICBkZWxldGVMb2FkaW5nLAogICAgICBleHBhbmRMb2FkaW5nLAogICAgICBwb2xpc2hMb2FkaW5nLAogICAgICBncmFtbWFyQ2hlY2tMb2FkaW5nLAogICAgICBuZXdEb2N1bWVudEZvcm0sCiAgICAgIGRvY3VtZW50Rm9ybVJ1bGVzLAogICAgICBkb2N1bWVudEZvcm1SZWYsCiAgICAgIGVkaXRvck9wdGlvbnMsCiAgICAgIGZldGNoRG9jdW1lbnRzLAogICAgICBmZXRjaERvY3VtZW50RGV0YWlsLAogICAgICBzZWxlY3REb2N1bWVudCwKICAgICAgc2F2ZURvY3VtZW50LAogICAgICB0b2dnbGVEb2NMaXN0LAogICAgICB0b2dnbGVBc3Npc3RhbnQsCiAgICAgIG9uRWRpdG9yQ2hhbmdlLAogICAgICBvcGVuTmV3RG9jdW1lbnREaWFsb2csCiAgICAgIGNyZWF0ZU5ld0RvY3VtZW50LAogICAgICBzaGFyZURvY3VtZW50LAogICAgICBjb25maXJtU2hhcmUsCiAgICAgIGRlbGV0ZURvY3VtZW50LAogICAgICBjb25maXJtRGVsZXRlLAogICAgICBleHBvcnREb2N1bWVudCwKICAgICAgZXhwb3J0VG9QZGYsCiAgICAgIGV4cG9ydFRvV29yZCwKICAgICAgcHJpbnREb2N1bWVudCwKICAgICAgYWRkQ29sbGFib3JhdG9yLAogICAgICB2aWV3SGlzdG9yeSwKICAgICAgZXhwYW5kQ29udGVudCwKICAgICAgcG9saXNoVGV4dCwKICAgICAgZGVib3VuY2VkU2VhcmNoLAogICAgICBmb3JtYXREYXRlLAogICAgICBsb2FkaW5nLAogICAgICBvblRpdGxlQ2hhbmdlLAogICAgICBvblR5cGVDaGFuZ2UsCiAgICAgIG9uQ29udGVudENoYW5nZSwKICAgICAgb25FZGl0b3JSZWFkeSwKICAgICAgY29tcGFyZURpYWxvZ1Zpc2libGUsCiAgICAgIGNvbXBhcmVEaWFsb2dEYXRhLAogICAgICBzaG93Q29tcGFyZURpYWxvZywKICAgICAgYXBwbHlDb21wYXJlQ2hhbmdlcywKICAgICAgY2xvc2VDb21wYXJlRGlhbG9nLAogICAgICBxdWlsbFNlbGVjdGlvbiwKICAgICAgcXVpbGxTZWxlY3RlZFRleHQsCiAgICAgIGhhc1ZhbGlkU2VsZWN0aW9uLAogICAgICBvblNlbGVjdGlvbkNoYW5nZSwKICAgICAgcXVpbGxJbnN0YW5jZSwKICAgICAgZ3JhbW1hckNoZWNrVGV4dCwKICAgICAgdHJhbnNsYXRlRGlhbG9nVmlzaWJsZSwKICAgICAgdHJhbnNsYXRlSW5wdXQsCiAgICAgIHRyYW5zbGF0ZVJlc3VsdCwKICAgICAgdHJhbnNsYXRlTG9hZGluZywKICAgICAgdGFyZ2V0TGFuZywKICAgICAgb3BlblRyYW5zbGF0ZURpYWxvZywKICAgICAgdXNlU2VsZWN0ZWRUZXh0Rm9yVHJhbnNsYXRlLAogICAgICBkb1RyYW5zbGF0ZSwKICAgICAgcWFEaWFsb2dWaXNpYmxlLAogICAgICBxYVF1ZXN0aW9uLAogICAgICBxYUFuc3dlciwKICAgICAgcWFMb2FkaW5nLAogICAgICBvcGVuUWFEaWFsb2csCiAgICAgIGRvUWEsCiAgICAgIHFhQW5zd2VySHRtbCwKICAgICAgcmVwbGFjZVNlbGVjdGlvbldpdGhUcmFuc2xhdGlvbiwKICAgICAgdHJhbnNsYXRlTW9kaWZpZWRDb250ZW50LAogICAgICBkb2N1bWVudHNMb2FkaW5nLAogICAgICBkb2N1bWVudENhY2hlLAogICAgICBzY3JvbGxUb0FjdGl2ZURvY3VtZW50LAogICAgICBnb0JhY2sKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["ref","computed","watch","onMounted","nextTick","useRoute","useRouter","ElMessage","ElMessageBox","ElLoading","_","getDocuments","getDocumentDetail","createDocument","updateDocument","deleteDocument","apiDeleteDocument","shareDocument","apiShareDocument","expandContent","apiExpandContent","polishText","apiPolishText","grammarCheck","translateText","docQa","Document","Plus","CircleCheck","Download","More","Search","ArrowLeft","ArrowRight","Share","ShareIcon","Edit","StarFilled","ChatDotRound","QuestionFilled","ArrowLeftBold","Loading","QuillEditor","QuillBetterTable","marked","markedHighlight","hljs","use","langPrefix","highlight","code","lang","language","getLanguage","value","Quill","register","gfm","breaks","pedantic","sanitize","smartLists","smartypants","name","components","setup","router","route","goBack","push","documents","currentDoc","documentChanged","isDocListCollapsed","isAssistantCollapsed","searchQuery","docTypeFilter","sortOption","newDocumentDialogVisible","shareDialogVisible","deleteDialogVisible","selectedUsers","availableUsers","documentsLoading","saveLoading","createLoading","shareLoading","deleteLoading","expandLoading","polishLoading","grammarCheckLoading","newDocumentForm","title","type","documentFormRules","required","message","trigger","min","max","documentFormRef","uploadImage","file","reader","FileReader","Promise","resolve","reject","onload","e","base64Data","target","result","url","onerror","Error","readAsDataURL","error","console","editorOptions","placeholder","modules","toolbar","container","handlers","image","input","document","createElement","setAttribute","click","onchange","files","size","supportedTypes","includes","info","res","quill","quillInstance","range","getSelection","insertEmbed","index","success","filteredDocuments","query","toLowerCase","filter","doc","typeFilter","sort","a","b","Date","update_time","create_time","localeCompare","fetchDocuments","page","allDocs","log","params","limit","_t","getTime","response","docsList","totalCount","currentPageDocs","hasMore","data","Array","isArray","count","total","length","results","next","existingIds","Set","map","id","newDocs","has","setTimeout","loading","documentCache","Map","selectDocument","_currentDoc$value","confirm","confirmButtonText","cancelButtonText","distinguishCancelAndClose","saveDocument","originalDoc","content","cachedDoc","get","replace","fetchDocumentDetail","retry","warn","set","entries","from","recentEntries","slice","trim","warning","errorMsg","status","detail","toggleDocList","toggleAssistant","onEditorChange","openNewDocumentDialog","createNewDocument","validate","valid","username","confirmShare","confirmDelete","deletedDocId","window","localStorage","removeItem","location","href","exportDocument","showCancelButton","closeOnClickModal","callback","action","exportToPdf","exportToWord","docTitle","filename","editorDom","querySelector","contentElement","cloneNode","options","margin","quality","html2canvas","scale","useCORS","jsPDF","unit","format","orientation","service","lock","text","background","then","html2pdfModule","html2pdf","default","save","close","catch","contentContainer","innerHTML","msWordHtml","FileSaver","saveAs","blob","Blob","printDocument","addCollaborator","viewHistory","quillSelection","quillSelectedText","hasValidSelection","onSelectionChange","oldRange","source","getText","JSON","stringify","MAX_AI_TEXT_LENGTH","getCurrentSelectionWithText","selection","textLength","getLength","getCurrentSelection","safeSetSelection","safeIndex","Math","safeLength","setSelection","refreshQuillEditor","focus","selectedText","showCompareDialog","original","modified","onApply","finalContent","quillLen","insertPos","deleteText","insertText","selPos","style","compareDialogVisible","compareDialogData","modifiedContent","applyCompareChanges","closeCompareDialog","debouncedSearch","debounce","formatDate","dateString","date","now","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","weekDays","diffDays","round","getDay","toLocaleDateString","month","day","newId","oldId","idNum","Number","isNaN","isInteger","immediate","_refresh","newVal","docId","setInterval","fetchInitialData","refreshDocumentData","scrollToActiveDocument","activeDoc","scrollIntoView","behavior","block","onTitleChange","val","onTypeChange","onContentChange","currentContent","originalContent","scrollQuillToBottom","onEditorReady","on","toolbarTooltips","getModule","selector","elements","querySelectorAll","forEach","el","hasAttribute","currentSelection","root","scrollTop","scrollHeight","grammarCheckText","suggestions","suggestionsHtml","parse","correctedText","corrected","optimizedTextMatch","match","finalCorrectedText","translateDialogVisible","translateInput","translateResult","translateLoading","targetLang","translateModifiedContent","openTranslateDialog","useSelectedTextForTranslate","doTranslate","target_lang","translated","replaceSelectionWithTranslation","clipboard","dangerouslyPasteHTML","cursor","qaDialogVisible","qaQuestion","qaAnswer","qaLoading","qaAnswerHtml","openQaDialog","doQa","question","context","answer"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue"],"sourcesContent":["<template>\n  <div class=\"smart-doc-container\">\n    <!-- 文档列表侧边栏 -->\n    <div class=\"sidebar\" :class=\"{ 'collapsed': isDocListCollapsed }\">\n      <!-- 侧边栏头部 -->\n      <div class=\"sidebar-header\">\n        <h4 v-if=\"!isDocListCollapsed\">我的文档</h4>\n        <div class=\"toggle-btn\" @click=\"toggleDocList\">\n          <el-icon><ArrowLeft v-if=\"!isDocListCollapsed\" /><ArrowRight v-else /></el-icon>\n        </div>\n      </div>\n\n      <!-- 展开状态的文档列表 -->\n      <div class=\"sidebar-content\" v-show=\"!isDocListCollapsed\">\n        <!-- 搜索和筛选区域 -->\n        <div class=\"search-area\">\n          <el-input\n            placeholder=\"搜索文档...\"\n            v-model=\"searchQuery\"\n            clearable\n            @input=\"debouncedSearch\"\n          >\n            <template #prefix>\n              <el-icon><Search /></el-icon>\n            </template>\n          </el-input>\n          <div class=\"filter-options\">\n            <el-input v-model=\"docTypeFilter\" placeholder=\"文档类型\" size=\"small\" clearable />\n            <el-select v-model=\"sortOption\" placeholder=\"排序\" size=\"small\">\n              <el-option label=\"最近更新\" value=\"update\" />\n              <el-option label=\"最近创建\" value=\"create\" />\n              <el-option label=\"名称升序\" value=\"name-asc\" />\n            </el-select>\n          </div>\n        </div>\n\n        <!-- 文档列表区域 -->\n        <el-scrollbar class=\"document-list-scrollbar\">\n          <div v-if=\"documentsLoading\" class=\"loading-state\">\n            <el-skeleton :rows=\"10\" animated />\n          </div>\n          <div v-else class=\"document-list\">\n            <div \n              v-for=\"doc in filteredDocuments\" \n              :key=\"doc.id\" \n              class=\"doc-item\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <div class=\"doc-icon\">\n                <el-icon><Document /></el-icon>\n              </div>\n              <div class=\"doc-info\">\n                <h5>{{ doc.title }}</h5>\n                <div class=\"doc-meta\">\n                  <span>{{ doc.type }}</span>\n                  <span>{{ formatDate(doc.update_time) }}</span>\n                </div>\n              </div>\n            </div>\n            \n            <div v-if=\"filteredDocuments.length === 0\" class=\"empty-state\">\n              <el-empty description=\"暂无文档\" :image-size=\"60\">\n                <el-button size=\"small\" @click=\"fetchDocuments(1, [])\">重新加载</el-button>\n              </el-empty>\n            </div>\n            \n            <div v-if=\"filteredDocuments.length > 0\" class=\"document-count\">\n              共 {{ filteredDocuments.length }} 个文档\n            </div>\n          </div>\n        </el-scrollbar>\n\n        <!-- 创建按钮区域 -->\n        <div class=\"action-buttons\">\n          <el-button type=\"primary\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon> 新建文档\n          </el-button>\n        </div>\n      </div>\n\n      <!-- 折叠状态的文档图标列表 -->\n      <div class=\"collapsed-sidebar\" v-if=\"isDocListCollapsed\">\n        <el-tooltip content=\"新建文档\" placement=\"right\">\n          <div class=\"icon-btn create-btn\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon>\n          </div>\n        </el-tooltip>\n        \n        <div class=\"recent-docs\">\n          <el-tooltip \n            v-for=\"doc in filteredDocuments.slice(0, 5)\" \n            :key=\"doc.id\" \n            :content=\"doc.title\"\n            placement=\"right\"\n          >\n            <div \n              class=\"icon-btn doc-btn\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <el-icon><Document /></el-icon>\n            </div>\n          </el-tooltip>\n        </div>\n      </div>\n    </div>\n\n    <!-- 主内容区域 -->\n    <div class=\"main-content\">\n      <!-- 文档内容显示区域 -->\n      <div class=\"document-content\">\n        <el-skeleton v-if=\"loading\" :rows=\"6\" animated style=\"margin:40px\" />\n        <template v-else-if=\"currentDoc\">\n          <!-- 文档标题和操作栏 -->\n          <div class=\"document-header\">\n            <div class=\"header-left-actions\">\n              <el-tooltip content=\"返回列表\" placement=\"bottom\">\n                <el-button @click=\"goBack\" circle>\n                  <el-icon><ArrowLeftBold /></el-icon>\n                </el-button>\n              </el-tooltip>\n            </div>\n            <div class=\"doc-info-area\">\n              <div class=\"doc-title-label\">标题：</div>\n              <div class=\"doc-title\">\n                <el-input \n                  v-model=\"currentDoc.title\"\n                  placeholder=\"文档标题\"\n                  size=\"large\"\n                  @change=\"onTitleChange\"\n                />\n              </div>\n              <div class=\"doc-type-label\">类型：</div>\n              <div class=\"doc-type-selector\">\n                <el-input \n                  v-model=\"currentDoc.type\" \n                  placeholder=\"输入文档类型\"\n                  size=\"default\"\n                  @change=\"onTypeChange\"\n                />\n              </div>\n            </div>\n            <div class=\"doc-actions\">\n              <el-tooltip content=\"保存文档\" placement=\"bottom\">\n                <el-button \n                  circle\n                  :disabled=\"!documentChanged\" \n                  :loading=\"saveLoading\"\n                  @click=\"saveDocument\"\n                >\n                  <el-icon><CircleCheck /></el-icon>\n                </el-button>\n              </el-tooltip>\n              <el-tooltip content=\"分享文档\" placement=\"bottom\">\n                <el-button circle @click=\"shareDocument\"><el-icon><ShareIcon /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"导出文档\" placement=\"bottom\">\n                <el-button circle @click=\"exportDocument\"><el-icon><Download /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"更多操作\" placement=\"bottom\">\n                <el-dropdown trigger=\"click\">\n                  <el-button circle><el-icon><More /></el-icon></el-button>\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                      <el-dropdown-item @click=\"deleteDocument\" class=\"text-red-500\">删除文档</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </el-tooltip>\n            </div>\n          </div>\n          \n          <!-- 编辑器区域 -->\n          <div class=\"editor-area\">\n            <QuillEditor\n              v-model:content=\"currentDoc.content\"\n              :options=\"editorOptions\"\n              contentType=\"html\"\n              theme=\"snow\"\n              class=\"quill-editor\"\n              @textChange=\"onContentChange\"\n              @ready=\"onEditorReady\"\n              placeholder=\" \"\n            />\n          </div>\n        </template>\n        \n        <!-- 无文档时的提示 -->\n        <div v-else class=\"empty-doc-state\">\n          <el-empty description=\"请选择或创建一个文档\">\n            <el-button type=\"primary\" @click=\"openNewDocumentDialog\">新建文档</el-button>\n          </el-empty>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 智能助手面板 -->\n    <div class=\"assistant-panel\" :class=\"{ 'collapsed': isAssistantCollapsed }\">\n      <div class=\"assistant-header\">\n        <h5 v-if=\"!isAssistantCollapsed\">AI功能</h5>\n        <div class=\"toggle-btn\" @click=\"toggleAssistant\">\n          <el-icon><ArrowRight v-if=\"!isAssistantCollapsed\" /><ArrowLeft v-else /></el-icon>\n        </div>\n      </div>\n      \n      <div class=\"assistant-body\" v-show=\"!isAssistantCollapsed\">\n        <div class=\"ai-features-beauty\">\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"hasValidSelection\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"primary\" class=\"ai-feature-btn\" @click=\"expandContent\" :loading=\"expandLoading\" :disabled=\"!hasValidSelection\">\n                <el-icon class=\"ai-icon\"><Edit /></el-icon>\n                内容扩写\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">将选中文本智能扩展为更丰富内容，适合写作、报告等场景。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"hasValidSelection\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"success\" class=\"ai-feature-btn\" @click=\"polishText\" :loading=\"polishLoading\" :disabled=\"!hasValidSelection\">\n                <el-icon class=\"ai-icon\"><StarFilled /></el-icon>\n                文本润色\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">让表达更专业、流畅，提升文档整体质量。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"hasValidSelection\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"warning\" class=\"ai-feature-btn\" @click=\"grammarCheckText\" :loading=\"grammarCheckLoading\" :disabled=\"!hasValidSelection\">\n                <el-icon class=\"ai-icon\"><Edit /></el-icon>\n                智能纠错\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">AI自动检查语法、错别字、表达不通顺并给出优化建议。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-button type=\"info\" class=\"ai-feature-btn\" @click=\"openTranslateDialog\">\n              <el-icon class=\"ai-icon\"><ChatDotRound /></el-icon>\n              多语言翻译\n            </el-button>\n            <div class=\"ai-feature-desc\">支持多语种精准互译，助力国际化办公。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-button type=\"success\" class=\"ai-feature-btn\" @click=\"openQaDialog\">\n              <el-icon class=\"ai-icon\"><QuestionFilled /></el-icon>\n              智能问答\n            </el-button>\n            <div class=\"ai-feature-desc\">基于文档内容，AI即时解答你的问题。</div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 折叠状态的AI功能图标列表 -->\n      <div class=\"collapsed-assistant\" v-if=\"isAssistantCollapsed\">\n        <el-tooltip :content=\"hasValidSelection ? '内容扩写' : '请先在编辑器中选择文本'\" placement=\"left\">\n          <div class=\"icon-btn\" @click=\"expandContent\" :class=\"{ 'disabled': !hasValidSelection || expandLoading }\">\n            <el-icon v-if=\"expandLoading\" class=\"is-loading\"><Loading /></el-icon>\n            <el-icon v-else><Edit /></el-icon>\n          </div>\n        </el-tooltip>\n        <el-tooltip :content=\"hasValidSelection ? '文本润色' : '请先在编辑器中选择文本'\" placement=\"left\">\n          <div class=\"icon-btn\" @click=\"polishText\" :class=\"{ 'disabled': !hasValidSelection || polishLoading }\">\n            <el-icon v-if=\"polishLoading\" class=\"is-loading\"><Loading /></el-icon>\n            <el-icon v-else><StarFilled /></el-icon>\n          </div>\n        </el-tooltip>\n        <el-tooltip :content=\"hasValidSelection ? '智能纠错' : '请先在编辑器中选择文本'\" placement=\"left\">\n          <div class=\"icon-btn\" @click=\"grammarCheckText\" :class=\"{ 'disabled': !hasValidSelection || grammarCheckLoading }\">\n            <el-icon v-if=\"grammarCheckLoading\" class=\"is-loading\"><Loading /></el-icon>\n            <el-icon v-else><Edit /></el-icon>\n          </div>\n        </el-tooltip>\n        <el-tooltip content=\"多语言翻译\" placement=\"left\">\n          <div class=\"icon-btn\" @click=\"openTranslateDialog\">\n            <el-icon><ChatDotRound /></el-icon>\n          </div>\n        </el-tooltip>\n        <el-tooltip content=\"智能问答\" placement=\"left\">\n          <div class=\"icon-btn\" @click=\"openQaDialog\">\n            <el-icon><QuestionFilled /></el-icon>\n          </div>\n        </el-tooltip>\n      </div>\n    </div>\n\n    <!-- 创建新文档对话框 -->\n    <el-dialog\n      v-model=\"newDocumentDialogVisible\"\n      title=\"新建智能文档\"\n      width=\"35%\"\n    >\n      <el-form \n        :model=\"newDocumentForm\" \n        label-width=\"80px\" \n        :rules=\"documentFormRules\"\n        ref=\"documentFormRef\"\n      >\n        <el-form-item label=\"文档标题\" prop=\"title\">\n          <el-input v-model=\"newDocumentForm.title\" placeholder=\"请输入文档标题\" />\n        </el-form-item>\n        <el-form-item label=\"文档类型\">\n          <el-input v-model=\"newDocumentForm.type\" placeholder=\"请输入文档类型\" />\n          <div class=\"form-tip\">如果未填写，默认为通用类型</div>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"newDocumentDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"createNewDocument\" :loading=\"createLoading\">\n            创建\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 分享文档对话框 -->\n    <el-dialog\n      v-model=\"shareDialogVisible\"\n      title=\"分享文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您即将分享文档: <strong>{{ currentDoc.title }}</strong></p>\n        <el-form label-width=\"120px\" class=\"mt-4\">\n          <el-form-item label=\"选择用户\">\n            <el-select\n              v-model=\"selectedUsers\"\n              multiple\n              placeholder=\"请选择用户\"\n              style=\"width: 100%\"\n            >\n              <el-option\n                v-for=\"user in availableUsers\"\n                :key=\"user.id\"\n                :label=\"user.username\"\n                :value=\"user.id\"\n              />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"shareDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"confirmShare\" :loading=\"shareLoading\">\n            分享\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 删除确认对话框 -->\n    <el-dialog\n      v-model=\"deleteDialogVisible\"\n      title=\"删除文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您确定要删除文档 <strong>{{ currentDoc.title }}</strong> 吗?</p>\n        <p class=\"warning-text\">此操作不可撤销!</p>\n        </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"deleteDialogVisible = false\">取消</el-button>\n          <el-button type=\"danger\" @click=\"confirmDelete\" :loading=\"deleteLoading\">\n            删除\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 比较弹窗 -->\n    <el-dialog\n      v-model=\"compareDialogVisible\"\n      :title=\"compareDialogData.title\"\n      width=\"90%\"\n      class=\"compare-dialog large-dialog\"\n      :fullscreen=\"false\"\n      :append-to-body=\"true\"\n      :destroy-on-close=\"false\"\n      :close-on-click-modal=\"false\"\n      :show-close=\"true\"\n    >\n      <div v-if=\"compareDialogData\" class=\"dialog-container\">\n        <div class=\"compare-content\">\n          <div class=\"original-content\">\n            <h6>原始内容</h6>\n            <QuillEditor\n              v-model:content=\"compareDialogData.original\"\n              contentType=\"text\"\n              theme=\"snow\"\n              :readOnly=\"true\"\n              class=\"quill-editor-in-dialog\"\n              style=\"background:#f9f9f9;\"\n            />\n          </div>\n          <div class=\"modified-content\">\n            <h6>优化建议内容（可编辑）</h6>\n            <QuillEditor\n              v-model:content=\"compareDialogData.modifiedContent\"\n              contentType=\"text\"\n              theme=\"snow\"\n              class=\"quill-editor-in-dialog\"\n            />\n          </div>\n        </div>\n        <div v-if=\"compareDialogData.suggestions\" class=\"ai-suggestions\" style=\"margin-top:16px;\">\n          <el-alert\n            title=\"AI纠错建议\"\n            type=\"info\"\n            :closable=\"false\"\n            show-icon\n            style=\"font-size:15px;line-height:1.8;\"\n          >\n            <div v-html=\"compareDialogData.suggestions\"></div>\n          </el-alert>\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"closeCompareDialog\">取消</el-button>\n          <el-button type=\"primary\" @click=\"applyCompareChanges\">应用更改</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 多语言翻译弹窗（对比模式） -->\n    <el-dialog v-model=\"translateDialogVisible\" title=\"多语言智能翻译\" width=\"900px\" destroy-on-close>\n      <div style=\"margin-bottom:12px; display:flex; align-items:center; gap:12px;\">\n        <el-select v-model=\"targetLang\" placeholder=\"选择目标语言\" style=\"width:180px;\">\n          <el-option label=\"英文\" value=\"en\" />\n          <el-option label=\"中文\" value=\"zh\" />\n          <el-option label=\"日文\" value=\"ja\" />\n          <el-option label=\"法文\" value=\"fr\" />\n          <el-option label=\"德文\" value=\"de\" />\n          <el-option label=\"西班牙文\" value=\"es\" />\n          <el-option label=\"俄文\" value=\"ru\" />\n          <el-option label=\"韩文\" value=\"ko\" />\n        </el-select>\n        <el-button type=\"primary\" :loading=\"translateLoading\" @click=\"doTranslate\">翻译</el-button>\n      </div>\n      <div class=\"compare-content\">\n        <div class=\"original-content\">\n          <h6>原文内容</h6>\n          <QuillEditor\n            v-model:content=\"translateInput\"\n            contentType=\"text\"\n            theme=\"snow\"\n            :readOnly=\"true\"\n            class=\"quill-editor-in-dialog\"\n            style=\"background:#f9f9f9;\"\n          />\n        </div>\n        <div class=\"modified-content\">\n          <h6>翻译内容（可编辑）</h6>\n          <QuillEditor\n            v-model:content=\"translateModifiedContent\"\n            contentType=\"text\"\n            theme=\"snow\"\n            class=\"quill-editor-in-dialog\"\n          />\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"translateDialogVisible = false\">取消</el-button>\n          <el-button v-if=\"translateModifiedContent\" type=\"success\" @click=\"replaceSelectionWithTranslation\">应用翻译</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 智能问答弹窗 -->\n    <el-dialog v-model=\"qaDialogVisible\" title=\"文档智能问答\" width=\"500px\">\n      <el-input\n        v-model=\"qaQuestion\"\n        placeholder=\"请输入您的问题\"\n        style=\"margin-bottom:12px;\"\n        @keyup.enter=\"doQa\"\n      />\n      <el-button type=\"primary\" :loading=\"qaLoading\" @click=\"doQa\">提问</el-button>\n      <div v-if=\"qaAnswer\" style=\"margin-top:16px;\">\n        <el-alert title=\"AI答案\" type=\"info\" :closable=\"false\" show-icon>\n          <div v-html=\"qaAnswerHtml\"></div>\n        </el-alert>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, watch, onMounted, nextTick } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox, ElLoading } from 'element-plus'\nimport _ from 'lodash'\nimport { \n  getDocuments, \n  getDocumentDetail, \n  createDocument, \n  updateDocument,\n  deleteDocument as apiDeleteDocument,\n  shareDocument as apiShareDocument,\n  expandContent as apiExpandContent,\n  polishText as apiPolishText,\n  grammarCheck,\n  translateText,\n  docQa\n} from '@/api/smartdoc'\nimport { Document, Plus, CircleCheck, Download, More, Search, ArrowLeft, ArrowRight, Share as ShareIcon, Edit, StarFilled, ChatDotRound, QuestionFilled, ArrowLeftBold, Loading } from '@element-plus/icons-vue'\nimport { QuillEditor } from '@vueup/vue-quill'\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\nimport QuillBetterTable from 'quill-better-table'\nimport 'quill-better-table/dist/quill-better-table.css'\nimport { marked } from 'marked'\nimport { markedHighlight } from 'marked-highlight'\nimport hljs from 'highlight.js'\nimport 'highlight.js/styles/github.css' // 导入代码高亮样式表\n\n// 配置marked\nmarked.use(\n  markedHighlight({\n    langPrefix: 'hljs language-',\n    highlight(code, lang) {\n      const language = hljs.getLanguage(lang) ? lang : 'plaintext';\n      return hljs.highlight(code, { language }).value;\n    }\n  })\n);\n\nQuill.register({\n  'modules/better-table': QuillBetterTable\n}, true)\n\n// 设置安全选项\nmarked.use({\n  gfm: true,\n  breaks: true,\n  pedantic: false,\n  sanitize: false, // marked v4.3.0不再支持sanitize选项\n  smartLists: true,\n  smartypants: false\n});\n\nexport default {\n  name: 'SmartDocDetail',\n  components: {\n    Document, Plus, CircleCheck, Download, More, \n    Search, ArrowLeft, ArrowRight, ShareIcon, QuillEditor, Edit, StarFilled, ChatDotRound, QuestionFilled, ArrowLeftBold, Loading\n  },\n  setup() {\n    const router = useRouter();\n    const route = useRoute();\n    \n    const goBack = () => {\n      router.push('/smartdoc');\n    };\n    \n    // 状态数据\n    const documents = ref([])\n    const currentDoc = ref(null)\n    const documentChanged = ref(false)\n    const isDocListCollapsed = ref(false)\n    const isAssistantCollapsed = ref(false)\n    const searchQuery = ref('')\n    const docTypeFilter = ref('')\n    const sortOption = ref('update')\n    const newDocumentDialogVisible = ref(false)\n    const shareDialogVisible = ref(false)\n    const deleteDialogVisible = ref(false)\n    const selectedUsers = ref([])\n    const availableUsers = ref([])\n    const documentsLoading = ref(true) // 文档加载状态\n    \n    // 加载状态\n    const saveLoading = ref(false)\n    const createLoading = ref(false)\n    const shareLoading = ref(false)\n    const deleteLoading = ref(false)\n    const expandLoading = ref(false)\n    const polishLoading = ref(false)\n    const grammarCheckLoading = ref(false)\n    \n    // 表单数据\n    const newDocumentForm = ref({\n        title: '',\n      type: ''\n    })\n    \n    // 表单验证规则\n    const documentFormRules = {\n      title: [\n        { required: true, message: '请输入文档标题', trigger: 'blur' },\n        { min: 2, max: 50, message: '标题长度须在2到50个字符之间', trigger: 'blur' }\n      ]\n    }\n    \n    const documentFormRef = ref(null)\n      \n    const uploadImage = async (file) => {\n      try {\n        // 使用FileReader将文件转换为base64\n        const reader = new FileReader()\n        return new Promise((resolve, reject) => {\n          reader.onload = (e) => {\n            const base64Data = e.target.result\n            // 直接返回base64数据作为图片URL\n            resolve({ url: base64Data })\n          }\n          reader.onerror = () => {\n            reject(new Error('文件读取失败'))\n          }\n          reader.readAsDataURL(file)\n        })\n      } catch (error) {\n        console.error('图片处理失败:', error)\n        throw error\n      }\n    }\n    \n      // 编辑器配置\n    const editorOptions = {\n      placeholder: ' ',\n        modules: {\n        toolbar: {\n          container: [\n            ['bold', 'italic', 'underline', 'strike'],\n            ['blockquote', 'code-block'],\n          [{ 'header': 1 }, { 'header': 2 }],\n          [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n          [{ 'script': 'sub' }, { 'script': 'super' }],\n          [{ 'indent': '-1' }, { 'indent': '+1' }],\n          [{ 'direction': 'rtl' }],\n          [{ 'size': ['small', false, 'large', 'huge'] }],\n          [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n          [{ 'color': [] }, { 'background': [] }],\n          [{ 'font': [] }],\n          [{ 'align': [] }],\n            ['clean'],\n          ['link', 'image', 'table']\n          ],\n          handlers: {\n            image: function () {\n              const input = document.createElement('input')\n              input.setAttribute('type', 'file')\n              input.setAttribute('accept', 'image/*')\n              input.click()\n              input.onchange = async () => {\n                const file = input.files[0]\n                if (!file) return\n                \n                // 检查文件大小和类型\n                if (file.size > 5 * 1024 * 1024) { // 5MB限制\n                  ElMessage.error('图片不能超过5MB')\n                  return\n                }\n                \n                // 支持的图片类型\n                const supportedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n                if (!supportedTypes.includes(file.type)) {\n                  ElMessage.error('只支持JPG、PNG、GIF和WEBP格式图片')\n                  return\n                }\n                \n                ElMessage.info('正在处理图片...')\n                \n                try {\n                  // 直接传递文件对象而不是FormData\n                  const res = await uploadImage(file)\n                  const url = res.url\n                  if (!url) throw new Error('无效的图片URL')\n                  \n                  // 获取编辑器实例并插入图片\n                  const quill = quillInstance.value\n                  const range = quill.getSelection(true)\n                  quill.insertEmbed(range.index, 'image', url)\n                  \n                  // 标记文档已修改\n                  documentChanged.value = true\n                  \n                  ElMessage.success('图片插入成功')\n                } catch (e) {\n                  console.error('图片处理失败:', e)\n                  ElMessage.error('图片处理失败: ' + e.message)\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    \n    // 计算属性\n    const filteredDocuments = computed(() => {\n      let result = [...documents.value]\n      \n      // 搜索筛选\n      if (searchQuery.value) {\n        const query = searchQuery.value.toLowerCase()\n        result = result.filter(doc => \n          doc.title.toLowerCase().includes(query) || \n          doc.type.toLowerCase().includes(query)\n        )\n      }\n      \n      // 类型筛选\n      if (docTypeFilter.value) {\n        const typeFilter = docTypeFilter.value.toLowerCase()\n        result = result.filter(doc => \n          doc.type.toLowerCase().includes(typeFilter)\n        )\n      }\n      \n      // 排序\n      if (sortOption.value === 'update') {\n        result.sort((a, b) => new Date(b.update_time) - new Date(a.update_time))\n      } else if (sortOption.value === 'create') {\n        result.sort((a, b) => new Date(b.create_time) - new Date(a.create_time))\n      } else if (sortOption.value === 'name-asc') {\n        result.sort((a, b) => a.title.localeCompare(b.title))\n      }\n      \n      return result\n    })\n    \n    // 方法\n    const fetchDocuments = async (page = 1, allDocs = []) => {\n      if (page === 1) {\n        documentsLoading.value = true\n      }\n      \n      try {\n        console.log(`开始获取文档列表 第${page}页...`)\n        const params = {\n          page: page,\n          limit: 100,  // 尝试请求更多，尽管后端可能只会返回10条（默认PAGE_SIZE）\n          _t: new Date().getTime() // 添加时间戳，确保不使用缓存\n        }\n        \n        const response = await getDocuments(params)\n        console.log(`文档列表响应(第${page}页):`, response)\n        \n        // 处理获取到的数据\n        let docsList = [...allDocs]\n        let totalCount = 0\n        let currentPageDocs = []\n        let hasMore = false\n        \n        // 处理不同格式的响应\n        if (response.data && Array.isArray(response.data)) {\n          currentPageDocs = response.data\n          totalCount = response.count || response.total || 0\n          hasMore = docsList.length + currentPageDocs.length < totalCount\n        } else if (response.results && Array.isArray(response.results)) {\n          currentPageDocs = response.results\n          totalCount = response.count || 0\n          hasMore = !!response.next\n        } else if (response.data && response.data.results && Array.isArray(response.data.results)) {\n          currentPageDocs = response.data.results\n          totalCount = response.data.count || 0\n          hasMore = !!response.data.next\n        }\n        \n        // 确保不添加重复的文档\n        const existingIds = new Set(docsList.map(doc => doc.id))\n        const newDocs = currentPageDocs.filter(doc => !existingIds.has(doc.id))\n        \n        if (newDocs.length > 0) {\n          docsList = [...docsList, ...newDocs]\n          console.log(`第${page}页添加了${newDocs.length}个新文档，当前共有${docsList.length}个文档`)\n        } else {\n          console.log(`第${page}页没有新文档，可能是达到了末尾或出现了重复数据`)\n        }\n        \n        // 更新文档列表\n        documents.value = docsList\n        \n        // 如果没有更多数据或已经加载了足够多的文档，则停止递归\n        if (!hasMore || currentPageDocs.length === 0 || page >= 50) {\n          console.log(`文档加载完成，共${docsList.length}个文档${hasMore ? '（但还有更多）' : ''}`)\n          documentsLoading.value = false\n          return docsList\n        }\n        \n        // 如果文档数量太少（比如小于50），并且有更多数据，继续加载下一页\n        if (docsList.length < 200 && hasMore) {\n          console.log(`已获取 ${docsList.length}/${totalCount || '未知'} 个文档，加载下一页...`)\n          // 延迟100ms避免请求过于频繁\n          await new Promise(resolve => setTimeout(resolve, 100))\n          // 递归加载下一页\n          return fetchDocuments(page + 1, docsList)\n        } else {\n          console.log(`已加载足够的文档(${docsList.length}个)或达到限制，停止加载更多`)\n          documentsLoading.value = false\n          return docsList\n        }\n      } catch (error) {\n        console.error('获取文档列表失败', error)\n        ElMessage.error('获取文档列表失败，已加载部分数据')\n        documentsLoading.value = false\n        documents.value = allDocs // 保留已加载的文档\n        return allDocs\n      }\n    }\n    \n    const loading = ref(false)\n    \n    // 添加一个文档缓存对象\n    const documentCache = ref(new Map());\n    \n    const selectDocument = async (id) => {\n      console.log(`选择文档: ${id}, 当前文档: ${currentDoc.value?.id}`);\n      \n      // 如果点击的是当前文档，不执行任何操作\n      if (currentDoc.value && currentDoc.value.id === id) {\n        console.log('已经选中该文档，不执行任何操作');\n        return;\n      }\n      \n      // 如果当前文档已修改，提示保存\n      if (documentChanged.value && currentDoc.value) {\n        try {\n          await ElMessageBox.confirm(\n            '当前文档已修改但未保存，是否保存更改？',\n            '保存提示',\n            {\n              confirmButtonText: '保存',\n              cancelButtonText: '不保存',\n              type: 'warning',\n              distinguishCancelAndClose: true // 允许区分取消和关闭\n            }\n          )\n          await saveDocument()\n        } catch (error) {\n          // 用户选择不保存或点×，撤销本地更改，恢复原内容\n          if (error === 'cancel' || error === 'close') {\n            if (currentDoc.value && originalDoc.value) {\n              currentDoc.value.title = originalDoc.value.title\n              currentDoc.value.type = originalDoc.value.type\n              currentDoc.value.content = originalDoc.value.content\n              documentChanged.value = false\n            }\n          }\n          // 用户选择不保存，继续切换文档\n        }\n      }\n      \n      // 快速显示缓存中的文档（如果有）\n      if (documentCache.value.has(id)) {\n        console.log(`使用缓存的文档数据: ${id}`);\n        const cachedDoc = documentCache.value.get(id);\n        \n        // 先设置当前文档为缓存数据，提高用户体验\n        currentDoc.value = cachedDoc;\n        originalDoc.value = {\n          title: cachedDoc.title || '',\n          type: cachedDoc.type || '通用',\n          content: cachedDoc.content || ''\n        };\n        documentChanged.value = false;\n      }\n      \n      // 更新路由以反映新选中的文档\n      router.push({ name: 'SmartDocDetail', params: { id }, replace: true })\n    }\n    \n    // 记录初始内容用于对比\n    const originalDoc = ref({ title: '', type: '', content: '' })\n    \n    const fetchDocumentDetail = async (id, retry = 0) => {\n      // 如果是同一个文档，且已加载，不重复加载\n      if (currentDoc.value && currentDoc.value.id === id && !loading.value) {\n        console.log(`文档 ${id} 已加载，不重复获取`);\n        return;\n      }\n      \n      loading.value = true\n      try {\n        console.log(`正在获取文档详情，ID: ${id}`)\n        const response = await getDocumentDetail(id)\n        console.log('文档详情响应:', response)\n        \n        if (response && response.data) {\n          // 确保文档数据完整\n          if (!response.data.content) {\n            console.warn('文档内容为空，设置为默认空字符串')\n            response.data.content = ''\n          }\n          \n          // 保存文档数据\n          currentDoc.value = response.data\n          \n          // 更新缓存\n          documentCache.value.set(id, { ...response.data });\n          \n          // 如果缓存过大，清理旧缓存\n          if (documentCache.value.size > 20) {\n            // 转换为数组，保留最近的10个\n            const entries = Array.from(documentCache.value.entries());\n            const recentEntries = entries.slice(-10);\n            documentCache.value = new Map(recentEntries);\n          }\n          \n          // 记录初始内容\n          originalDoc.value = {\n            title: response.data.title || '',\n            type: response.data.type || '通用',\n            content: response.data.content || ''\n          }\n          \n          documentChanged.value = false\n          loading.value = false\n          \n          // 检查数据完整性\n          if (!currentDoc.value.content) {\n            console.warn('文档内容可能缺失，尝试重新获取')\n            // 设置一个定时器，在编辑器加载完成后检查内容\n            setTimeout(() => {\n              if (quillInstance.value && (!currentDoc.value.content || currentDoc.value.content.trim() === '')) {\n                ElMessage.warning('文档内容可能不完整，请尝试刷新页面')\n              }\n            }, 2000)\n          }\n        } else {\n          throw new Error('文档不存在或数据无效')\n        }\n      } catch (error) {\n        console.error('获取文档详情失败', error)\n        \n        if (retry < 3) {\n          console.log(`获取文档详情失败，${retry + 1}秒后重试...`)\n          setTimeout(() => fetchDocumentDetail(id, retry + 1), 1000 * (retry + 1))\n        } else {\n          loading.value = false\n          console.error('多次重试后获取文档详情仍然失败', error)\n          const errorMsg = error.response && error.response.status === 404 \n            ? '文档不存在' \n            : error.response && error.response.data && error.response.data.detail \n              ? error.response.data.detail \n              : '获取文档详情失败'\n          \n          ElMessage.error(errorMsg)\n          // 如果是404，导航回文档列表页\n          if (error.response && error.response.status === 404) {\n            router.push('/smartdoc')\n          }\n        }\n      }\n    }\n    \n    const saveDocument = async () => {\n      if (!currentDoc.value || !documentChanged.value) return\n      \n      saveLoading.value = true\n      try {\n        await updateDocument(currentDoc.value.id, {\n          title: currentDoc.value.title,\n          type: currentDoc.value.type,\n          content: currentDoc.value.content\n        })\n        \n        // 保存成功后，更新原始文档记录\n        originalDoc.value = {\n          title: currentDoc.value.title,\n          type: currentDoc.value.type,\n          content: currentDoc.value.content\n        }\n        documentChanged.value = false\n        ElMessage.success('文档保存成功')\n      } catch (error) {\n        console.error('保存文档失败', error)\n        ElMessage.error('保存文档失败')\n      } finally {\n        saveLoading.value = false\n      }\n    }\n    \n    const toggleDocList = () => {\n      isDocListCollapsed.value = !isDocListCollapsed.value\n    }\n    \n    const toggleAssistant = () => {\n      isAssistantCollapsed.value = !isAssistantCollapsed.value\n    }\n    \n    const onEditorChange = () => {\n      documentChanged.value = true\n    }\n    \n    const openNewDocumentDialog = () => {\n      newDocumentForm.value = { title: '', type: '' }\n      newDocumentDialogVisible.value = true\n    }\n    \n    const createNewDocument = async () => {\n      if (!documentFormRef.value) return\n      \n      await documentFormRef.value.validate(async (valid) => {\n        if (valid) {\n          createLoading.value = true\n          try {\n            const response = await createDocument({\n              title: newDocumentForm.value.title,\n              type: newDocumentForm.value.type || '通用',\n              content: ''\n            })\n            \n            ElMessage.success('文档创建成功')\n            newDocumentDialogVisible.value = false\n            \n            // 刷新文档列表并打开新文档\n            await fetchDocuments()\n            router.push({ name: 'SmartDocDetail', params: { id: response.data.id } })\n      } catch (error) {\n            console.error('创建文档失败', error)\n            ElMessage.error('创建文档失败')\n          } finally {\n            createLoading.value = false\n          }\n        }\n      })\n    }\n    \n    const shareDocument = () => {\n      if (!currentDoc.value) return\n      \n      // 在实际项目中，这里应该从API获取可用用户列表\n      availableUsers.value = [\n        { id: 1, username: '张三' },\n        { id: 2, username: '李四' },\n        { id: 3, username: '王五' }\n      ]\n      selectedUsers.value = []\n      shareDialogVisible.value = true\n    }\n    \n    const confirmShare = async () => {\n      if (!currentDoc.value || selectedUsers.value.length === 0) {\n        ElMessage.warning('请选择至少一个用户')\n        return\n      }\n      \n      shareLoading.value = true\n      try {\n        await apiShareDocument(currentDoc.value.id, selectedUsers.value)\n        ElMessage.success('文档分享成功')\n        shareDialogVisible.value = false\n      } catch (error) {\n        console.error('分享文档失败', error)\n        ElMessage.error('分享文档失败')\n      } finally {\n        shareLoading.value = false\n      }\n    }\n    \n    const deleteDocument = () => {\n      if (!currentDoc.value) return\n      \n      deleteDialogVisible.value = true\n    }\n    \n    const confirmDelete = async () => {\n      if (!currentDoc.value) return\n      \n      deleteLoading.value = true\n      try {\n        // 记录将要删除的文档ID，便于调试\n        const deletedDocId = currentDoc.value.id\n        \n        // 执行删除API调用\n        await apiDeleteDocument(deletedDocId)\n        ElMessage.success('文档删除成功')\n        deleteDialogVisible.value = false\n        \n        console.log(`文档已删除，ID: ${deletedDocId}，准备返回列表页面并刷新`)\n        \n        // 清除可能的缓存数据\n        if (window.localStorage) {\n          try {\n            // 移除可能存在的相关缓存\n            localStorage.removeItem(`doc_cache_${deletedDocId}`);\n            // 移除文档列表缓存，确保再次加载时获取最新数据\n            localStorage.removeItem(`doc_list_cache`);\n          } catch (e) {\n            console.error('清除本地缓存失败:', e);\n          }\n        }\n        \n        // 清除当前文档状态，避免可能的内存泄漏\n        currentDoc.value = null;\n        \n        // 使用window.location.href而不是router.replace，强制整个页面刷新\n        // 添加时间戳参数，确保不走缓存\n        window.location.href = '/smartdoc?_refresh=' + new Date().getTime();\n      } catch (error) {\n        console.error('删除文档失败', error)\n        ElMessage.error('删除文档失败')\n      } finally {\n        deleteLoading.value = false\n      }\n    }\n    \n    const exportDocument = () => {\n      ElMessageBox({\n        title: '导出文档',\n        message: '请选择导出格式',\n        showCancelButton: true,\n        confirmButtonText: '导出为PDF',\n        cancelButtonText: '导出为Word',\n        closeOnClickModal: true,\n        callback: (action) => {\n          if (action === 'confirm') {\n            exportToPdf()\n          } else if (action === 'cancel') {\n            exportToWord()\n          }\n        }\n      })\n    }\n    \n    // 导出为PDF\n    const exportToPdf = () => {\n      if (!currentDoc.value || !currentDoc.value.content) {\n        ElMessage.error('没有可导出的文档')\n        return\n      }\n      const docTitle = currentDoc.value.title || '未命名文档'\n      const filename = `${docTitle}.pdf`\n      // 直接克隆quill编辑器内容\n      const editorDom = document.querySelector('.ql-editor')\n      if (!editorDom) {\n        ElMessage.error('未找到编辑器内容')\n        return\n      }\n      const contentElement = editorDom.cloneNode(true)\n      const options = {\n        margin: [15, 15, 15, 15],\n        filename: filename,\n        image: { type: 'jpeg', quality: 0.98 },\n        html2canvas: { scale: 2, useCORS: true },\n        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n      }\n      const loading = ElLoading.service({\n        lock: true,\n        text: '正在生成PDF...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      import('html2pdf.js').then(html2pdfModule => {\n        const html2pdf = html2pdfModule.default\n        html2pdf().from(contentElement).set(options).save().then(() => {\n          loading.close()\n          ElMessage.success('PDF导出成功')\n        }).catch(error => {\n          console.error('PDF导出失败:', error)\n          loading.close()\n          ElMessage.error('PDF导出失败')\n        })\n      }).catch(error => {\n        console.error('加载html2pdf.js失败:', error)\n        loading.close()\n        ElMessage.error('PDF导出功能加载失败')\n      })\n    }\n    \n    // 导出为Word（保留图片）\n    const exportToWord = async () => {\n      if (!currentDoc.value || !currentDoc.value.content) {\n        ElMessage.error('没有可导出的文档')\n        return\n      }\n      \n      const docTitle = currentDoc.value.title || '未命名文档'\n      const filename = `${docTitle}.doc`\n      \n      const loading = ElLoading.service({\n        lock: true,\n        text: '正在生成Word文档...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      \n      try {\n        // 创建一个临时文档容器处理内容\n        const contentContainer = document.createElement('div')\n        contentContainer.innerHTML = currentDoc.value.content\n        // 不再替换图片为占位符，直接保留<img>标签\n        // 创建微软Word兼容的HTML文档\n        const msWordHtml = `\n          <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" \n                xmlns:w=\"urn:schemas-microsoft-com:office:word\" \n                xmlns=\"http://www.w3.org/TR/REC-html40\">\n          <head>\n            <meta charset=\"utf-8\">\n            <title>${docTitle}</title>\n            <style>\n              body { font-family: SimSun, Arial, sans-serif; margin: 1cm; }\n              img { max-width: 100%; height: auto; }\n              p { margin: 0; padding: 0; }\n              h1 { font-size: 18pt; }\n              h2 { font-size: 16pt; }\n              h3 { font-size: 14pt; }\n              table { border-collapse: collapse; width: 100%; }\n              td, th { border: 1px solid #000; padding: 5px; }\n            </style>\n          </head>\n          <body>\n            <h1>${docTitle}</h1>\n            ${contentContainer.innerHTML}\n          </body>\n          </html>\n        `\n        // 使用file-saver保存文件\n        const FileSaver = await import('file-saver')\n        const saveAs = FileSaver.saveAs || FileSaver.default\n        const blob = new Blob([msWordHtml], { type: 'application/msword' })\n        saveAs(blob, filename)\n        loading.close()\n        ElMessage.success('Word文档导出成功')\n      } catch (error) {\n        console.error('Word导出失败:', error)\n        loading.close()\n        ElMessage.error(`Word导出失败: ${error.message || '未知错误'}`)\n      }\n    }\n    \n    const printDocument = () => {\n      ElMessage.info('打印文档功能暂未实现')\n    }\n    \n    const addCollaborator = () => {\n      ElMessage.info('添加协作者功能暂未实现')\n    }\n    \n    const viewHistory = () => {\n      ElMessage.info('查看历史版本功能暂未实现')\n    }\n    \n    // 1. 在setup里加缓存变量\n    const quillSelection = ref(null);\n    const quillSelectedText = ref('');\n\n    // 计算属性：判断是否有有效的选择文本（去除空白字符后不为空）\n    const hasValidSelection = computed(() => {\n      return quillSelectedText.value && quillSelectedText.value.trim().length > 0;\n    });\n\n    // 2. 监听Quill的selection-change事件\n    const onSelectionChange = (range, oldRange, source) => {\n      console.log('=== Quill Selection Change ===');\n      console.log('Range:', range);\n      console.log('Old Range:', oldRange);\n      console.log('Source:', source);\n\n      if (!quillInstance.value) {\n        console.log('Quill实例不存在');\n        return;\n      }\n\n      // 防止在程序化操作时清除选择状态\n      if (source === 'api' && !range) {\n        console.log('API操作导致的空选择，忽略');\n        return;\n      }\n\n      if (range && range.length > 0) {\n        const text = quillInstance.value.getText(range.index, range.length);\n        console.log('选中文本长度:', text.length);\n        console.log('选中文本内容:', JSON.stringify(text));\n        console.log('选中文本(显示):', text);\n\n        // 保存原始文本，不进行trim处理，确保与实际选择一致\n        quillSelectedText.value = text;\n        quillSelection.value = { ...range }; // 深拷贝避免引用问题\n\n        console.log('已保存选择状态');\n      } else {\n        console.log('清除选择状态');\n        quillSelectedText.value = '';\n        quillSelection.value = null;\n      }\n      console.log('=== End Selection Change ===');\n    };\n\n    // 1. 最大长度常量\n    const MAX_AI_TEXT_LENGTH = 2000;\n\n    // 辅助函数：获取当前有效的选择和对应文本\n    const getCurrentSelectionWithText = () => {\n      if (!quillInstance.value) return { selection: null, text: '' };\n\n      let selection = quillInstance.value.getSelection();\n      let text = '';\n\n      // 如果当前有选择，直接使用\n      if (selection && selection.length > 0) {\n        text = quillInstance.value.getText(selection.index, selection.length);\n        console.log('使用当前选择:', { selection, text: JSON.stringify(text) });\n        return { selection, text };\n      }\n\n      // 如果当前没有选择，尝试使用缓存的选择和文本\n      if (quillSelection.value && quillSelection.value.length > 0 && quillSelectedText.value) {\n        // 验证缓存的选择是否仍然有效\n        const textLength = quillInstance.value.getLength();\n        if (quillSelection.value.index + quillSelection.value.length <= textLength) {\n          // 直接使用缓存的文本，而不是重新获取，确保一致性\n          selection = quillSelection.value;\n          text = quillSelectedText.value;\n          console.log('使用缓存的选择和文本:', { selection, text: JSON.stringify(text) });\n          return { selection, text };\n        }\n      }\n\n      console.log('没有有效的选择');\n      return { selection: null, text: '' };\n    };\n\n    // 保持向后兼容的getCurrentSelection函数\n    const getCurrentSelection = () => {\n      const result = getCurrentSelectionWithText();\n      return result.selection;\n    };\n\n    // 辅助函数：安全地设置选择状态\n    const safeSetSelection = (index, length = 0, source = 'api') => {\n      if (!quillInstance.value) return;\n\n      try {\n        const textLength = quillInstance.value.getLength();\n        const safeIndex = Math.max(0, Math.min(index, textLength - 1));\n        const safeLength = Math.max(0, Math.min(length, textLength - safeIndex));\n\n        quillInstance.value.setSelection(safeIndex, safeLength, source);\n      } catch (error) {\n        console.warn('设置选择状态失败:', error);\n      }\n    };\n\n    // 刷新编辑器实例的函数\n    const refreshQuillEditor = () => {\n      if (quillInstance.value) {\n        try {\n          // 清除选择状态\n          quillSelectedText.value = '';\n          quillSelection.value = null;\n\n          // 重新获取焦点\n          nextTick(() => {\n            if (quillInstance.value) {\n              quillInstance.value.focus();\n              console.log('Quill编辑器已刷新');\n            }\n          });\n        } catch (error) {\n          console.warn('刷新Quill编辑器失败:', error);\n        }\n      }\n    };\n\n    // 2. expandContent方法加截断\n    const expandContent = async () => {\n      if (!currentDoc.value || expandLoading.value) return;\n      try {\n        expandLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          expandLoading.value = false;\n          return;\n        }\n\n        // 使用新的辅助函数获取选择和文本\n        const { selection, text } = getCurrentSelectionWithText();\n\n        console.log('=== 扩写内容 - 获取选择 ===');\n        console.log('Selection:', selection);\n        console.log('原始文本:', JSON.stringify(text));\n        console.log('缓存的选择文本:', JSON.stringify(quillSelectedText.value));\n\n        let selectedText = text.trim();\n        let range = null;\n        if (selection && selection.length > 0 && selectedText) {\n          range = { ...selection };\n        }\n\n        console.log('处理后的文本:', JSON.stringify(selectedText));\n        console.log('=== End 扩写内容获取 ===');\n\n        if (!selectedText) {\n          ElMessage.warning('请先选择要扩写的文本内容');\n          expandLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在扩写内容，请稍候...');\n        const response = await apiExpandContent(currentDoc.value.id, {\n          selection: selectedText,\n          length: 'medium'\n        });\n        showCompareDialog({\n          title: '内容扩写结果',\n          original: selectedText,\n          modified: response.data.content,\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n\n              // 使用 API 源标记，避免触发不必要的选择变化事件\n              quillInstance.value.deleteText(insertPos, range.length, 'api');\n              quillInstance.value.insertText(insertPos, finalContent, 'api');\n\n              // 设置新的选择位置\n              let selPos = insertPos + finalContent.length;\n              selPos = Math.max(0, Math.min(selPos, quillInstance.value.getLength()));\n\n              // 延迟设置选择，确保文本插入完成\n              nextTick(() => {\n                safeSetSelection(selPos, 0, 'api');\n                documentChanged.value = true;\n                ElMessage.success('内容扩写已应用');\n                // 刷新编辑器实例\n                setTimeout(() => {\n                  refreshQuillEditor();\n                }, 100);\n              });\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[内容扩写] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('内容扩写失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('内容扩写失败，请稍后再试');\n        }\n      } finally {\n        expandLoading.value = false;\n      }\n    };\n\n    // 3. polishText同理\n    const polishText = async () => {\n      if (!currentDoc.value || polishLoading.value) return;\n      try {\n        polishLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          polishLoading.value = false;\n          return;\n        }\n\n        // 使用新的辅助函数获取选择和文本\n        const { selection, text } = getCurrentSelectionWithText();\n\n        let selectedText = text.trim();\n        let range = null;\n        if (selection && selection.length > 0 && selectedText) {\n          range = { ...selection };\n        }\n        if (!selectedText) {\n          ElMessage.warning('请先选择要润色的文本内容');\n          polishLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在润色文本，请稍候...');\n        const response = await apiPolishText(currentDoc.value.id, {\n          selection: selectedText,\n          style: 'professional'\n        });\n        showCompareDialog({\n          title: '文本润色结果',\n          original: selectedText,\n          modified: response.data.content,\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n\n              // 使用 API 源标记，避免触发不必要的选择变化事件\n              quillInstance.value.deleteText(insertPos, range.length, 'api');\n              quillInstance.value.insertText(insertPos, finalContent, 'api');\n\n              // 设置新的选择位置\n              let selPos = insertPos + finalContent.length;\n              selPos = Math.max(0, Math.min(selPos, quillInstance.value.getLength()));\n\n              // 延迟设置选择，确保文本插入完成\n              nextTick(() => {\n                safeSetSelection(selPos, 0, 'api');\n                documentChanged.value = true;\n                ElMessage.success('文本润色已应用');\n                // 刷新编辑器实例\n                setTimeout(() => {\n                  refreshQuillEditor();\n                }, 100);\n              });\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[文本润色] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('文本润色失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('文本润色失败，请稍后再试');\n        }\n      } finally {\n        polishLoading.value = false;\n      }\n    };\n    \n    // 添加比较弹窗的状态变量和方法\n    const compareDialogVisible = ref(false)\n    const compareDialogData = ref({\n      title: '',\n      original: '',\n      modified: '',\n      modifiedContent: '',\n      onApply: () => {}\n    })\n    \n    // 显示比较弹窗\n    const showCompareDialog = (data) => {\n      compareDialogData.value = {\n        ...data,\n        modifiedContent: data.modified\n      };\n      compareDialogVisible.value = true;\n    }\n    \n    // 应用比较弹窗的更改\n    const applyCompareChanges = () => {\n      compareDialogData.value.onApply(compareDialogData.value.modifiedContent);\n      compareDialogVisible.value = false;\n    }\n    \n    // 关闭比较弹窗\n    const closeCompareDialog = () => {\n      compareDialogVisible.value = false\n    }\n    \n    // 防抖搜索\n    const debouncedSearch = _.debounce(() => {\n      // 搜索逻辑已通过计算属性处理\n    }, 300)\n    \n    const formatDate = (dateString) => {\n      const date = new Date(dateString)\n      const now = new Date()\n      \n      // 同一天显示时间\n      if (date.toDateString() === now.toDateString()) {\n        return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n      }\n      \n      // 昨天\n      const yesterday = new Date(now)\n      yesterday.setDate(now.getDate() - 1)\n      if (date.toDateString() === yesterday.toDateString()) {\n        return '昨天'\n      }\n      \n      // 一周内显示星期\n      const weekDays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n      const diffDays = Math.round((now - date) / (1000 * 60 * 60 * 24))\n      if (diffDays < 7) {\n        return weekDays[date.getDay()]\n      }\n      \n      // 其他情况显示日期\n      return date.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' })\n    }\n    \n    // 监听路由变化\n    watch(() => route.params.id, (newId, oldId) => {\n      console.log(`路由参数ID变化: ${oldId} -> ${newId}`)\n      if (newId) {\n        // 检查ID是否为有效正整数\n        const idNum = Number(newId)\n        if (isNaN(idNum) || idNum <= 0 || !Number.isInteger(idNum)) {\n          ElMessage.error('无效的文档ID')\n          router.push('/smartdoc')\n          return\n        }\n        \n        // 如果ID发生了变化，重新获取文档\n        if (newId !== oldId) {\n          console.log(`文档ID变化，获取文档详情: ${newId}`)\n          // 检查是否已有缓存\n          if (documentCache.value.has(newId)) {\n            console.log(`使用缓存的文档数据: ${newId}`);\n            currentDoc.value = documentCache.value.get(newId);\n            originalDoc.value = {\n              title: currentDoc.value.title || '',\n              type: currentDoc.value.type || '通用',\n              content: currentDoc.value.content || ''\n            };\n            documentChanged.value = false;\n            \n            // 在后台异步刷新数据\n            setTimeout(() => {\n              fetchDocumentDetail(newId);\n            }, 500);\n          } else {\n            // 没有缓存，直接获取\n            fetchDocumentDetail(newId);\n          }\n        }\n      } else {\n        currentDoc.value = null\n      }\n    }, { immediate: false }) // 设为false避免重复加载\n    \n    // 监听query参数变化，处理强制刷新\n    watch(() => route.query._refresh, (newVal) => {\n      if (newVal) {\n        console.log('检测到强制刷新参数:', newVal)\n        const docId = route.params.id\n        if (docId) {\n          console.log('强制刷新文档详情:', docId)\n          fetchDocumentDetail(docId)\n        }\n        // 同时刷新文档列表\n        fetchDocuments()\n      }\n    })\n    \n    // 自动保存功能\n    setInterval(() => {\n      if (documentChanged.value && currentDoc.value && !saveLoading.value) {\n        saveDocument()\n      }\n    }, 60000) // 每分钟自动保存一次\n    \n    // 生命周期钩子\n    onMounted(() => {\n      fetchInitialData();\n      \n      // 监听路由参数变化，当ID变化时刷新页面数据\n      watch(() => route.params.id, (newId, oldId) => {\n        if (newId && newId !== oldId) {\n          refreshDocumentData(newId);\n        }\n      });\n    })\n    \n    // 滚动到当前选中的文档\n    const scrollToActiveDocument = () => {\n      try {\n        if (!currentDoc.value) return;\n        \n        // 查找当前激活的文档元素\n        const activeDoc = document.querySelector('.doc-item.active');\n        if (activeDoc) {\n          // 使用scrollIntoView滚动到该元素\n          activeDoc.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n        }\n      } catch (error) {\n        console.error('滚动到活动文档失败:', error);\n      }\n    }\n    \n    // 只有内容实际变化才标记为已修改\n    const onTitleChange = (val) => {\n      documentChanged.value = val !== originalDoc.value.title\n    }\n    const onTypeChange = (val) => {\n      documentChanged.value = val !== originalDoc.value.type\n    }\n    const onContentChange = () => {\n      // 修复：正确比较编辑器内容\n      if (currentDoc.value && originalDoc.value) {\n        // 比较当前内容与原始内容是否真的不同\n        const currentContent = currentDoc.value.content\n        const originalContent = originalDoc.value.content\n        documentChanged.value = currentContent !== originalContent\n      }\n      scrollQuillToBottom();\n    }\n    \n    // 编辑器实例\n    const quillInstance = ref(null);\n\n    // 2. 编辑器ready时赋值\n    const onEditorReady = (quill) => {\n      console.log('编辑器就绪');\n      quillInstance.value = quill;\n      quill.on('selection-change', onSelectionChange);\n\n      // 延迟执行，确保工具栏DOM已完全渲染\n      setTimeout(() => {\n        // 为工具栏按钮添加提示\n        const toolbarTooltips = {\n          '.ql-bold': '加粗 (Ctrl+B)',\n          '.ql-italic': '斜体 (Ctrl+I)',\n          '.ql-underline': '下划线 (Ctrl+U)',\n          '.ql-strike': '删除线',\n          '.ql-blockquote': '块级引用',\n          '.ql-code-block': '代码块',\n          '.ql-header[value=\"1\"]': '标题1',\n          '.ql-header[value=\"2\"]': '标题2',\n          '.ql-list[value=\"ordered\"]': '有序列表',\n          '.ql-list[value=\"bullet\"]': '无序列表',\n          '.ql-script[value=\"sub\"]': '下标',\n          '.ql-script[value=\"super\"]': '上标',\n          '.ql-indent[value=\"-1\"]': '减少缩进',\n          '.ql-indent[value=\"+1\"]': '增加缩进',\n          '.ql-direction': '文本方向',\n          '.ql-clean': '清除格式',\n          '.ql-link': '超链接',\n          '.ql-image': '图片',\n          // Pickers (less specific selectors)\n          '.ql-size': '字号',\n          '.ql-header': '段落格式',\n          '.ql-color': '字体颜色',\n          '.ql-background': '背景颜色',\n          '.ql-font': '字体',\n          '.ql-align': '对齐方式',\n        };\n\n        try {\n          const toolbar = quill.getModule('toolbar').container;\n          if (!toolbar) {\n            console.error(\"未能获取编辑器工具栏容器。\");\n            return;\n          }\n          for (const selector in toolbarTooltips) {\n            const elements = toolbar.querySelectorAll(selector);\n            elements.forEach(el => {\n              // 避免覆盖更具体选择器的提示\n              if (!el.hasAttribute('title')) {\n                 el.title = toolbarTooltips[selector];\n              }\n            });\n          }\n        } catch (error) {\n          console.error(\"为编辑器工具栏添加提示时出错:\", error);\n        }\n      }, 200); // 延迟200毫秒\n    };\n    \n    // 智能滚动函数 - 避免干扰文本选择\n    function scrollQuillToBottom() {\n      if (quillInstance.value) {\n        // 保存当前选择状态\n        const currentSelection = quillInstance.value.getSelection();\n\n        const container = quillInstance.value.root;\n        container.scrollTop = container.scrollHeight;\n\n        // 恢复选择状态（如果存在）\n        if (currentSelection && currentSelection.length > 0) {\n          // 使用 nextTick 确保滚动完成后再恢复选择\n          nextTick(() => {\n            try {\n              quillInstance.value.setSelection(currentSelection.index, currentSelection.length);\n            } catch (error) {\n              console.warn('恢复选择状态失败:', error);\n            }\n          });\n        }\n      }\n    }\n    \n    const grammarCheckText = async () => {\n      if (!currentDoc.value || grammarCheckLoading.value) return;\n      try {\n        grammarCheckLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          grammarCheckLoading.value = false;\n          return;\n        }\n\n        // 使用新的辅助函数获取选择和文本\n        const { selection, text } = getCurrentSelectionWithText();\n\n        let selectedText = text.trim();\n        let range = null;\n        if (selection && selection.length > 0 && selectedText) {\n          range = { ...selection };\n        }\n        if (!selectedText) {\n          ElMessage.warning('请先选择要纠错的文本内容');\n          grammarCheckLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在智能纠错，请稍候...');\n        const response = await grammarCheck(currentDoc.value.id, { selection: selectedText });\n        // 只保留建议部分，去除\"优化后的文本\"字样，并将md转为html\n        let suggestions = response.suggestions || '';\n        suggestions = suggestions.replace(/\\*\\*优化后的文本\\*\\*[:：]?([\\s\\S]*)$/, '').trim();\n        const suggestionsHtml = marked.parse(suggestions);\n\n        // 从修正文本中只提取优化后的文本\n        let correctedText = response.corrected || '';\n        const optimizedTextMatch = correctedText.match(/优化后的文本[:：]([\\s\\S]*)/);\n        const finalCorrectedText = optimizedTextMatch ? optimizedTextMatch[1].trim() : correctedText;\n\n        showCompareDialog({\n          title: '智能纠错建议',\n          original: selectedText,\n          modified: finalCorrectedText, // 右侧编辑器直接填优化后文本\n          suggestions: suggestionsHtml, // AI建议区只显示建议，且为html\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n\n              // 使用 API 源标记，避免触发不必要的选择变化事件\n              quillInstance.value.deleteText(insertPos, range.length, 'api');\n              quillInstance.value.insertText(insertPos, finalContent, 'api');\n\n              // 设置新的选择位置\n              let selPos = insertPos + finalContent.length;\n              selPos = Math.max(0, Math.min(selPos, quillInstance.value.getLength()));\n\n              // 延迟设置选择，确保文本插入完成\n              nextTick(() => {\n                safeSetSelection(selPos, 0, 'api');\n                documentChanged.value = true;\n                ElMessage.success('智能纠错已应用');\n                // 刷新编辑器实例\n                setTimeout(() => {\n                  refreshQuillEditor();\n                }, 100);\n              });\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[智能纠错] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('智能纠错失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('智能纠错失败，请稍后再试');\n        }\n      } finally {\n        grammarCheckLoading.value = false;\n      }\n    }\n    \n    // 多语言翻译\n    const translateDialogVisible = ref(false)\n    const translateInput = ref('')\n    const translateResult = ref('')\n    const translateLoading = ref(false)\n    const targetLang = ref('en')\n    const translateModifiedContent = ref('')\n    const openTranslateDialog = () => {\n      if (!quillInstance.value) {\n        ElMessage.error('编辑器未就绪，请稍后重试');\n        return;\n      }\n\n      // 使用新的辅助函数获取选择和文本\n      const { selection, text } = getCurrentSelectionWithText();\n\n      // 清空旧数据\n      translateResult.value = '';\n      translateModifiedContent.value = '';\n\n      if (selection && selection.length > 0) {\n        translateInput.value = text.trim();\n      } else {\n        translateInput.value = '';\n      }\n\n      // 显示对话框\n      translateDialogVisible.value = true;\n    }\n    const useSelectedTextForTranslate = () => {\n      if (!quillInstance.value) return\n      const selection = quillInstance.value.getSelection()\n      if (selection && selection.length > 0) {\n        translateInput.value = quillInstance.value.getText(selection.index, selection.length)\n      }\n    }\n    const doTranslate = async () => {\n      if (!currentDoc.value || !translateInput.value) return\n      translateLoading.value = true\n      try {\n        const res = await translateText(currentDoc.value.id, { selection: translateInput.value, target_lang: targetLang.value })\n        translateResult.value = res.translated\n        translateModifiedContent.value = res.translated\n      } catch (e) {\n        ElMessage.error('翻译失败')\n      } finally {\n        translateLoading.value = false\n      }\n    }\n    const replaceSelectionWithTranslation = () => {\n      if (!quillInstance.value || !translateModifiedContent.value) return\n\n      // 使用辅助函数获取当前有效选择\n      const selection = getCurrentSelection();\n\n      if (selection && selection.length > 0) {\n        const quillLen = quillInstance.value.getLength()\n        let insertPos = selection.index\n        if (insertPos > quillLen) insertPos = quillLen - 1\n\n        // 使用 API 源标记，避免触发不必要的选择变化事件\n        quillInstance.value.deleteText(insertPos, selection.length, 'api')\n        quillInstance.value.clipboard.dangerouslyPasteHTML(insertPos, translateModifiedContent.value, 'api')\n\n        let selPos = insertPos + translateModifiedContent.value.replace(/<[^>]+>/g, '').length\n        if (selPos > quillInstance.value.getLength() - 1) selPos = quillInstance.value.getLength() - 1\n\n        // 延迟设置选择，确保文本插入完成\n        nextTick(() => {\n          safeSetSelection(selPos, 0, 'api')\n          documentChanged.value = true\n          ElMessage.success('已替换为翻译内容')\n          translateDialogVisible.value = false\n          // 刷新编辑器实例\n          setTimeout(() => {\n            refreshQuillEditor();\n          }, 100);\n        });\n      } else {\n        // 未选中内容时插入到光标处\n        const cursor = quillInstance.value.getSelection(true)\n        let insertPos = cursor ? cursor.index : quillInstance.value.getLength() - 1\n        quillInstance.value.insertEmbed(insertPos, 'text', translateModifiedContent.value, 'api')\n\n        nextTick(() => {\n          safeSetSelection(insertPos + translateModifiedContent.value.replace(/<[^>]+>/g, '').length, 0, 'api')\n          documentChanged.value = true\n          ElMessage.success('已插入翻译内容')\n          translateDialogVisible.value = false\n          // 刷新编辑器实例\n          setTimeout(() => {\n            refreshQuillEditor();\n          }, 100);\n        });\n      }\n    }\n\n    // 智能问答\n    const qaDialogVisible = ref(false)\n    const qaQuestion = ref('')\n    const qaAnswer = ref('')\n    const qaLoading = ref(false)\n    \n    // 计算属性：将Markdown格式的回答转换为HTML\n    const qaAnswerHtml = computed(() => {\n      return qaAnswer.value ? marked.parse(qaAnswer.value) : ''\n    })\n    \n    const openQaDialog = () => {\n      qaDialogVisible.value = true\n      qaQuestion.value = ''\n      qaAnswer.value = ''\n    }\n    const doQa = async () => {\n      if (!currentDoc.value || !qaQuestion.value) return\n      qaLoading.value = true\n      try {\n        const res = await docQa(currentDoc.value.id, { question: qaQuestion.value, context: currentDoc.value.content })\n        qaAnswer.value = res.answer\n      } catch (e) {\n        ElMessage.error('问答失败')\n      } finally {\n        qaLoading.value = false\n      }\n    }\n    \n    // 刷新文档数据\n    const refreshDocumentData = async (docId) => {\n      loading.value = true;\n      try {\n        if (docId) {\n          await fetchDocumentDetail(docId);\n        }\n      } catch (error) {\n        console.error('刷新文档数据失败:', error);\n        ElMessage.error('刷新文档数据失败');\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // 初始化数据加载\n    const fetchInitialData = () => {\n      console.log('组件挂载，开始加载数据');\n      \n      // 获取当前文档ID\n      const docId = route.params.id;\n      \n      // 如果有文档ID，优先加载文档详情\n      if (docId) {\n        console.log('有文档ID，优先加载文档详情:', docId);\n        fetchDocumentDetail(docId).then(() => {\n          // 文档详情加载完成后，异步加载文档列表\n          console.log('文档详情加载完成，开始加载文档列表');\n          fetchDocuments().then(() => {\n            // 文档列表加载完成后，滚动到当前文档\n            console.log('文档列表加载完成');\n            nextTick(() => {\n              scrollToActiveDocument();\n            });\n          });\n        });\n      } else {\n        // 没有文档ID，只加载文档列表\n        console.log('没有文档ID，只加载文档列表');\n        fetchDocuments();\n      }\n    };\n    \n    return {\n      documents,\n      currentDoc,\n      documentChanged,\n      isDocListCollapsed,\n      isAssistantCollapsed,\n      searchQuery,\n      docTypeFilter,\n      sortOption,\n      filteredDocuments,\n      newDocumentDialogVisible,\n      shareDialogVisible,\n      deleteDialogVisible,\n      selectedUsers,\n      availableUsers,\n      saveLoading,\n      createLoading,\n      shareLoading,\n      deleteLoading,\n      expandLoading,\n      polishLoading,\n      grammarCheckLoading,\n      newDocumentForm,\n      documentFormRules,\n      documentFormRef,\n      editorOptions,\n      fetchDocuments,\n      fetchDocumentDetail,\n      selectDocument,\n      saveDocument,\n      toggleDocList,\n      toggleAssistant,\n      onEditorChange,\n      openNewDocumentDialog,\n      createNewDocument,\n      shareDocument,\n      confirmShare,\n      deleteDocument,\n      confirmDelete,\n      exportDocument,\n      exportToPdf,\n      exportToWord,\n      printDocument,\n      addCollaborator,\n      viewHistory,\n      expandContent,\n      polishText,\n      debouncedSearch,\n      formatDate,\n      loading,\n      onTitleChange,\n      onTypeChange,\n      onContentChange,\n      onEditorReady,\n      compareDialogVisible,\n      compareDialogData,\n      showCompareDialog,\n      applyCompareChanges,\n      closeCompareDialog,\n      quillSelection,\n      quillSelectedText,\n      hasValidSelection,\n      onSelectionChange,\n      quillInstance,\n      grammarCheckText,\n      translateDialogVisible,\n      translateInput,\n      translateResult,\n      translateLoading,\n      targetLang,\n      openTranslateDialog,\n      useSelectedTextForTranslate,\n      doTranslate,\n      qaDialogVisible,\n      qaQuestion,\n      qaAnswer,\n      qaLoading,\n      openQaDialog,\n      doQa,\n      qaAnswerHtml,\n      replaceSelectionWithTranslation,\n      translateModifiedContent,\n      documentsLoading,\n      documentCache,\n      scrollToActiveDocument,\n      goBack\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n/* 修改整体布局，调整侧边栏和主内容区域的宽度比例 */\n.smart-doc-container {\n  display: flex;\n  height: 100%;\n  overflow: hidden;\n  background-color: #fff;\n}\n\n.sidebar {\n  width: 240px;\n  height: 100%;\n  border-right: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  /* 仅保留宽度变化的过渡，其他动画全部去除 */\n  transition: width 0.3s;\n}\n\n.sidebar.collapsed {\n  width: 50px;\n}\n\n.sidebar-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.sidebar-header h4 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.toggle-btn {\n  cursor: pointer;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n}\n\n.toggle-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.sidebar-content {\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 48px);\n  overflow: hidden;\n}\n\n.search-area {\n  padding: 12px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.filter-options {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.document-list-scrollbar {\n  flex: 1;\n  padding: 8px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  scroll-behavior: smooth; /* 添加平滑滚动效果 */\n}\n\n.document-list-scrollbar :deep(.el-scrollbar__wrap) {\n  overflow-x: hidden;\n  scrollbar-width: thin; /* Firefox */\n}\n\n.document-list-scrollbar :deep(.el-scrollbar__thumb) {\n  background-color: rgba(144, 147, 153, 0.3);\n  border-radius: 6px;\n}\n\n.document-list-scrollbar :deep(.el-scrollbar__thumb:hover) {\n  background-color: rgba(144, 147, 153, 0.5);\n}\n\n.document-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding-right: 4px; /* 为滚动条留出空间 */\n}\n\n.doc-item {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.2s ease; /* 加快过渡速度 */\n}\n\n.doc-item:hover {\n  background-color: #f5f7fa;\n}\n\n.doc-item.active {\n  background-color: #ecf5ff;\n}\n\n.doc-icon {\n  margin-right: 12px;\n  color: #409eff;\n}\n\n.doc-info {\n  flex: 1;\n  overflow: hidden;\n}\n\n.doc-info h5 {\n  margin: 0 0 4px 0;\n  font-size: 14px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.doc-meta {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n  color: #909399;\n}\n\n.action-buttons {\n  padding: 12px;\n  border-top: 1px solid #f0f0f0;\n}\n\n.action-buttons .el-button {\n  width: 100%;\n}\n\n.collapsed-sidebar {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 12px 0;\n  gap: 12px;\n  height: calc(100% - 48px);\n  overflow-y: auto;\n}\n\n.icon-btn {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.icon-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.icon-btn.doc-btn.active {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.create-btn {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.recent-docs {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n  align-items: center;\n}\n\n/* 主内容区域样式 */\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n  height: 100%;\n  background-color: #f6f6f6;\n  position: relative;\n  /* 去除外部滚动 */\n  overflow: hidden;\n}\n\n.document-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  height: 100%;\n  overflow: hidden;\n}\n\n/* 文档标题和类型标签样式 */\n.doc-title-label, .doc-type-label {\n  font-size: 14px;\n  font-weight: 600;\n  color: #606266;\n  white-space: nowrap;\n}\n\n.document-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 15px 20px;\n  border-bottom: 1px solid #e0e0e0;\n  background-color: #fafafa;\n  height: 68px;\n  box-sizing: border-box;\n  width: 100%;\n  z-index: 5;\n}\n\n.header-left-actions {\n  margin-right: 15px;\n}\n\n.doc-info-area {\n  flex-grow: 1;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.doc-title {\n  width: 300px;\n}\n\n.doc-type-selector {\n  width: 150px;\n}\n\n.doc-actions {\n  display: flex;\n  gap: 8px;\n  z-index: 6; /* 确保操作按钮在最上层 */\n}\n\n.editor-area {\n  flex: 1;\n  background-color: #fff;\n  height: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-sizing: border-box;\n  padding: 0; /* 取消padding，避免高度累加 */\n}\n\n.quill-editor {\n  flex: 1;\n  height: 100%;\n  background: #fff;\n  min-height: 0;\n  box-sizing: border-box;\n}\n\n.quill-editor :deep(.ql-container) {\n  flex: 1;\n  height: 100% !important;\n  min-height: 0 !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  box-sizing: border-box;\n}\n\n.quill-editor :deep(.ql-editor) {\n  flex: 1;\n  min-height: 0 !important;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  padding: 15px;\n  box-sizing: border-box;\n}\n\n.empty-doc-state {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #fff;\n}\n\n/* 智能助手面板样式 */\n.assistant-panel {\n  width: 280px;\n  height: 100%;\n  border-left: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s;\n}\n\n.assistant-panel.collapsed {\n  width: 50px;\n}\n\n.assistant-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.assistant-header h5 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.assistant-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 16px;\n}\n\n.ai-features-beauty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 28px;\n  margin-top: 30px;\n}\n\n.ai-feature-card {\n  width: 100%;\n  max-width: 320px;\n  background: #f8fafd;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(80,120,200,0.06);\n  padding: 18px 20px 10px 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  transition: box-shadow 0.2s;\n}\n\n.ai-feature-card:hover {\n  box-shadow: 0 4px 16px rgba(80,120,200,0.13);\n}\n\n.ai-feature-btn {\n  width: 100%;\n  height: 48px;\n  font-size: 17px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  margin-bottom: 6px;\n  transition: background 0.2s, color 0.2s;\n}\n\n.ai-feature-desc {\n  font-size: 13px;\n  color: #7a8599;\n  text-align: center;\n  margin-top: 2px;\n  margin-bottom: 2px;\n  line-height: 1.6;\n}\n\n.context-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.warning-text {\n  color: #f56c6c;\n  font-weight: 500;\n}\n\n.compare-content {\n  flex: 1;\n  display: flex;\n  gap: 20px;\n  overflow: hidden;\n}\n\n.original-content, .modified-content {\n  flex: 1;\n  min-width: 350px;\n  max-width: 50%;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  background: #fff;\n}\n\n.original-content h6, .modified-content h6 {\n  margin: 0;\n  padding: 10px;\n  font-size: 14px;\n  font-weight: 600;\n  background-color: #eef2f6;\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.content-box {\n  padding: 15px;\n  overflow-y: auto;\n  white-space: pre-wrap;\n  flex: 1;\n  font-size: 14px;\n  line-height: 1.6;\n  max-height: 50vh;\n  border: 1px solid #e0e0e0;\n  background-color: #fff;\n}\n\n.compare-dialog :deep(.el-dialog__body) {\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  max-height: 60vh;\n  height: 60vh;\n  overflow: hidden;\n}\n\n.compare-dialog :deep(.el-dialog__header) {\n  padding: 15px 20px;\n}\n\n.compare-dialog :deep(.el-dialog__footer) {\n  padding: 10px 20px;\n}\n\n.compare-dialog :deep(.el-dialog) {\n  max-height: 85vh; /* 限制整个对话框的最大高度 */\n  display: flex;\n  flex-direction: column;\n  margin: 0 auto !important;\n  overflow: hidden; /* 弹窗本身不应该滚动 */\n}\n\n/* 确保弹窗内容能够撑满但不溢出弹窗 */\n.compare-dialog :deep(.el-dialog__body) {\n  padding: 20px;\n  flex: 1;\n  overflow: auto;\n  max-height: calc(85vh - 110px); /* 减去头部和底部的高度 */\n  height: auto;\n  display: flex;\n  flex-direction: column;\n}\n\n.dialog-container {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  overflow: visible;\n}\n\n.quill-editor-in-dialog {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n.quill-editor-in-dialog :deep(.ql-toolbar) {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: #fff;\n}\n\n.quill-editor-in-dialog :deep(.ql-container) {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n}\n\n.quill-editor-in-dialog :deep(.ql-editor) {\n  flex: 1;\n  min-height: 0 !important;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  padding: 15px;\n}\n\n.document-count {\n  text-align: center;\n  padding: 12px;\n  color: #909399;\n  font-size: 13px;\n  border-top: 1px dashed #e6e6e6;\n  margin-top: 10px;\n}\n\n.loading-state {\n  padding: 10px;\n  min-height: 200px;\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 200px;\n  padding: 20px;\n  text-align: center;\n  color: #909399;\n}\n\n.collapsed-assistant {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 12px 0;\n  gap: 12px;\n  height: calc(100% - 48px);\n  overflow-y: auto;\n}\n\n.icon-btn.disabled {\n  color: #a8abb2;\n  cursor: not-allowed;\n}\n\n.icon-btn.disabled:hover {\n  background-color: transparent;\n}\n\n.collapsed-assistant .icon-btn {\n  border-radius: 50%;\n  color: #606266;\n  background-color: #f7f7f7;\n  border: 1px solid #e9e9eb;\n  transition: all 0.2s ease-in-out;\n}\n\n.collapsed-assistant .icon-btn:hover {\n  background-color: #409eff;\n  color: white;\n  transform: translateY(-2px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n  border-color: #409eff;\n}\n\n.collapsed-assistant .icon-btn.disabled {\n  color: #c0c4cc;\n  background-color: #f9f9f9;\n  border-color: #f0f0f0;\n}\n\n.collapsed-assistant .icon-btn.disabled:hover {\n  background-color: #f9f9f9;\n  color: #c0c4cc;\n  transform: none;\n  box-shadow: none;\n  border-color: #f0f0f0;\n  cursor: not-allowed;\n}\n</style>\n\n<style>\n/* Markdown 内容样式 */\n.el-alert__content div {\n  max-height: 400px;\n  overflow-y: auto;\n  padding-right: 8px;\n}\n\n/* Markdown 样式 */\n.el-alert__content div h1,\n.el-alert__content div h2,\n.el-alert__content div h3,\n.el-alert__content div h4,\n.el-alert__content div h5,\n.el-alert__content div h6 {\n  margin-top: 16px;\n  margin-bottom: 8px;\n  font-weight: 600;\n}\n\n.el-alert__content div h1 { font-size: 1.5em; }\n.el-alert__content div h2 { font-size: 1.3em; }\n.el-alert__content div h3 { font-size: 1.2em; }\n\n.el-alert__content div p {\n  margin-bottom: 12px;\n  line-height: 1.6;\n}\n\n.el-alert__content div ul,\n.el-alert__content div ol {\n  padding-left: 20px;\n  margin-bottom: 12px;\n}\n\n.el-alert__content div li {\n  margin-bottom: 4px;\n}\n\n.el-alert__content div code {\n  background-color: #f0f0f0;\n  padding: 2px 4px;\n  border-radius: 3px;\n  font-family: monospace;\n  font-size: 0.9em;\n}\n\n.el-alert__content div pre {\n  background-color: #f5f5f5;\n  padding: 12px;\n  border-radius: 4px;\n  overflow-x: auto;\n  margin-bottom: 12px;\n}\n\n.el-alert__content div pre code {\n  background-color: transparent;\n  padding: 0;\n  border-radius: 0;\n  display: block;\n  white-space: pre;\n}\n\n.el-alert__content div blockquote {\n  border-left: 4px solid #ddd;\n  padding-left: 12px;\n  color: #666;\n  margin: 0 0 12px;\n}\n\n.el-alert__content div table {\n  border-collapse: collapse;\n  margin-bottom: 12px;\n  width: 100%;\n}\n\n.el-alert__content div th,\n.el-alert__content div td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: left;\n}\n\n.el-alert__content div th {\n  background-color: #f2f2f2;\n}\n\n.el-alert__content div a {\n  color: #409eff;\n  text-decoration: none;\n}\n\n.el-alert__content div a:hover {\n  text-decoration: underline;\n}\n\n.el-alert__content div img {\n  max-width: 100%;\n  height: auto;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}