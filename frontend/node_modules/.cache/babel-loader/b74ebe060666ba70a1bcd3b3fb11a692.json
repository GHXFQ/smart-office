{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue","mtime":1748954453781},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\babel.config.js","mtime":1748077811200},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1746431202000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgeyByZWYsIGNvbXB1dGVkLCB3YXRjaCwgb25Nb3VudGVkIH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdXNlUm91dGUsIHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyBFbE1lc3NhZ2UsIEVsTWVzc2FnZUJveCwgRWxMb2FkaW5nIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgZ2V0RG9jdW1lbnRzLCBnZXREb2N1bWVudERldGFpbCwgY3JlYXRlRG9jdW1lbnQsIHVwZGF0ZURvY3VtZW50LCBkZWxldGVEb2N1bWVudCBhcyBhcGlEZWxldGVEb2N1bWVudCwgc2hhcmVEb2N1bWVudCBhcyBhcGlTaGFyZURvY3VtZW50LCBleHBhbmRDb250ZW50IGFzIGFwaUV4cGFuZENvbnRlbnQsIHBvbGlzaFRleHQgYXMgYXBpUG9saXNoVGV4dCwgZ3JhbW1hckNoZWNrLCB0cmFuc2xhdGVUZXh0LCBkb2NRYSB9IGZyb20gJ0AvYXBpL3NtYXJ0ZG9jJzsKaW1wb3J0IHsgRG9jdW1lbnQsIFBsdXMsIENpcmNsZUNoZWNrLCBEb3dubG9hZCwgTW9yZSwgU2VhcmNoLCBBcnJvd0xlZnQsIEFycm93UmlnaHQsIFNoYXJlIGFzIFNoYXJlSWNvbiwgRWRpdCwgU3RhckZpbGxlZCwgQ2hhdERvdFJvdW5kLCBRdWVzdGlvbkZpbGxlZCB9IGZyb20gJ0BlbGVtZW50LXBsdXMvaWNvbnMtdnVlJzsKaW1wb3J0IHsgUXVpbGxFZGl0b3IgfSBmcm9tICdAdnVldXAvdnVlLXF1aWxsJzsKaW1wb3J0ICdAdnVldXAvdnVlLXF1aWxsL2Rpc3QvdnVlLXF1aWxsLnNub3cuY3NzJzsKaW1wb3J0IHsgTWFya2VkRE9NUmVuZGVyZXIsIE1hcmtlZCB9IGZyb20gJ21hcmtlZCc7CmltcG9ydCB7IG1hcmtlZEhpZ2hsaWdodCB9IGZyb20gJ21hcmtlZC1oaWdobGlnaHQnOwppbXBvcnQgaGxqcyBmcm9tICdoaWdobGlnaHQuanMnOwppbXBvcnQgJ2hpZ2hsaWdodC5qcy9zdHlsZXMvZ2l0aHViLmNzcyc7IC8vIOWvvOWFpeS7o+eggemrmOS6ruagt+W8j+ihqAoKLy8g6YWN572ubWFya2VkCmNvbnN0IG1hcmtlZCA9IG5ldyBNYXJrZWQobWFya2VkSGlnaGxpZ2h0KHsKICBsYW5nUHJlZml4OiAnaGxqcyBsYW5ndWFnZS0nLAogIGhpZ2hsaWdodChjb2RlLCBsYW5nKSB7CiAgICBjb25zdCBsYW5ndWFnZSA9IGhsanMuZ2V0TGFuZ3VhZ2UobGFuZykgPyBsYW5nIDogJ3BsYWludGV4dCc7CiAgICByZXR1cm4gaGxqcy5oaWdobGlnaHQoY29kZSwgewogICAgICBsYW5ndWFnZQogICAgfSkudmFsdWU7CiAgfQp9KSk7CgovLyDorr7nva7lronlhajpgInpobkKbWFya2VkLnVzZSh7CiAgcmVuZGVyZXI6IG5ldyBNYXJrZWRET01SZW5kZXJlcigpLAogIGdmbTogdHJ1ZSwKICBicmVha3M6IHRydWUsCiAgcGVkYW50aWM6IGZhbHNlLAogIHNhbml0aXplOiB0cnVlLAogIC8vIOWQr+eUqOWuieWFqOi/h+a7pAogIHNtYXJ0TGlzdHM6IHRydWUsCiAgc21hcnR5cGFudHM6IGZhbHNlCn0pOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NtYXJ0RG9jRGV0YWlsJywKICBjb21wb25lbnRzOiB7CiAgICBEb2N1bWVudCwKICAgIFBsdXMsCiAgICBDaXJjbGVDaGVjaywKICAgIERvd25sb2FkLAogICAgTW9yZSwKICAgIFNlYXJjaCwKICAgIEFycm93TGVmdCwKICAgIEFycm93UmlnaHQsCiAgICBTaGFyZUljb24sCiAgICBRdWlsbEVkaXRvciwKICAgIEVkaXQsCiAgICBTdGFyRmlsbGVkLAogICAgQ2hhdERvdFJvdW5kLAogICAgUXVlc3Rpb25GaWxsZWQKICB9LAogIHNldHVwKCkgewogICAgY29uc3Qgcm91dGUgPSB1c2VSb3V0ZSgpOwogICAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7CgogICAgLy8g54q25oCB5pWw5o2uCiAgICBjb25zdCBkb2N1bWVudHMgPSByZWYoW10pOwogICAgY29uc3QgY3VycmVudERvYyA9IHJlZihudWxsKTsKICAgIGNvbnN0IGRvY3VtZW50Q2hhbmdlZCA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBpc0RvY0xpc3RDb2xsYXBzZWQgPSByZWYoZmFsc2UpOwogICAgY29uc3QgaXNBc3Npc3RhbnRDb2xsYXBzZWQgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2VhcmNoUXVlcnkgPSByZWYoJycpOwogICAgY29uc3QgZG9jVHlwZUZpbHRlciA9IHJlZignJyk7CiAgICBjb25zdCBzb3J0T3B0aW9uID0gcmVmKCd1cGRhdGUnKTsKICAgIGNvbnN0IG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzaGFyZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZGVsZXRlRGlhbG9nVmlzaWJsZSA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzZWxlY3RlZFVzZXJzID0gcmVmKFtdKTsKICAgIGNvbnN0IGF2YWlsYWJsZVVzZXJzID0gcmVmKFtdKTsKCiAgICAvLyDliqDovb3nirbmgIEKICAgIGNvbnN0IHNhdmVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGNyZWF0ZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2hhcmVMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGRlbGV0ZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgZXhwYW5kTG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBwb2xpc2hMb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGdyYW1tYXJDaGVja0xvYWRpbmcgPSByZWYoZmFsc2UpOwoKICAgIC8vIOihqOWNleaVsOaNrgogICAgY29uc3QgbmV3RG9jdW1lbnRGb3JtID0gcmVmKHsKICAgICAgdGl0bGU6ICcnLAogICAgICB0eXBlOiAnJwogICAgfSk7CgogICAgLy8g6KGo5Y2V6aqM6K+B6KeE5YiZCiAgICBjb25zdCBkb2N1bWVudEZvcm1SdWxlcyA9IHsKICAgICAgdGl0bGU6IFt7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+aho+agh+mimCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICBtaW46IDIsCiAgICAgICAgbWF4OiA1MCwKICAgICAgICBtZXNzYWdlOiAn5qCH6aKY6ZW/5bqm6aG75ZyoMuWIsDUw5Liq5a2X56ym5LmL6Ze0JywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfV0KICAgIH07CiAgICBjb25zdCBkb2N1bWVudEZvcm1SZWYgPSByZWYobnVsbCk7CiAgICBjb25zdCB1cGxvYWRJbWFnZSA9IGFzeW5jIGZpbGUgPT4gewogICAgICB0cnkgewogICAgICAgIC8vIOS9v+eUqEZpbGVSZWFkZXLlsIbmlofku7bovazmjaLkuLpiYXNlNjQKICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICByZWFkZXIub25sb2FkID0gZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgIC8vIOebtOaOpei/lOWbnmJhc2U2NOaVsOaNruS9nOS4uuWbvueJh1VSTAogICAgICAgICAgICByZXNvbHZlKHsKICAgICAgICAgICAgICB1cmw6IGJhc2U2NERhdGEKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSAoKSA9PiB7CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ+aWh+S7tuivu+WPluWksei0pScpKTsKICAgICAgICAgIH07CiAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCflm77niYflpITnkIblpLHotKU6JywgZXJyb3IpOwogICAgICAgIHRocm93IGVycm9yOwogICAgICB9CiAgICB9OwoKICAgIC8vIOe8lui+keWZqOmFjee9rgogICAgY29uc3QgZWRpdG9yT3B0aW9ucyA9IHsKICAgICAgcGxhY2Vob2xkZXI6ICcgJywKICAgICAgbW9kdWxlczogewogICAgICAgIHRvb2xiYXI6IHsKICAgICAgICAgIGNvbnRhaW5lcjogW1snYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJywgJ3N0cmlrZSddLCBbJ2Jsb2NrcXVvdGUnLCAnY29kZS1ibG9jayddLCBbewogICAgICAgICAgICAnaGVhZGVyJzogMQogICAgICAgICAgfSwgewogICAgICAgICAgICAnaGVhZGVyJzogMgogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdsaXN0JzogJ29yZGVyZWQnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgICdsaXN0JzogJ2J1bGxldCcKICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnc2NyaXB0JzogJ3N1YicKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgJ3NjcmlwdCc6ICdzdXBlcicKICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnaW5kZW50JzogJy0xJwogICAgICAgICAgfSwgewogICAgICAgICAgICAnaW5kZW50JzogJysxJwogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdkaXJlY3Rpb24nOiAncnRsJwogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdzaXplJzogWydzbWFsbCcsIGZhbHNlLCAnbGFyZ2UnLCAnaHVnZSddCiAgICAgICAgICB9XSwgW3sKICAgICAgICAgICAgJ2hlYWRlcic6IFsxLCAyLCAzLCA0LCA1LCA2LCBmYWxzZV0KICAgICAgICAgIH1dLCBbewogICAgICAgICAgICAnY29sb3InOiBbXQogICAgICAgICAgfSwgewogICAgICAgICAgICAnYmFja2dyb3VuZCc6IFtdCiAgICAgICAgICB9XSwgW3sKICAgICAgICAgICAgJ2ZvbnQnOiBbXQogICAgICAgICAgfV0sIFt7CiAgICAgICAgICAgICdhbGlnbic6IFtdCiAgICAgICAgICB9XSwgWydjbGVhbiddLCBbJ2xpbmsnLCAnaW1hZ2UnXV0sCiAgICAgICAgICBoYW5kbGVyczogewogICAgICAgICAgICBpbWFnZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZmlsZScpOwogICAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnYWNjZXB0JywgJ2ltYWdlLyonKTsKICAgICAgICAgICAgICBpbnB1dC5jbGljaygpOwogICAgICAgICAgICAgIGlucHV0Lm9uY2hhbmdlID0gYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IGlucHV0LmZpbGVzWzBdOwogICAgICAgICAgICAgICAgaWYgKCFmaWxlKSByZXR1cm47CgogICAgICAgICAgICAgICAgLy8g5qOA5p+l5paH5Lu25aSn5bCP5ZKM57G75Z6LCiAgICAgICAgICAgICAgICBpZiAoZmlsZS5zaXplID4gNSAqIDEwMjQgKiAxMDI0KSB7CiAgICAgICAgICAgICAgICAgIC8vIDVNQumZkOWItgogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WbvueJh+S4jeiDvei2hei/hzVNQicpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8g5pSv5oyB55qE5Zu+54mH57G75Z6LCiAgICAgICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFsnaW1hZ2UvanBlZycsICdpbWFnZS9wbmcnLCAnaW1hZ2UvZ2lmJywgJ2ltYWdlL3dlYnAnXTsKICAgICAgICAgICAgICAgIGlmICghc3VwcG9ydGVkVHlwZXMuaW5jbHVkZXMoZmlsZS50eXBlKSkgewogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WPquaUr+aMgUpQR+OAgVBOR+OAgUdJRuWSjFdFQlDmoLzlvI/lm77niYcnKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOWkhOeQhuWbvueJhy4uLicpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgLy8g55u05o6l5Lyg6YCS5paH5Lu25a+56LGh6ICM5LiN5pivRm9ybURhdGEKICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdXBsb2FkSW1hZ2UoZmlsZSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IHJlcy51cmw7CiAgICAgICAgICAgICAgICAgIGlmICghdXJsKSB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOWbvueJh1VSTCcpOwoKICAgICAgICAgICAgICAgICAgLy8g6I635Y+W57yW6L6R5Zmo5a6e5L6L5bm25o+S5YWl5Zu+54mHCiAgICAgICAgICAgICAgICAgIGNvbnN0IHF1aWxsID0gcXVpbGxJbnN0YW5jZS52YWx1ZTsKICAgICAgICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBxdWlsbC5nZXRTZWxlY3Rpb24odHJ1ZSk7CiAgICAgICAgICAgICAgICAgIHF1aWxsLmluc2VydEVtYmVkKHJhbmdlLmluZGV4LCAnaW1hZ2UnLCB1cmwpOwoKICAgICAgICAgICAgICAgICAgLy8g5qCH6K6w5paH5qGj5bey5L+u5pS5CiAgICAgICAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCflm77niYfmj5LlhaXmiJDlip8nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign5Zu+54mH5aSE55CG5aSx6LSlOicsIGUpOwogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WbvueJh+WkhOeQhuWksei0pTogJyArIGUubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyDorqHnrpflsZ7mgKcKICAgIGNvbnN0IGZpbHRlcmVkRG9jdW1lbnRzID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBsZXQgcmVzdWx0ID0gWy4uLmRvY3VtZW50cy52YWx1ZV07CgogICAgICAvLyDmkJzntKLnrZvpgIkKICAgICAgaWYgKHNlYXJjaFF1ZXJ5LnZhbHVlKSB7CiAgICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hRdWVyeS52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoZG9jID0+IGRvYy50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSB8fCBkb2MudHlwZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSk7CiAgICAgIH0KCiAgICAgIC8vIOexu+Wei+etm+mAiQogICAgICBpZiAoZG9jVHlwZUZpbHRlci52YWx1ZSkgewogICAgICAgIGNvbnN0IHR5cGVGaWx0ZXIgPSBkb2NUeXBlRmlsdGVyLnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihkb2MgPT4gZG9jLnR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0eXBlRmlsdGVyKSk7CiAgICAgIH0KCiAgICAgIC8vIOaOkuW6jwogICAgICBpZiAoc29ydE9wdGlvbi52YWx1ZSA9PT0gJ3VwZGF0ZScpIHsKICAgICAgICByZXN1bHQuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi51cGRhdGVfdGltZSkgLSBuZXcgRGF0ZShhLnVwZGF0ZV90aW1lKSk7CiAgICAgIH0gZWxzZSBpZiAoc29ydE9wdGlvbi52YWx1ZSA9PT0gJ2NyZWF0ZScpIHsKICAgICAgICByZXN1bHQuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5jcmVhdGVfdGltZSkgLSBuZXcgRGF0ZShhLmNyZWF0ZV90aW1lKSk7CiAgICAgIH0gZWxzZSBpZiAoc29ydE9wdGlvbi52YWx1ZSA9PT0gJ25hbWUtYXNjJykgewogICAgICAgIHJlc3VsdC5zb3J0KChhLCBiKSA9PiBhLnRpdGxlLmxvY2FsZUNvbXBhcmUoYi50aXRsZSkpOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9KTsKCiAgICAvLyDmlrnms5UKICAgIGNvbnN0IGZldGNoRG9jdW1lbnRzID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0RG9jdW1lbnRzKCk7CiAgICAgICAgZG9jdW1lbnRzLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bmlofmoaPliJfooajlpLHotKUnLCBlcnJvcik7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfojrflj5bmlofmoaPliJfooajlpLHotKUnKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGxvYWRpbmcgPSByZWYoZmFsc2UpOwoKICAgIC8vIOiusOW9leWIneWni+WGheWuueeUqOS6juWvueavlAogICAgY29uc3Qgb3JpZ2luYWxEb2MgPSByZWYoewogICAgICB0aXRsZTogJycsCiAgICAgIHR5cGU6ICcnLAogICAgICBjb250ZW50OiAnJwogICAgfSk7CiAgICBjb25zdCBmZXRjaERvY3VtZW50RGV0YWlsID0gYXN5bmMgKGlkLCByZXRyeSA9IDApID0+IHsKICAgICAgbG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXREb2N1bWVudERldGFpbChpZCk7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIGN1cnJlbnREb2MudmFsdWUgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgLy8g6K6w5b2V5Yid5aeL5YaF5a65CiAgICAgICAgICBvcmlnaW5hbERvYy52YWx1ZSA9IHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEudGl0bGUsCiAgICAgICAgICAgIHR5cGU6IHJlc3BvbnNlLmRhdGEudHlwZSwKICAgICAgICAgICAgY29udGVudDogcmVzcG9uc2UuZGF0YS5jb250ZW50CiAgICAgICAgICB9OwogICAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcign5paH5qGj5LiN5a2Y5Zyo5oiW5pWw5o2u5peg5pWIJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlmIChyZXRyeSA8IDMpIHsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZmV0Y2hEb2N1bWVudERldGFpbChpZCwgcmV0cnkgKyAxKSwgMTAwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluaWh+aho+ivpuaDheWksei0pScsIGVycm9yKTsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCA/ICfmlofmoaPkuI3lrZjlnKgnIDogJ+iOt+WPluaWh+aho+ivpuaDheWksei0pScpOwogICAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIGNvbnN0IHNlbGVjdERvY3VtZW50ID0gYXN5bmMgaWQgPT4gewogICAgICAvLyDlpoLmnpzlvZPliY3mlofmoaPlt7Lkv67mlLnvvIzmj5DnpLrkv53lrZgKICAgICAgaWYgKGRvY3VtZW50Q2hhbmdlZC52YWx1ZSAmJiBjdXJyZW50RG9jLnZhbHVlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGF3YWl0IEVsTWVzc2FnZUJveC5jb25maXJtKCflvZPliY3mlofmoaPlt7Lkv67mlLnkvYbmnKrkv53lrZjvvIzmmK/lkKbkv53lrZjmm7TmlLnvvJ8nLCAn5L+d5a2Y5o+Q56S6JywgewogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+S/neWtmCcsCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICfkuI3kv53lrZgnLAogICAgICAgICAgICB0eXBlOiAnd2FybmluZycsCiAgICAgICAgICAgIGRpc3Rpbmd1aXNoQ2FuY2VsQW5kQ2xvc2U6IHRydWUgLy8g5YWB6K645Yy65YiG5Y+W5raI5ZKM5YWz6ZetCiAgICAgICAgICB9KTsKICAgICAgICAgIGF3YWl0IHNhdmVEb2N1bWVudCgpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAvLyDnlKjmiLfpgInmi6nkuI3kv53lrZjmiJbngrnDl++8jOaSpOmUgOacrOWcsOabtOaUue+8jOaBouWkjeWOn+WGheWuuQogICAgICAgICAgaWYgKGVycm9yID09PSAnY2FuY2VsJyB8fCBlcnJvciA9PT0gJ2Nsb3NlJykgewogICAgICAgICAgICBpZiAoY3VycmVudERvYy52YWx1ZSAmJiBvcmlnaW5hbERvYy52YWx1ZSkgewogICAgICAgICAgICAgIGN1cnJlbnREb2MudmFsdWUudGl0bGUgPSBvcmlnaW5hbERvYy52YWx1ZS50aXRsZTsKICAgICAgICAgICAgICBjdXJyZW50RG9jLnZhbHVlLnR5cGUgPSBvcmlnaW5hbERvYy52YWx1ZS50eXBlOwogICAgICAgICAgICAgIGN1cnJlbnREb2MudmFsdWUuY29udGVudCA9IG9yaWdpbmFsRG9jLnZhbHVlLmNvbnRlbnQ7CiAgICAgICAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC8vIOeUqOaIt+mAieaLqeS4jeS/neWtmO+8jOe7p+e7reWIh+aNouaWh+ahowogICAgICAgIH0KICAgICAgfQogICAgICAvLyDmm7TmlrDot6/nlLHku6Xlj43mmKDmlrDpgInkuK3nmoTmlofmoaMKICAgICAgcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpZAogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3Qgc2F2ZURvY3VtZW50ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUgfHwgIWRvY3VtZW50Q2hhbmdlZC52YWx1ZSkgcmV0dXJuOwogICAgICBzYXZlTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdXBkYXRlRG9jdW1lbnQoY3VycmVudERvYy52YWx1ZS5pZCwgewogICAgICAgICAgdGl0bGU6IGN1cnJlbnREb2MudmFsdWUudGl0bGUsCiAgICAgICAgICB0eXBlOiBjdXJyZW50RG9jLnZhbHVlLnR5cGUsCiAgICAgICAgICBjb250ZW50OiBjdXJyZW50RG9jLnZhbHVlLmNvbnRlbnQKICAgICAgICB9KTsKCiAgICAgICAgLy8g5L+d5a2Y5oiQ5Yqf5ZCO77yM5pu05paw5Y6f5aeL5paH5qGj6K6w5b2VCiAgICAgICAgb3JpZ2luYWxEb2MudmFsdWUgPSB7CiAgICAgICAgICB0aXRsZTogY3VycmVudERvYy52YWx1ZS50aXRsZSwKICAgICAgICAgIHR5cGU6IGN1cnJlbnREb2MudmFsdWUudHlwZSwKICAgICAgICAgIGNvbnRlbnQ6IGN1cnJlbnREb2MudmFsdWUuY29udGVudAogICAgICAgIH07CiAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gZmFsc2U7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+S/neWtmOaIkOWKnycpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOaWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+S/neWtmOaWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHNhdmVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCB0b2dnbGVEb2NMaXN0ID0gKCkgPT4gewogICAgICBpc0RvY0xpc3RDb2xsYXBzZWQudmFsdWUgPSAhaXNEb2NMaXN0Q29sbGFwc2VkLnZhbHVlOwogICAgfTsKICAgIGNvbnN0IHRvZ2dsZUFzc2lzdGFudCA9ICgpID0+IHsKICAgICAgaXNBc3Npc3RhbnRDb2xsYXBzZWQudmFsdWUgPSAhaXNBc3Npc3RhbnRDb2xsYXBzZWQudmFsdWU7CiAgICB9OwogICAgY29uc3Qgb25FZGl0b3JDaGFuZ2UgPSAoKSA9PiB7CiAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3Qgb3Blbk5ld0RvY3VtZW50RGlhbG9nID0gKCkgPT4gewogICAgICBuZXdEb2N1bWVudEZvcm0udmFsdWUgPSB7CiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIHR5cGU6ICcnCiAgICAgIH07CiAgICAgIG5ld0RvY3VtZW50RGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICB9OwogICAgY29uc3QgY3JlYXRlTmV3RG9jdW1lbnQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghZG9jdW1lbnRGb3JtUmVmLnZhbHVlKSByZXR1cm47CiAgICAgIGF3YWl0IGRvY3VtZW50Rm9ybVJlZi52YWx1ZS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY3JlYXRlRG9jdW1lbnQoewogICAgICAgICAgICAgIHRpdGxlOiBuZXdEb2N1bWVudEZvcm0udmFsdWUudGl0bGUsCiAgICAgICAgICAgICAgdHlwZTogbmV3RG9jdW1lbnRGb3JtLnZhbHVlLnR5cGUgfHwgJ+mAmueUqCcsCiAgICAgICAgICAgICAgY29udGVudDogJycKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmlofmoaPliJvlu7rmiJDlip8nKTsKICAgICAgICAgICAgbmV3RG9jdW1lbnREaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CgogICAgICAgICAgICAvLyDliLfmlrDmlofmoaPliJfooajlubbmiZPlvIDmlrDmlofmoaMKICAgICAgICAgICAgYXdhaXQgZmV0Y2hEb2N1bWVudHMoKTsKICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICdTbWFydERvY0RldGFpbCcsCiAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5pZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliJvlu7rmlofmoaPlpLHotKUnLCBlcnJvcik7CiAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5Yib5bu65paH5qGj5aSx6LSlJyk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjcmVhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgICBjb25zdCBzaGFyZURvY3VtZW50ID0gKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKCiAgICAgIC8vIOWcqOWunumZhemhueebruS4re+8jOi/memHjOW6lOivpeS7jkFQSeiOt+WPluWPr+eUqOeUqOaIt+WIl+ihqAogICAgICBhdmFpbGFibGVVc2Vycy52YWx1ZSA9IFt7CiAgICAgICAgaWQ6IDEsCiAgICAgICAgdXNlcm5hbWU6ICflvKDkuIknCiAgICAgIH0sIHsKICAgICAgICBpZDogMiwKICAgICAgICB1c2VybmFtZTogJ+adjuWbmycKICAgICAgfSwgewogICAgICAgIGlkOiAzLAogICAgICAgIHVzZXJuYW1lOiAn546L5LqUJwogICAgICB9XTsKICAgICAgc2VsZWN0ZWRVc2Vycy52YWx1ZSA9IFtdOwogICAgICBzaGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfTsKICAgIGNvbnN0IGNvbmZpcm1TaGFyZSA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8IHNlbGVjdGVkVXNlcnMudmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoJ+ivt+mAieaLqeiHs+WwkeS4gOS4queUqOaItycpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzaGFyZUxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFwaVNoYXJlRG9jdW1lbnQoY3VycmVudERvYy52YWx1ZS5pZCwgc2VsZWN0ZWRVc2Vycy52YWx1ZSk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+WIhuS6q+aIkOWKnycpOwogICAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIhuS6q+aWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIhuS6q+aWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHNoYXJlTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwogICAgY29uc3QgZGVsZXRlRG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIGlmICghY3VycmVudERvYy52YWx1ZSkgcmV0dXJuOwogICAgICBkZWxldGVEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBjb25maXJtRGVsZXRlID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgZGVsZXRlTG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgYXBpRGVsZXRlRG9jdW1lbnQoY3VycmVudERvYy52YWx1ZS5pZCk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+aho+WIoOmZpOaIkOWKnycpOwogICAgICAgIGRlbGV0ZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgLy8g6L+U5Zue5Yiw5paH5qGj5YiX6KGo6aG1CiAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOaWh+aho+Wksei0pScsIGVycm9yKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOaWh+aho+Wksei0pScpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGRlbGV0ZUxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IGV4cG9ydERvY3VtZW50ID0gKCkgPT4gewogICAgICBFbE1lc3NhZ2VCb3goewogICAgICAgIHRpdGxlOiAn5a+85Ye65paH5qGjJywKICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oup5a+85Ye65qC85byPJywKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn5a+85Ye65Li6UERGJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5a+85Ye65Li6V29yZCcsCiAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IHRydWUsCiAgICAgICAgY2FsbGJhY2s6IGFjdGlvbiA9PiB7CiAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpIHsKICAgICAgICAgICAgZXhwb3J0VG9QZGYoKTsKICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnY2FuY2VsJykgewogICAgICAgICAgICBleHBvcnRUb1dvcmQoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICAvLyDlr7zlh7rkuLpQREYKICAgIGNvbnN0IGV4cG9ydFRvUGRmID0gKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUgfHwgIWN1cnJlbnREb2MudmFsdWUuY29udGVudCkgewogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5rKh5pyJ5Y+v5a+85Ye655qE5paH5qGjJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGRvY1RpdGxlID0gY3VycmVudERvYy52YWx1ZS50aXRsZSB8fCAn5pyq5ZG95ZCN5paH5qGjJzsKICAgICAgY29uc3QgZmlsZW5hbWUgPSBgJHtkb2NUaXRsZX0ucGRmYDsKICAgICAgLy8g55u05o6l5YWL6ZqGcXVpbGznvJbovpHlmajlhoXlrrkKICAgICAgY29uc3QgZWRpdG9yRG9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnFsLWVkaXRvcicpOwogICAgICBpZiAoIWVkaXRvckRvbSkgewogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5pyq5om+5Yiw57yW6L6R5Zmo5YaF5a65Jyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gZWRpdG9yRG9tLmNsb25lTm9kZSh0cnVlKTsKICAgICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgICBtYXJnaW46IFsxNSwgMTUsIDE1LCAxNV0sCiAgICAgICAgZmlsZW5hbWU6IGZpbGVuYW1lLAogICAgICAgIGltYWdlOiB7CiAgICAgICAgICB0eXBlOiAnanBlZycsCiAgICAgICAgICBxdWFsaXR5OiAwLjk4CiAgICAgICAgfSwKICAgICAgICBodG1sMmNhbnZhczogewogICAgICAgICAgc2NhbGU6IDIsCiAgICAgICAgICB1c2VDT1JTOiB0cnVlCiAgICAgICAgfSwKICAgICAgICBqc1BERjogewogICAgICAgICAgdW5pdDogJ21tJywKICAgICAgICAgIGZvcm1hdDogJ2E0JywKICAgICAgICAgIG9yaWVudGF0aW9uOiAncG9ydHJhaXQnCiAgICAgICAgfQogICAgICB9OwogICAgICBjb25zdCBsb2FkaW5nID0gRWxMb2FkaW5nLnNlcnZpY2UoewogICAgICAgIGxvY2s6IHRydWUsCiAgICAgICAgdGV4dDogJ+ato+WcqOeUn+aIkFBERi4uLicsCiAgICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC43KScKICAgICAgfSk7CiAgICAgIGltcG9ydCgnaHRtbDJwZGYuanMnKS50aGVuKGh0bWwycGRmTW9kdWxlID0+IHsKICAgICAgICBjb25zdCBodG1sMnBkZiA9IGh0bWwycGRmTW9kdWxlLmRlZmF1bHQ7CiAgICAgICAgaHRtbDJwZGYoKS5mcm9tKGNvbnRlbnRFbGVtZW50KS5zZXQob3B0aW9ucykuc2F2ZSgpLnRoZW4oKCkgPT4gewogICAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ1BERuWvvOWHuuaIkOWKnycpOwogICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BERuWvvOWHuuWksei0pTonLCBlcnJvcik7CiAgICAgICAgICBsb2FkaW5nLmNsb3NlKCk7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ1BERuWvvOWHuuWksei0pScpOwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L29aHRtbDJwZGYuanPlpLHotKU6JywgZXJyb3IpOwogICAgICAgIGxvYWRpbmcuY2xvc2UoKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ1BERuWvvOWHuuWKn+iDveWKoOi9veWksei0pScpOwogICAgICB9KTsKICAgIH07CgogICAgLy8g5a+85Ye65Li6V29yZO+8iOS/neeVmeWbvueJh++8iQogICAgY29uc3QgZXhwb3J0VG9Xb3JkID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUgfHwgIWN1cnJlbnREb2MudmFsdWUuY29udGVudCkgewogICAgICAgIEVsTWVzc2FnZS5lcnJvcign5rKh5pyJ5Y+v5a+85Ye655qE5paH5qGjJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGRvY1RpdGxlID0gY3VycmVudERvYy52YWx1ZS50aXRsZSB8fCAn5pyq5ZG95ZCN5paH5qGjJzsKICAgICAgY29uc3QgZmlsZW5hbWUgPSBgJHtkb2NUaXRsZX0uZG9jYDsKICAgICAgY29uc3QgbG9hZGluZyA9IEVsTG9hZGluZy5zZXJ2aWNlKHsKICAgICAgICBsb2NrOiB0cnVlLAogICAgICAgIHRleHQ6ICfmraPlnKjnlJ/miJBXb3Jk5paH5qGjLi4uJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpJwogICAgICB9KTsKICAgICAgdHJ5IHsKICAgICAgICAvLyDliJvlu7rkuIDkuKrkuLTml7bmlofmoaPlrrnlmajlpITnkIblhoXlrrkKICAgICAgICBjb25zdCBjb250ZW50Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgY29udGVudENvbnRhaW5lci5pbm5lckhUTUwgPSBjdXJyZW50RG9jLnZhbHVlLmNvbnRlbnQ7CiAgICAgICAgLy8g5LiN5YaN5pu/5o2i5Zu+54mH5Li65Y2g5L2N56ym77yM55u05o6l5L+d55WZPGltZz7moIfnrb4KICAgICAgICAvLyDliJvlu7rlvq7ova9Xb3Jk5YW85a6555qESFRNTOaWh+ahowogICAgICAgIGNvbnN0IG1zV29yZEh0bWwgPSBgCiAgICAgICAgICA8aHRtbCB4bWxuczpvPSJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTpvZmZpY2UiIAogICAgICAgICAgICAgICAgeG1sbnM6dz0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6d29yZCIgCiAgICAgICAgICAgICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MCI+CiAgICAgICAgICA8aGVhZD4KICAgICAgICAgICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogICAgICAgICAgICA8dGl0bGU+JHtkb2NUaXRsZX08L3RpdGxlPgogICAgICAgICAgICA8c3R5bGU+CiAgICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OiBTaW1TdW4sIEFyaWFsLCBzYW5zLXNlcmlmOyBtYXJnaW46IDFjbTsgfQogICAgICAgICAgICAgIGltZyB7IG1heC13aWR0aDogMTAwJTsgaGVpZ2h0OiBhdXRvOyB9CiAgICAgICAgICAgICAgcCB7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgfQogICAgICAgICAgICAgIGgxIHsgZm9udC1zaXplOiAxOHB0OyB9CiAgICAgICAgICAgICAgaDIgeyBmb250LXNpemU6IDE2cHQ7IH0KICAgICAgICAgICAgICBoMyB7IGZvbnQtc2l6ZTogMTRwdDsgfQogICAgICAgICAgICAgIHRhYmxlIHsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgd2lkdGg6IDEwMCU7IH0KICAgICAgICAgICAgICB0ZCwgdGggeyBib3JkZXI6IDFweCBzb2xpZCAjMDAwOyBwYWRkaW5nOiA1cHg7IH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAgIDwvaGVhZD4KICAgICAgICAgIDxib2R5PgogICAgICAgICAgICA8aDE+JHtkb2NUaXRsZX08L2gxPgogICAgICAgICAgICAke2NvbnRlbnRDb250YWluZXIuaW5uZXJIVE1MfQogICAgICAgICAgPC9ib2R5PgogICAgICAgICAgPC9odG1sPgogICAgICAgIGA7CiAgICAgICAgLy8g5L2/55SoZmlsZS1zYXZlcuS/neWtmOaWh+S7tgogICAgICAgIGNvbnN0IEZpbGVTYXZlciA9IGF3YWl0IGltcG9ydCgnZmlsZS1zYXZlcicpOwogICAgICAgIGNvbnN0IHNhdmVBcyA9IEZpbGVTYXZlci5zYXZlQXMgfHwgRmlsZVNhdmVyLmRlZmF1bHQ7CiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFttc1dvcmRIdG1sXSwgewogICAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL21zd29yZCcKICAgICAgICB9KTsKICAgICAgICBzYXZlQXMoYmxvYiwgZmlsZW5hbWUpOwogICAgICAgIGxvYWRpbmcuY2xvc2UoKTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2VzcygnV29yZOaWh+aho+WvvOWHuuaIkOWKnycpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dvcmTlr7zlh7rlpLHotKU6JywgZXJyb3IpOwogICAgICAgIGxvYWRpbmcuY2xvc2UoKTsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoYFdvcmTlr7zlh7rlpLHotKU6ICR7ZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJ31gKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHByaW50RG9jdW1lbnQgPSAoKSA9PiB7CiAgICAgIEVsTWVzc2FnZS5pbmZvKCfmiZPljbDmlofmoaPlip/og73mmoLmnKrlrp7njrAnKTsKICAgIH07CiAgICBjb25zdCBhZGRDb2xsYWJvcmF0b3IgPSAoKSA9PiB7CiAgICAgIEVsTWVzc2FnZS5pbmZvKCfmt7vliqDljY/kvZzogIXlip/og73mmoLmnKrlrp7njrAnKTsKICAgIH07CiAgICBjb25zdCB2aWV3SGlzdG9yeSA9ICgpID0+IHsKICAgICAgRWxNZXNzYWdlLmluZm8oJ+afpeeci+WOhuWPsueJiOacrOWKn+iDveaaguacquWunueOsCcpOwogICAgfTsKCiAgICAvLyAxLiDlnKhzZXR1cOmHjOWKoOe8k+WtmOWPmOmHjwogICAgY29uc3QgcXVpbGxTZWxlY3Rpb24gPSByZWYobnVsbCk7CiAgICBjb25zdCBxdWlsbFNlbGVjdGVkVGV4dCA9IHJlZignJyk7CgogICAgLy8gMi4g55uR5ZCsUXVpbGznmoRzZWxlY3Rpb24tY2hhbmdl5LqL5Lu2CiAgICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IHJhbmdlID0+IHsKICAgICAgY29uc29sZS5sb2coJ+e7hOS7tnNlbGVjdGlvbi1jaGFuZ2Xkuovku7Y6JywgcmFuZ2UpOwogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHJldHVybjsKICAgICAgaWYgKHJhbmdlICYmIHJhbmdlLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCB0ZXh0ID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHJhbmdlLmluZGV4LCByYW5nZS5sZW5ndGgpOwogICAgICAgIGNvbnNvbGUubG9nKCfnu4Tku7bpgInkuK3mlofmnKw6JywgdGV4dCk7CiAgICAgICAgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgPSB0ZXh0OwogICAgICAgIHF1aWxsU2VsZWN0aW9uLnZhbHVlID0gcmFuZ2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ+e7hOS7tua4hemZpOmAieaLqScpOwogICAgICAgIHF1aWxsU2VsZWN0ZWRUZXh0LnZhbHVlID0gJyc7CiAgICAgICAgcXVpbGxTZWxlY3Rpb24udmFsdWUgPSBudWxsOwogICAgICB9CiAgICB9OwoKICAgIC8vIDEuIOacgOWkp+mVv+W6puW4uOmHjwogICAgY29uc3QgTUFYX0FJX1RFWFRfTEVOR1RIID0gMjAwMDsKCiAgICAvLyAyLiBleHBhbmRDb250ZW505pa55rOV5Yqg5oiq5patCiAgICBjb25zdCBleHBhbmRDb250ZW50ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign57yW6L6R5Zmo5pyq5bCx57uq77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZm9jdXMoKTsKICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGxldCBzZWxlY3RlZFRleHQgPSAnJzsKICAgICAgICBsZXQgcmFuZ2UgPSBudWxsOwogICAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJhbmdlID0gc2VsZWN0aW9uOwogICAgICAgICAgc2VsZWN0ZWRUZXh0ID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgICAgfQogICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup6KaB5omp5YaZ55qE5paH5pys5YaF5a65Jyk7CiAgICAgICAgICBleHBhbmRMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gTUFYX0FJX1RFWFRfTEVOR1RIKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZyhg6YCJ5Lit5paH5pys6L+H6ZW/77yM5bey6Ieq5Yqo5oiq5pat5Li65YmNJHtNQVhfQUlfVEVYVF9MRU5HVEh95a2XYCk7CiAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UoMCwgTUFYX0FJX1RFWFRfTEVOR1RIKTsKICAgICAgICB9CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOaJqeWGmeWGheWuue+8jOivt+eojeWAmS4uLicpOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpRXhwYW5kQ29udGVudChjdXJyZW50RG9jLnZhbHVlLmlkLCB7CiAgICAgICAgICBzZWxlY3Rpb246IHNlbGVjdGVkVGV4dCwKICAgICAgICAgIGxlbmd0aDogJ21lZGl1bScKICAgICAgICB9KTsKICAgICAgICBzaG93Q29tcGFyZURpYWxvZyh7CiAgICAgICAgICB0aXRsZTogJ+WGheWuueaJqeWGmee7k+aenCcsCiAgICAgICAgICBvcmlnaW5hbDogc2VsZWN0ZWRUZXh0LAogICAgICAgICAgbW9kaWZpZWQ6IHJlc3BvbnNlLmRhdGEuY29udGVudCwKICAgICAgICAgIG9uQXBwbHk6IGZpbmFsQ29udGVudCA9PiB7CiAgICAgICAgICAgIGlmIChyYW5nZSAmJiB0eXBlb2YgcmFuZ2UuaW5kZXggPT09ICdudW1iZXInICYmIHR5cGVvZiByYW5nZS5sZW5ndGggPT09ICdudW1iZXInICYmIHJhbmdlLmluZGV4ID49IDAgJiYgcmFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IHF1aWxsTGVuID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKTsKICAgICAgICAgICAgICBsZXQgaW5zZXJ0UG9zID0gcmFuZ2UuaW5kZXg7CiAgICAgICAgICAgICAgaWYgKGluc2VydFBvcyA+IHF1aWxsTGVuKSBpbnNlcnRQb3MgPSBxdWlsbExlbiAtIDE7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5kZWxldGVUZXh0KGluc2VydFBvcywgcmFuZ2UubGVuZ3RoKTsKICAgICAgICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmluc2VydFRleHQoaW5zZXJ0UG9zLCBmaW5hbENvbnRlbnQpOwogICAgICAgICAgICAgIGxldCBzZWxQb3MgPSBpbnNlcnRQb3MgKyBmaW5hbENvbnRlbnQubGVuZ3RoOwogICAgICAgICAgICAgIGlmIChzZWxQb3MgPiBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpIC0gMSkgc2VsUG9zID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSAtIDE7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5zZXRTZWxlY3Rpb24oc2VsUG9zLCAwKTsKICAgICAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCflhoXlrrnmianlhpnlt7LlupTnlKgnKTsKICAgICAgICAgICAgICBzY3JvbGxRdWlsbFRvQm90dG9tKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfpgInljLrml6DmlYjvvIzml6Dms5Xmj5LlhaXlhoXlrrknKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1vlhoXlrrnmianlhpldIOW8guW4uDonLCBlcnJvcik7CiAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+WGheWuueaJqeWGmeWksei0pTogJyArIChlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCB8fCBlcnJvci5tZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5YaF5a655omp5YaZ5aSx6LSl77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIGV4cGFuZExvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyAzLiBwb2xpc2hUZXh05ZCM55CGCiAgICBjb25zdCBwb2xpc2hUZXh0ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBwb2xpc2hMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign57yW6L6R5Zmo5pyq5bCx57uq77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgICBwb2xpc2hMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZm9jdXMoKTsKICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGxldCBzZWxlY3RlZFRleHQgPSAnJzsKICAgICAgICBsZXQgcmFuZ2UgPSBudWxsOwogICAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJhbmdlID0gc2VsZWN0aW9uOwogICAgICAgICAgc2VsZWN0ZWRUZXh0ID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgICAgfQogICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup6KaB5ram6Imy55qE5paH5pys5YaF5a65Jyk7CiAgICAgICAgICBwb2xpc2hMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gTUFYX0FJX1RFWFRfTEVOR1RIKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZyhg6YCJ5Lit5paH5pys6L+H6ZW/77yM5bey6Ieq5Yqo5oiq5pat5Li65YmNJHtNQVhfQUlfVEVYVF9MRU5HVEh95a2XYCk7CiAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UoMCwgTUFYX0FJX1RFWFRfTEVOR1RIKTsKICAgICAgICB9CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOa2puiJsuaWh+acrO+8jOivt+eojeWAmS4uLicpOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUG9saXNoVGV4dChjdXJyZW50RG9jLnZhbHVlLmlkLCB7CiAgICAgICAgICBzZWxlY3Rpb246IHNlbGVjdGVkVGV4dCwKICAgICAgICAgIHN0eWxlOiAncHJvZmVzc2lvbmFsJwogICAgICAgIH0pOwogICAgICAgIHNob3dDb21wYXJlRGlhbG9nKHsKICAgICAgICAgIHRpdGxlOiAn5paH5pys5ram6Imy57uT5p6cJywKICAgICAgICAgIG9yaWdpbmFsOiBzZWxlY3RlZFRleHQsCiAgICAgICAgICBtb2RpZmllZDogcmVzcG9uc2UuZGF0YS5jb250ZW50LAogICAgICAgICAgb25BcHBseTogZmluYWxDb250ZW50ID0+IHsKICAgICAgICAgICAgaWYgKHJhbmdlICYmIHR5cGVvZiByYW5nZS5pbmRleCA9PT0gJ251bWJlcicgJiYgdHlwZW9mIHJhbmdlLmxlbmd0aCA9PT0gJ251bWJlcicgJiYgcmFuZ2UuaW5kZXggPj0gMCAmJiByYW5nZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgY29uc3QgcXVpbGxMZW4gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpOwogICAgICAgICAgICAgIGxldCBpbnNlcnRQb3MgPSByYW5nZS5pbmRleDsKICAgICAgICAgICAgICBpZiAoaW5zZXJ0UG9zID4gcXVpbGxMZW4pIGluc2VydFBvcyA9IHF1aWxsTGVuIC0gMTsKICAgICAgICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmRlbGV0ZVRleHQoaW5zZXJ0UG9zLCByYW5nZS5sZW5ndGgpOwogICAgICAgICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuaW5zZXJ0VGV4dChpbnNlcnRQb3MsIGZpbmFsQ29udGVudCk7CiAgICAgICAgICAgICAgbGV0IHNlbFBvcyA9IGluc2VydFBvcyArIGZpbmFsQ29udGVudC5sZW5ndGg7CiAgICAgICAgICAgICAgaWYgKHNlbFBvcyA+IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCkgLSAxKSBzZWxQb3MgPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpIC0gMTsKICAgICAgICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLnNldFNlbGVjdGlvbihzZWxQb3MsIDApOwogICAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+aWh+acrOa2puiJsuW3suW6lOeUqCcpOwogICAgICAgICAgICAgIHNjcm9sbFF1aWxsVG9Cb3R0b20oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+mAieWMuuaXoOaViO+8jOaXoOazleaPkuWFpeWGheWuuScpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW+aWh+acrOa2puiJsl0g5byC5bi4OicsIGVycm9yKTsKICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5paH5pys5ram6Imy5aSx6LSlOiAnICsgKGVycm9yLnJlc3BvbnNlLmRhdGEuZGV0YWlsIHx8IGVycm9yLm1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfmlofmnKzmtqboibLlpLHotKXvvIzor7fnqI3lkI7lho3or5UnKTsKICAgICAgICB9CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgcG9saXNoTG9hZGluZy52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIC8vIOa3u+WKoOavlOi+g+W8ueeql+eahOeKtuaAgeWPmOmHj+WSjOaWueazlQogICAgY29uc3QgY29tcGFyZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgY29tcGFyZURpYWxvZ0RhdGEgPSByZWYoewogICAgICB0aXRsZTogJycsCiAgICAgIG9yaWdpbmFsOiAnJywKICAgICAgbW9kaWZpZWQ6ICcnLAogICAgICBtb2RpZmllZENvbnRlbnQ6ICcnLAogICAgICBvbkFwcGx5OiAoKSA9PiB7fQogICAgfSk7CgogICAgLy8g5pi+56S65q+U6L6D5by556qXCiAgICBjb25zdCBzaG93Q29tcGFyZURpYWxvZyA9IGRhdGEgPT4gewogICAgICBjb21wYXJlRGlhbG9nRGF0YS52YWx1ZSA9IHsKICAgICAgICAuLi5kYXRhLAogICAgICAgIG1vZGlmaWVkQ29udGVudDogZGF0YS5tb2RpZmllZAogICAgICB9OwogICAgICBjb21wYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICB9OwoKICAgIC8vIOW6lOeUqOavlOi+g+W8ueeql+eahOabtOaUuQogICAgY29uc3QgYXBwbHlDb21wYXJlQ2hhbmdlcyA9ICgpID0+IHsKICAgICAgY29tcGFyZURpYWxvZ0RhdGEudmFsdWUub25BcHBseShjb21wYXJlRGlhbG9nRGF0YS52YWx1ZS5tb2RpZmllZENvbnRlbnQpOwogICAgICBjb21wYXJlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgfTsKCiAgICAvLyDlhbPpl63mr5TovoPlvLnnqpcKICAgIGNvbnN0IGNsb3NlQ29tcGFyZURpYWxvZyA9ICgpID0+IHsKICAgICAgY29tcGFyZURpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgIH07CgogICAgLy8g6Ziy5oqW5pCc57SiCiAgICBjb25zdCBkZWJvdW5jZWRTZWFyY2ggPSBfLmRlYm91bmNlKCgpID0+IHsKICAgICAgLy8g5pCc57Si6YC76L6R5bey6YCa6L+H6K6h566X5bGe5oCn5aSE55CGCiAgICB9LCAzMDApOwogICAgY29uc3QgZm9ybWF0RGF0ZSA9IGRhdGVTdHJpbmcgPT4gewogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7CiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CgogICAgICAvLyDlkIzkuIDlpKnmmL7npLrml7bpl7QKICAgICAgaWYgKGRhdGUudG9EYXRlU3RyaW5nKCkgPT09IG5vdy50b0RhdGVTdHJpbmcoKSkgewogICAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygnemgtQ04nLCB7CiAgICAgICAgICBob3VyOiAnMi1kaWdpdCcsCiAgICAgICAgICBtaW51dGU6ICcyLWRpZ2l0JwogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyDmmKjlpKkKICAgICAgY29uc3QgeWVzdGVyZGF5ID0gbmV3IERhdGUobm93KTsKICAgICAgeWVzdGVyZGF5LnNldERhdGUobm93LmdldERhdGUoKSAtIDEpOwogICAgICBpZiAoZGF0ZS50b0RhdGVTdHJpbmcoKSA9PT0geWVzdGVyZGF5LnRvRGF0ZVN0cmluZygpKSB7CiAgICAgICAgcmV0dXJuICfmmKjlpKknOwogICAgICB9CgogICAgICAvLyDkuIDlkajlhoXmmL7npLrmmJ/mnJ8KICAgICAgY29uc3Qgd2Vla0RheXMgPSBbJ+WRqOaXpScsICflkajkuIAnLCAn5ZGo5LqMJywgJ+WRqOS4iScsICflkajlm5snLCAn5ZGo5LqUJywgJ+WRqOWFrSddOwogICAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGgucm91bmQoKG5vdyAtIGRhdGUpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTsKICAgICAgaWYgKGRpZmZEYXlzIDwgNykgewogICAgICAgIHJldHVybiB3ZWVrRGF5c1tkYXRlLmdldERheSgpXTsKICAgICAgfQoKICAgICAgLy8g5YW25LuW5oOF5Ya15pi+56S65pel5pyfCiAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnemgtQ04nLCB7CiAgICAgICAgbW9udGg6ICdudW1lcmljJywKICAgICAgICBkYXk6ICdudW1lcmljJwogICAgICB9KTsKICAgIH07CgogICAgLy8g55uR5ZCs6Lev55Sx5Y+Y5YyWCiAgICB3YXRjaCgoKSA9PiByb3V0ZS5wYXJhbXMuaWQsIG5ld0lkID0+IHsKICAgICAgaWYgKG5ld0lkKSB7CiAgICAgICAgLy8g5qOA5p+lSUTmmK/lkKbkuLrmnInmlYjmraPmlbTmlbAKICAgICAgICBjb25zdCBpZE51bSA9IE51bWJlcihuZXdJZCk7CiAgICAgICAgaWYgKGlzTmFOKGlkTnVtKSB8fCBpZE51bSA8PSAwIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGlkTnVtKSkgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfml6DmlYjnmoTmlofmoaNJRCcpOwogICAgICAgICAgcm91dGVyLnB1c2goJy9zbWFydGRvYycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmZXRjaERvY3VtZW50RGV0YWlsKG5ld0lkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjdXJyZW50RG9jLnZhbHVlID0gbnVsbDsKICAgICAgfQogICAgfSwgewogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0pOwoKICAgIC8vIOiHquWKqOS/neWtmOWKn+iDvQogICAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICBpZiAoZG9jdW1lbnRDaGFuZ2VkLnZhbHVlICYmIGN1cnJlbnREb2MudmFsdWUgJiYgIXNhdmVMb2FkaW5nLnZhbHVlKSB7CiAgICAgICAgc2F2ZURvY3VtZW50KCk7CiAgICAgIH0KICAgIH0sIDYwMDAwKTsgLy8g5q+P5YiG6ZKf6Ieq5Yqo5L+d5a2Y5LiA5qyhCgogICAgLy8g55Sf5ZG95ZGo5pyf6ZKp5a2QCiAgICBvbk1vdW50ZWQoKCkgPT4gewogICAgICBmZXRjaERvY3VtZW50cygpOwoKICAgICAgLy8g5LuO6Lev55Sx6I635Y+W5paH5qGjSUQKICAgICAgY29uc3QgZG9jSWQgPSByb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIGlmIChkb2NJZCkgewogICAgICAgIGZldGNoRG9jdW1lbnREZXRhaWwoZG9jSWQpOwogICAgICB9CiAgICB9KTsKCiAgICAvLyDlj6rmnInlhoXlrrnlrp7pmYXlj5jljJbmiY3moIforrDkuLrlt7Lkv67mlLkKICAgIGNvbnN0IG9uVGl0bGVDaGFuZ2UgPSB2YWwgPT4gewogICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB2YWwgIT09IG9yaWdpbmFsRG9jLnZhbHVlLnRpdGxlOwogICAgfTsKICAgIGNvbnN0IG9uVHlwZUNoYW5nZSA9IHZhbCA9PiB7CiAgICAgIGRvY3VtZW50Q2hhbmdlZC52YWx1ZSA9IHZhbCAhPT0gb3JpZ2luYWxEb2MudmFsdWUudHlwZTsKICAgIH07CiAgICBjb25zdCBvbkNvbnRlbnRDaGFuZ2UgPSAoKSA9PiB7CiAgICAgIC8vIOS/ruWkje+8muato+ehruavlOi+g+e8lui+keWZqOWGheWuuQogICAgICBpZiAoY3VycmVudERvYy52YWx1ZSAmJiBvcmlnaW5hbERvYy52YWx1ZSkgewogICAgICAgIC8vIOavlOi+g+W9k+WJjeWGheWuueS4juWOn+Wni+WGheWuueaYr+WQpuecn+eahOS4jeWQjAogICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gY3VycmVudERvYy52YWx1ZS5jb250ZW50OwogICAgICAgIGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IG9yaWdpbmFsRG9jLnZhbHVlLmNvbnRlbnQ7CiAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gY3VycmVudENvbnRlbnQgIT09IG9yaWdpbmFsQ29udGVudDsKICAgICAgfQogICAgICBzY3JvbGxRdWlsbFRvQm90dG9tKCk7CiAgICB9OwoKICAgIC8vIOe8lui+keWZqOWunuS+iwogICAgY29uc3QgcXVpbGxJbnN0YW5jZSA9IHJlZihudWxsKTsKCiAgICAvLyAyLiDnvJbovpHlmahyZWFkeeaXtui1i+WAvAogICAgY29uc3Qgb25FZGl0b3JSZWFkeSA9IHF1aWxsID0+IHsKICAgICAgY29uc29sZS5sb2coJ+e8lui+keWZqOWwsee7qicpOwogICAgICBxdWlsbEluc3RhbmNlLnZhbHVlID0gcXVpbGw7CgogICAgICAvLyDnm7TmjqXnm5HlkKxlZGl0b3LnmoRzZWxlY3Rpb24tY2hhbmdl5LqL5Lu2CiAgICAgIHF1aWxsLm9uKCdzZWxlY3Rpb24tY2hhbmdlJywgKHJhbmdlLCBvbGRSYW5nZSwgc291cmNlKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ+mAieaLqeWPmOWMljonLCByYW5nZSwgc291cmNlKTsKICAgICAgICBpZiAocmFuZ2UgJiYgcmFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgICAgY29uc3QgdGV4dCA9IHF1aWxsLmdldFRleHQocmFuZ2UuaW5kZXgsIHJhbmdlLmxlbmd0aCk7CiAgICAgICAgICBjb25zb2xlLmxvZygn6YCJ5Lit5paH5pysOicsIHRleHQpOwogICAgICAgICAgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgPSB0ZXh0OwogICAgICAgICAgcXVpbGxTZWxlY3Rpb24udmFsdWUgPSByYW5nZTsKICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZSA9PT0gJ3VzZXInIHx8ICFyYW5nZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ+a4hemZpOmAieaLqScpOwogICAgICAgICAgcXVpbGxTZWxlY3RlZFRleHQudmFsdWUgPSAnJzsKICAgICAgICAgIHF1aWxsU2VsZWN0aW9uLnZhbHVlID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICAvLyDoh6rliqjmu5rliqjliLDlupXpg6gKICAgIGZ1bmN0aW9uIHNjcm9sbFF1aWxsVG9Cb3R0b20oKSB7CiAgICAgIGlmIChxdWlsbEluc3RhbmNlLnZhbHVlKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5yb290OwogICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSBjb250YWluZXIuc2Nyb2xsSGVpZ2h0OwogICAgICB9CiAgICB9CiAgICBjb25zdCBncmFtbWFyQ2hlY2tUZXh0ID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICBncmFtbWFyQ2hlY2tMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign57yW6L6R5Zmo5pyq5bCx57uq77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgICBncmFtbWFyQ2hlY2tMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZm9jdXMoKTsKICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGxldCBzZWxlY3RlZFRleHQgPSAnJzsKICAgICAgICBsZXQgcmFuZ2UgPSBudWxsOwogICAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJhbmdlID0gc2VsZWN0aW9uOwogICAgICAgICAgc2VsZWN0ZWRUZXh0ID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgICAgfQogICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup6KaB57qg6ZSZ55qE5paH5pys5YaF5a65Jyk7CiAgICAgICAgICBncmFtbWFyQ2hlY2tMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gTUFYX0FJX1RFWFRfTEVOR1RIKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uud2FybmluZyhg6YCJ5Lit5paH5pys6L+H6ZW/77yM5bey6Ieq5Yqo5oiq5pat5Li65YmNJHtNQVhfQUlfVEVYVF9MRU5HVEh95a2XYCk7CiAgICAgICAgICBzZWxlY3RlZFRleHQgPSBzZWxlY3RlZFRleHQuc2xpY2UoMCwgTUFYX0FJX1RFWFRfTEVOR1RIKTsKICAgICAgICB9CiAgICAgICAgRWxNZXNzYWdlLmluZm8oJ+ato+WcqOaZuuiDvee6oOmUme+8jOivt+eojeWAmS4uLicpOwogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ3JhbW1hckNoZWNrKGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHNlbGVjdGlvbjogc2VsZWN0ZWRUZXh0CiAgICAgICAgfSk7CiAgICAgICAgLy8g5Y+q5L+d55WZ5bu66K6u6YOo5YiG77yM5Y676ZmkIuS8mOWMluWQjueahOaWh+acrCLlrZfmoLfvvIzlubblsIZtZOi9rOS4umh0bWwKICAgICAgICBsZXQgc3VnZ2VzdGlvbnMgPSByZXNwb25zZS5zdWdnZXN0aW9ucyB8fCAnJzsKICAgICAgICBzdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLnJlcGxhY2UoL1wqXCrkvJjljJblkI7nmoTmlofmnKxcKlwqWzrvvJpdPyhbXHNcU10qKSQvLCAnJykudHJpbSgpOwogICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zSHRtbCA9IG1hcmtlZC5wYXJzZShzdWdnZXN0aW9ucyk7CiAgICAgICAgc2hvd0NvbXBhcmVEaWFsb2coewogICAgICAgICAgdGl0bGU6ICfmmbrog73nuqDplJnlu7rorq4nLAogICAgICAgICAgb3JpZ2luYWw6IHNlbGVjdGVkVGV4dCwKICAgICAgICAgIG1vZGlmaWVkOiByZXNwb25zZS5jb3JyZWN0ZWQsCiAgICAgICAgICAvLyDlj7PkvqfnvJbovpHlmajnm7TmjqXloavkvJjljJblkI7mlofmnKwKICAgICAgICAgIHN1Z2dlc3Rpb25zOiBzdWdnZXN0aW9uc0h0bWwsCiAgICAgICAgICAvLyBBSeW7uuiuruWMuuWPquaYvuekuuW7uuiuru+8jOS4lOS4umh0bWwKICAgICAgICAgIG9uQXBwbHk6IGZpbmFsQ29udGVudCA9PiB7CiAgICAgICAgICAgIGlmIChyYW5nZSAmJiB0eXBlb2YgcmFuZ2UuaW5kZXggPT09ICdudW1iZXInICYmIHR5cGVvZiByYW5nZS5sZW5ndGggPT09ICdudW1iZXInICYmIHJhbmdlLmluZGV4ID49IDAgJiYgcmFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IHF1aWxsTGVuID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKTsKICAgICAgICAgICAgICBsZXQgaW5zZXJ0UG9zID0gcmFuZ2UuaW5kZXg7CiAgICAgICAgICAgICAgaWYgKGluc2VydFBvcyA+IHF1aWxsTGVuKSBpbnNlcnRQb3MgPSBxdWlsbExlbiAtIDE7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5kZWxldGVUZXh0KGluc2VydFBvcywgcmFuZ2UubGVuZ3RoKTsKICAgICAgICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLmluc2VydFRleHQoaW5zZXJ0UG9zLCBmaW5hbENvbnRlbnQpOwogICAgICAgICAgICAgIGxldCBzZWxQb3MgPSBpbnNlcnRQb3MgKyBmaW5hbENvbnRlbnQubGVuZ3RoOwogICAgICAgICAgICAgIGlmIChzZWxQb3MgPiBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpIC0gMSkgc2VsUG9zID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSAtIDE7CiAgICAgICAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5zZXRTZWxlY3Rpb24oc2VsUG9zLCAwKTsKICAgICAgICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfmmbrog73nuqDplJnlt7LlupTnlKgnKTsKICAgICAgICAgICAgICBzY3JvbGxRdWlsbFRvQm90dG9tKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfpgInljLrml6DmlYjvvIzml6Dms5Xmj5LlhaXlhoXlrrknKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1vmmbrog73nuqDplJldIOW8guW4uDonLCBlcnJvcik7CiAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoJ+aZuuiDvee6oOmUmeWksei0pTogJyArIChlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCB8fCBlcnJvci5tZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign5pm66IO957qg6ZSZ5aSx6LSl77yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIGdyYW1tYXJDaGVja0xvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICAvLyDlpJror63oqIDnv7vor5EKICAgIGNvbnN0IHRyYW5zbGF0ZURpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3QgdHJhbnNsYXRlSW5wdXQgPSByZWYoJycpOwogICAgY29uc3QgdHJhbnNsYXRlUmVzdWx0ID0gcmVmKCcnKTsKICAgIGNvbnN0IHRyYW5zbGF0ZUxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgY29uc3QgdGFyZ2V0TGFuZyA9IHJlZignZW4nKTsKICAgIGNvbnN0IHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudCA9IHJlZignJyk7CiAgICBjb25zdCBvcGVuVHJhbnNsYXRlRGlhbG9nID0gKCkgPT4gewogICAgICB0cmFuc2xhdGVEaWFsb2dWaXNpYmxlLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJhbnNsYXRlSW5wdXQudmFsdWUgPSAnJzsKICAgICAgdHJhbnNsYXRlUmVzdWx0LnZhbHVlID0gJyc7CiAgICAgIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSA9ICcnOwogICAgICAvLyDoh6rliqjloavlhaXpgInljLrlhoXlrrkKICAgICAgaWYgKHF1aWxsSW5zdGFuY2UudmFsdWUpIHsKICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRyYW5zbGF0ZUlucHV0LnZhbHVlID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgY29uc3QgdXNlU2VsZWN0ZWRUZXh0Rm9yVHJhbnNsYXRlID0gKCkgPT4gewogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUpIHJldHVybjsKICAgICAgY29uc3Qgc2VsZWN0aW9uID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRTZWxlY3Rpb24oKTsKICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24ubGVuZ3RoID4gMCkgewogICAgICAgIHRyYW5zbGF0ZUlucHV0LnZhbHVlID0gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRUZXh0KHNlbGVjdGlvbi5pbmRleCwgc2VsZWN0aW9uLmxlbmd0aCk7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBkb1RyYW5zbGF0ZSA9IGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFjdXJyZW50RG9jLnZhbHVlIHx8ICF0cmFuc2xhdGVJbnB1dC52YWx1ZSkgcmV0dXJuOwogICAgICB0cmFuc2xhdGVMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0cmFuc2xhdGVUZXh0KGN1cnJlbnREb2MudmFsdWUuaWQsIHsKICAgICAgICAgIHNlbGVjdGlvbjogdHJhbnNsYXRlSW5wdXQudmFsdWUsCiAgICAgICAgICB0YXJnZXRfbGFuZzogdGFyZ2V0TGFuZy52YWx1ZQogICAgICAgIH0pOwogICAgICAgIHRyYW5zbGF0ZVJlc3VsdC52YWx1ZSA9IHJlcy50cmFuc2xhdGVkOwogICAgICAgIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSA9IHJlcy50cmFuc2xhdGVkOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCfnv7vor5HlpLHotKUnKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cmFuc2xhdGVMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICBjb25zdCByZXBsYWNlU2VsZWN0aW9uV2l0aFRyYW5zbGF0aW9uID0gKCkgPT4gewogICAgICBpZiAoIXF1aWxsSW5zdGFuY2UudmFsdWUgfHwgIXRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudC52YWx1ZSkgcmV0dXJuOwogICAgICBjb25zdCBzZWxlY3Rpb24gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbigpOwogICAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3QgcXVpbGxMZW4gPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldExlbmd0aCgpOwogICAgICAgIGxldCBpbnNlcnRQb3MgPSBzZWxlY3Rpb24uaW5kZXg7CiAgICAgICAgaWYgKGluc2VydFBvcyA+IHF1aWxsTGVuKSBpbnNlcnRQb3MgPSBxdWlsbExlbiAtIDE7CiAgICAgICAgLy8g5o+S5YWl5a+M5paH5pys5YaF5a6577yIaHRtbO+8iQogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuZGVsZXRlVGV4dChpbnNlcnRQb3MsIHNlbGVjdGlvbi5sZW5ndGgpOwogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuY2xpcGJvYXJkLmRhbmdlcm91c2x5UGFzdGVIVE1MKGluc2VydFBvcywgdHJhbnNsYXRlTW9kaWZpZWRDb250ZW50LnZhbHVlKTsKICAgICAgICBsZXQgc2VsUG9zID0gaW5zZXJ0UG9zICsgdHJhbnNsYXRlTW9kaWZpZWRDb250ZW50LnZhbHVlLnJlcGxhY2UoLzxbXj5dKz4vZywgJycpLmxlbmd0aDsKICAgICAgICBpZiAoc2VsUG9zID4gcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSAtIDEpIHNlbFBvcyA9IHF1aWxsSW5zdGFuY2UudmFsdWUuZ2V0TGVuZ3RoKCkgLSAxOwogICAgICAgIHF1aWxsSW5zdGFuY2UudmFsdWUuc2V0U2VsZWN0aW9uKHNlbFBvcywgMCk7CiAgICAgICAgZG9jdW1lbnRDaGFuZ2VkLnZhbHVlID0gdHJ1ZTsKICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5bey5pu/5o2i5Li657+76K+R5YaF5a65Jyk7CiAgICAgICAgdHJhbnNsYXRlRGlhbG9nVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgIHNjcm9sbFF1aWxsVG9Cb3R0b20oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyDmnKrpgInkuK3lhoXlrrnml7bmj5LlhaXliLDlhYnmoIflpIQKICAgICAgICBjb25zdCBjdXJzb3IgPSBxdWlsbEluc3RhbmNlLnZhbHVlLmdldFNlbGVjdGlvbih0cnVlKTsKICAgICAgICBsZXQgaW5zZXJ0UG9zID0gY3Vyc29yID8gY3Vyc29yLmluZGV4IDogcXVpbGxJbnN0YW5jZS52YWx1ZS5nZXRMZW5ndGgoKSAtIDE7CiAgICAgICAgcXVpbGxJbnN0YW5jZS52YWx1ZS5pbnNlcnRFbWJlZChpbnNlcnRQb3MsICd0ZXh0JywgdHJhbnNsYXRlTW9kaWZpZWRDb250ZW50LnZhbHVlKTsKICAgICAgICBxdWlsbEluc3RhbmNlLnZhbHVlLnNldFNlbGVjdGlvbihpbnNlcnRQb3MgKyB0cmFuc2xhdGVNb2RpZmllZENvbnRlbnQudmFsdWUucmVwbGFjZSgvPFtePl0rPi9nLCAnJykubGVuZ3RoLCAwKTsKICAgICAgICBkb2N1bWVudENoYW5nZWQudmFsdWUgPSB0cnVlOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCflt7Lmj5LlhaXnv7vor5HlhoXlrrknKTsKICAgICAgICB0cmFuc2xhdGVEaWFsb2dWaXNpYmxlLnZhbHVlID0gZmFsc2U7CiAgICAgICAgc2Nyb2xsUXVpbGxUb0JvdHRvbSgpOwogICAgICB9CiAgICB9OwoKICAgIC8vIOaZuuiDvemXruetlAogICAgY29uc3QgcWFEaWFsb2dWaXNpYmxlID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHFhUXVlc3Rpb24gPSByZWYoJycpOwogICAgY29uc3QgcWFBbnN3ZXIgPSByZWYoJycpOwogICAgY29uc3QgcWFMb2FkaW5nID0gcmVmKGZhbHNlKTsKCiAgICAvLyDorqHnrpflsZ7mgKfvvJrlsIZNYXJrZG93buagvOW8j+eahOWbnuetlOi9rOaNouS4ukhUTUwKICAgIGNvbnN0IHFhQW5zd2VySHRtbCA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgcmV0dXJuIHFhQW5zd2VyLnZhbHVlID8gbWFya2VkLnBhcnNlKHFhQW5zd2VyLnZhbHVlKSA6ICcnOwogICAgfSk7CiAgICBjb25zdCBvcGVuUWFEaWFsb2cgPSAoKSA9PiB7CiAgICAgIHFhRGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICAgIHFhUXVlc3Rpb24udmFsdWUgPSAnJzsKICAgICAgcWFBbnN3ZXIudmFsdWUgPSAnJzsKICAgIH07CiAgICBjb25zdCBkb1FhID0gYXN5bmMgKCkgPT4gewogICAgICBpZiAoIWN1cnJlbnREb2MudmFsdWUgfHwgIXFhUXVlc3Rpb24udmFsdWUpIHJldHVybjsKICAgICAgcWFMb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkb2NRYShjdXJyZW50RG9jLnZhbHVlLmlkLCB7CiAgICAgICAgICBxdWVzdGlvbjogcWFRdWVzdGlvbi52YWx1ZSwKICAgICAgICAgIGNvbnRleHQ6IGN1cnJlbnREb2MudmFsdWUuY29udGVudAogICAgICAgIH0pOwogICAgICAgIHFhQW5zd2VyLnZhbHVlID0gcmVzLmFuc3dlcjsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIEVsTWVzc2FnZS5lcnJvcign6Zeu562U5aSx6LSlJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgcWFMb2FkaW5nLnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gewogICAgICBkb2N1bWVudHMsCiAgICAgIGN1cnJlbnREb2MsCiAgICAgIGRvY3VtZW50Q2hhbmdlZCwKICAgICAgaXNEb2NMaXN0Q29sbGFwc2VkLAogICAgICBpc0Fzc2lzdGFudENvbGxhcHNlZCwKICAgICAgc2VhcmNoUXVlcnksCiAgICAgIGRvY1R5cGVGaWx0ZXIsCiAgICAgIHNvcnRPcHRpb24sCiAgICAgIGZpbHRlcmVkRG9jdW1lbnRzLAogICAgICBuZXdEb2N1bWVudERpYWxvZ1Zpc2libGUsCiAgICAgIHNoYXJlRGlhbG9nVmlzaWJsZSwKICAgICAgZGVsZXRlRGlhbG9nVmlzaWJsZSwKICAgICAgc2VsZWN0ZWRVc2VycywKICAgICAgYXZhaWxhYmxlVXNlcnMsCiAgICAgIHNhdmVMb2FkaW5nLAogICAgICBjcmVhdGVMb2FkaW5nLAogICAgICBzaGFyZUxvYWRpbmcsCiAgICAgIGRlbGV0ZUxvYWRpbmcsCiAgICAgIGV4cGFuZExvYWRpbmcsCiAgICAgIHBvbGlzaExvYWRpbmcsCiAgICAgIGdyYW1tYXJDaGVja0xvYWRpbmcsCiAgICAgIG5ld0RvY3VtZW50Rm9ybSwKICAgICAgZG9jdW1lbnRGb3JtUnVsZXMsCiAgICAgIGRvY3VtZW50Rm9ybVJlZiwKICAgICAgZWRpdG9yT3B0aW9ucywKICAgICAgZmV0Y2hEb2N1bWVudHMsCiAgICAgIGZldGNoRG9jdW1lbnREZXRhaWwsCiAgICAgIHNlbGVjdERvY3VtZW50LAogICAgICBzYXZlRG9jdW1lbnQsCiAgICAgIHRvZ2dsZURvY0xpc3QsCiAgICAgIHRvZ2dsZUFzc2lzdGFudCwKICAgICAgb25FZGl0b3JDaGFuZ2UsCiAgICAgIG9wZW5OZXdEb2N1bWVudERpYWxvZywKICAgICAgY3JlYXRlTmV3RG9jdW1lbnQsCiAgICAgIHNoYXJlRG9jdW1lbnQsCiAgICAgIGNvbmZpcm1TaGFyZSwKICAgICAgZGVsZXRlRG9jdW1lbnQsCiAgICAgIGNvbmZpcm1EZWxldGUsCiAgICAgIGV4cG9ydERvY3VtZW50LAogICAgICBleHBvcnRUb1BkZiwKICAgICAgZXhwb3J0VG9Xb3JkLAogICAgICBwcmludERvY3VtZW50LAogICAgICBhZGRDb2xsYWJvcmF0b3IsCiAgICAgIHZpZXdIaXN0b3J5LAogICAgICBleHBhbmRDb250ZW50LAogICAgICBwb2xpc2hUZXh0LAogICAgICBkZWJvdW5jZWRTZWFyY2gsCiAgICAgIGZvcm1hdERhdGUsCiAgICAgIGxvYWRpbmcsCiAgICAgIG9uVGl0bGVDaGFuZ2UsCiAgICAgIG9uVHlwZUNoYW5nZSwKICAgICAgb25Db250ZW50Q2hhbmdlLAogICAgICBvbkVkaXRvclJlYWR5LAogICAgICBjb21wYXJlRGlhbG9nVmlzaWJsZSwKICAgICAgY29tcGFyZURpYWxvZ0RhdGEsCiAgICAgIHNob3dDb21wYXJlRGlhbG9nLAogICAgICBhcHBseUNvbXBhcmVDaGFuZ2VzLAogICAgICBjbG9zZUNvbXBhcmVEaWFsb2csCiAgICAgIHF1aWxsU2VsZWN0aW9uLAogICAgICBxdWlsbFNlbGVjdGVkVGV4dCwKICAgICAgb25TZWxlY3Rpb25DaGFuZ2UsCiAgICAgIHF1aWxsSW5zdGFuY2UsCiAgICAgIGdyYW1tYXJDaGVja1RleHQsCiAgICAgIHRyYW5zbGF0ZURpYWxvZ1Zpc2libGUsCiAgICAgIHRyYW5zbGF0ZUlucHV0LAogICAgICB0cmFuc2xhdGVSZXN1bHQsCiAgICAgIHRyYW5zbGF0ZUxvYWRpbmcsCiAgICAgIHRhcmdldExhbmcsCiAgICAgIG9wZW5UcmFuc2xhdGVEaWFsb2csCiAgICAgIHVzZVNlbGVjdGVkVGV4dEZvclRyYW5zbGF0ZSwKICAgICAgZG9UcmFuc2xhdGUsCiAgICAgIHFhRGlhbG9nVmlzaWJsZSwKICAgICAgcWFRdWVzdGlvbiwKICAgICAgcWFBbnN3ZXIsCiAgICAgIHFhTG9hZGluZywKICAgICAgb3BlblFhRGlhbG9nLAogICAgICBkb1FhLAogICAgICBxYUFuc3dlckh0bWwsCiAgICAgIHJlcGxhY2VTZWxlY3Rpb25XaXRoVHJhbnNsYXRpb24sCiAgICAgIHRyYW5zbGF0ZU1vZGlmaWVkQ29udGVudAogICAgfTsKICB9Cn07"},{"version":3,"names":["ref","computed","watch","onMounted","useRoute","useRouter","ElMessage","ElMessageBox","ElLoading","_","getDocuments","getDocumentDetail","createDocument","updateDocument","deleteDocument","apiDeleteDocument","shareDocument","apiShareDocument","expandContent","apiExpandContent","polishText","apiPolishText","grammarCheck","translateText","docQa","Document","Plus","CircleCheck","Download","More","Search","ArrowLeft","ArrowRight","Share","ShareIcon","Edit","StarFilled","ChatDotRound","QuestionFilled","QuillEditor","MarkedDOMRenderer","Marked","markedHighlight","hljs","marked","langPrefix","highlight","code","lang","language","getLanguage","value","use","renderer","gfm","breaks","pedantic","sanitize","smartLists","smartypants","name","components","setup","route","router","documents","currentDoc","documentChanged","isDocListCollapsed","isAssistantCollapsed","searchQuery","docTypeFilter","sortOption","newDocumentDialogVisible","shareDialogVisible","deleteDialogVisible","selectedUsers","availableUsers","saveLoading","createLoading","shareLoading","deleteLoading","expandLoading","polishLoading","grammarCheckLoading","newDocumentForm","title","type","documentFormRules","required","message","trigger","min","max","documentFormRef","uploadImage","file","reader","FileReader","Promise","resolve","reject","onload","e","base64Data","target","result","url","onerror","Error","readAsDataURL","error","console","editorOptions","placeholder","modules","toolbar","container","handlers","image","input","document","createElement","setAttribute","click","onchange","files","size","supportedTypes","includes","info","res","quill","quillInstance","range","getSelection","insertEmbed","index","success","filteredDocuments","query","toLowerCase","filter","doc","typeFilter","sort","a","b","Date","update_time","create_time","localeCompare","fetchDocuments","response","data","loading","originalDoc","content","fetchDocumentDetail","id","retry","setTimeout","status","push","selectDocument","confirm","confirmButtonText","cancelButtonText","distinguishCancelAndClose","saveDocument","params","toggleDocList","toggleAssistant","onEditorChange","openNewDocumentDialog","createNewDocument","validate","valid","username","confirmShare","length","warning","confirmDelete","exportDocument","showCancelButton","closeOnClickModal","callback","action","exportToPdf","exportToWord","docTitle","filename","editorDom","querySelector","contentElement","cloneNode","options","margin","quality","html2canvas","scale","useCORS","jsPDF","unit","format","orientation","service","lock","text","background","then","html2pdfModule","html2pdf","default","from","set","save","close","catch","contentContainer","innerHTML","msWordHtml","FileSaver","saveAs","blob","Blob","printDocument","addCollaborator","viewHistory","quillSelection","quillSelectedText","onSelectionChange","log","getText","MAX_AI_TEXT_LENGTH","focus","selection","selectedText","slice","showCompareDialog","original","modified","onApply","finalContent","quillLen","getLength","insertPos","deleteText","insertText","selPos","setSelection","scrollQuillToBottom","detail","style","compareDialogVisible","compareDialogData","modifiedContent","applyCompareChanges","closeCompareDialog","debouncedSearch","debounce","formatDate","dateString","date","now","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","weekDays","diffDays","Math","round","getDay","toLocaleDateString","month","day","newId","idNum","Number","isNaN","isInteger","immediate","setInterval","docId","onTitleChange","val","onTypeChange","onContentChange","currentContent","originalContent","onEditorReady","on","oldRange","source","root","scrollTop","scrollHeight","grammarCheckText","suggestions","replace","trim","suggestionsHtml","parse","corrected","translateDialogVisible","translateInput","translateResult","translateLoading","targetLang","translateModifiedContent","openTranslateDialog","useSelectedTextForTranslate","doTranslate","target_lang","translated","replaceSelectionWithTranslation","clipboard","dangerouslyPasteHTML","cursor","qaDialogVisible","qaQuestion","qaAnswer","qaLoading","qaAnswerHtml","openQaDialog","doQa","question","context","answer"],"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\smartdoc\\Detail.vue"],"sourcesContent":["<template>\n  <div class=\"smart-doc-container\">\n    <!-- 文档列表侧边栏 -->\n    <div class=\"sidebar\" :class=\"{ 'collapsed': isDocListCollapsed }\">\n      <!-- 侧边栏头部 -->\n      <div class=\"sidebar-header\">\n        <h4 v-if=\"!isDocListCollapsed\">我的文档</h4>\n        <div class=\"toggle-btn\" @click=\"toggleDocList\">\n          <el-icon><ArrowLeft v-if=\"!isDocListCollapsed\" /><ArrowRight v-else /></el-icon>\n        </div>\n      </div>\n\n      <!-- 展开状态的文档列表 -->\n      <div class=\"sidebar-content\" v-show=\"!isDocListCollapsed\">\n        <!-- 搜索和筛选区域 -->\n        <div class=\"search-area\">\n          <el-input\n            placeholder=\"搜索文档...\"\n            v-model=\"searchQuery\"\n            clearable\n            @input=\"debouncedSearch\"\n          >\n            <template #prefix>\n              <el-icon><Search /></el-icon>\n            </template>\n          </el-input>\n          <div class=\"filter-options\">\n            <el-input v-model=\"docTypeFilter\" placeholder=\"文档类型\" size=\"small\" clearable />\n            <el-select v-model=\"sortOption\" placeholder=\"排序\" size=\"small\">\n              <el-option label=\"最近更新\" value=\"update\" />\n              <el-option label=\"最近创建\" value=\"create\" />\n              <el-option label=\"名称升序\" value=\"name-asc\" />\n            </el-select>\n          </div>\n        </div>\n\n        <!-- 文档列表区域 -->\n        <el-scrollbar class=\"document-list-scrollbar\">\n          <div class=\"document-list\">\n            <div \n              v-for=\"doc in filteredDocuments\" \n              :key=\"doc.id\" \n              class=\"doc-item\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <div class=\"doc-icon\">\n                <el-icon><Document /></el-icon>\n              </div>\n              <div class=\"doc-info\">\n                <h5>{{ doc.title }}</h5>\n                <div class=\"doc-meta\">\n                  <span>{{ doc.type }}</span>\n                  <span>{{ formatDate(doc.update_time) }}</span>\n                </div>\n              </div>\n            </div>\n            \n            <div v-if=\"filteredDocuments.length === 0\" class=\"empty-state\">\n              <!-- 移除暂无文档的显示 -->\n            </div>\n          </div>\n        </el-scrollbar>\n\n        <!-- 创建按钮区域 -->\n        <div class=\"action-buttons\">\n          <el-button type=\"primary\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon> 新建文档\n          </el-button>\n        </div>\n      </div>\n\n      <!-- 折叠状态的文档图标列表 -->\n      <div class=\"collapsed-sidebar\" v-if=\"isDocListCollapsed\">\n        <el-tooltip content=\"新建文档\" placement=\"right\">\n          <div class=\"icon-btn create-btn\" @click=\"openNewDocumentDialog\">\n            <el-icon><Plus /></el-icon>\n          </div>\n        </el-tooltip>\n        \n        <div class=\"recent-docs\">\n          <el-tooltip \n            v-for=\"doc in filteredDocuments.slice(0, 5)\" \n            :key=\"doc.id\" \n            :content=\"doc.title\"\n            placement=\"right\"\n          >\n            <div \n              class=\"icon-btn doc-btn\"\n              :class=\"{ 'active': currentDoc?.id === doc.id }\"\n              @click=\"selectDocument(doc.id)\"\n            >\n              <el-icon><Document /></el-icon>\n            </div>\n          </el-tooltip>\n        </div>\n      </div>\n    </div>\n\n    <!-- 主内容区域 -->\n    <div class=\"main-content\">\n      <!-- 文档内容显示区域 -->\n      <div class=\"document-content\">\n        <el-skeleton v-if=\"loading\" :rows=\"6\" animated style=\"margin:40px\" />\n        <template v-else-if=\"currentDoc\">\n          <!-- 文档标题和操作栏 -->\n          <div class=\"document-header\">\n            <div class=\"doc-info-area\">\n              <div class=\"doc-title-label\">标题：</div>\n              <div class=\"doc-title\">\n                <el-input \n                  v-model=\"currentDoc.title\"\n                  placeholder=\"文档标题\"\n                  size=\"large\"\n                  @change=\"onTitleChange\"\n                />\n              </div>\n              <div class=\"doc-type-label\">类型：</div>\n              <div class=\"doc-type-selector\">\n                <el-input \n                  v-model=\"currentDoc.type\" \n                  placeholder=\"输入文档类型\"\n                  size=\"default\"\n                  @change=\"onTypeChange\"\n                />\n              </div>\n            </div>\n            <div class=\"doc-actions\">\n              <el-tooltip content=\"保存文档\" placement=\"bottom\">\n                <el-button \n                  circle\n                  :disabled=\"!documentChanged\" \n                  :loading=\"saveLoading\"\n                  @click=\"saveDocument\"\n                >\n                  <el-icon><CircleCheck /></el-icon>\n                </el-button>\n              </el-tooltip>\n              <el-tooltip content=\"分享文档\" placement=\"bottom\">\n                <el-button circle @click=\"shareDocument\"><el-icon><ShareIcon /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"导出文档\" placement=\"bottom\">\n                <el-button circle @click=\"exportDocument\"><el-icon><Download /></el-icon></el-button>\n              </el-tooltip>\n              <el-tooltip content=\"更多操作\" placement=\"bottom\">\n                <el-dropdown trigger=\"click\">\n                  <el-button circle><el-icon><More /></el-icon></el-button>\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                      <el-dropdown-item @click=\"printDocument\">打印文档</el-dropdown-item>\n                      <el-dropdown-item @click=\"addCollaborator\">添加协作者</el-dropdown-item>\n                      <el-dropdown-item @click=\"viewHistory\">查看历史版本</el-dropdown-item>\n                      <el-dropdown-item divided @click=\"deleteDocument\" class=\"text-red-500\">删除文档</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </el-tooltip>\n            </div>\n          </div>\n          \n          <!-- 编辑器区域 -->\n          <div class=\"editor-area\">\n            <QuillEditor\n              v-model:content=\"currentDoc.content\"\n              :options=\"editorOptions\"\n              contentType=\"html\"\n              theme=\"snow\"\n              class=\"quill-editor\"\n              @textChange=\"onContentChange\"\n              @ready=\"onEditorReady\"\n              placeholder=\" \"\n              @selection-change=\"onSelectionChange\"\n            />\n          </div>\n        </template>\n        \n        <!-- 无文档时的提示 -->\n        <div v-else class=\"empty-doc-state\">\n          <el-empty description=\"请选择或创建一个文档\">\n            <el-button type=\"primary\" @click=\"openNewDocumentDialog\">新建文档</el-button>\n          </el-empty>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 智能助手面板 -->\n    <div class=\"assistant-panel\" :class=\"{ 'collapsed': isAssistantCollapsed }\">\n      <div class=\"assistant-header\">\n        <h5 v-if=\"!isAssistantCollapsed\">AI功能</h5>\n        <div class=\"toggle-btn\" @click=\"toggleAssistant\">\n          <el-icon><ArrowRight v-if=\"!isAssistantCollapsed\" /><ArrowLeft v-else /></el-icon>\n        </div>\n      </div>\n      \n      <div class=\"assistant-body\" v-show=\"!isAssistantCollapsed\">\n        <div class=\"ai-features-beauty\">\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"!!quillSelectedText\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"primary\" class=\"ai-feature-btn\" @click=\"expandContent\" :loading=\"expandLoading\" :disabled=\"!quillSelectedText\">\n                <el-icon class=\"ai-icon\"><Edit /></el-icon>\n                内容扩写\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">将选中文本智能扩展为更丰富内容，适合写作、报告等场景。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"!!quillSelectedText\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"success\" class=\"ai-feature-btn\" @click=\"polishText\" :loading=\"polishLoading\" :disabled=\"!quillSelectedText\">\n                <el-icon class=\"ai-icon\"><StarFilled /></el-icon>\n                文本润色\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">让表达更专业、流畅，提升文档整体质量。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-tooltip content=\"请先在编辑器中选择文本后再使用此功能\" :disabled=\"!!quillSelectedText\" placement=\"top\" effect=\"dark\">\n              <el-button type=\"warning\" class=\"ai-feature-btn\" @click=\"grammarCheckText\" :loading=\"grammarCheckLoading\" :disabled=\"!quillSelectedText\">\n                <el-icon class=\"ai-icon\"><Edit /></el-icon>\n                智能纠错\n              </el-button>\n            </el-tooltip>\n            <div class=\"ai-feature-desc\">AI自动检查语法、错别字、表达不通顺并给出优化建议。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-button type=\"info\" class=\"ai-feature-btn\" @click=\"openTranslateDialog\">\n              <el-icon class=\"ai-icon\"><ChatDotRound /></el-icon>\n              多语言翻译\n            </el-button>\n            <div class=\"ai-feature-desc\">支持多语种精准互译，助力国际化办公。</div>\n          </div>\n          <div class=\"ai-feature-card\">\n            <el-button type=\"success\" class=\"ai-feature-btn\" @click=\"openQaDialog\">\n              <el-icon class=\"ai-icon\"><QuestionFilled /></el-icon>\n              智能问答\n            </el-button>\n            <div class=\"ai-feature-desc\">基于文档内容，AI即时解答你的问题。</div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 创建新文档对话框 -->\n    <el-dialog\n      v-model=\"newDocumentDialogVisible\"\n      title=\"新建智能文档\"\n      width=\"35%\"\n    >\n      <el-form \n        :model=\"newDocumentForm\" \n        label-width=\"80px\" \n        :rules=\"documentFormRules\"\n        ref=\"documentFormRef\"\n      >\n        <el-form-item label=\"文档标题\" prop=\"title\">\n          <el-input v-model=\"newDocumentForm.title\" placeholder=\"请输入文档标题\" />\n        </el-form-item>\n        <el-form-item label=\"文档类型\">\n          <el-input v-model=\"newDocumentForm.type\" placeholder=\"请输入文档类型\" />\n          <div class=\"form-tip\">如果未填写，默认为通用类型</div>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"newDocumentDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"createNewDocument\" :loading=\"createLoading\">\n            创建\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 分享文档对话框 -->\n    <el-dialog\n      v-model=\"shareDialogVisible\"\n      title=\"分享文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您即将分享文档: <strong>{{ currentDoc.title }}</strong></p>\n        <el-form label-width=\"120px\" class=\"mt-4\">\n          <el-form-item label=\"选择用户\">\n            <el-select\n              v-model=\"selectedUsers\"\n              multiple\n              placeholder=\"请选择用户\"\n              style=\"width: 100%\"\n            >\n              <el-option\n                v-for=\"user in availableUsers\"\n                :key=\"user.id\"\n                :label=\"user.username\"\n                :value=\"user.id\"\n              />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"shareDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"confirmShare\" :loading=\"shareLoading\">\n            分享\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n    \n    <!-- 删除确认对话框 -->\n    <el-dialog\n      v-model=\"deleteDialogVisible\"\n      title=\"删除文档\"\n      width=\"30%\"\n    >\n      <div v-if=\"currentDoc\">\n        <p>您确定要删除文档 <strong>{{ currentDoc.title }}</strong> 吗?</p>\n        <p class=\"warning-text\">此操作不可撤销!</p>\n        </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"deleteDialogVisible = false\">取消</el-button>\n          <el-button type=\"danger\" @click=\"confirmDelete\" :loading=\"deleteLoading\">\n            删除\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 比较弹窗 -->\n    <el-dialog\n      v-model=\"compareDialogVisible\"\n      :title=\"compareDialogData.title\"\n      width=\"90%\"\n      class=\"compare-dialog large-dialog\"\n      :fullscreen=\"false\"\n      :append-to-body=\"true\"\n      :destroy-on-close=\"false\"\n      :close-on-click-modal=\"false\"\n      :show-close=\"true\"\n    >\n      <div v-if=\"compareDialogData\" class=\"dialog-container\">\n        <div class=\"compare-content\">\n          <div class=\"original-content\">\n            <h6>原始内容</h6>\n            <QuillEditor\n              v-model:content=\"compareDialogData.original\"\n              contentType=\"text\"\n              theme=\"snow\"\n              :readOnly=\"true\"\n              class=\"quill-editor-in-dialog\"\n              style=\"background:#f9f9f9;\"\n            />\n          </div>\n          <div class=\"modified-content\">\n            <h6>优化建议内容（可编辑）</h6>\n            <QuillEditor\n              v-model:content=\"compareDialogData.modifiedContent\"\n              contentType=\"text\"\n              theme=\"snow\"\n              class=\"quill-editor-in-dialog\"\n            />\n          </div>\n        </div>\n        <div v-if=\"compareDialogData.suggestions\" class=\"ai-suggestions\" style=\"margin-top:16px;\">\n          <el-alert\n            title=\"AI纠错建议\"\n            type=\"info\"\n            :closable=\"false\"\n            show-icon\n            style=\"font-size:15px;line-height:1.8;\"\n          >\n            <div v-html=\"compareDialogData.suggestions\"></div>\n          </el-alert>\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"closeCompareDialog\">取消</el-button>\n          <el-button type=\"primary\" @click=\"applyCompareChanges\">应用更改</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 多语言翻译弹窗（对比模式） -->\n    <el-dialog v-model=\"translateDialogVisible\" title=\"多语言智能翻译\" width=\"900px\">\n      <div style=\"margin-bottom:12px; display:flex; align-items:center; gap:12px;\">\n        <el-select v-model=\"targetLang\" placeholder=\"选择目标语言\" style=\"width:180px;\">\n          <el-option label=\"英文\" value=\"en\" />\n          <el-option label=\"中文\" value=\"zh\" />\n          <el-option label=\"日文\" value=\"ja\" />\n          <el-option label=\"法文\" value=\"fr\" />\n          <el-option label=\"德文\" value=\"de\" />\n          <el-option label=\"西班牙文\" value=\"es\" />\n          <el-option label=\"俄文\" value=\"ru\" />\n          <el-option label=\"韩文\" value=\"ko\" />\n        </el-select>\n        <el-button type=\"primary\" :loading=\"translateLoading\" @click=\"doTranslate\">翻译</el-button>\n      </div>\n      <div class=\"compare-content\">\n        <div class=\"original-content\">\n          <h6>原文内容</h6>\n          <QuillEditor\n            v-model:content=\"translateInput\"\n            contentType=\"text\"\n            theme=\"snow\"\n            :readOnly=\"true\"\n            class=\"quill-editor-in-dialog\"\n            style=\"background:#f9f9f9;\"\n          />\n        </div>\n        <div class=\"modified-content\">\n          <h6>翻译内容（可编辑）</h6>\n          <QuillEditor\n            v-model:content=\"translateModifiedContent\"\n            contentType=\"text\"\n            theme=\"snow\"\n            class=\"quill-editor-in-dialog\"\n          />\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"translateDialogVisible = false\">取消</el-button>\n          <el-button v-if=\"translateModifiedContent\" type=\"success\" @click=\"replaceSelectionWithTranslation\">应用翻译</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 智能问答弹窗 -->\n    <el-dialog v-model=\"qaDialogVisible\" title=\"文档智能问答\" width=\"500px\">\n      <el-input\n        v-model=\"qaQuestion\"\n        placeholder=\"请输入您的问题\"\n        style=\"margin-bottom:12px;\"\n        @keyup.enter=\"doQa\"\n      />\n      <el-button type=\"primary\" :loading=\"qaLoading\" @click=\"doQa\">提问</el-button>\n      <div v-if=\"qaAnswer\" style=\"margin-top:16px;\">\n        <el-alert title=\"AI答案\" type=\"info\" :closable=\"false\" show-icon>\n          <div v-html=\"qaAnswerHtml\"></div>\n        </el-alert>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, watch, onMounted } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox, ElLoading } from 'element-plus'\nimport _ from 'lodash'\nimport { \n  getDocuments, \n  getDocumentDetail, \n  createDocument, \n  updateDocument,\n  deleteDocument as apiDeleteDocument,\n  shareDocument as apiShareDocument,\n  expandContent as apiExpandContent,\n  polishText as apiPolishText,\n  grammarCheck,\n  translateText,\n  docQa\n} from '@/api/smartdoc'\nimport { Document, Plus, CircleCheck, Download, More, Search, ArrowLeft, ArrowRight, Share as ShareIcon, Edit, StarFilled, ChatDotRound, QuestionFilled } from '@element-plus/icons-vue'\nimport { QuillEditor } from '@vueup/vue-quill'\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\nimport { MarkedDOMRenderer, Marked } from 'marked'\nimport { markedHighlight } from 'marked-highlight'\nimport hljs from 'highlight.js'\nimport 'highlight.js/styles/github.css' // 导入代码高亮样式表\n\n// 配置marked\nconst marked = new Marked(\n  markedHighlight({\n    langPrefix: 'hljs language-',\n    highlight(code, lang) {\n      const language = hljs.getLanguage(lang) ? lang : 'plaintext';\n      return hljs.highlight(code, { language }).value;\n    }\n  })\n);\n\n// 设置安全选项\nmarked.use({\n  renderer: new MarkedDOMRenderer(),\n  gfm: true,\n  breaks: true,\n  pedantic: false,\n  sanitize: true, // 启用安全过滤\n  smartLists: true,\n  smartypants: false\n});\n\nexport default {\n  name: 'SmartDocDetail',\n  components: {\n    Document, Plus, CircleCheck, Download, More, \n    Search, ArrowLeft, ArrowRight, ShareIcon, QuillEditor, Edit, StarFilled, ChatDotRound, QuestionFilled\n  },\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    \n    // 状态数据\n    const documents = ref([])\n    const currentDoc = ref(null)\n    const documentChanged = ref(false)\n    const isDocListCollapsed = ref(false)\n    const isAssistantCollapsed = ref(false)\n    const searchQuery = ref('')\n    const docTypeFilter = ref('')\n    const sortOption = ref('update')\n    const newDocumentDialogVisible = ref(false)\n    const shareDialogVisible = ref(false)\n    const deleteDialogVisible = ref(false)\n    const selectedUsers = ref([])\n    const availableUsers = ref([])\n    \n    // 加载状态\n    const saveLoading = ref(false)\n    const createLoading = ref(false)\n    const shareLoading = ref(false)\n    const deleteLoading = ref(false)\n    const expandLoading = ref(false)\n    const polishLoading = ref(false)\n    const grammarCheckLoading = ref(false)\n    \n    // 表单数据\n    const newDocumentForm = ref({\n        title: '',\n      type: ''\n    })\n    \n    // 表单验证规则\n    const documentFormRules = {\n      title: [\n        { required: true, message: '请输入文档标题', trigger: 'blur' },\n        { min: 2, max: 50, message: '标题长度须在2到50个字符之间', trigger: 'blur' }\n      ]\n    }\n    \n    const documentFormRef = ref(null)\n      \n    const uploadImage = async (file) => {\n      try {\n        // 使用FileReader将文件转换为base64\n        const reader = new FileReader()\n        return new Promise((resolve, reject) => {\n          reader.onload = (e) => {\n            const base64Data = e.target.result\n            // 直接返回base64数据作为图片URL\n            resolve({ url: base64Data })\n          }\n          reader.onerror = () => {\n            reject(new Error('文件读取失败'))\n          }\n          reader.readAsDataURL(file)\n        })\n      } catch (error) {\n        console.error('图片处理失败:', error)\n        throw error\n      }\n    }\n    \n      // 编辑器配置\n    const editorOptions = {\n      placeholder: ' ',\n        modules: {\n        toolbar: {\n          container: [\n            ['bold', 'italic', 'underline', 'strike'],\n            ['blockquote', 'code-block'],\n          [{ 'header': 1 }, { 'header': 2 }],\n          [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n          [{ 'script': 'sub' }, { 'script': 'super' }],\n          [{ 'indent': '-1' }, { 'indent': '+1' }],\n          [{ 'direction': 'rtl' }],\n          [{ 'size': ['small', false, 'large', 'huge'] }],\n          [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n          [{ 'color': [] }, { 'background': [] }],\n          [{ 'font': [] }],\n          [{ 'align': [] }],\n            ['clean'],\n          ['link', 'image']\n          ],\n          handlers: {\n            image: function () {\n              const input = document.createElement('input')\n              input.setAttribute('type', 'file')\n              input.setAttribute('accept', 'image/*')\n              input.click()\n              input.onchange = async () => {\n                const file = input.files[0]\n                if (!file) return\n                \n                // 检查文件大小和类型\n                if (file.size > 5 * 1024 * 1024) { // 5MB限制\n                  ElMessage.error('图片不能超过5MB')\n                  return\n                }\n                \n                // 支持的图片类型\n                const supportedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n                if (!supportedTypes.includes(file.type)) {\n                  ElMessage.error('只支持JPG、PNG、GIF和WEBP格式图片')\n                  return\n                }\n                \n                ElMessage.info('正在处理图片...')\n                \n                try {\n                  // 直接传递文件对象而不是FormData\n                  const res = await uploadImage(file)\n                  const url = res.url\n                  if (!url) throw new Error('无效的图片URL')\n                  \n                  // 获取编辑器实例并插入图片\n                  const quill = quillInstance.value\n                  const range = quill.getSelection(true)\n                  quill.insertEmbed(range.index, 'image', url)\n                  \n                  // 标记文档已修改\n                  documentChanged.value = true\n                  \n                  ElMessage.success('图片插入成功')\n                } catch (e) {\n                  console.error('图片处理失败:', e)\n                  ElMessage.error('图片处理失败: ' + e.message)\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    \n    // 计算属性\n    const filteredDocuments = computed(() => {\n      let result = [...documents.value]\n      \n      // 搜索筛选\n      if (searchQuery.value) {\n        const query = searchQuery.value.toLowerCase()\n        result = result.filter(doc => \n          doc.title.toLowerCase().includes(query) || \n          doc.type.toLowerCase().includes(query)\n        )\n      }\n      \n      // 类型筛选\n      if (docTypeFilter.value) {\n        const typeFilter = docTypeFilter.value.toLowerCase()\n        result = result.filter(doc => \n          doc.type.toLowerCase().includes(typeFilter)\n        )\n      }\n      \n      // 排序\n      if (sortOption.value === 'update') {\n        result.sort((a, b) => new Date(b.update_time) - new Date(a.update_time))\n      } else if (sortOption.value === 'create') {\n        result.sort((a, b) => new Date(b.create_time) - new Date(a.create_time))\n      } else if (sortOption.value === 'name-asc') {\n        result.sort((a, b) => a.title.localeCompare(b.title))\n      }\n      \n      return result\n    })\n    \n    // 方法\n    const fetchDocuments = async () => {\n      try {\n        const response = await getDocuments()\n        documents.value = response.data\n      } catch (error) {\n        console.error('获取文档列表失败', error)\n        ElMessage.error('获取文档列表失败')\n      }\n    }\n    \n    const loading = ref(false)\n    \n    // 记录初始内容用于对比\n    const originalDoc = ref({ title: '', type: '', content: '' })\n    \n    const fetchDocumentDetail = async (id, retry = 0) => {\n      loading.value = true\n      try {\n        const response = await getDocumentDetail(id)\n        if (response && response.data) {\n          currentDoc.value = response.data\n          // 记录初始内容\n          originalDoc.value = {\n            title: response.data.title,\n            type: response.data.type,\n            content: response.data.content\n          }\n          documentChanged.value = false\n          loading.value = false\n        } else {\n          throw new Error('文档不存在或数据无效')\n        }\n      } catch (error) {\n        if (retry < 3) {\n          setTimeout(() => fetchDocumentDetail(id, retry + 1), 1000)\n        } else {\n          loading.value = false\n          console.error('获取文档详情失败', error)\n          ElMessage.error(error.response && error.response.status === 404 ? '文档不存在' : '获取文档详情失败')\n          router.push('/smartdoc')\n        }\n      }\n    }\n    \n    const selectDocument = async (id) => {\n      // 如果当前文档已修改，提示保存\n      if (documentChanged.value && currentDoc.value) {\n        try {\n          await ElMessageBox.confirm(\n            '当前文档已修改但未保存，是否保存更改？',\n            '保存提示',\n            {\n              confirmButtonText: '保存',\n              cancelButtonText: '不保存',\n              type: 'warning',\n              distinguishCancelAndClose: true // 允许区分取消和关闭\n            }\n          )\n          await saveDocument()\n        } catch (error) {\n          // 用户选择不保存或点×，撤销本地更改，恢复原内容\n          if (error === 'cancel' || error === 'close') {\n            if (currentDoc.value && originalDoc.value) {\n              currentDoc.value.title = originalDoc.value.title\n              currentDoc.value.type = originalDoc.value.type\n              currentDoc.value.content = originalDoc.value.content\n              documentChanged.value = false\n            }\n          }\n          // 用户选择不保存，继续切换文档\n        }\n      }\n      // 更新路由以反映新选中的文档\n      router.push({ name: 'SmartDocDetail', params: { id } })\n    }\n    \n    const saveDocument = async () => {\n      if (!currentDoc.value || !documentChanged.value) return\n      \n      saveLoading.value = true\n      try {\n        await updateDocument(currentDoc.value.id, {\n          title: currentDoc.value.title,\n          type: currentDoc.value.type,\n          content: currentDoc.value.content\n        })\n        \n        // 保存成功后，更新原始文档记录\n        originalDoc.value = {\n          title: currentDoc.value.title,\n          type: currentDoc.value.type,\n          content: currentDoc.value.content\n        }\n        documentChanged.value = false\n        ElMessage.success('文档保存成功')\n      } catch (error) {\n        console.error('保存文档失败', error)\n        ElMessage.error('保存文档失败')\n      } finally {\n        saveLoading.value = false\n      }\n    }\n    \n    const toggleDocList = () => {\n      isDocListCollapsed.value = !isDocListCollapsed.value\n    }\n    \n    const toggleAssistant = () => {\n      isAssistantCollapsed.value = !isAssistantCollapsed.value\n    }\n    \n    const onEditorChange = () => {\n      documentChanged.value = true\n    }\n    \n    const openNewDocumentDialog = () => {\n      newDocumentForm.value = { title: '', type: '' }\n      newDocumentDialogVisible.value = true\n    }\n    \n    const createNewDocument = async () => {\n      if (!documentFormRef.value) return\n      \n      await documentFormRef.value.validate(async (valid) => {\n        if (valid) {\n          createLoading.value = true\n          try {\n            const response = await createDocument({\n              title: newDocumentForm.value.title,\n              type: newDocumentForm.value.type || '通用',\n              content: ''\n            })\n            \n            ElMessage.success('文档创建成功')\n            newDocumentDialogVisible.value = false\n            \n            // 刷新文档列表并打开新文档\n            await fetchDocuments()\n            router.push({ name: 'SmartDocDetail', params: { id: response.data.id } })\n      } catch (error) {\n            console.error('创建文档失败', error)\n            ElMessage.error('创建文档失败')\n          } finally {\n            createLoading.value = false\n          }\n        }\n      })\n    }\n    \n    const shareDocument = () => {\n      if (!currentDoc.value) return\n      \n      // 在实际项目中，这里应该从API获取可用用户列表\n      availableUsers.value = [\n        { id: 1, username: '张三' },\n        { id: 2, username: '李四' },\n        { id: 3, username: '王五' }\n      ]\n      selectedUsers.value = []\n      shareDialogVisible.value = true\n    }\n    \n    const confirmShare = async () => {\n      if (!currentDoc.value || selectedUsers.value.length === 0) {\n        ElMessage.warning('请选择至少一个用户')\n        return\n      }\n      \n      shareLoading.value = true\n      try {\n        await apiShareDocument(currentDoc.value.id, selectedUsers.value)\n        ElMessage.success('文档分享成功')\n        shareDialogVisible.value = false\n      } catch (error) {\n        console.error('分享文档失败', error)\n        ElMessage.error('分享文档失败')\n      } finally {\n        shareLoading.value = false\n      }\n    }\n    \n    const deleteDocument = () => {\n      if (!currentDoc.value) return\n      \n      deleteDialogVisible.value = true\n    }\n    \n    const confirmDelete = async () => {\n      if (!currentDoc.value) return\n      \n      deleteLoading.value = true\n      try {\n        await apiDeleteDocument(currentDoc.value.id)\n        ElMessage.success('文档删除成功')\n        deleteDialogVisible.value = false\n        \n        // 返回到文档列表页\n        router.push('/smartdoc')\n      } catch (error) {\n        console.error('删除文档失败', error)\n        ElMessage.error('删除文档失败')\n      } finally {\n        deleteLoading.value = false\n      }\n    }\n    \n    const exportDocument = () => {\n      ElMessageBox({\n        title: '导出文档',\n        message: '请选择导出格式',\n        showCancelButton: true,\n        confirmButtonText: '导出为PDF',\n        cancelButtonText: '导出为Word',\n        closeOnClickModal: true,\n        callback: (action) => {\n          if (action === 'confirm') {\n            exportToPdf()\n          } else if (action === 'cancel') {\n            exportToWord()\n          }\n        }\n      })\n    }\n    \n    // 导出为PDF\n    const exportToPdf = () => {\n      if (!currentDoc.value || !currentDoc.value.content) {\n        ElMessage.error('没有可导出的文档')\n        return\n      }\n      const docTitle = currentDoc.value.title || '未命名文档'\n      const filename = `${docTitle}.pdf`\n      // 直接克隆quill编辑器内容\n      const editorDom = document.querySelector('.ql-editor')\n      if (!editorDom) {\n        ElMessage.error('未找到编辑器内容')\n        return\n      }\n      const contentElement = editorDom.cloneNode(true)\n      const options = {\n        margin: [15, 15, 15, 15],\n        filename: filename,\n        image: { type: 'jpeg', quality: 0.98 },\n        html2canvas: { scale: 2, useCORS: true },\n        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n      }\n      const loading = ElLoading.service({\n        lock: true,\n        text: '正在生成PDF...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      import('html2pdf.js').then(html2pdfModule => {\n        const html2pdf = html2pdfModule.default\n        html2pdf().from(contentElement).set(options).save().then(() => {\n          loading.close()\n          ElMessage.success('PDF导出成功')\n        }).catch(error => {\n          console.error('PDF导出失败:', error)\n          loading.close()\n          ElMessage.error('PDF导出失败')\n        })\n      }).catch(error => {\n        console.error('加载html2pdf.js失败:', error)\n        loading.close()\n        ElMessage.error('PDF导出功能加载失败')\n      })\n    }\n    \n    // 导出为Word（保留图片）\n    const exportToWord = async () => {\n      if (!currentDoc.value || !currentDoc.value.content) {\n        ElMessage.error('没有可导出的文档')\n        return\n      }\n      \n      const docTitle = currentDoc.value.title || '未命名文档'\n      const filename = `${docTitle}.doc`\n      \n      const loading = ElLoading.service({\n        lock: true,\n        text: '正在生成Word文档...',\n        background: 'rgba(255, 255, 255, 0.7)'\n      })\n      \n      try {\n        // 创建一个临时文档容器处理内容\n        const contentContainer = document.createElement('div')\n        contentContainer.innerHTML = currentDoc.value.content\n        // 不再替换图片为占位符，直接保留<img>标签\n        // 创建微软Word兼容的HTML文档\n        const msWordHtml = `\n          <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" \n                xmlns:w=\"urn:schemas-microsoft-com:office:word\" \n                xmlns=\"http://www.w3.org/TR/REC-html40\">\n          <head>\n            <meta charset=\"utf-8\">\n            <title>${docTitle}</title>\n            <style>\n              body { font-family: SimSun, Arial, sans-serif; margin: 1cm; }\n              img { max-width: 100%; height: auto; }\n              p { margin: 0; padding: 0; }\n              h1 { font-size: 18pt; }\n              h2 { font-size: 16pt; }\n              h3 { font-size: 14pt; }\n              table { border-collapse: collapse; width: 100%; }\n              td, th { border: 1px solid #000; padding: 5px; }\n            </style>\n          </head>\n          <body>\n            <h1>${docTitle}</h1>\n            ${contentContainer.innerHTML}\n          </body>\n          </html>\n        `\n        // 使用file-saver保存文件\n        const FileSaver = await import('file-saver')\n        const saveAs = FileSaver.saveAs || FileSaver.default\n        const blob = new Blob([msWordHtml], { type: 'application/msword' })\n        saveAs(blob, filename)\n        loading.close()\n        ElMessage.success('Word文档导出成功')\n      } catch (error) {\n        console.error('Word导出失败:', error)\n        loading.close()\n        ElMessage.error(`Word导出失败: ${error.message || '未知错误'}`)\n      }\n    }\n    \n    const printDocument = () => {\n      ElMessage.info('打印文档功能暂未实现')\n    }\n    \n    const addCollaborator = () => {\n      ElMessage.info('添加协作者功能暂未实现')\n    }\n    \n    const viewHistory = () => {\n      ElMessage.info('查看历史版本功能暂未实现')\n    }\n    \n    // 1. 在setup里加缓存变量\n    const quillSelection = ref(null);\n    const quillSelectedText = ref('');\n\n    // 2. 监听Quill的selection-change事件\n    const onSelectionChange = (range) => {\n      console.log('组件selection-change事件:', range);\n      if (!quillInstance.value) return;\n      \n      if (range && range.length > 0) {\n        const text = quillInstance.value.getText(range.index, range.length);\n        console.log('组件选中文本:', text);\n        quillSelectedText.value = text;\n        quillSelection.value = range;\n      } else {\n        console.log('组件清除选择');\n        quillSelectedText.value = '';\n        quillSelection.value = null;\n      }\n    };\n\n    // 1. 最大长度常量\n    const MAX_AI_TEXT_LENGTH = 2000;\n\n    // 2. expandContent方法加截断\n    const expandContent = async () => {\n      if (!currentDoc.value) return;\n      try {\n        expandLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          expandLoading.value = false;\n          return;\n        }\n        quillInstance.value.focus();\n        const selection = quillInstance.value.getSelection();\n        let selectedText = '';\n        let range = null;\n        if (selection && selection.length > 0) {\n          range = selection;\n          selectedText = quillInstance.value.getText(selection.index, selection.length);\n        }\n        if (!selectedText) {\n          ElMessage.warning('请先选择要扩写的文本内容');\n          expandLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在扩写内容，请稍候...');\n        const response = await apiExpandContent(currentDoc.value.id, {\n          selection: selectedText,\n          length: 'medium'\n        });\n        showCompareDialog({\n          title: '内容扩写结果',\n          original: selectedText,\n          modified: response.data.content,\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n              quillInstance.value.deleteText(insertPos, range.length);\n              quillInstance.value.insertText(insertPos, finalContent);\n              let selPos = insertPos + finalContent.length;\n              if (selPos > quillInstance.value.getLength() - 1) selPos = quillInstance.value.getLength() - 1;\n              quillInstance.value.setSelection(selPos, 0);\n              documentChanged.value = true;\n              ElMessage.success('内容扩写已应用');\n              scrollQuillToBottom();\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[内容扩写] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('内容扩写失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('内容扩写失败，请稍后再试');\n        }\n      } finally {\n        expandLoading.value = false;\n      }\n    };\n\n    // 3. polishText同理\n    const polishText = async () => {\n      if (!currentDoc.value) return;\n      try {\n        polishLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          polishLoading.value = false;\n          return;\n        }\n        quillInstance.value.focus();\n        const selection = quillInstance.value.getSelection();\n        let selectedText = '';\n        let range = null;\n        if (selection && selection.length > 0) {\n          range = selection;\n          selectedText = quillInstance.value.getText(selection.index, selection.length);\n        }\n        if (!selectedText) {\n          ElMessage.warning('请先选择要润色的文本内容');\n          polishLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在润色文本，请稍候...');\n        const response = await apiPolishText(currentDoc.value.id, {\n          selection: selectedText,\n          style: 'professional'\n        });\n        showCompareDialog({\n          title: '文本润色结果',\n          original: selectedText,\n          modified: response.data.content,\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n              quillInstance.value.deleteText(insertPos, range.length);\n              quillInstance.value.insertText(insertPos, finalContent);\n              let selPos = insertPos + finalContent.length;\n              if (selPos > quillInstance.value.getLength() - 1) selPos = quillInstance.value.getLength() - 1;\n              quillInstance.value.setSelection(selPos, 0);\n              documentChanged.value = true;\n              ElMessage.success('文本润色已应用');\n              scrollQuillToBottom();\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[文本润色] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('文本润色失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('文本润色失败，请稍后再试');\n        }\n      } finally {\n        polishLoading.value = false;\n      }\n    };\n    \n    // 添加比较弹窗的状态变量和方法\n    const compareDialogVisible = ref(false)\n    const compareDialogData = ref({\n      title: '',\n      original: '',\n      modified: '',\n      modifiedContent: '',\n      onApply: () => {}\n    })\n    \n    // 显示比较弹窗\n    const showCompareDialog = (data) => {\n      compareDialogData.value = {\n        ...data,\n        modifiedContent: data.modified\n      };\n      compareDialogVisible.value = true;\n    }\n    \n    // 应用比较弹窗的更改\n    const applyCompareChanges = () => {\n      compareDialogData.value.onApply(compareDialogData.value.modifiedContent);\n      compareDialogVisible.value = false;\n    }\n    \n    // 关闭比较弹窗\n    const closeCompareDialog = () => {\n      compareDialogVisible.value = false\n    }\n    \n    // 防抖搜索\n    const debouncedSearch = _.debounce(() => {\n      // 搜索逻辑已通过计算属性处理\n    }, 300)\n    \n    const formatDate = (dateString) => {\n      const date = new Date(dateString)\n      const now = new Date()\n      \n      // 同一天显示时间\n      if (date.toDateString() === now.toDateString()) {\n        return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n      }\n      \n      // 昨天\n      const yesterday = new Date(now)\n      yesterday.setDate(now.getDate() - 1)\n      if (date.toDateString() === yesterday.toDateString()) {\n        return '昨天'\n      }\n      \n      // 一周内显示星期\n      const weekDays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n      const diffDays = Math.round((now - date) / (1000 * 60 * 60 * 24))\n      if (diffDays < 7) {\n        return weekDays[date.getDay()]\n      }\n      \n      // 其他情况显示日期\n      return date.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' })\n    }\n    \n    // 监听路由变化\n    watch(() => route.params.id, (newId) => {\n      if (newId) {\n        // 检查ID是否为有效正整数\n        const idNum = Number(newId)\n        if (isNaN(idNum) || idNum <= 0 || !Number.isInteger(idNum)) {\n          ElMessage.error('无效的文档ID')\n          router.push('/smartdoc')\n          return\n        }\n        fetchDocumentDetail(newId)\n      } else {\n        currentDoc.value = null\n      }\n    }, { immediate: true })\n    \n    // 自动保存功能\n    setInterval(() => {\n      if (documentChanged.value && currentDoc.value && !saveLoading.value) {\n        saveDocument()\n      }\n    }, 60000) // 每分钟自动保存一次\n    \n    // 生命周期钩子\n    onMounted(() => {\n      fetchDocuments()\n      \n      // 从路由获取文档ID\n      const docId = route.params.id\n      if (docId) {\n        fetchDocumentDetail(docId)\n      }\n    })\n    \n    // 只有内容实际变化才标记为已修改\n    const onTitleChange = (val) => {\n      documentChanged.value = val !== originalDoc.value.title\n    }\n    const onTypeChange = (val) => {\n      documentChanged.value = val !== originalDoc.value.type\n    }\n    const onContentChange = () => {\n      // 修复：正确比较编辑器内容\n      if (currentDoc.value && originalDoc.value) {\n        // 比较当前内容与原始内容是否真的不同\n        const currentContent = currentDoc.value.content\n        const originalContent = originalDoc.value.content\n        documentChanged.value = currentContent !== originalContent\n      }\n      scrollQuillToBottom();\n    }\n    \n    // 编辑器实例\n    const quillInstance = ref(null);\n\n    // 2. 编辑器ready时赋值\n    const onEditorReady = (quill) => {\n      console.log('编辑器就绪');\n      quillInstance.value = quill;\n      \n      // 直接监听editor的selection-change事件\n      quill.on('selection-change', (range, oldRange, source) => {\n        console.log('选择变化:', range, source);\n        if (range && range.length > 0) {\n          const text = quill.getText(range.index, range.length);\n          console.log('选中文本:', text);\n          quillSelectedText.value = text;\n          quillSelection.value = range;\n        } else if (source === 'user' || !range) {\n          console.log('清除选择');\n          quillSelectedText.value = '';\n          quillSelection.value = null;\n        }\n      });\n    };\n    \n    // 自动滚动到底部\n    function scrollQuillToBottom() {\n      if (quillInstance.value) {\n        const container = quillInstance.value.root;\n        container.scrollTop = container.scrollHeight;\n      }\n    }\n    \n    const grammarCheckText = async () => {\n      if (!currentDoc.value) return;\n      try {\n        grammarCheckLoading.value = true;\n        if (!quillInstance.value) {\n          ElMessage.error('编辑器未就绪，请稍后再试');\n          grammarCheckLoading.value = false;\n          return;\n        }\n        quillInstance.value.focus();\n        const selection = quillInstance.value.getSelection();\n        let selectedText = '';\n        let range = null;\n        if (selection && selection.length > 0) {\n          range = selection;\n          selectedText = quillInstance.value.getText(selection.index, selection.length);\n        }\n        if (!selectedText) {\n          ElMessage.warning('请先选择要纠错的文本内容');\n          grammarCheckLoading.value = false;\n          return;\n        }\n        if (selectedText.length > MAX_AI_TEXT_LENGTH) {\n          ElMessage.warning(`选中文本过长，已自动截断为前${MAX_AI_TEXT_LENGTH}字`);\n          selectedText = selectedText.slice(0, MAX_AI_TEXT_LENGTH);\n        }\n        ElMessage.info('正在智能纠错，请稍候...');\n        const response = await grammarCheck(currentDoc.value.id, { selection: selectedText });\n        // 只保留建议部分，去除\"优化后的文本\"字样，并将md转为html\n        let suggestions = response.suggestions || '';\n        suggestions = suggestions.replace(/\\*\\*优化后的文本\\*\\*[:：]?([\\s\\S]*)$/, '').trim();\n        const suggestionsHtml = marked.parse(suggestions);\n        showCompareDialog({\n          title: '智能纠错建议',\n          original: selectedText,\n          modified: response.corrected, // 右侧编辑器直接填优化后文本\n          suggestions: suggestionsHtml, // AI建议区只显示建议，且为html\n          onApply: (finalContent) => {\n            if (\n              range &&\n              typeof range.index === 'number' &&\n              typeof range.length === 'number' &&\n              range.index >= 0 &&\n              range.length > 0\n            ) {\n              const quillLen = quillInstance.value.getLength();\n              let insertPos = range.index;\n              if (insertPos > quillLen) insertPos = quillLen - 1;\n              quillInstance.value.deleteText(insertPos, range.length);\n              quillInstance.value.insertText(insertPos, finalContent);\n              let selPos = insertPos + finalContent.length;\n              if (selPos > quillInstance.value.getLength() - 1) selPos = quillInstance.value.getLength() - 1;\n              quillInstance.value.setSelection(selPos, 0);\n              documentChanged.value = true;\n              ElMessage.success('智能纠错已应用');\n              scrollQuillToBottom();\n            } else {\n              ElMessage.error('选区无效，无法插入内容');\n            }\n          }\n        });\n      } catch (error) {\n        console.error('[智能纠错] 异常:', error);\n        if (error && error.response) {\n          ElMessage.error('智能纠错失败: ' + (error.response.data.detail || error.message));\n        } else {\n          ElMessage.error('智能纠错失败，请稍后再试');\n        }\n      } finally {\n        grammarCheckLoading.value = false;\n      }\n    }\n    \n    // 多语言翻译\n    const translateDialogVisible = ref(false)\n    const translateInput = ref('')\n    const translateResult = ref('')\n    const translateLoading = ref(false)\n    const targetLang = ref('en')\n    const translateModifiedContent = ref('')\n    const openTranslateDialog = () => {\n      translateDialogVisible.value = true\n      translateInput.value = ''\n      translateResult.value = ''\n      translateModifiedContent.value = ''\n      // 自动填入选区内容\n      if (quillInstance.value) {\n        const selection = quillInstance.value.getSelection()\n        if (selection && selection.length > 0) {\n          translateInput.value = quillInstance.value.getText(selection.index, selection.length)\n        }\n      }\n    }\n    const useSelectedTextForTranslate = () => {\n      if (!quillInstance.value) return\n      const selection = quillInstance.value.getSelection()\n      if (selection && selection.length > 0) {\n        translateInput.value = quillInstance.value.getText(selection.index, selection.length)\n      }\n    }\n    const doTranslate = async () => {\n      if (!currentDoc.value || !translateInput.value) return\n      translateLoading.value = true\n      try {\n        const res = await translateText(currentDoc.value.id, { selection: translateInput.value, target_lang: targetLang.value })\n        translateResult.value = res.translated\n        translateModifiedContent.value = res.translated\n      } catch (e) {\n        ElMessage.error('翻译失败')\n      } finally {\n        translateLoading.value = false\n      }\n    }\n    const replaceSelectionWithTranslation = () => {\n      if (!quillInstance.value || !translateModifiedContent.value) return\n      const selection = quillInstance.value.getSelection()\n      if (selection && selection.length > 0) {\n        const quillLen = quillInstance.value.getLength()\n        let insertPos = selection.index\n        if (insertPos > quillLen) insertPos = quillLen - 1\n        // 插入富文本内容（html）\n        quillInstance.value.deleteText(insertPos, selection.length)\n        quillInstance.value.clipboard.dangerouslyPasteHTML(insertPos, translateModifiedContent.value)\n        let selPos = insertPos + translateModifiedContent.value.replace(/<[^>]+>/g, '').length\n        if (selPos > quillInstance.value.getLength() - 1) selPos = quillInstance.value.getLength() - 1\n        quillInstance.value.setSelection(selPos, 0)\n        documentChanged.value = true\n        ElMessage.success('已替换为翻译内容')\n        translateDialogVisible.value = false\n        scrollQuillToBottom()\n      } else {\n        // 未选中内容时插入到光标处\n        const cursor = quillInstance.value.getSelection(true)\n        let insertPos = cursor ? cursor.index : quillInstance.value.getLength() - 1\n        quillInstance.value.insertEmbed(insertPos, 'text', translateModifiedContent.value)\n        quillInstance.value.setSelection(insertPos + translateModifiedContent.value.replace(/<[^>]+>/g, '').length, 0)\n        documentChanged.value = true\n        ElMessage.success('已插入翻译内容')\n        translateDialogVisible.value = false\n        scrollQuillToBottom()\n      }\n    }\n\n    // 智能问答\n    const qaDialogVisible = ref(false)\n    const qaQuestion = ref('')\n    const qaAnswer = ref('')\n    const qaLoading = ref(false)\n    \n    // 计算属性：将Markdown格式的回答转换为HTML\n    const qaAnswerHtml = computed(() => {\n      return qaAnswer.value ? marked.parse(qaAnswer.value) : ''\n    })\n    \n    const openQaDialog = () => {\n      qaDialogVisible.value = true\n      qaQuestion.value = ''\n      qaAnswer.value = ''\n    }\n    const doQa = async () => {\n      if (!currentDoc.value || !qaQuestion.value) return\n      qaLoading.value = true\n      try {\n        const res = await docQa(currentDoc.value.id, { question: qaQuestion.value, context: currentDoc.value.content })\n        qaAnswer.value = res.answer\n      } catch (e) {\n        ElMessage.error('问答失败')\n      } finally {\n        qaLoading.value = false\n      }\n    }\n    \n    return {\n      documents,\n      currentDoc,\n      documentChanged,\n      isDocListCollapsed,\n      isAssistantCollapsed,\n      searchQuery,\n      docTypeFilter,\n      sortOption,\n      filteredDocuments,\n      newDocumentDialogVisible,\n      shareDialogVisible,\n      deleteDialogVisible,\n      selectedUsers,\n      availableUsers,\n      saveLoading,\n      createLoading,\n      shareLoading,\n      deleteLoading,\n      expandLoading,\n      polishLoading,\n      grammarCheckLoading,\n      newDocumentForm,\n      documentFormRules,\n      documentFormRef,\n      editorOptions,\n      fetchDocuments,\n      fetchDocumentDetail,\n      selectDocument,\n      saveDocument,\n      toggleDocList,\n      toggleAssistant,\n      onEditorChange,\n      openNewDocumentDialog,\n      createNewDocument,\n      shareDocument,\n      confirmShare,\n      deleteDocument,\n      confirmDelete,\n      exportDocument,\n      exportToPdf,\n      exportToWord,\n      printDocument,\n      addCollaborator,\n      viewHistory,\n      expandContent,\n      polishText,\n      debouncedSearch,\n      formatDate,\n      loading,\n      onTitleChange,\n      onTypeChange,\n      onContentChange,\n      onEditorReady,\n      compareDialogVisible,\n      compareDialogData,\n      showCompareDialog,\n      applyCompareChanges,\n      closeCompareDialog,\n      quillSelection,\n      quillSelectedText,\n      onSelectionChange,\n      quillInstance,\n      grammarCheckText,\n      translateDialogVisible,\n      translateInput,\n      translateResult,\n      translateLoading,\n      targetLang,\n      openTranslateDialog,\n      useSelectedTextForTranslate,\n      doTranslate,\n      qaDialogVisible,\n      qaQuestion,\n      qaAnswer,\n      qaLoading,\n      openQaDialog,\n      doQa,\n      qaAnswerHtml,\n      replaceSelectionWithTranslation,\n      translateModifiedContent\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n/* 修改整体布局，调整侧边栏和主内容区域的宽度比例 */\n.smart-doc-container {\n  display: flex;\n  height: 100%;\n  overflow: hidden;\n  background-color: #fff;\n}\n\n.sidebar {\n  width: 240px;\n  height: 100%;\n  border-right: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  /* 仅保留宽度变化的过渡，其他动画全部去除 */\n  transition: width 0.3s;\n}\n\n.sidebar.collapsed {\n  width: 50px;\n}\n\n.sidebar-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.sidebar-header h4 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.toggle-btn {\n  cursor: pointer;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n}\n\n.toggle-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.sidebar-content {\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 48px);\n  overflow: hidden;\n}\n\n.search-area {\n  padding: 12px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.filter-options {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.document-list-scrollbar {\n  flex: 1;\n  padding: 8px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.document-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.doc-item {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.doc-item:hover {\n  background-color: #f5f7fa;\n}\n\n.doc-item.active {\n  background-color: #ecf5ff;\n}\n\n.doc-icon {\n  margin-right: 12px;\n  color: #409eff;\n}\n\n.doc-info {\n  flex: 1;\n  overflow: hidden;\n}\n\n.doc-info h5 {\n  margin: 0 0 4px 0;\n  font-size: 14px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.doc-meta {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n  color: #909399;\n}\n\n.action-buttons {\n  padding: 12px;\n  border-top: 1px solid #f0f0f0;\n}\n\n.action-buttons .el-button {\n  width: 100%;\n}\n\n.collapsed-sidebar {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 12px 0;\n  gap: 12px;\n  height: calc(100% - 48px);\n  overflow-y: auto;\n}\n\n.icon-btn {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.icon-btn:hover {\n  background-color: #f2f2f2;\n}\n\n.icon-btn.doc-btn.active {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.create-btn {\n  background-color: #ecf5ff;\n  color: #409eff;\n}\n\n.recent-docs {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n  align-items: center;\n}\n\n/* 主内容区域样式 */\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n  height: 100%;\n  background-color: #f6f6f6;\n  position: relative;\n  /* 去除外部滚动 */\n  overflow: hidden;\n}\n\n.document-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  height: 100%;\n  overflow: hidden;\n}\n\n/* 文档标题和类型标签样式 */\n.doc-title-label, .doc-type-label {\n  font-size: 14px;\n  font-weight: 600;\n  color: #606266;\n  white-space: nowrap;\n}\n\n.document-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 24px;\n  background-color: #fff;\n  border-bottom: 1px solid #e6e6e6;\n  height: 68px;\n  box-sizing: border-box;\n  width: 100%;\n  z-index: 5;\n}\n\n.doc-info-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.doc-title {\n  width: 300px;\n}\n\n.doc-type-selector {\n  width: 150px;\n}\n\n.doc-actions {\n  display: flex;\n  gap: 8px;\n  z-index: 6; /* 确保操作按钮在最上层 */\n}\n\n.editor-area {\n  flex: 1;\n  background-color: #fff;\n  height: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-sizing: border-box;\n  padding: 0; /* 取消padding，避免高度累加 */\n}\n\n.quill-editor {\n  flex: 1;\n  height: 100%;\n  background: #fff;\n  min-height: 0;\n  box-sizing: border-box;\n}\n\n.quill-editor :deep(.ql-container) {\n  flex: 1;\n  height: 100% !important;\n  min-height: 0 !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  box-sizing: border-box;\n}\n\n.quill-editor :deep(.ql-editor) {\n  flex: 1;\n  min-height: 0 !important;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  padding: 15px;\n  box-sizing: border-box;\n}\n\n.empty-doc-state {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #fff;\n}\n\n/* 智能助手面板样式 */\n.assistant-panel {\n  width: 280px;\n  height: 100%;\n  border-left: 1px solid #e6e6e6;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s;\n}\n\n.assistant-panel.collapsed {\n  width: 50px;\n}\n\n.assistant-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e6e6e6;\n  height: 48px;\n  box-sizing: border-box;\n}\n\n.assistant-header h5 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.assistant-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 16px;\n}\n\n.ai-features-beauty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 28px;\n  margin-top: 30px;\n}\n\n.ai-feature-card {\n  width: 100%;\n  max-width: 320px;\n  background: #f8fafd;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(80,120,200,0.06);\n  padding: 18px 20px 10px 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  transition: box-shadow 0.2s;\n}\n\n.ai-feature-card:hover {\n  box-shadow: 0 4px 16px rgba(80,120,200,0.13);\n}\n\n.ai-feature-btn {\n  width: 100%;\n  height: 48px;\n  font-size: 17px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  margin-bottom: 6px;\n  transition: background 0.2s, color 0.2s;\n}\n\n.ai-feature-desc {\n  font-size: 13px;\n  color: #7a8599;\n  text-align: center;\n  margin-top: 2px;\n  margin-bottom: 2px;\n  line-height: 1.6;\n}\n\n.context-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.warning-text {\n  color: #f56c6c;\n  font-weight: 500;\n}\n\n.compare-content {\n  flex: 1;\n  display: flex;\n  gap: 20px;\n  overflow: hidden;\n}\n\n.original-content, .modified-content {\n  flex: 1;\n  min-width: 350px;\n  max-width: 50%;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  background: #fff;\n}\n\n.original-content h6, .modified-content h6 {\n  margin: 0;\n  padding: 10px;\n  font-size: 14px;\n  font-weight: 600;\n  background-color: #eef2f6;\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.content-box {\n  padding: 15px;\n  overflow-y: auto;\n  white-space: pre-wrap;\n  flex: 1;\n  font-size: 14px;\n  line-height: 1.6;\n  max-height: 50vh;\n  border: 1px solid #e0e0e0;\n  background-color: #fff;\n}\n\n.compare-dialog :deep(.el-dialog__body) {\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  max-height: 60vh;\n  height: 60vh;\n  overflow: hidden;\n}\n\n.compare-dialog :deep(.el-dialog__header) {\n  padding: 15px 20px;\n}\n\n.compare-dialog :deep(.el-dialog__footer) {\n  padding: 10px 20px;\n}\n\n.compare-dialog :deep(.el-dialog) {\n  max-height: 85vh; /* 限制整个对话框的最大高度 */\n  display: flex;\n  flex-direction: column;\n  margin: 0 auto !important;\n  overflow: hidden; /* 弹窗本身不应该滚动 */\n}\n\n/* 确保弹窗内容能够撑满但不溢出弹窗 */\n.compare-dialog :deep(.el-dialog__body) {\n  padding: 20px;\n  flex: 1;\n  overflow: auto;\n  max-height: calc(85vh - 110px); /* 减去头部和底部的高度 */\n  height: auto;\n  display: flex;\n  flex-direction: column;\n}\n\n.dialog-container {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  overflow: visible;\n}\n\n.quill-editor-in-dialog {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n.quill-editor-in-dialog :deep(.ql-toolbar) {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: #fff;\n}\n\n.quill-editor-in-dialog :deep(.ql-container) {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n}\n\n.quill-editor-in-dialog :deep(.ql-editor) {\n  flex: 1;\n  min-height: 0 !important;\n  height: 100% !important;\n  overflow-y: auto !important;\n  background: #fff !important;\n  padding: 15px;\n}\n</style>\n\n<style>\n/* Markdown 内容样式 */\n.el-alert__content div {\n  max-height: 400px;\n  overflow-y: auto;\n  padding-right: 8px;\n}\n\n/* Markdown 样式 */\n.el-alert__content div h1,\n.el-alert__content div h2,\n.el-alert__content div h3,\n.el-alert__content div h4,\n.el-alert__content div h5,\n.el-alert__content div h6 {\n  margin-top: 16px;\n  margin-bottom: 8px;\n  font-weight: 600;\n}\n\n.el-alert__content div h1 { font-size: 1.5em; }\n.el-alert__content div h2 { font-size: 1.3em; }\n.el-alert__content div h3 { font-size: 1.2em; }\n\n.el-alert__content div p {\n  margin-bottom: 12px;\n  line-height: 1.6;\n}\n\n.el-alert__content div ul,\n.el-alert__content div ol {\n  padding-left: 20px;\n  margin-bottom: 12px;\n}\n\n.el-alert__content div li {\n  margin-bottom: 4px;\n}\n\n.el-alert__content div code {\n  background-color: #f0f0f0;\n  padding: 2px 4px;\n  border-radius: 3px;\n  font-family: monospace;\n  font-size: 0.9em;\n}\n\n.el-alert__content div pre {\n  background-color: #f5f5f5;\n  padding: 12px;\n  border-radius: 4px;\n  overflow-x: auto;\n  margin-bottom: 12px;\n}\n\n.el-alert__content div pre code {\n  background-color: transparent;\n  padding: 0;\n  border-radius: 0;\n  display: block;\n  white-space: pre;\n}\n\n.el-alert__content div blockquote {\n  border-left: 4px solid #ddd;\n  padding-left: 12px;\n  color: #666;\n  margin: 0 0 12px;\n}\n\n.el-alert__content div table {\n  border-collapse: collapse;\n  margin-bottom: 12px;\n  width: 100%;\n}\n\n.el-alert__content div th,\n.el-alert__content div td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: left;\n}\n\n.el-alert__content div th {\n  background-color: #f2f2f2;\n}\n\n.el-alert__content div a {\n  color: #409eff;\n  text-decoration: none;\n}\n\n.el-alert__content div a:hover {\n  text-decoration: underline;\n}\n\n.el-alert__content div img {\n  max-width: 100%;\n  height: auto;\n}\n</style> "],"mappings":"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","ignoreList":[]}]}