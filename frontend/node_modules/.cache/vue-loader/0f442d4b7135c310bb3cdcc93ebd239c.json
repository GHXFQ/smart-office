{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\contract\\Index.vue?vue&type=style&index=0&id=b01c68e2&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\contract\\Index.vue","mtime":1751705135684},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jb250cmFjdC1jb250YWluZXIgewogIHBhZGRpbmc6IDIwcHg7Cn0KCi5jYXJkLWhlYWRlci1mbGV4IHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9CgouY29udHJhY3QtbGlzdC1jYXJkIHsKICBtaW4taGVpZ2h0OiA1MDBweDsKfQoKLmNvbnRyYWN0LWxpc3QgewogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBnYXA6IDEycHg7Cn0KCi5jb250cmFjdC1pdGVtIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHBhZGRpbmc6IDE1cHg7CiAgYm9yZGVyOiAxcHggc29saWQgI2U0ZTdlZDsKICBib3JkZXItcmFkaXVzOiA4cHg7CiAgY3Vyc29yOiBwb2ludGVyOwogIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0Owp9CgouY29udHJhY3QtaXRlbTpob3ZlciB7CiAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMDgpOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsKfQoKLmNvbnRyYWN0LWl0ZW0uYWN0aXZlIHsKICBib3JkZXItY29sb3I6ICM0MDllZmY7CiAgYmFja2dyb3VuZC1jb2xvcjogI2VjZjVmZjsKfQoKLmNvbnRyYWN0LW1haW4taW5mbyB7CiAgZmxleC1ncm93OiAxOwp9CgouY29udHJhY3QtdGl0bGUgewogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgZm9udC1zaXplOiAxNnB4OwogIGNvbG9yOiAjMzAzMTMzOwogIG1hcmdpbi1ib3R0b206IDhweDsKfQoKLmNvbnRyYWN0LWluZm8gewogIGZvbnQtc2l6ZTogMTNweDsKICBjb2xvcjogIzYwNjI2NjsKICBkaXNwbGF5OiBmbGV4OwogIGdhcDogMjBweDsKfQoKLmNvbnRyYWN0LWluZm8gc3BhbiB7CiAgbWluLXdpZHRoOiAxNTBweDsKfQoKLmNvbnRyYWN0LWFjdGlvbnMgewogIGZsZXgtc2hyaW5rOiAwOwogIG1hcmdpbi1sZWZ0OiAyMHB4Owp9CgoubW9yZS1idXR0b24gewogIGJvcmRlcjogbm9uZTsKfQoKLnBhZ2luYXRpb24tY29udGFpbmVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7CiAgbWFyZ2luLXRvcDogMjBweDsKfQoKLmRpYWxvZy1mb290ZXIgewogIHRleHQtYWxpZ246IHJpZ2h0Owp9Cg=="},{"version":3,"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\contract\\Index.vue"],"names":[],"mappings":"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","file":"C:/Users/18083/Desktop/CCIT/office/smart-office/frontend/src/views/contract/Index.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"contract-container\">\n    <div class=\"row\">\n      <!-- 合同列表 -->\n      <div class=\"col-lg-12\">\n        <el-card class=\"contract-list-card\" v-loading=\"isLoading\">\n          <template #header>\n            <div class=\"card-header-flex\">\n              <span>合同列表</span>\n              <div class=\"d-flex align-items-center ms-auto me-3\">\n                <el-input v-model=\"searchQuery\" placeholder=\"搜索标题或编号...\" clearable :prefix-icon=\"Search\"\n                  class=\"me-2\" style=\"width: 200px;\" @clear=\"handleFilterChange\"></el-input>\n                <el-select v-model=\"sortBy\" placeholder=\"默认排序\" class=\"me-2\" style=\"width: 150px;\"\n                  @change=\"handleFilterChange\">\n                  <el-option label=\"默认排序\" value=\"default\"></el-option>\n                  <el-option label=\"合同标题\" value=\"title\"></el-option>\n                  <el-option label=\"创建时间\" value=\"created_at\"></el-option>\n                  <el-option label=\"合同金额\" value=\"amount\"></el-option>\n                </el-select>\n                <el-select v-model=\"sortOrder\" style=\"width: 100px;\" @change=\"handleFilterChange\">\n                  <el-option label=\"升序\" value=\"asc\"></el-option>\n                  <el-option label=\"降序\" value=\"desc\"></el-option>\n                </el-select>\n              </div>\n              <el-button type=\"primary\" size=\"small\" @click=\"openContractDialog\">\n                <el-icon class=\"mr-1\">\n                  <Plus />\n                </el-icon> 新建合同\n              </el-button>\n            </div>\n          </template>\n\n          <div class=\"contract-list\">\n            <div v-for=\"(contract) in filteredContracts\" :key=\"contract.id\" class=\"contract-item\"\n              :class=\"{'active': selectedContract && selectedContract.id === contract.id}\">\n              <div class=\"contract-main-info\" @click=\"viewContractDetail(contract)\">\n                <div class=\"contract-title\">\n                  {{ contract.title }}\n                </div>\n                <div class=\"contract-info\">\n                  <span>合同编号: {{ contract.number }}</span>\n                  <span>创建时间: {{ contract.createdAt }}</span>\n                </div>\n                <div class=\"contract-info mt-1\">\n                  <span>{{ contract.company }}</span>\n                  <span>金额: {{ contract.displayAmount }}</span>\n                </div>\n              </div>\n              <div class=\"contract-actions\">\n                <el-dropdown trigger=\"click\" @click.stop>\n                  <el-button :icon=\"MoreFilled\" class=\"more-button\" text circle />\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                      <el-dropdown-item :icon=\"Edit\" @click=\"handleEdit(contract)\">编辑</el-dropdown-item>\n                      <el-dropdown-item :icon=\"Share\" @click=\"handleShare(contract)\">分享</el-dropdown-item>\n                      <el-dropdown-item :icon=\"Delete\" divided class=\"text-danger\"\n                        @click=\"handleDelete(contract)\">删除</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </div>\n            </div>\n\n            <el-empty v-if=\"filteredContracts.length === 0\" description=\"没有找到匹配的合同\"></el-empty>\n          </div>\n\n          <!-- 添加分页组件 -->\n          <div class=\"pagination-container\">\n            <el-pagination v-model:current-page=\"currentPage\" :page-size=\"10\" layout=\"total, prev, pager, next, jumper\"\n              :total=\"totalItems\" @current-change=\"handleCurrentChange\" />\n          </div>\n        </el-card>\n      </div>\n    </div>\n\n    <!-- 创建合同模态框 -->\n    <el-dialog v-model=\"showNewContractDialog\" title=\"新建合同\" width=\"70%\" top=\"5vh\">\n      <el-form :model=\"templateForm\" ref=\"contractForm\" label-width=\"100px\">\n        <el-form-item label=\"创建方式\" prop=\"creationMode\">\n          <el-radio-group v-model=\"creationMode\">\n            <el-radio-button label=\"template\">使用模板</el-radio-button>\n            <el-radio-button label=\"manual\">手动创建</el-radio-button>\n            <el-radio-button label=\"ai\">AI 生成</el-radio-button>\n          </el-radio-group>\n        </el-form-item>\n\n        <el-divider />\n\n        <!-- 模板选择部分 -->\n        <div v-if=\"creationMode === 'template'\">\n          <el-row :gutter=\"20\">\n            <el-col :span=\"8\">\n              <el-form-item label=\"合同类型\">\n                <el-select v-model=\"templateForm.contractType\" placeholder=\"请选择合同类型\" style=\"width: 100%\" filterable>\n                  <el-option v-for=\"item in contractTypes\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"行业领域\">\n                <el-select v-model=\"templateForm.industry\" placeholder=\"请选择行业领域\" style=\"width: 100%\" filterable>\n                  <el-option v-for=\"item in industries\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"交易场景\">\n                <el-select v-model=\"templateForm.scene\" placeholder=\"请选择交易场景\" style=\"width: 100%\" filterable>\n                   <el-option v-for=\"item in scenes\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n                </el-select>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-form-item label=\"推荐模板\">\n            <el-select v-model=\"selectedTemplate\" placeholder=\"搜索并选择一个模板\" style=\"width: 100%\" filterable\n              @change=\"handleTemplateSelect\">\n              <el-option v-for=\"template in availableTemplates\" :key=\"template.id\" :label=\"template.name\"\n                :value=\"template.id\">\n                <span style=\"float: left\">{{ template.name }}</span>\n                <span\n                  style=\"float: right; color: var(--el-text-color-secondary); font-size: 13px;\">{{ template.contract_type }}</span>\n              </el-option>\n            </el-select>\n          </el-form-item>\n\n          <el-row :gutter=\"20\">\n            <el-col :span=\"12\">\n              <el-form-item label=\"合同名称\" required>\n                <el-input v-model=\"templateForm.title\" placeholder=\"根据模板和日期生成\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item label=\"签约对方\" required>\n                <el-input v-model=\"templateForm.partyB\" placeholder=\"请输入签约对方名称\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row :gutter=\"20\">\n            <el-col :span=\"12\">\n               <el-form-item label=\"合同金额\">\n                <el-input-number v-model=\"templateForm.amount\" :precision=\"2\" :step=\"1000\" placeholder=\"请输入合同金额\" style=\"width: 100%;\" />\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-form-item label=\"备注\">\n            <el-input v-model=\"templateForm.notes\" type=\"textarea\" :rows=\"3\" placeholder=\"请输入备注\"></el-input>\n          </el-form-item>\n        </div>\n\n        <!-- 手动创建/AI生成通用部分 -->\n        <div v-else>\n           <el-row :gutter=\"20\">\n            <el-col :span=\"12\">\n              <el-form-item label=\"合同名称\" required>\n                <el-input v-model=\"newContract.title\"></el-input>\n              </el-form-item>\n            </el-col>\n             <el-col :span=\"12\">\n              <el-form-item label=\"签约对方\" required>\n                <el-input v-model=\"newContract.company\"></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n           <el-row :gutter=\"20\">\n             <el-col :span=\"12\">\n                <el-form-item label=\"合同类型\" required>\n                <el-select v-model=\"newContract.type\" placeholder=\"请选择...\" style=\"width: 100%\" filterable allow-create\n                  default-first-option @change=\"handleContractTypeChange\">\n                   <el-option v-for=\"item in contractTypes\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n                </el-select>\n              </el-form-item>\n            </el-col>\n             <el-col :span=\"12\">\n               <el-form-item label=\"合同金额\">\n                <el-input-number v-model=\"newContract.amount\" :precision=\"2\" :step=\"1000\" placeholder=\"请输入合同金额\" style=\"width: 100%;\" />\n              </el-form-item>\n            </el-col>\n          </el-row>\n           <el-row :gutter=\"20\">\n            <el-col :span=\"8\">\n              <el-form-item label=\"签约日期\">\n                <el-date-picker v-model=\"newContract.signDate\" type=\"date\" placeholder=\"选择日期\" style=\"width: 100%\">\n                </el-date-picker>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"生效日期\">\n                <el-date-picker v-model=\"newContract.startDate\" type=\"date\" placeholder=\"选择日期\" style=\"width: 100%\">\n                </el-date-picker>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"8\">\n              <el-form-item label=\"到期日期\">\n                <el-date-picker v-model=\"newContract.expireDate\" type=\"date\" placeholder=\"选择日期\" style=\"width: 100%\">\n                </el-date-picker>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-form-item label=\"备注\">\n            <el-input v-model=\"newContract.remark\" type=\"textarea\" :rows=\"3\"></el-input>\n          </el-form-item>\n\n          <div v-if=\"creationMode === 'ai'\">\n             <el-divider>AI 生成选项</el-divider>\n             <el-form-item label=\"AI生成要求\">\n                <el-input v-model=\"aiRequirements\" type=\"textarea\" :rows=\"4\" placeholder=\"请详细描述您对合同的要求，例如：\n- 合同目的：为期一年的软件开发外包服务\n- 关键条款：明确开发范围、交付里程碑、付款条件、知识产权归属、保密协议等\n- 特殊要求：需要兼容GDPR数据保护法规\"></el-input>\n              </el-form-item>\n          </div>\n        </div>\n      </el-form>\n\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"showNewContractDialog = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"handleCreateContract\" :loading=\"isCreating\">\n            {{ creationMode === 'ai' ? '开始生成' : '立即创建' }}\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport {\n  ref,\n  reactive,\n  onMounted,\n  watch,\n  computed\n} from 'vue';\nimport {\n  useRouter\n} from 'vue-router';\nimport {\n  ElMessage,\n  ElMessageBox\n} from 'element-plus';\nimport {\n  Search,\n  Plus,\n  MoreFilled,\n  Edit,\n  Share,\n  Delete\n} from '@element-plus/icons-vue';\nimport {\n  getContractList,\n  createContract,\n  deleteContract,\n  getContractTemplates,\n  getContractCategories,\n  getIndustries,\n  getScenes,\n} from '@/api/contract'; // 假设API在一个文件中\n\nconst router = useRouter();\n\n// 搜索和排序\nconst searchQuery = ref('');\nconst sortBy = ref('default');\nconst sortOrder = ref('desc');\n\n// 合同列表\nconst contracts = ref([]);\nconst isLoading = ref(false);\nconst selectedContract = ref(null);\n\n// 分页\nconst currentPage = ref(1);\nconst totalItems = ref(0);\n\n// 创建合同对话框\nconst showNewContractDialog = ref(false);\nconst isCreating = ref(false);\nconst creationMode = ref('template'); // 'manual', 'template', 'ai'\n\n// 模拟从API获取数据\nconst contractTypes = ref([]);\nconst industries = ref([]);\nconst scenes = ref([]);\n\nconst fetchDropdownData = async () => {\n  try {\n    // 这些API函数需要您在 @/api/contract.js 中实现\n    contractTypes.value = await getContractCategories();\n    industries.value = await getIndustries();\n    scenes.value = await getScenes();\n  } catch (error) {\n    ElMessage.error('获取分类数据失败');\n    // 使用备用静态数据\n    contractTypes.value = [{\n      label: '劳动合同',\n      value: '劳动合同'\n    }, {\n      label: '服务合同',\n      value: '服务合同'\n    }];\n    industries.value = [{\n      label: '信息技术',\n      value: '信息技术'\n    }, {\n      label: '制造业',\n      value: '制造业'\n    }];\n     scenes.value = [{\n      label: '国内贸易',\n      value: '国内贸易'\n    }, {\n      label: '跨境交易',\n      value: '跨境交易'\n    }];\n  }\n};\n\n\n// 新建合同表单 (手动)\nconst newContract = reactive({\n  title: '',\n  type: '',\n  company: '',\n  amount: null,\n  signDate: '',\n  startDate: '',\n  expireDate: '',\n  remark: '',\n});\n\n// 模板创建表单\nconst templateForm = reactive({\n  title: '',\n  partyB: '',\n  amount: null,\n  notes: '',\n  contractType: '',\n  industry: '',\n  scene: '',\n});\nconst availableTemplates = ref([]);\nconst selectedTemplate = ref(null);\nconst isLoadingTemplates = ref(false);\n\n// AI 创建\nconst aiRequirements = ref('');\n\n// 计算属性\nconst filteredContracts = computed(() => {\n  // 搜索和排序逻辑\n  let result = contracts.value;\n\n  if (searchQuery.value) {\n    result = result.filter(c =>\n      c.title.includes(searchQuery.value) ||\n      c.number.includes(searchQuery.value)\n    );\n  }\n\n  if (sortBy.value !== 'default') {\n    result.sort((a, b) => {\n      let valA = a[sortBy.value];\n      let valB = b[sortBy.value];\n      if (typeof valA === 'string') {\n        return sortOrder.value === 'asc' ? valA.localeCompare(valB) : valB.localeCompare(valA);\n      }\n      return sortOrder.value === 'asc' ? valA - valB : valB - valA;\n    });\n  }\n\n  return result;\n});\n\n\n// 方法\nconst loadContracts = async () => {\n  isLoading.value = true;\n  try {\n    const response = await getContractList({\n      page: currentPage.value,\n      search: searchQuery.value,\n      ordering: (sortBy.value !== 'default' ? (sortOrder.value === 'desc' ? '-' : '') + sortBy.value : undefined)\n    });\n    contracts.value = response.results.map(c => ({\n      ...c,\n      displayAmount: `¥${parseFloat(c.amount).toLocaleString()}`,\n      createdAt: new Date(c.created_at).toLocaleDateString(),\n    }));\n    totalItems.value = response.count;\n  } catch (error) {\n    ElMessage.error('获取合同列表失败');\n  } finally {\n    isLoading.value = false;\n  }\n};\n\nconst handleFilterChange = () => {\n  currentPage.value = 1;\n  loadContracts();\n}\n\nconst handleCurrentChange = (page) => {\n  currentPage.value = page;\n  loadContracts();\n};\n\n\nconst openContractDialog = () => {\n  // 重置所有表单\n  Object.assign(newContract, {\n    title: '',\n    type: '',\n    company: '',\n    amount: null,\n    signDate: '',\n    startDate: '',\n    expireDate: '',\n    remark: ''\n  });\n  Object.assign(templateForm, {\n    title: '',\n    partyB: '',\n    amount: null,\n    notes: '',\n    contractType: '',\n    industry: '',\n    scene: ''\n  });\n  selectedTemplate.value = null;\n  aiRequirements.value = '';\n  creationMode.value = 'template';\n  showNewContractDialog.value = true;\n};\n\nconst handleTemplateSelect = (templateId) => {\n  const template = availableTemplates.value.find(t => t.id === templateId);\n  if (template) {\n    selectedTemplate.value = template.id;\n    const today = new Date().toLocaleDateString('zh-CN', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n    templateForm.title = `${template.name}_${today}`;\n  }\n};\n\nconst handleCreateContract = async () => {\n  isCreating.value = true;\n  let contractData = {};\n\n  if (creationMode.value === 'template') {\n    if (!selectedTemplate.value) {\n      ElMessage.warning('请选择一个合同模板');\n      isCreating.value = false;\n      return;\n    }\n    contractData = {\n      title: templateForm.title,\n      party_b: templateForm.partyB,\n      amount: templateForm.amount,\n      notes: templateForm.notes,\n      template_id: selectedTemplate.value,\n      creation_mode: 'template',\n    };\n  } else if (creationMode.value === 'manual') {\n    contractData = {\n      title: newContract.title,\n      contract_type: newContract.type,\n      party_b: newContract.company,\n      amount: newContract.amount,\n      signing_date: newContract.signDate,\n      effective_date: newContract.startDate,\n      expiry_date: newContract.expireDate,\n      notes: newContract.remark,\n      creation_mode: 'manual',\n    };\n  } else { // AI\n    contractData = {\n      requirements: aiRequirements.value,\n      creation_mode: 'ai',\n      title: 'AI生成合同',\n    };\n  }\n\n\n  try {\n    const response = await createContract(contractData);\n    ElMessage.success('合同创建成功');\n    showNewContractDialog.value = false;\n    // 跳转到详情页\n    router.push({\n      name: 'ContractDetail',\n      params: {\n        id: response.id\n      }\n    });\n    loadContracts();\n  } catch (error) {\n    ElMessage.error('创建失败: ' + (error.message || '请检查输入'));\n  } finally {\n    isCreating.value = false;\n  }\n};\n\n\nconst viewContractDetail = (contract) => {\n  selectedContract.value = contract;\n  router.push({\n    name: 'ContractDetail',\n    params: {\n      id: contract.id\n    }\n  });\n};\n\nconst handleEdit = (contract) => {\n  console.log('编辑', contract.id);\n  // 实现编辑逻辑\n};\n\nconst handleShare = (contract) => {\n  console.log('分享', contract.id);\n  // 实现分享逻辑\n};\n\nconst handleDelete = async (contract) => {\n  try {\n    await ElMessageBox.confirm(\n      `确定要删除合同 \"${contract.title}\" 吗？此操作不可逆。`,\n      '警告', {\n        confirmButtonText: '确定删除',\n        cancelButtonText: '取消',\n        type: 'warning',\n      }\n    );\n    await deleteContract(contract.id);\n    ElMessage.success('合同删除成功');\n    loadContracts();\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('删除失败');\n    }\n  }\n};\n\n\n// 监听模板筛选条件变化\nwatch([() => templateForm.contractType, () => templateForm.industry, () => templateForm.scene],\n  async ([type, industry, scene]) => {\n    isLoadingTemplates.value = true;\n    try {\n      const response = await getContractTemplates({\n        contract_type: type,\n        industry: industry,\n        scene: scene\n      });\n      availableTemplates.value = response.results;\n    } catch (error) {\n      ElMessage.error('获取模板列表失败');\n    } finally {\n      isLoadingTemplates.value = false;\n    }\n  }, {\n    deep: true\n  }\n);\n\n\nonMounted(() => {\n  loadContracts();\n  fetchDropdownData();\n});\n</script>\n\n<style scoped>\n.contract-container {\n  padding: 20px;\n}\n\n.card-header-flex {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.contract-list-card {\n  min-height: 500px;\n}\n\n.contract-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.contract-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 15px;\n  border: 1px solid #e4e7ed;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n}\n\n.contract-item:hover {\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  transform: translateY(-2px);\n}\n\n.contract-item.active {\n  border-color: #409eff;\n  background-color: #ecf5ff;\n}\n\n.contract-main-info {\n  flex-grow: 1;\n}\n\n.contract-title {\n  font-weight: 600;\n  font-size: 16px;\n  color: #303133;\n  margin-bottom: 8px;\n}\n\n.contract-info {\n  font-size: 13px;\n  color: #606266;\n  display: flex;\n  gap: 20px;\n}\n\n.contract-info span {\n  min-width: 150px;\n}\n\n.contract-actions {\n  flex-shrink: 0;\n  margin-left: 20px;\n}\n\n.more-button {\n  border: none;\n}\n\n.pagination-container {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 20px;\n}\n\n.dialog-footer {\n  text-align: right;\n}\n</style> "]}]}