{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\ContractTemplateEdit.vue?vue&type=style&index=0&id=2d046381&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\ContractTemplateEdit.vue","mtime":1751638891534},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jb250cmFjdC10ZW1wbGF0ZS1lZGl0IHsKICBwYWRkaW5nOiAycmVtOwogIGJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7Cn0KCi5wYWdlLXRpdGxlIHsKICBmb250LXdlaWdodDogMzAwOwogIGNvbG9yOiAjMzQzYTQwOwogIG1hcmdpbi1ib3R0b206IDEuNXJlbTsKfQoKLmNhcmQgewogIGJvcmRlcjogbm9uZTsKICBib3gtc2hhZG93OiAwIDAuMTI1cmVtIDAuMjVyZW0gcmdiYSgwLDAsMCwuMDc1KTsKfQoKLmFjdGlvbnMtZm9vdGVyIHsKICBwYWRkaW5nLXRvcDogMXJlbTsKICBib3JkZXItdG9wOiAxcHggc29saWQgI2RlZTJlNjsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7Cn0KCi50ZXh0LWRhbmdlciB7CiAgY29sb3I6ICNkYzM1NDUgIWltcG9ydGFudDsKfQoKLyogUXVpbGznvJbovpHlmajpqozor4HmoLflvI8gKi8KLnFsLWNvbnRhaW5lci5xbC1lcnJvciB7CiAgYm9yZGVyLWNvbG9yOiAjZGMzNTQ1Owp9CgouaW52YWxpZC1mZWVkYmFjayB7CiAgZGlzcGxheTogbm9uZTsKICB3aWR0aDogMTAwJTsKICBtYXJnaW4tdG9wOiAwLjI1cmVtOwogIGZvbnQtc2l6ZTogODAlOwogIGNvbG9yOiAjZGMzNTQ1Owp9Cg=="},{"version":3,"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\ContractTemplateEdit.vue"],"names":[],"mappings":"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","file":"C:/Users/18083/Desktop/CCIT/office/smart-office/frontend/src/views/admin/ContractTemplateEdit.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"contract-template-edit\">\n    <h1 class=\"page-title\">{{ isEditing ? '编辑' : '新建' }}合同模板</h1>\n\n    <div class=\"card\">\n      <div class=\"card-body\">\n        <form @submit.prevent=\"saveTemplate\">\n          <div class=\"mb-3\">\n            <label for=\"templateName\" class=\"form-label\">模板名称 <span class=\"text-danger\">*</span></label>\n            <input type=\"text\" v-model=\"template.name\" class=\"form-control\" id=\"templateName\" required>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col-md-6 mb-3\">\n              <label for=\"contractType\" class=\"form-label\">合同类型 <span class=\"text-danger\">*</span></label>\n              <input type=\"text\" v-model=\"template.contract_type\" class=\"form-control\" id=\"contractType\" required>\n            </div>\n            <div class=\"col-md-6 mb-3\">\n              <label for=\"industry\" class=\"form-label\">行业领域 <span class=\"text-danger\">*</span></label>\n              <input type=\"text\" v-model=\"template.industry\" class=\"form-control\" id=\"industry\" required>\n            </div>\n          </div>\n\n          <div class=\"mb-3\">\n            <label for=\"scene\" class=\"form-label\">交易场景 <span class=\"text-danger\">*</span></label>\n            <input type=\"text\" v-model=\"template.scene\" class=\"form-control\" id=\"scene\" required>\n          </div>\n\n          <div class=\"mb-3\">\n            <label for=\"description\" class=\"form-label\">模板描述 <span class=\"text-danger\">*</span></label>\n            <textarea v-model=\"template.description\" class=\"form-control\" id=\"description\" rows=\"3\" required></textarea>\n          </div>\n\n          <div class=\"mb-4\">\n            <label class=\"form-label\">模板内容 <span class=\"text-danger\">*</span></label>\n            <div ref=\"quillEditor\" style=\"height: 400px;\"></div>\n            <div class=\"invalid-feedback\" :style=\"{display: contentError ? 'block' : 'none'}\">\n              请输入模板内容\n            </div>\n          </div>\n\n          <div class=\"mb-3 form-check\">\n            <input type=\"checkbox\" v-model=\"template.is_active\" class=\"form-check-input\" id=\"isActive\">\n            <label class=\"form-check-label\" for=\"isActive\">启用该模板</label>\n          </div>\n\n          <div class=\"actions-footer\">\n            <button type=\"button\" @click=\"cancel\" class=\"btn btn-secondary me-3\">\n              取消\n            </button>\n            <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"saving\">\n              <span v-if=\"saving\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n              {{ saving ? '保存中...' : '保存模板' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- 保存成功弹窗 -->\n    <div class=\"modal fade\" id=\"saveSuccessModal\" tabindex=\"-1\" aria-hidden=\"true\">\n      <div class=\"modal-dialog modal-dialog-centered\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header bg-success text-white\">\n            <h5 class=\"modal-title\">\n              <i class=\"bi bi-check-circle me-2\"></i>操作成功\n            </h5>\n            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n          </div>\n          <div class=\"modal-body text-center py-4\">\n            <h4>模板保存成功！</h4>\n            <p class=\"mb-0\">合同模板已成功{{ isEditing ? '更新' : '创建' }}。</p>\n          </div>\n          <div class=\"modal-footer justify-content-center\">\n            <button type=\"button\" class=\"btn btn-success px-4\" @click=\"goToList\">\n              返回列表\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport api from '@/api/admin';\nimport Quill from 'quill';\nimport 'quill/dist/quill.snow.css';\nimport { Modal } from 'bootstrap';\n\nexport default {\n  name: 'ContractTemplateEdit',\n  data() {\n    return {\n      template: {\n        name: '',\n        contract_type: '',\n        industry: '',\n        scene: '',\n        description: '',\n        content: '',\n        is_active: true,\n      },\n      quill: null,\n      isEditing: false,\n      saving: false,\n      contentError: false,\n      saveSuccessModal: null,\n    };\n  },\n  async created() {\n    const templateId = this.$route.params.id;\n    if (templateId) {\n      this.isEditing = true;\n      await this.fetchTemplateData(templateId);\n    }\n  },\n  mounted() {\n    this.initializeQuill();\n    this.saveSuccessModal = new Modal(document.getElementById('saveSuccessModal'));\n  },\n  methods: {\n    initializeQuill() {\n      if (this.$refs.quillEditor) {\n        this.quill = new Quill(this.$refs.quillEditor, {\n          theme: 'snow',\n          modules: {\n            toolbar: [\n              [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n              ['bold', 'italic', 'underline', 'strike'],\n              [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n              [{ 'script': 'sub'}, { 'script': 'super' }],\n              [{ 'indent': '-1'}, { 'indent': '+1' }],\n              [{ 'direction': 'rtl' }],\n              [{ 'size': ['small', false, 'large', 'huge'] }],\n              [{ 'color': [] }, { 'background': [] }],\n              [{ 'font': [] }],\n              [{ 'align': [] }],\n              ['clean'],\n              ['link', 'image']\n            ],\n          },\n        });\n        this.quill.root.innerHTML = this.template.content;\n        this.quill.on('text-change', () => {\n          this.template.content = this.quill.root.innerHTML;\n          this.contentError = false;\n        });\n      }\n    },\n    async fetchTemplateData(id) {\n      try {\n        const response = await api.getContractTemplate(id);\n        this.template = response.data;\n        if (this.quill) {\n          this.quill.root.innerHTML = this.template.content;\n        }\n      } catch (error) {\n        console.error('获取模板数据失败:', error);\n        this.showErrorModal('加载模板失败，请稍后重试。');\n        this.$router.push({ name: 'AdminContractTemplateManagement' });\n      }\n    },\n    async saveTemplate() {\n      // 验证Quill编辑器内容\n      if (!this.template.content || this.template.content.replace(/<[^>]*>?/gm, '').trim() === '') {\n        this.contentError = true;\n        return;\n      }\n\n      this.saving = true;\n      try {\n        if (this.isEditing) {\n          await api.updateContractTemplate(this.template.id, this.template);\n        } else {\n          await api.createContractTemplate(this.template);\n        }\n        this.saveSuccessModal.show();\n      } catch (error) {\n        console.error('保存模板失败:', error);\n        this.showErrorModal('保存模板失败，请检查输入内容并重试。');\n      } finally {\n        this.saving = false;\n      }\n    },\n    cancel() {\n      this.$router.push({ name: 'AdminContractTemplateManagement' });\n    },\n    goToList() {\n      this.saveSuccessModal.hide();\n      this.$router.push({ name: 'AdminContractTemplateManagement' });\n    },\n    showErrorModal(message) {\n      // 创建临时的错误模态框元素\n      const modalDiv = document.createElement('div');\n      modalDiv.innerHTML = `\n        <div class=\"modal fade\" id=\"tempErrorModal\" tabindex=\"-1\" aria-hidden=\"true\">\n          <div class=\"modal-dialog modal-dialog-centered\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header bg-danger text-white\">\n                <h5 class=\"modal-title\"><i class=\"bi bi-exclamation-triangle me-2\"></i>操作失败</h5>\n                <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n              </div>\n              <div class=\"modal-body text-center py-4\">\n                <p class=\"mb-0\">${message}</p>\n              </div>\n              <div class=\"modal-footer justify-content-center\">\n                <button type=\"button\" class=\"btn btn-secondary px-4\" data-bs-dismiss=\"modal\">确定</button>\n              </div>\n            </div>\n          </div>\n        </div>`;\n      document.body.appendChild(modalDiv);\n      \n      const errorModal = new Modal(document.getElementById('tempErrorModal'));\n      errorModal.show();\n      \n      // 模态框关闭后移除元素\n      document.getElementById('tempErrorModal').addEventListener('hidden.bs.modal', function () {\n        document.body.removeChild(modalDiv);\n      });\n    }\n  },\n};\n</script>\n\n<style scoped>\n.contract-template-edit {\n  padding: 2rem;\n  background-color: #f8f9fa;\n}\n\n.page-title {\n  font-weight: 300;\n  color: #343a40;\n  margin-bottom: 1.5rem;\n}\n\n.card {\n  border: none;\n  box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,.075);\n}\n\n.actions-footer {\n  padding-top: 1rem;\n  border-top: 1px solid #dee2e6;\n  display: flex;\n  justify-content: flex-end;\n}\n\n.text-danger {\n  color: #dc3545 !important;\n}\n\n/* Quill编辑器验证样式 */\n.ql-container.ql-error {\n  border-color: #dc3545;\n}\n\n.invalid-feedback {\n  display: none;\n  width: 100%;\n  margin-top: 0.25rem;\n  font-size: 80%;\n  color: #dc3545;\n}\n</style> "]}]}