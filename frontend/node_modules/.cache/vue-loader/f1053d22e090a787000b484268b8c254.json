{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue?vue&type=style&index=4&id=f042b266&lang=scss&scoped=true","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue","mtime":1752411443572},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1747194135644},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5vcGVud2VidWktb3B0aW9ucy1hcmVhIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIHBhZGRpbmctdG9wOiA4cHg7Cn0K"},{"version":3,"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\o\\smart-office\\frontend\\src\\views\\dashboard\\Index.vue"],"names":[],"mappings":";AAigFA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACtB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClB","file":"C:/Users/18083/Desktop/CCIT/office/o/smart-office/frontend/src/views/dashboard/Index.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"openwebui-chat-root\">\n    <div class=\"openwebui-chat-window\">\n      <div class=\"openwebui-chat-header\">\n        <span class=\"openwebui-title\">æ™ºæ…§AIåŠå…¬åŠ©æ‰‹</span>\n        <el-button type=\"link\" size=\"small\" @click=\"clearChat\" class=\"clear-chat-btn\">\n          <el-icon><Delete /></el-icon> æ–°å¯¹è¯\n        </el-button>\n      </div>\n      \n      <div class=\"openwebui-chat-container\">\n        <div class=\"openwebui-chat-body\" ref=\"chatBody\">\n          <div v-for=\"(msg, idx) in messages\" :key=\"idx\" :class=\"['openwebui-msg', msg.role]\">\n            <template v-if=\"msg.role==='assistant'\">\n              <div class=\"openwebui-avatar ai-avatar left-avatar\">\n                <svg viewBox=\"0 0 40 40\" width=\"36\" height=\"36\"><circle cx=\"20\" cy=\"20\" r=\"20\" fill=\"#2f54eb\"/><text x=\"50%\" y=\"55%\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"20\" font-family=\"Arial\" dy=\".3em\">ğŸ¤–</text></svg>\n              </div>\n            </template>\n            <template v-if=\"msg.role==='user'\">\n              <div class=\"openwebui-avatar user-avatar right-avatar\">\n                <img v-if=\"userAvatarUrl\" :src=\"userAvatarUrl\" class=\"user-avatar-img\" alt=\"ç”¨æˆ·å¤´åƒ\" @error=\"handleAvatarError\" />\n                <svg v-else viewBox=\"0 0 40 40\" width=\"36\" height=\"36\"><circle cx=\"20\" cy=\"20\" r=\"20\" fill=\"#bbb\"/><text x=\"50%\" y=\"55%\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"20\" font-family=\"Arial\" dy=\".3em\">ğŸ§‘</text></svg>\n              </div>\n            </template>\n            <div class=\"openwebui-msg-bubble\">\n              <template v-if=\"msg.type === 'text'\">\n                <span v-if=\"msg.role==='user'\">{{ msg.content }}</span>\n                <span v-else v-html=\"msg.content\"></span>\n                <span v-if=\"msg.streaming\" class=\"openwebui-cursor\"></span>\n                <div v-if=\"msg.source === 'knowledge_base' && msg.role === 'assistant'\" class=\"source-tag knowledge-base-tag\">\n                  <el-icon><DataAnalysis /></el-icon> çŸ¥è¯†åº“\n                </div>\n                <div v-if=\"msg.source === 'general_ai' && msg.role === 'assistant'\" class=\"source-tag general-ai-tag\">\n                  <el-icon><Cpu /></el-icon> AIå¤§æ¨¡å‹\n                </div>\n              </template>\n              <!-- å¡ç‰‡ç±»å‹æ¶ˆæ¯æ¸²æŸ“ï¼ˆå·²ä¿®æ”¹ï¼‰ -->\n              <template v-else-if=\"msg.type === 'card'\">\n                <div class=\"openwebui-card-message\" :class=\"getCardClass(msg.status)\" :data-event-id=\"msg.event_id\">\n                  <div class=\"card-icon-wrapper\">\n                    <el-icon><component :is=\"getCardIcon(msg.status)\" /></el-icon>\n                  </div>\n                  <div class=\"card-content-wrapper\">\n                    <div class=\"card-title\">{{ getCardTitle(msg.status) }}</div>\n                    <div class=\"card-body\" v-html=\"msg.content\"></div>\n                    <!-- æ–°å¢ï¼šå¡ç‰‡æ“ä½œæŒ‰é’® -->\n                    <div v-if=\"msg.status === 'success' && msg.event_id\" class=\"card-actions\">\n                        <el-button size=\"small\" @click=\"editEvent(msg)\" round>\n                          <el-icon><EditPen /></el-icon> ç¼–è¾‘\n                        </el-button>\n                        <el-button type=\"danger\" size=\"small\" @click=\"deleteEventFromCard(msg.event_id)\" round>\n                          <el-icon><Delete /></el-icon> åˆ é™¤\n                        </el-button>\n                    </div>\n                  </div>\n                </div>\n              </template>\n              <template v-else-if=\"msg.type === 'file'\">\n                <div class=\"file-bubble-nest file-bubble-vertical\">\n                  <div v-for=\"file in msg.files\" :key=\"file.name + file.size\" class=\"file-message-card\">\n                    <div class=\"file-icon-area\">\n                      <img v-if=\"file.ext==='csv'\" src=\"https://cdn.jsdelivr.net/gh/file-icons/icons/svg/csv.svg\" class=\"file-icon-img\" />\n                      <el-icon v-else><Document /></el-icon>\n                    </div>\n                    <div class=\"file-info-area\">\n                      <div class=\"file-name\">{{ file.name }}</div>\n                      <div class=\"file-meta\">{{ file.ext.toUpperCase() }} Â· {{ file.size }}</div>\n                    </div>\n                  </div>\n                  <div class=\"file-desc-text\" v-if=\"msg.content\">{{ msg.content }}</div>\n                </div>\n              </template>\n            </div>\n          </div>\n        </div>\n        \n        <!-- å³ä¾§é¢æ¿ - åŒ…å«æ¨¡å¼åˆ‡æ¢å’Œå†å²è®°å½• -->\n        <div class=\"openwebui-right-panel\" :class=\"{'collapsed': rightPanelCollapsed}\">\n          <div class=\"right-panel-header\">\n            <!-- æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->\n            <div class=\"right-panel-mode-controls\">\n              <el-radio-group v-model=\"chatMode\" size=\"default\">\n                <el-radio-button label=\"agent\">\n                  <el-icon><MagicStick /></el-icon> AIåŠ©æ‰‹\n                </el-radio-button>\n                <el-radio-button label=\"knowledge_base\">\n                  <el-icon><DataAnalysis /></el-icon> çŸ¥è¯†åº“\n                </el-radio-button>\n              </el-radio-group>\n            </div>\n            \n            <!-- å±•å¼€/æ”¶èµ·æŒ‰é’® -->\n            <el-button \n              circle\n              @click=\"rightPanelCollapsed = !rightPanelCollapsed\"\n              :title=\"rightPanelCollapsed ? 'å±•å¼€' : 'æ”¶èµ·'\"\n              class=\"collapse-button\"\n            >\n              <el-icon :size=\"16\">\n                <Expand v-if=\"!rightPanelCollapsed\" />\n                <Fold v-else />\n              </el-icon>\n            </el-button>\n          </div>\n          \n          <!-- å†å²è®°å½•å†…å®¹ -->\n          <div class=\"history-container\">\n            <div class=\"history-header\">\n              <h3 class=\"history-title\">å†å²è®°å½•</h3>\n              <el-button \n                v-if=\"chatSessions.length > 0\"\n                text\n                size=\"small\" \n                class=\"clear-all-btn\"\n                @click=\"confirmClearAllHistory\"\n              >\n                æ¸…ç©º\n              </el-button>\n            </div>\n            \n            <div class=\"history-list\">\n              <div \n                v-for=\"(session, index) in chatSessions\" \n                :key=\"session.id\"\n                class=\"history-item\"\n                :class=\"{'active': session.id === chatId}\"\n              >\n                <div class=\"history-item-content\" @click=\"switchChatSession(session.id)\">\n                  <div class=\"history-item-icon\">\n                    <el-icon><ChatLineSquare /></el-icon>\n                  </div>\n                  <div class=\"history-item-info\">\n                    <div class=\"history-item-title\">{{ session.title || `å¯¹è¯ ${index + 1}` }}</div>\n                    <div class=\"history-item-time\">{{ formatTime(session.created_at) }}</div>\n                  </div>\n                </div>\n                <div class=\"history-item-actions\">\n                  <div class=\"delete-btn-wrapper\" @click.stop=\"deleteSession(session.id)\">\n                    <el-icon class=\"delete-icon\"><Delete /></el-icon>\n                  </div>\n                </div>\n              </div>\n              <div v-if=\"chatSessions.length === 0\" class=\"history-empty\">\n                æš‚æ— å†å²è®°å½•\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"openwebui-chat-footer\">\n        <!-- é¢„è§ˆåŒºæ”¾åœ¨footeré¡¶éƒ¨ -->\n        <div v-if=\"selectedFiles.length\" class=\"openwebui-file-preview-bar\">\n          <div v-for=\"(file, idx) in selectedFiles\" :key=\"file.id\" class=\"openwebui-file-card\">\n            <div class=\"openwebui-file-thumb\">\n              <img v-if=\"file.type.startsWith('image/')\" :src=\"file.url\" class=\"openwebui-file-img\" />\n              <div v-else class=\"openwebui-file-icon\" :style=\"{background: file.bg}\">\n                <el-icon v-if=\"file.ext==='pdf'\"><Document /></el-icon>\n                <el-icon v-else-if=\"file.ext==='csv' || file.ext==='xls' || file.ext==='xlsx'\"><Document /></el-icon>\n                <el-icon v-else><Document /></el-icon>\n              </div>\n            </div>\n            <div class=\"openwebui-file-info\">\n              <div class=\"openwebui-file-name\" :title=\"file.name\">{{ file.name }}</div>\n              <div class=\"openwebui-file-meta\">{{ file.label }} Â· {{ file.size }}</div>\n              <!-- æ·»åŠ è¿›åº¦æ¡æ˜¾ç¤º -->\n              <el-progress \n                v-if=\"file.status !== 'completed'\" \n                :percentage=\"file.progress\" \n                :status=\"file.status === 'failed' ? 'exception' : ''\" \n                :stroke-width=\"4\"\n                class=\"openwebui-file-progress\" />\n              <div v-else class=\"openwebui-file-status completed\">\n                <el-icon><Check /></el-icon> å¤„ç†å®Œæˆ\n              </div>\n            </div>\n            <el-icon class=\"openwebui-file-remove\" @click=\"removeFile(idx)\"><Close /></el-icon>\n          </div>\n        </div>\n        <!-- è¾“å…¥åŒº -->\n        <div class=\"openwebui-input-area\">\n          <input type=\"file\" ref=\"fileInput\" style=\"display:none\" @change=\"handleFileUpload\" multiple \n               accept=\".txt,.pdf,.doc,.docx,.md,.xls,.xlsx,.csv,.jpg,.jpeg,.png,.gif,.bmp,.webp,.svg,.tiff\" />\n          <el-tooltip\n            content=\"æ–‡æ¡£: txt, pdf, doc, docx, md&#10;è¡¨æ ¼: xls, xlsx, csv&#10;å›¾ç‰‡: jpg, jpeg, png, gif, bmp, webp, svg, tiff\"\n            placement=\"top\"\n            popper-class=\"openwebui-upload-tooltip\"\n            :open-delay=\"200\"\n            v-if=\"chatMode === 'agent'\"\n          >\n            <el-button class=\"openwebui-upload-btn\" @click=\"triggerFileInput\" title=\"ä¸Šä¼ æ–‡ä»¶/å›¾ç‰‡\" :disabled=\"loading\">\n              <el-icon><UploadFilled /></el-icon>\n            </el-button>\n          </el-tooltip>\n          <el-input\n            v-model=\"input\"\n            placeholder=\"è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...\"\n            @keyup.enter=\"sendMsg\"\n            class=\"openwebui-input\"\n            :disabled=\"loading || processingFiles\"\n          />\n          <el-button type=\"primary\" @click=\"sendMsg\" class=\"openwebui-send-btn\" :loading=\"loading\" :disabled=\"processingFiles\">\n            {{ loading ? 'ç”Ÿæˆä¸­' : (processingFiles ? 'å¤„ç†ä¸­' : 'å‘é€') }}\n          </el-button>\n        </div>\n        <div class=\"openwebui-options-area\" v-if=\"chatMode === 'knowledge_base'\">\n            <el-radio-group v-model=\"searchMethod\" size=\"small\">\n              <el-radio-button label=\"basic\">åŸºç¡€æ£€ç´¢</el-radio-button>\n              <el-radio-button label=\"local\">å¤æ‚æ£€ç´¢</el-radio-button>\n            </el-radio-group>\n        </div>\n        <div class=\"openwebui-footer-hint\" v-if=\"chatMode === 'agent'\">\n          æ”¯æŒæ–‡æ¡£ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰å¤šç§æ ¼å¼æ–‡ä»¶\n        </div>\n      </div>\n    </div>\n\n    <!-- æ–°å¢ï¼šç¼–è¾‘æ—¥ç¨‹å¯¹è¯æ¡† -->\n    <el-dialog\n      v-model=\"editEventDialogVisible\"\n      title=\"ç¼–è¾‘æ—¥ç¨‹\"\n      width=\"500px\"\n      class=\"calendar-dialog\"\n      :append-to-body=\"true\"\n      :destroy-on-close=\"true\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-form :model=\"editingEvent\" label-width=\"80px\" v-if=\"editingEvent\">\n        <el-form-item label=\"æ ‡é¢˜\">\n          <el-input v-model=\"editingEvent.title\" placeholder=\"è¯·è¾“å…¥æ—¥ç¨‹æ ‡é¢˜\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"å¼€å§‹æ—¶é—´\">\n          <el-date-picker\n            v-model=\"editingEvent.start\"\n            type=\"datetime\"\n            placeholder=\"é€‰æ‹©å¼€å§‹æ—¶é—´\"\n            format=\"YYYY-MM-DD HH:mm\"\n            value-format=\"YYYY-MM-DD HH:mm\"\n          ></el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"ç»“æŸæ—¶é—´\">\n          <el-date-picker\n            v-model=\"editingEvent.end\"\n            type=\"datetime\"\n            placeholder=\"é€‰æ‹©ç»“æŸæ—¶é—´\"\n            format=\"YYYY-MM-DD HH:mm\"\n            value-format=\"YYYY-MM-DD HH:mm\"\n          ></el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"åœ°ç‚¹\">\n          <el-input v-model=\"editingEvent.location\" placeholder=\"è¯·è¾“å…¥åœ°ç‚¹\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"ç±»å‹\">\n          <el-select v-model=\"editingEvent.type\" placeholder=\"è¯·é€‰æ‹©æ—¥ç¨‹ç±»å‹\">\n            <el-option label=\"ä¼šè®®\" value=\"blue\"></el-option>\n            <el-option label=\"å‡ºå·®\" value=\"orange\"></el-option>\n            <el-option label=\"å‡æœŸ\" value=\"green\"></el-option>\n            <el-option label=\"æˆªæ­¢æ—¥æœŸ\" value=\"red\"></el-option>\n            <el-option label=\"å…¶ä»–\" value=\"purple\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"æé†’\">\n          <el-select v-model=\"editingEvent.reminder\" placeholder=\"è¯·é€‰æ‹©æé†’æ—¶é—´\">\n            <el-option label=\"ä¸æé†’\" value=\"none\"></el-option>\n            <el-option label=\"10åˆ†é’Ÿå‰\" value=\"10min\"></el-option>\n            <el-option label=\"30åˆ†é’Ÿå‰\" value=\"30min\"></el-option>\n            <el-option label=\"1å°æ—¶å‰\" value=\"1hour\"></el-option>\n            <el-option label=\"1å¤©å‰\" value=\"1day\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"å¤‡æ³¨\">\n          <el-input \n            v-model=\"editingEvent.description\" \n            type=\"textarea\" \n            :rows=\"3\"\n            placeholder=\"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <div class=\"dialog-footer\">\n          <el-button @click=\"editEventDialogVisible = false\">å–æ¶ˆ</el-button>\n          <el-button type=\"primary\" @click=\"saveEditEvent\">ç¡®å®š</el-button>\n        </div>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, nextTick, computed, onMounted, watch } from 'vue'\nimport { UploadFilled, Document, Close, Check, Delete, DataAnalysis, Cpu, MagicStick, ChatLineSquare, Fold, Expand, \n  Calendar, ChatDotRound, Collection, DocumentCopy, Grid, Connection, CircleCheckFilled, InfoFilled, CircleCloseFilled, WarningFilled, EditPen } from '@element-plus/icons-vue'\nimport request from '@/utils/request'\nimport { marked } from 'marked'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { aiChatWithDocumentsStream, getAIChatSessions, getAIChatSession, deleteAIChatSession } from '@/api/ai'\nimport { deleteCalendarEvent } from '@/api/calendar' // æ–°å¢å¯¼å…¥\nimport { getCurrentInstance } from 'vue';\nimport { getCalendarEvent, updateEvent } from '@/api/calendar' // æ–°å¢å¯¼å…¥\n\nfunction formatSize(size) {\n  if (size < 1024) return size + 'B';\n  if (size < 1024*1024) return (size/1024).toFixed(1) + 'KB';\n  return (size/1024/1024).toFixed(1) + 'MB';\n}\nfunction getExt(name) {\n  const arr = name.split('.');\n  return arr.length > 1 ? arr[arr.length-1].toLowerCase() : '';\n}\nfunction getFileLabel(type, ext) {\n  const ext_lower = ext.toLowerCase();\n  if (type.startsWith('image/')) return 'å›¾ç‰‡';\n  if (ext_lower === 'pdf') return 'PDF';\n  if (['csv','xls','xlsx'].includes(ext_lower)) return 'è¡¨æ ¼';\n  if (['doc','docx'].includes(ext_lower)) return 'æ–‡æ¡£';\n  if (ext_lower === 'md') return 'Markdown';\n  if (ext_lower === 'txt') return 'æ–‡æœ¬';\n  return ext_lower.toUpperCase();\n}\nfunction getFileBg(ext) {\n  const ext_lower = ext.toLowerCase();\n  if (ext_lower === 'pdf') return '#f87171'; // çº¢è‰²\n  if (['csv','xls','xlsx'].includes(ext_lower)) return '#34d399'; // ç»¿è‰²\n  if (['doc','docx'].includes(ext_lower)) return '#60a5fa'; // è“è‰²\n  if (ext_lower === 'md') return '#a78bfa'; // ç´«è‰²\n  if (ext_lower === 'txt') return '#fbbf24'; // é»„è‰²\n  return '#a5b4fc'; // é»˜è®¤æ·¡ç´«è‰²\n}\nfunction escapeHtml(html) {\n  return html.replace(/[&<>\"']/g, function(m) {\n    return ({\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#39;'\n    })[m];\n  });\n}\n\n// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´\nfunction formatTime(dateTimeStr) {\n  if (!dateTimeStr) return '';\n  const date = new Date(dateTimeStr);\n  return `${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥ ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;\n}\n\n// ISOæ—¥æœŸæ ¼å¼åŒ–ä¸ºå¯è¯»æ ¼å¼\nfunction formatISODate(isoDateStr) {\n  if (!isoDateStr) return '';\n  try {\n    const date = new Date(isoDateStr);\n    return date.toLocaleString('zh-CN', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  } catch (error) {\n    console.error('æ—¥æœŸæ ¼å¼åŒ–é”™è¯¯:', error);\n    return isoDateStr; // è¿”å›åŸå§‹å€¼\n  }\n}\n\nexport default {\n  name: 'Dashboard',\n  components: {\n    UploadFilled, Document, Close, Check, Delete, DataAnalysis, Cpu, MagicStick, ChatLineSquare, Fold, Expand,\n    Calendar, ChatDotRound, Collection, DocumentCopy, Grid, Connection, CircleCheckFilled, InfoFilled, CircleCloseFilled, WarningFilled, EditPen\n  },\n  setup() {\n    const { proxy } = getCurrentInstance();\n    const userAvatarUrl = ref(proxy.$store.state.user.avatar)\n    const handleAvatarError = () => {\n      userAvatarUrl.value = ''; // åŠ è½½å¤±è´¥æ—¶æ¸…ç©ºï¼Œä¼šæ˜¾ç¤ºé»˜è®¤SVG\n    };\n    \n    const input = ref('')\n    const messages = ref([\n      { \n        role: 'assistant', \n        content: `<div class=\"welcome-message\">\n          <h3>æ¬¢è¿æ¥åˆ°æ™ºè¡ŒèˆŸå¹³å°</h3>\n          <div class=\"platform-intro\">\n            <p>æ™ºè¡ŒèˆŸå¹³å°æ˜¯æ‚¨çš„æ™ºèƒ½åä½œä¸­å¿ƒï¼Œèåˆäº†é¡¹ç›®ç®¡ç†ã€å³æ—¶é€šè®¯ã€æ™ºèƒ½æ–‡æ¡£å’ŒAIåŠ©æ‰‹ç­‰ã€‚æˆ‘ä»¬è‡´åŠ›äºé€šè¿‡å‰æ²¿AIæŠ€æœ¯èµ‹èƒ½æ‚¨çš„å›¢é˜Ÿï¼Œä¼˜åŒ–ä¸šåŠ¡æµç¨‹ï¼Œä¸ºæ‚¨æ‰“é€ æ— ç¼è¿æ¥çš„æœªæ¥åŠå…¬æ–°èŒƒå¼ï¼Œæ ¸å¿ƒä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>\n            \n            <ul class=\"platform-features\">\n              <li><span class=\"feature-highlight\">AIæ™ºèƒ½å¼•æ“</span> - æˆ‘ä»¬çš„AIåŠ©æ‰‹èƒ½å¤Ÿç†è§£è‡ªç„¶è¯­è¨€ï¼Œå¤„ç†å¤æ‚æ–‡æ¡£ï¼Œåˆ›å»ºæ—¥ç¨‹ï¼Œæˆä¸ºæ‚¨24å°æ—¶çš„æ™ºèƒ½å·¥ä½œä¼™ä¼´ã€‚</li>\n              <li><span class=\"feature-highlight\">ä¸€ä½“åŒ–åä½œ</span> - æ— ç¼æ•´åˆé¡¹ç›®ã€æ—¥ç¨‹ä¸æ²Ÿé€šå·¥å…·ï¼Œæ‰“ç ´ä¿¡æ¯å­¤å²›ï¼Œè®©å›¢é˜Ÿåä½œå¦‚è¡Œäº‘æµæ°´èˆ¬é¡ºç•…ï¼Œæ˜¾è‘—æå‡æ•ˆç‡ã€‚</li>\n              <li><span class=\"feature-highlight\">æ™ºæ…§æ–‡æ¡£å¤„ç†</span> - ä»æ™ºèƒ½åˆåŒç”Ÿæˆåˆ°çŸ¥è¯†åº“ç®¡ç†ï¼Œè‡ªåŠ¨åŒ–å¤„ç†ç¹æ‚çš„æ–‡æ¡£å·¥ä½œæµï¼Œè®©æ‚¨çš„å›¢é˜Ÿèšç„¦äºæ ¸å¿ƒåˆ›æ–°ã€‚</li>\n              <li><span class=\"feature-highlight\">å®‰å…¨å¯é ä¿éšœ</span> - é‡‡ç”¨ä¼ä¸šçº§æ•°æ®åŠ å¯†ä¸ç²¾ç»†åŒ–æƒé™ç®¡ç†ï¼Œå…¨æ–¹ä½å®ˆæŠ¤æ‚¨çš„æ ¸å¿ƒæ•°æ®èµ„äº§å®‰å…¨ã€‚</li>\n            </ul>\n            \n            <p>å€ŸåŠ©æ™ºè¡ŒèˆŸå¹³å°ï¼Œæ‚¨çš„ä¼ä¸šå°†è¿ˆå…¥æ›´æ•æ·ã€é«˜æ•ˆã€æ™ºèƒ½çš„åä½œæ–°çºªå…ƒï¼Œæ¿€å‘å›¢é˜Ÿæ½œåŠ›ï¼Œæå‡æ•´ä½“ç«äº‰åŠ›ã€‚</p>\n          </div>\n          <p>é€‰æ‹©ä»¥ä¸‹åŠŸèƒ½æ¨¡å—ï¼Œæˆ–ç›´æ¥å‘æˆ‘æé—®ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›æ™ºèƒ½åŠ©æ‰‹æœåŠ¡ã€‚</p>\n          <div class=\"quick-nav-cards\">\n            <div class=\"nav-card\" onclick=\"window.location.href='/project'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-kanban\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">é¡¹ç›®åä½œ</div>\n                <div class=\"nav-card-desc\">ä»»åŠ¡åˆ†é…ã€è¿›åº¦è·Ÿè¸ªã€å›¢é˜Ÿåä½œ</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n            <div class=\"nav-card\" onclick=\"window.location.href='/calendar'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-calendar-week\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">æ—¥ç¨‹å®‰æ’</div>\n                <div class=\"nav-card-desc\">ä¼šè®®é¢„çº¦ã€æ—¥ç¨‹æé†’ã€æ—¶é—´ç®¡ç†</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n            <div class=\"nav-card\" onclick=\"window.location.href='/chat'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-chat-dots\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">å³æ—¶æ²Ÿé€š</div>\n                <div class=\"nav-card-desc\">å›¢é˜ŸèŠå¤©ã€æ–‡ä»¶å…±äº«ã€æ¶ˆæ¯é€šçŸ¥</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n            <div class=\"nav-card\" onclick=\"window.location.href='/smartdoc'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-file-earmark-text\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">æ™ºèƒ½æ–‡æ¡£</div>\n                <div class=\"nav-card-desc\">å†…å®¹åˆ›ä½œã€æ™ºèƒ½é—®ç­”ã€æ–‡æ¡£å…±äº«</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n            <div class=\"nav-card\" onclick=\"window.location.href='/knowledge'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-book\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">çŸ¥è¯†åº“</div>\n                <div class=\"nav-card-desc\">å›¢é˜ŸçŸ¥è¯†å…±äº«ã€æ£€ç´¢ã€å­˜å‚¨å¹³å°</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n            <div class=\"nav-card\" onclick=\"window.location.href='/contract'\">\n              <div class=\"nav-card-icon\">\n                <i class=\"bi bi-file-earmark-ruled\"></i>\n              </div>\n              <div class=\"nav-card-content\">\n                <div class=\"nav-card-title\">æ™ºèƒ½åˆåŒ</div>\n                <div class=\"nav-card-desc\">åˆåŒæ¨¡æ¿ã€AIå®¡æŸ¥ã€æ™ºèƒ½ç”Ÿæˆ</div>\n              </div>\n              <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n            </div>\n          </div>\n        </div>`, \n        rawContent: 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ‚¨çš„AIåŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ',\n        type: 'text' \n      }\n    ])\n    const chatBody = ref(null)\n    const fileInput = ref(null)\n    const selectedFiles = ref([])\n    const loading = ref(false)\n    const processingFiles = computed(() => {\n      return selectedFiles.value.some(file => file.status !== 'completed' && file.status !== 'failed');\n    })\n    const chatId = ref(null) // å­˜å‚¨å½“å‰èŠå¤©IDï¼Œç”¨äºç»´æŒå¯¹è¯ä¸Šä¸‹æ–‡\n    const showContextBar = computed(() => chatId.value !== null)\n    const searchMethod = ref('basic') // æ–°å¢ï¼šæœç´¢æ–¹æ³•, é»˜è®¤ä¸ºbasic\n    const chatMode = ref('agent') // agent æˆ– knowledge_base\n    const retrievalScope = ref('local') // 'local' æˆ– 'basic'\n    \n    // æ·»åŠ å˜é‡æ¥å­˜å‚¨å½“å‰è¯·æ±‚çš„æ§åˆ¶å™¨\n    const currentRequestController = ref(null);\n    \n    // å³ä¾§é¢æ¿ç›¸å…³çŠ¶æ€\n    const rightPanelCollapsed = ref(false);\n    const chatSessions = ref([]);\n    \n    // ç¼–è¾‘å¯¹è¯æ¡†ç›¸å…³çŠ¶æ€\n    const editEventDialogVisible = ref(false);\n    const editingEvent = ref(null);\n    const currentEditingMessage = ref(null);\n    \n    // è·å– emitter å®ä¾‹\n    const emitter = proxy.emitter;\n    \n    // è·å–èŠå¤©ä¼šè¯åˆ—è¡¨\n    const fetchChatSessions = async () => {\n      try {\n        const res = await getAIChatSessions();\n        if (res.data && Array.isArray(res.data)) {\n          chatSessions.value = res.data;\n        } else if (res.data && res.data.results && Array.isArray(res.data.results)) {\n          chatSessions.value = res.data.results;\n        }\n        return chatSessions.value;\n      } catch (error) {\n        console.error('è·å–èŠå¤©ä¼šè¯åˆ—è¡¨å¤±è´¥:', error);\n        chatSessions.value = [];\n        return [];\n      }\n    };\n    \n    // åˆ‡æ¢èŠå¤©ä¼šè¯\n    const switchChatSession = async (sessionId) => {\n      if (sessionId === chatId.value) return;\n      \n      try {\n        loading.value = true;\n        const res = await getAIChatSession(sessionId);\n        if (res.data) {\n          chatId.value = sessionId;\n          // åŠ è½½èŠå¤©å†å²\n          if (res.data.messages && Array.isArray(res.data.messages)) {\n            messages.value = res.data.messages.map(msg => {\n              return {\n                role: msg.role,\n                content: msg.content,\n                rawContent: msg.content,\n                type: msg.type || 'text',\n                source: msg.role === 'user' ? '' : (msg.source || (msg.role === 'assistant' ? 'general_ai' : '')) // ç¡®ä¿ç”¨æˆ·æ¶ˆæ¯æ²¡æœ‰sourceå±æ€§\n              }\n            });\n          }\n        }\n      } catch (error) {\n        console.error('è·å–èŠå¤©ä¼šè¯è¯¦æƒ…å¤±è´¥:', error);\n        ElMessage.error('åˆ‡æ¢èŠå¤©ä¼šè¯å¤±è´¥');\n        \n        // å¦‚æœåˆ‡æ¢å¤±è´¥ï¼Œæ£€æŸ¥å½“å‰ä¼šè¯åˆ—è¡¨ä¸­æ˜¯å¦è¿˜æœ‰è¿™ä¸ªä¼šè¯\n        const sessionExists = chatSessions.value.some(session => session.id === sessionId);\n        if (!sessionExists) {\n          // å¦‚æœä¼šè¯å·²ä¸å­˜åœ¨ï¼Œå°è¯•åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªå¯ç”¨ä¼šè¯æˆ–åˆ›å»ºæ–°ä¼šè¯\n          if (chatSessions.value.length > 0) {\n            await switchChatSession(chatSessions.value[0].id);\n          } else {\n            clearChat();\n          }\n        }\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // ç›‘å¬èŠå¤©IDå˜åŒ–ï¼Œæ›´æ–°ä¼šè¯åˆ—è¡¨\n    watch(chatId, (newChatId) => {\n      if (newChatId) {\n        fetchChatSessions();\n      }\n    });\n\n    // è·å–ç”¨æˆ·ä¿¡æ¯\n    const getUserInfo = async () => {\n      try {\n        const res = await request({\n          url: '/api/auth/users/me/',\n          method: 'get'\n        })\n        console.log('ç”¨æˆ·ä¿¡æ¯å®Œæ•´å“åº”:', res)\n\n        // å°è¯•ä»å“åº”çš„ä¸åŒä½ç½®è·å–å¤´åƒURL\n        let avatarUrl = null\n        if (res.data && res.data.data && res.data.data.avatar) {\n          avatarUrl = res.data.data.avatar\n        } else if (res.data && res.data.avatar) {\n          avatarUrl = res.data.avatar\n        } else if (res.data) {\n          // éå†res.dataæŸ¥æ‰¾avatarå­—æ®µ\n          const findAvatar = (obj) => {\n            if (!obj || typeof obj !== 'object') return null\n            \n            if ('avatar' in obj) return obj.avatar\n            \n            // é€’å½’æœç´¢æ‰€æœ‰å­å¯¹è±¡\n            for (const key in obj) {\n              if (typeof obj[key] === 'object') {\n                const result = findAvatar(obj[key])\n                if (result) return result\n              }\n            }\n            return null\n          }\n          \n          avatarUrl = findAvatar(res.data)\n        }\n\n        console.log('æ‰¾åˆ°çš„å¤´åƒURL:', avatarUrl)\n        \n        if (avatarUrl) {\n          // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ·»åŠ åŸºç¡€URL\n          if (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data:')) {\n            // ç¡®ä¿åª’ä½“URLæ­£ç¡®æ‹¼æ¥\n            const baseUrl = window.location.origin\n            if (avatarUrl.startsWith('/')) {\n              userAvatarUrl.value = `${baseUrl}${avatarUrl}`\n            } else {\n              userAvatarUrl.value = `${baseUrl}/${avatarUrl}`\n            }\n          } else {\n            userAvatarUrl.value = avatarUrl\n          }\n          console.log('å¤„ç†åçš„ç”¨æˆ·å¤´åƒURL:', userAvatarUrl.value)\n        } else {\n          console.log('ç”¨æˆ·ä¿¡æ¯ä¸­æ²¡æœ‰æ‰¾åˆ°å¤´åƒ:', res.data)\n        }\n      } catch (error) {\n        console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error)\n      }\n    }\n    \n    const scrollToBottom = () => {\n      nextTick(() => {\n        if (chatBody.value) chatBody.value.scrollTop = chatBody.value.scrollHeight\n      })\n    }\n    \n    const uploadFileAndGetId = async (file) => {\n      const formData = new FormData()\n      formData.append('file', file.rawFile)\n      try {\n        // æ ‡è®°æ–‡ä»¶ä¸ºä¸Šä¼ ä¸­\n        file.progress = 0;\n        file.status = 'pending';\n        let smoothTimer = null;\n        let lastProgress = 0;\n        let uploadFinished = false;\n        const res = await request({\n          url: '/api/ai/documents/upload/',\n          method: 'post',\n          data: formData,\n          onUploadProgress: (progressEvent) => {\n            const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n            if (percentCompleted < 100) {\n              file.progress = percentCompleted;\n              lastProgress = percentCompleted;\n            } else {\n              // ä¸Šä¼ ç¬é—´å®Œæˆï¼Œå¹³æ»‘é€’å¢åˆ°95%\n              if (!uploadFinished) {\n                uploadFinished = true;\n                let fakeProgress = lastProgress;\n                smoothTimer = setInterval(() => {\n                  fakeProgress += 3;\n                  if (fakeProgress >= 95) {\n                    fakeProgress = 95;\n                    clearInterval(smoothTimer);\n                  }\n                  file.progress = fakeProgress;\n                }, 20);\n              }\n            }\n          }\n        })\n        // ä¸Šä¼ å®Œæˆåï¼ŒçŠ¶æ€æ”¹ä¸ºå¤„ç†ä¸­ï¼Œä¸é‡ç½®è¿›åº¦æ¡\n        if (smoothTimer) clearInterval(smoothTimer);\n        if (file.progress < 95) file.progress = 95;\n        file.status = 'processing';\n        file.documentId = res.data.id;\n        pollDocumentStatus(file);\n        return res.data.id;\n      } catch (error) {\n        file.status = 'failed';\n        console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);\n        throw new Error(`ä¸Šä¼ æ–‡ä»¶ ${file.name} å¤±è´¥: ${error.message || 'æœåŠ¡å™¨é”™è¯¯'}`);\n      }\n    }\n    \n    // è½®è¯¢æ–‡æ¡£å¤„ç†çŠ¶æ€\n    const pollDocumentStatus = async (file, interval = 1000) => {\n      if (!file.documentId) return;\n      \n      try {\n        const res = await request({\n          url: `/api/ai/documents/${file.documentId}/`,\n          method: 'get'\n        });\n        \n        if (res.data.status === 'completed') {\n          file.progress = 100;\n          file.status = 'completed';\n          return;\n        } else if (res.data.status === 'failed') {\n          file.status = 'failed';\n          file.progress = 0;\n          return;\n        } else if (res.data.status === 'processing') {\n          // å¤„ç†ä¸­ï¼Œå¢åŠ è¿›åº¦ï¼ˆä»…åœ¨å°äº95æ—¶é€’å¢ï¼‰\n          if (file.progress < 95) {\n            file.progress = Math.min(file.progress + 5, 95);\n          }\n        }\n        \n        // ç»§ç»­è½®è¯¢\n        setTimeout(() => pollDocumentStatus(file, interval), interval);\n      } catch (e) {\n        // å‡ºé”™æ—¶ï¼Œç»§ç»­è½®è¯¢ï¼Œä½†ä¸æ›´æ–°è¿›åº¦\n        setTimeout(() => pollDocumentStatus(file, interval), interval);\n      }\n    }\n    \n    const clearChat = () => {\n      // æ¸…ç©ºå¯¹è¯å†å²ï¼Œå¼€å§‹æ–°çš„å¯¹è¯\n      chatId.value = null;\n      \n      // é‡ç½®æ¶ˆæ¯åˆ—è¡¨ï¼Œåªä¿ç•™æ¬¢è¿æ¶ˆæ¯\n      messages.value = [\n        { \n          role: 'assistant', \n          content: `<div class=\"welcome-message\">\n            <h3>æ¬¢è¿æ¥åˆ°æ™ºè¡ŒèˆŸå¹³å°</h3>\n            <div class=\"platform-intro\">\n              <p>æ™ºè¡ŒèˆŸå¹³å°æ˜¯æ‚¨çš„æ™ºèƒ½åä½œä¸­å¿ƒï¼Œèåˆäº†é¡¹ç›®ç®¡ç†ã€å³æ—¶é€šè®¯ã€æ™ºèƒ½æ–‡æ¡£å’ŒAIåŠ©æ‰‹ã€‚æˆ‘ä»¬è‡´åŠ›äºé€šè¿‡å‰æ²¿AIæŠ€æœ¯èµ‹èƒ½æ‚¨çš„å›¢é˜Ÿï¼Œä¼˜åŒ–ä¸šåŠ¡æµç¨‹ï¼Œä¸ºæ‚¨æ‰“é€ æ— ç¼è¿æ¥çš„æœªæ¥åŠå…¬æ–°èŒƒå¼ï¼Œæ ¸å¿ƒä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>\n              \n              <ul class=\"platform-features\">\n                <li><span class=\"feature-highlight\">AIæ™ºèƒ½å¼•æ“</span> - æˆ‘ä»¬çš„AIåŠ©æ‰‹èƒ½å¤Ÿç†è§£è‡ªç„¶è¯­è¨€ï¼Œå¤„ç†å¤æ‚æ–‡æ¡£ï¼Œè‡ªåŠ¨åˆ›å»ºæ—¥ç¨‹ï¼Œæˆä¸ºæ‚¨24å°æ—¶çš„æ™ºèƒ½å·¥ä½œä¼™ä¼´ã€‚</li>\n                <li><span class=\"feature-highlight\">ä¸€ä½“åŒ–åä½œ</span> - æ— ç¼æ•´åˆé¡¹ç›®ã€æ—¥ç¨‹ä¸æ²Ÿé€šå·¥å…·ï¼Œæ‰“ç ´ä¿¡æ¯å­¤å²›ï¼Œè®©å›¢é˜Ÿåä½œå¦‚è¡Œäº‘æµæ°´èˆ¬é¡ºç•…ï¼Œæ˜¾è‘—æå‡æ•ˆç‡ã€‚</li>\n                <li><span class=\"feature-highlight\">æ™ºæ…§æ–‡æ¡£å¤„ç†</span> - ä»æ™ºèƒ½åˆåŒç”Ÿæˆåˆ°çŸ¥è¯†åº“ç®¡ç†ï¼Œè‡ªåŠ¨åŒ–å¤„ç†ç¹æ‚çš„æ–‡æ¡£å·¥ä½œæµï¼Œè®©æ‚¨çš„å›¢é˜Ÿèšç„¦äºæ ¸å¿ƒåˆ›æ–°ã€‚</li>\n                <li><span class=\"feature-highlight\">å®‰å…¨å¯é ä¿éšœ</span> - é‡‡ç”¨ä¼ä¸šçº§æ•°æ®åŠ å¯†ä¸ç²¾ç»†åŒ–æƒé™ç®¡ç†ï¼Œå…¨æ–¹ä½å®ˆæŠ¤æ‚¨çš„æ ¸å¿ƒæ•°æ®èµ„äº§å®‰å…¨ã€‚</li>\n              </ul>\n              \n              <p>å€ŸåŠ©æ™ºè¡ŒèˆŸå¹³å°ï¼Œæ‚¨çš„ä¼ä¸šå°†è¿ˆå…¥æ›´æ•æ·ã€é«˜æ•ˆã€æ™ºèƒ½çš„åä½œæ–°çºªå…ƒï¼Œæ¿€å‘å›¢é˜Ÿæ½œåŠ›ï¼Œæå‡æ•´ä½“ç«äº‰åŠ›ã€‚</p>\n            </div>\n            <p>é€‰æ‹©ä»¥ä¸‹åŠŸèƒ½æ¨¡å—ï¼Œæˆ–ç›´æ¥å‘æˆ‘æé—®ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›æ™ºèƒ½åŠ©æ‰‹æœåŠ¡ã€‚</p>\n            <div class=\"quick-nav-cards\">\n              <div class=\"nav-card\" onclick=\"window.location.href='/project'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-kanban\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">é¡¹ç›®åä½œ</div>\n                  <div class=\"nav-card-desc\">ä»»åŠ¡åˆ†é…ã€è¿›åº¦è·Ÿè¸ªã€å›¢é˜Ÿåä½œ</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n              <div class=\"nav-card\" onclick=\"window.location.href='/calendar'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-calendar-week\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">æ—¥ç¨‹å®‰æ’</div>\n                  <div class=\"nav-card-desc\">ä¼šè®®é¢„çº¦ã€æ—¥ç¨‹æé†’ã€æ—¶é—´ç®¡ç†</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n              <div class=\"nav-card\" onclick=\"window.location.href='/chat'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-chat-dots\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">å³æ—¶æ²Ÿé€š</div>\n                  <div class=\"nav-card-desc\">å›¢é˜ŸèŠå¤©ã€æ–‡ä»¶å…±äº«ã€æ¶ˆæ¯é€šçŸ¥</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n              <div class=\"nav-card\" onclick=\"window.location.href='/smartdoc'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-file-earmark-text\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">AIæ–‡æ¡£</div>\n                  <div class=\"nav-card-desc\">æ–‡æ¡£æ‘˜è¦ã€æ™ºèƒ½é—®ç­”ã€å†…å®¹åˆ›ä½œ</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n              <div class=\"nav-card\" onclick=\"window.location.href='/knowledge'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-book\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">çŸ¥è¯†åº“</div>\n                  <div class=\"nav-card-desc\">å›¢é˜ŸçŸ¥è¯†å…±äº«ã€æ£€ç´¢ã€å­˜å‚¨å¹³å°</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n              <div class=\"nav-card\" onclick=\"window.location.href='/contract'\">\n                <div class=\"nav-card-icon\">\n                  <i class=\"bi bi-file-earmark-ruled\"></i>\n                </div>\n                <div class=\"nav-card-content\">\n                  <div class=\"nav-card-title\">æ™ºèƒ½åˆåŒ</div>\n                  <div class=\"nav-card-desc\">åˆåŒæ¨¡æ¿ã€AIå®¡æŸ¥ã€æ™ºèƒ½ç”Ÿæˆ</div>\n                </div>\n                <div class=\"nav-card-arrow\"><i class=\"nav-arrow-icon\">â†’</i></div>\n              </div>\n            </div>\n          </div>`, \n          rawContent: 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ‚¨çš„AIåŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ',\n          type: 'text' \n        }\n      ];\n      \n      // æ¸…ç©ºé€‰æ‹©çš„æ–‡ä»¶\n      selectedFiles.value = [];\n      \n      // æ¸…ç©ºè¾“å…¥æ¡†\n      input.value = '';\n      \n      // å¦‚æœæœ‰æ­£åœ¨è¿›è¡Œçš„è¯·æ±‚ï¼Œå–æ¶ˆå®ƒ\n      if (currentRequestController.value) {\n        currentRequestController.value.abort();\n        currentRequestController.value = null;\n      }\n      \n      // é‡ç½®åŠ è½½çŠ¶æ€\n      loading.value = false;\n      \n      // æ»šåŠ¨åˆ°é¡¶éƒ¨\n      nextTick(() => {\n        if (chatBody.value) {\n          chatBody.value.scrollTop = 0;\n        }\n      });\n      \n      // åˆ·æ–°å†å²è®°å½•åˆ—è¡¨\n      fetchChatSessions();\n    }\n    \n    const processBuffer = (data) => {\n        let lastMessage = messages.value[messages.value.length - 1];\n        if (!lastMessage || lastMessage.role !== 'assistant') {\n            lastMessage = { \n                role: 'assistant', \n                content: '', \n                rawContent: '', \n                type: 'text', \n                streaming: true,\n                source: chatMode.value === 'knowledge_base' ? 'knowledge_base' : 'general_ai' // æ ¹æ®å½“å‰æ¨¡å¼è®¾ç½®é»˜è®¤source\n            };\n            messages.value.push(lastMessage);\n        }\n\n        if (data.type === 'processing_start') {\n            lastMessage.type = 'text';\n            lastMessage.content = data.content;\n            lastMessage.rawContent = data.content;\n            lastMessage.streaming = true;\n        } else if (data.type === 'text_chunk') {\n            lastMessage.type = 'text';\n            lastMessage.streaming = true;\n            if (!lastMessage.rawContent || lastMessage.rawContent === \"æ­£åœ¨ä¸ºæ‚¨å¤„ç†æ—¥ç¨‹...\") {\n              lastMessage.rawContent = '';\n            }\n            // åœ¨å°†å†…å®¹æ·»åŠ åˆ°rawContentä¹‹å‰è¿›è¡Œè¿‡æ»¤\n            const filteredContent = data.content.replace(/\\[Data: Sources \\(\\d+\\)\\]\\.?/g, '');\n            lastMessage.rawContent += filteredContent;\n            // æµå¼ä¼ è¾“æ—¶ï¼Œå®æ—¶è¿›è¡Œmarkdownè½¬æ¢\n            lastMessage.content = marked.parse(lastMessage.rawContent);\n        } else if (data.type === 'final_card') {\n            // ä»…å½“æ˜¯æ—¥ç¨‹ç›¸å…³ä¸”æœ‰event_idæ—¶æ‰æ˜¾ç¤ºä¸ºå¡ç‰‡\n            if (data.event_id && data.is_schedule === true) {\n                lastMessage.type = 'card';\n                lastMessage.streaming = false;\n                lastMessage.content = marked.parse(data.content || '');\n                lastMessage.status = data.status || 'clarification';\n                lastMessage.event_id = data.event_id || null;\n                \n                // å¦‚æœæ˜¯æˆåŠŸåˆ›å»ºæ—¥ç¨‹ï¼Œè§¦å‘æ—¥å†åˆ·æ–°\n                if (data.status === 'success') {\n                    emitter.emit('refreshCalendar');\n                }\n            } else {\n                // éæ—¥ç¨‹ç›¸å…³æˆ–æ— event_idæ—¶ä»¥æ–‡æœ¬å½¢å¼å±•ç¤º\n                lastMessage.type = 'text';\n                lastMessage.streaming = false;\n                lastMessage.rawContent = data.content || '';\n                lastMessage.content = marked.parse(lastMessage.rawContent);\n            }\n        } else if (data.type === 'error') {\n            // å¦‚æœæ˜¯æ—¥ç¨‹ç›¸å…³é”™è¯¯ä¸”æ˜ç¡®æŒ‡å®šäº†is_scheduleï¼Œæ‰æ˜¾ç¤ºä¸ºå¡ç‰‡\n            if (data.is_schedule === true) {\n                lastMessage.type = 'card';\n                lastMessage.streaming = false;\n                lastMessage.content = data.content || 'å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚';\n                lastMessage.status = 'error';\n            } else {\n                // éæ—¥ç¨‹é”™è¯¯ä»¥æ–‡æœ¬å½¢å¼å±•ç¤º\n                lastMessage.type = 'text';\n                lastMessage.streaming = false;\n                lastMessage.rawContent = data.content || 'å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚';\n                lastMessage.content = marked.parse(lastMessage.rawContent);\n            }\n        } else if (data.type === 'update_card') {\n            // ä»…æ›´æ–°æ—¥ç¨‹å¡ç‰‡\n            if (data.is_schedule === true && data.event_id) {\n                // å¤„ç†å¡ç‰‡æ›´æ–°\n                const targetCard = messages.value.find(msg => \n                    msg.type === 'card' && msg.event_id === data.event_id\n                );\n                \n                if (targetCard) {\n                    targetCard.content = marked.parse(data.content || '');\n                    targetCard.status = data.status || targetCard.status;\n                }\n            }\n        } else if (data.type === 'session_id') {\n            // å¤„ç†ä¼šè¯IDæ¶ˆæ¯ï¼Œæ›´æ–°å½“å‰èŠå¤©ID\n            if (data.chat_id && !chatId.value) {\n                chatId.value = data.chat_id;\n                fetchChatSessions(); // åˆ›å»ºæ–°ä¼šè¯ååˆ·æ–°åˆ—è¡¨\n            }\n        }\n        scrollToBottom();\n    };\n\n    const sendMsg = async () => {\n      if (!input.value.trim() && selectedFiles.value.length === 0) {\n        ElMessage.warning('è¯·è¾“å…¥å†…å®¹æˆ–ä¸Šä¼ æ–‡ä»¶');\n        return;\n      }\n      \n      if (processingFiles.value) {\n        ElMessage.warning('æ–‡ä»¶æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™å†è¯•');\n        return;\n      }\n      \n      if (currentRequestController.value) {\n        currentRequestController.value.abort();\n      }\n      \n      const userMsg = { role: 'user', content: input.value, type: 'text' };\n      messages.value.push(userMsg);\n      \n      if (selectedFiles.value.length > 0) {\n        messages.value.push({\n          role: 'user',\n          content: `ä¸Šä¼ äº†${selectedFiles.value.length}ä¸ªæ–‡ä»¶`,\n          type: 'file',\n          files: selectedFiles.value.map(f => ({ name: f.name, size: f.size, ext: f.ext }))\n        });\n      }\n      \n      const assistantMsg = { role: 'assistant', content: '', type: 'text', streaming: true, source: chatMode.value === 'knowledge_base' ? 'knowledge_base' : 'general_ai' };\n      messages.value.push(assistantMsg);\n      \n      const currentInput = input.value;\n      input.value = '';\n      \n      const currentDocumentIds = selectedFiles.value.map(f => f.documentId).filter(Boolean);\n      selectedFiles.value = [];\n      \n      scrollToBottom();\n      loading.value = true;\n      \n      // è·å–ç”¨æˆ·çš„AIä¸ªæ€§åŒ–è®¾ç½®\n      let aiSettings = null;\n      try {\n        const aiSettingsResponse = await request({\n          url: '/api/settings/ai-settings',\n          method: 'get'\n        });\n        \n        if (aiSettingsResponse && aiSettingsResponse.success) {\n          aiSettings = aiSettingsResponse.data;\n        }\n      } catch (error) {\n        console.error('è·å–AIä¸ªæ€§åŒ–è®¾ç½®å¤±è´¥:', error);\n        // å³ä½¿è·å–å¤±è´¥ä¹Ÿç»§ç»­èŠå¤©\n      }\n      \n      const requestData = {\n        message: currentInput,\n        chat_id: chatId.value,\n        document_ids: currentDocumentIds,\n        chatMode: chatMode.value,\n        method: searchMethod.value // For knowledge base\n      };\n\n      // æ·»åŠ AIä¸ªæ€§åŒ–è®¾ç½®\n      if (aiSettings) {\n        requestData.ai_settings = aiSettings;\n      }\n\n      // ç»Ÿä¸€ä½¿ç”¨æµå¼è¯·æ±‚å¤„ç†æ‰€æœ‰æ¨¡å¼\n      currentRequestController.value = aiChatWithDocumentsStream(\n        requestData,\n        // onChunk callback\n        (payload, newChatId) => {\n          if (newChatId && !chatId.value) {\n            chatId.value = newChatId;\n          }\n          processBuffer(payload);\n        },\n        // onComplete callback\n        (newChatId) => {\n          const lastMsg = messages.value[messages.value.length - 1];\n          if (lastMsg && lastMsg.role === 'assistant') {\n            lastMsg.streaming = false;\n          }\n          if (newChatId && !chatId.value) {\n            chatId.value = newChatId;\n            fetchChatSessions(); // åˆ›å»ºæ–°ä¼šè¯ååˆ·æ–°åˆ—è¡¨\n          }\n          loading.value = false;\n          currentRequestController.value = null;\n        },\n        // onError callback\n        (error) => {\n          console.error('æµå¼è¯·æ±‚å‡ºé”™:', error);\n          const lastMsg = messages.value[messages.value.length - 1];\n          if (lastMsg && lastMsg.role === 'assistant') {\n            lastMsg.content = 'æŠ±æ­‰ï¼Œå“åº”ç”Ÿæˆè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚';\n            lastMsg.streaming = false;\n          }\n          loading.value = false;\n          currentRequestController.value = null;\n          ElMessage.error('è¯·æ±‚å‡ºé”™: ' + (error.message || 'æœªçŸ¥é”™è¯¯'));\n        }\n      );\n    }\n    \n    const triggerFileInput = () => {\n      if (fileInput.value) fileInput.value.value = '';\n      fileInput.value && fileInput.value.click()\n    }\n    \n    const handleFileUpload = (e) => {\n      const files = e.target.files\n      if (!files || !files.length) return\n      \n      // æ”¯æŒçš„æ–‡ä»¶ç±»å‹é…ç½®\n      const allowedTypes = {\n        // æ–‡æ¡£ç±»å‹\n        'text/plain': 'txt',                          // txtæ–‡ä»¶\n        'application/pdf': 'pdf',                     // pdfæ–‡ä»¶\n        'application/msword': 'doc',                  // docæ–‡ä»¶\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx', // docxæ–‡ä»¶\n        'text/markdown': 'md',                        // markdownæ–‡ä»¶\n        'text/x-markdown': 'md',                      // markdownæ–‡ä»¶å˜ä½“\n        \n        // è¡¨æ ¼ç±»å‹\n        'text/csv': 'csv',                            // csvæ–‡ä»¶\n        'application/csv': 'csv',                     // csvæ–‡ä»¶å¦ä¸€ç§MIME\n        'application/vnd.ms-excel': 'xls',            // xlsæ–‡ä»¶\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'xlsx', // xlsxæ–‡ä»¶\n        \n        // å›¾ç‰‡ç±»å‹\n        'image/jpeg': 'jpg',                          // jpg/jpegå›¾ç‰‡\n        'image/png': 'png',                           // pngå›¾ç‰‡\n        'image/gif': 'gif',                           // gifå›¾ç‰‡\n        'image/bmp': 'bmp',                           // bmpå›¾ç‰‡\n        'image/webp': 'webp',                         // webpå›¾ç‰‡\n        'image/svg+xml': 'svg',                       // svgçŸ¢é‡å›¾\n        'image/tiff': 'tiff'                          // tiffå›¾ç‰‡\n      };\n      \n      // æ˜¾ç¤ºæ”¯æŒçš„æ–‡ä»¶æ ¼å¼æç¤º\n      const supportedFormats = 'æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: txt, pdf, doc, docx, md, xls, xlsx, csv å’Œå¸¸è§å›¾ç‰‡æ ¼å¼';\n      \n      // æ£€æŸ¥æ¯ä¸ªæ–‡ä»¶\n      const validFiles = [];\n      let hasInvalidFile = false;\n      \n      // æœ‰æ•ˆçš„æ–‡ä»¶æ‰©å±•ååˆ—è¡¨ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰\n      const validExtensions = ['txt', 'pdf', 'doc', 'docx', 'md', 'xls', 'xlsx', 'csv', \n                              'jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n      \n      Array.from(files).forEach(file => {\n        const ext = getExt(file.name).toLowerCase();\n        const isValidExtension = validExtensions.includes(ext);\n        \n        // æ£€æŸ¥MIMEç±»å‹æˆ–æ‰©å±•åæ˜¯å¦æœ‰æ•ˆ\n        if (allowedTypes[file.type] || isValidExtension) {\n          const id = file.name + '_' + file.size + '_' + Date.now() + Math.random()\n          if (file.type.startsWith('image/')) {\n            const reader = new FileReader()\n            reader.onload = (ev) => {\n              selectedFiles.value.push({\n                id,\n                name: file.name,\n                type: file.type,\n                url: ev.target.result,\n                size: formatSize(file.size),\n                ext,\n                label: getFileLabel(file.type, ext),\n                bg: getFileBg(ext),\n                rawFile: file,\n                progress: 0,\n                status: 'ready'\n              })\n              // è‡ªåŠ¨ä¸Šä¼ \n              uploadFileAndGetId(selectedFiles.value[selectedFiles.value.length - 1])\n            }\n            reader.readAsDataURL(file)\n          } else {\n            selectedFiles.value.push({\n              id,\n              name: file.name,\n              type: file.type,\n              url: URL.createObjectURL(file),\n              size: formatSize(file.size),\n              ext,\n              label: getFileLabel(file.type, ext),\n              bg: getFileBg(ext),\n              rawFile: file, // ç›´æ¥ä½¿ç”¨åŸå§‹fileå¯¹è±¡\n              progress: 0,\n              status: 'ready'\n            })\n            // è‡ªåŠ¨ä¸Šä¼ \n            uploadFileAndGetId(selectedFiles.value[selectedFiles.value.length - 1])\n          }\n          validFiles.push(selectedFiles.value[selectedFiles.value.length - 1])\n        } else {\n          hasInvalidFile = true;\n          ElMessage.error(`ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: ${file.name}`);\n          console.warn(`æ–‡ä»¶ç±»å‹æ‹’ç»: ${file.name}, MIME: ${file.type}, æ‰©å±•å: ${ext}`);\n        }\n      })\n      \n      // åœ¨æœ‰ä¸æ”¯æŒæ–‡ä»¶ç±»å‹æ—¶æ˜¾ç¤ºæ”¯æŒçš„æ ¼å¼ä¿¡æ¯\n      if (hasInvalidFile) {\n        ElMessage.info(supportedFormats);\n      }\n      \n      // å¦‚æœå…¨éƒ¨æ–‡ä»¶éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ˜¾ç¤ºæˆåŠŸä¸Šä¼ æç¤º\n      if (validFiles.length > 0 && validFiles.length === files.length) {\n        ElMessage.success(`å·²æ·»åŠ ${validFiles.length}ä¸ªæ–‡ä»¶`);\n      }\n    }\n    \n    const removeFile = (idx) => {\n      selectedFiles.value.splice(idx, 1)\n    }\n\n    // markedé…ç½®ï¼šè¡¨æ ¼å¸¦è¾¹æ¡†+ä»£ç å—ç¾åŒ–+å¤åˆ¶æŒ‰é’®\n    const renderer = new marked.Renderer();\n    renderer.table = function(header, body) {\n      return `<table class=\"openwebui-md-table\"><thead>${header}</thead><tbody>${body}</tbody></table>`;\n    };\n    renderer.code = function(code, infostring, escaped) {\n      const codeId = 'code-' + Math.random().toString(36).substr(2, 9);\n      let lang = (infostring || '').split(/\\s+/)[0];\n      let langLabel = lang ? lang : 'code';\n      let langClass = lang ? `language-${lang}` : '';\n      return `\n        <div class=\"openwebui-md-code-block-beauty\">\n          <div class=\"openwebui-md-code-toolbar\">\n            <span class=\"openwebui-md-code-lang\">${langLabel}</span>\n            <button class=\"openwebui-copy-btn\" data-clipboard-target=\"#${codeId}\" title=\"å¤åˆ¶ä»£ç \">å¤åˆ¶</button>\n          </div>\n          <pre class=\"openwebui-md-pre\"><code id=\"${codeId}\" class=\"${langClass}\">${escaped ? code : escapeHtml(code)}</code></pre>\n        </div>\n      `;\n    };\n    \n    // æ–°å¢ï¼šè‡ªå®šä¹‰æ‰©å±•ï¼Œç¦ç”¨åˆ é™¤çº¿åŠŸèƒ½\n    const disableStrikethrough = {\n      walkTokens(token) {\n        if (token.type === 'del') {\n          // å°†åˆ é™¤çº¿ï¼ˆdelï¼‰ç±»å‹çš„tokenæ”¹å†™ä¸ºæ™®é€šæ–‡æœ¬ï¼ˆtextï¼‰ç±»å‹\n          token.type = 'text';\n          token.text = token.raw; // ä½¿ç”¨åŸå§‹æ–‡æœ¬ï¼Œä¿ç•™'~~'\n          delete token.tokens;\n        }\n      },\n    };\n\n    marked.use(disableStrikethrough);\n    \n    marked.setOptions({\n      breaks: true,\n      gfm: true,\n      headerIds: false,\n      mangle: false,\n      renderer\n    })\n\n    // --- å¡ç‰‡æ ·å¼è¾…åŠ©å‡½æ•° (æ–°å¢) ---\n    const getCardClass = (status) => {\n      switch (status) {\n        case 'success':\n          return 'success-card';\n        case 'error':\n          return 'error-card';\n        case 'clarification':\n          return 'clarification-card';\n        case 'deleted':\n          return 'deleted-card';\n        default:\n          return '';\n      }\n    };\n    const getCardIcon = (status) => {\n      switch (status) {\n        case 'success':\n          return 'CircleCheckFilled';\n        case 'error':\n          return 'CircleCloseFilled';\n        case 'clarification':\n          return 'InfoFilled';\n        case 'deleted':\n          return 'WarningFilled';\n        default:\n          return 'InfoFilled';\n      }\n    };\n    const getCardTitle = (status) => {\n      switch (status) {\n        case 'success':\n          return 'æ—¥ç¨‹æ“ä½œæˆåŠŸ';\n        case 'error':\n          return 'æ“ä½œå¤±è´¥';\n        case 'clarification':\n          return 'éœ€è¦ç¡®è®¤';\n        case 'deleted':\n          return 'æ—¥ç¨‹å·²åˆ é™¤';\n        default:\n          return 'æç¤ºä¿¡æ¯';\n      }\n    };\n    // ------------------------------------\n    \n    // å¯¼èˆªåˆ°å…¶ä»–æ¨¡å—\n    const navigateTo = (path) => {\n      // è·å–å½“å‰è·¯ç”±è·¯å¾„\n      const currentPath = window.location.pathname;\n      // å¦‚æœå·²ç»åœ¨æŒ‡å®šè·¯å¾„ï¼Œä¸è¿›è¡Œè·³è½¬\n      if (currentPath.includes(path)) return;\n      \n      // åœ¨åŒä¸€tabä¸­å¯¼èˆª\n      window.location.href = `/${path}`;\n    }\n\n    // è¿™ä¸ªæ–¹æ³•åœ¨welcome-messageä¸­ä½¿ç”¨\n    const navigateToModule = (path) => {\n      navigateTo(path);\n    }\n\n    // åˆ é™¤å•ä¸ªèŠå¤©ä¼šè¯\n    const deleteSession = async (sessionId) => {\n      try {\n        await ElMessageBox.confirm(\n          'ç¡®è®¤è¦åˆ é™¤è¿™æ¡å¯¹è¯è®°å½•å—ï¼Ÿ',\n          'æç¤º',\n          {\n            confirmButtonText: 'ç¡®è®¤',\n            cancelButtonText: 'å–æ¶ˆ',\n            type: 'info',\n          }\n        );\n        \n        await deleteAIChatSession(sessionId);\n        \n        // åˆ·æ–°ä¼šè¯åˆ—è¡¨\n        await fetchChatSessions();\n        \n        // æ— è®ºåˆ é™¤çš„æ˜¯ä¸æ˜¯å½“å‰ä¼šè¯ï¼Œéƒ½ç›´æ¥åˆ›å»ºæ–°ä¼šè¯\n        clearChat(); // æ¸…ç©ºå½“å‰ä¼šè¯ï¼Œåˆ›å»ºæ–°å¯¹è¯\n        ElMessage.success('å¯¹è¯å·²åˆ é™¤ï¼Œå·²åˆ›å»ºæ–°å¯¹è¯');\n      } catch (error) {\n        if (error !== 'cancel' && error !== 'close') {\n          console.error('åˆ é™¤èŠå¤©ä¼šè¯å¤±è´¥:', error);\n          ElMessage.error('åˆ é™¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');\n        }\n      }\n    }\n\n    // ç¡®è®¤æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•\n    const confirmClearAllHistory = () => {\n      ElMessageBox.confirm(\n        'ç¡®è®¤è¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚',\n        'è­¦å‘Š',\n        {\n          confirmButtonText: 'ç¡®è®¤',\n          cancelButtonText: 'å–æ¶ˆ',\n          type: 'warning',\n        }\n      )\n        .then(() => {\n          clearAllHistory();\n        })\n        .catch(() => {\n          // ç”¨æˆ·å–æ¶ˆï¼Œä¸åšä»»ä½•æ“ä½œ\n        });\n    }\n\n    // æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•\n    const clearAllHistory = async () => {\n      try {\n        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€\n        loading.value = true;\n        \n        for (const session of chatSessions.value) {\n          await deleteAIChatSession(session.id);\n        }\n        \n        // æ¸…ç©ºä¼šè¯åˆ—è¡¨\n        chatSessions.value = [];\n        \n        // æ¸…ç©ºå½“å‰ä¼šè¯ï¼Œåˆ›å»ºæ–°å¯¹è¯\n        clearChat();\n        \n        ElMessage.success('æ‰€æœ‰å†å²è®°å½•å·²æ¸…ç©ºï¼Œå·²åˆ›å»ºæ–°å¯¹è¯');\n      } catch (error) {\n        console.error('æ¸…ç©ºå†å²è®°å½•å¤±è´¥:', error);\n        ElMessage.error('æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');\n      } finally {\n        // å…³é—­åŠ è½½çŠ¶æ€\n        loading.value = false;\n      }\n    }\n\n    onMounted(() => {\n      document.body.addEventListener('click', function(e) {\n        if (e.target.classList && e.target.classList.contains('openwebui-copy-btn')) {\n          const codeId = e.target.getAttribute('data-clipboard-target').replace('#', '');\n          const codeElem = document.getElementById(codeId);\n          if (codeElem) {\n            navigator.clipboard.writeText(codeElem.innerText).then(() => {\n              e.target.innerText = 'å·²å¤åˆ¶';\n              setTimeout(() => { e.target.innerText = 'å¤åˆ¶'; }, 1200);\n            });\n          }\n        }\n      });\n      \n      // è·å–ç”¨æˆ·å¤´åƒ\n      getUserInfo();\n      \n      // è·å–èŠå¤©ä¼šè¯åˆ—è¡¨å¹¶åˆå§‹åŒ–ç•Œé¢\n      fetchChatSessions().then(() => {\n        // å¦‚æœæ²¡æœ‰å†å²ä¼šè¯ï¼Œç¡®ä¿æ˜¾ç¤ºæ–°å¯¹è¯ç•Œé¢\n        if (chatSessions.value.length === 0) {\n          clearChat();\n        }\n      });\n      \n      // æ·»åŠ é¡µé¢å¸è½½æ—¶çš„æ¸…ç†\n      window.addEventListener('beforeunload', () => {\n        if (currentRequestController.value) {\n          currentRequestController.value.abort();\n        }\n      });\n    });\n\n    // ç›‘æ§æ—¥å†åˆ·æ–°äº‹ä»¶\n    emitter.on('refreshCalendar', () => {\n      // å‡è®¾æ—¥å†æœ‰è‡ªå·±çš„åˆ·æ–°æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬è°ƒç”¨å®ƒ\n      // å¦‚æœæ—¥å†ç»„ä»¶æœ‰ref, å¯ä»¥æ˜¯ this.$refs.calendar.fetchEvents();\n      // æˆ–è€…å¦‚æœåˆ·æ–°é€»è¾‘åœ¨å½“å‰ç»„ä»¶å†…ï¼Œç›´æ¥è°ƒç”¨\n      console.log('æ”¶åˆ°æ—¥å†åˆ·æ–°äº‹ä»¶ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®...');\n      // ç¤ºä¾‹: findCalendarComponentAndRefresh();\n    });\n\n    // --- æ–°å¢ï¼šå¡ç‰‡æ“ä½œå‡½æ•° ---\n    const editEvent = async (msg) => {\n      if (!msg || !msg.event_id || msg.is_schedule !== true) {\n        ElMessage.error('æ— æ•ˆçš„æ—¥ç¨‹ä¿¡æ¯ï¼Œæ— æ³•ç¼–è¾‘');\n        return;\n      }\n      \n      try {\n        // è·å–äº‹ä»¶è¯¦æƒ…\n        const response = await getCalendarEvent(msg.event_id);\n        \n        if (!response || !response.data) {\n          ElMessage.error('æ— æ³•è·å–æ—¥ç¨‹è¯¦æƒ…ï¼Œè¯·ç¨åé‡è¯•');\n          return;\n        }\n        \n        // è®¾ç½®ç¼–è¾‘äº‹ä»¶æ•°æ®\n        editingEvent.value = {...response.data};\n        currentEditingMessage.value = msg;\n        \n        // æ˜¾ç¤ºç¼–è¾‘å¯¹è¯æ¡†\n        editEventDialogVisible.value = true;\n      } catch (error) {\n        console.error('è·å–æ—¥ç¨‹è¯¦æƒ…å‡ºé”™:', error);\n        ElMessage.error('è·å–æ—¥ç¨‹ä¿¡æ¯å¤±è´¥: ' + (error.response?.data?.message || error.message || 'æœªçŸ¥é”™è¯¯'));\n      }\n    };\n\n    // ä¿å­˜ç¼–è¾‘åçš„äº‹ä»¶\n    const saveEditEvent = async () => {\n      if (!editingEvent.value || !currentEditingMessage.value) {\n        ElMessage.error('ç¼–è¾‘æ•°æ®æ— æ•ˆ');\n        return;\n      }\n      \n      // ç®€å•éªŒè¯\n      if (!editingEvent.value.title) {\n        ElMessage.warning('è¯·è¾“å…¥æ—¥ç¨‹æ ‡é¢˜');\n        return;\n      }\n      \n      // ç»„è£…æ›´æ–°æ•°æ®\n      const updateData = {\n        title: editingEvent.value.title,\n        start: editingEvent.value.start,\n        end: editingEvent.value.end,\n        location: editingEvent.value.location || '',\n        description: editingEvent.value.description || '',\n        type: editingEvent.value.type,\n        reminder: editingEvent.value.reminder || 'none'\n      };\n      \n      try {\n        // è°ƒç”¨æ›´æ–°API\n        await updateEvent(editingEvent.value.id, updateData);\n        \n        // æ›´æ–°æ¶ˆæ¯å¡ç‰‡å†…å®¹\n        if (currentEditingMessage.value) {\n          const title = editingEvent.value.title;\n          const start = formatISODate(editingEvent.value.start);\n          const end = formatISODate(editingEvent.value.end);\n          const location = editingEvent.value.location;\n          \n          let content = `å·²æˆåŠŸæ›´æ–°æ—¥ç¨‹ï¼š**${title}**\\n\\n`;\n          content += `- **æ—¶é—´**: ${start} - ${end}\\n`;\n          if (location) content += `- **åœ°ç‚¹**: ${location}\\n`;\n          \n          currentEditingMessage.value.content = marked.parse(content);\n          currentEditingMessage.value.status = 'success';\n        }\n        \n        // è§¦å‘æ—¥å†åˆ·æ–°äº‹ä»¶\n        emitter.emit('refreshCalendar');\n        \n        ElMessage.success('æ—¥ç¨‹å·²æˆåŠŸæ›´æ–°ï¼');\n        \n        // å…³é—­å¯¹è¯æ¡†\n        editEventDialogVisible.value = false;\n      } catch (error) {\n        console.error('æ›´æ–°æ—¥ç¨‹å¤±è´¥:', error);\n        ElMessage.error('æ›´æ–°å¤±è´¥: ' + (error.response?.data?.message || error.message || 'æœªçŸ¥é”™è¯¯'));\n      }\n    };\n\n    // ä»å¡ç‰‡ä¸­åˆ é™¤æ—¥ç¨‹\n    const deleteEventFromCard = async (eventId) => {\n      if (!eventId) {\n        ElMessage.error('æ— æ³•åˆ é™¤ï¼šç¼ºå°‘äº‹ä»¶ID');\n        return;\n      }\n      \n      try {\n        await ElMessageBox.confirm(\n          'æ‚¨ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ—¥ç¨‹å—ï¼Ÿ',\n          'æç¤º',\n          {\n            confirmButtonText: 'ç¡®è®¤åˆ é™¤',\n            cancelButtonText: 'å–æ¶ˆ',\n            type: 'warning'\n          }\n        );\n        \n        // è°ƒç”¨åˆ é™¤API\n        await deleteCalendarEvent(eventId);\n        \n        // æ‰¾åˆ°åŒ…å«è¿™ä¸ªäº‹ä»¶IDçš„å¡ç‰‡æ¶ˆæ¯\n        const eventMsg = messages.value.find(msg => \n          msg.type === 'card' && msg.event_id === eventId && msg.is_schedule === true\n        );\n        \n        if (eventMsg) {\n          // è·å–äº‹ä»¶æ ‡é¢˜\n          const titleMatch = eventMsg.content.match(/\\*\\*([^*]+)\\*\\*/);\n          const eventTitle = titleMatch ? titleMatch[1] : 'å¼€ä¼š';\n          \n          // æ›´æ–°å¡ç‰‡æ˜¾ç¤ºä¸ºå·²åˆ é™¤ï¼Œä½†ä½¿ç”¨ç®€æ´çš„ç¡®è®¤æ¶ˆæ¯\n          eventMsg.status = 'deleted';\n          eventMsg.content = `å¥½çš„ï¼Œåä¸º\"${eventTitle}\"çš„äº‹ä»¶å·²æˆåŠŸåˆ é™¤ã€‚`;\n        }\n        \n        // è§¦å‘æ—¥å†åˆ·æ–°äº‹ä»¶\n        emitter.emit('refreshCalendar');\n        \n        ElMessage.success('æ—¥ç¨‹å·²åˆ é™¤');\n      } catch (error) {\n        if (error === 'cancel') return;\n        \n        if (error.response?.status === 404) {\n          ElMessage.error('æ“ä½œå¤±è´¥ï¼šè¯¥æ—¥ç¨‹å·²è¢«åˆ é™¤æˆ–ä¸å­˜åœ¨ã€‚');\n        } else {\n          console.error(\"ä»å¡ç‰‡åˆ é™¤æ—¥ç¨‹æ—¶å‡ºé”™:\", error);\n          ElMessage.error('åˆ é™¤å¤±è´¥ï¼š' + (error.response?.data?.message || error.message || 'æœªçŸ¥é”™è¯¯'));\n        }\n      }\n    };\n    \n    // æ›´æ–°å¡ç‰‡æ˜¾ç¤º\n    const updateCardDisplay = (msg, title, description) => {\n      // æ„å»ºæ–°çš„å¡ç‰‡å†…å®¹\n      const eventDate = new Date();\n      const dateStr = `${eventDate.getFullYear()}å¹´${eventDate.getMonth() + 1}æœˆ${eventDate.getDate()}æ—¥`;\n      let content = `å·²æˆåŠŸæ›´æ–°æ—¥ç¨‹ï¼š**${title}**\\n\\n`;\n      content += `æ—¥æœŸï¼š${dateStr}\\n\\n`;\n      if (description) {\n        content += `æè¿°ï¼š${description}\\n\\n`;\n      }\n      content += `æ‚¨å¯ä»¥åœ¨æ—¥å†ä¸­æŸ¥çœ‹å®Œæ•´è¯¦æƒ…ã€‚`;\n      \n      // æ›´æ–°å¡ç‰‡å†…å®¹\n      msg.content = marked.parse(content);\n      \n      // ç¡®ä¿å¡ç‰‡çŠ¶æ€ä¸ºæˆåŠŸ\n      msg.status = 'success';\n      \n      // å¼ºåˆ¶é‡æ–°æ¸²æŸ“å¡ç‰‡\n      nextTick(() => {\n        const cardElement = document.querySelector(`.openwebui-card-message[data-event-id=\"${msg.event_id}\"]`);\n        if (cardElement) {\n          cardElement.classList.remove('clarification-card', 'error-card', 'deleted-card');\n          cardElement.classList.add('success-card');\n        }\n      });\n    };\n    \n    // ä¸ºæ—¥æœŸé€‰æ‹©å™¨æ ¼å¼åŒ–æ—¥æœŸ (ä¿ç•™æ­¤å‡½æ•°ä»¥å…¼å®¹å…¶ä»–åœ°æ–¹çš„è°ƒç”¨)\n    const formatDateForPicker = (date) => {\n      if (!date) return '';\n      \n      try {\n        // ç¡®ä¿ä½¿ç”¨æœ‰æ•ˆçš„Dateå¯¹è±¡\n        let dateObj;\n        if (date instanceof Date) {\n          if (isNaN(date.getTime())) {\n            console.error('æ— æ•ˆæ—¥æœŸå¯¹è±¡', date);\n            dateObj = new Date(); // ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºå›é€€\n          } else {\n            dateObj = date;\n          }\n        } else {\n          // å°è¯•è§£æå­—ç¬¦ä¸²æ—¥æœŸ\n          dateObj = new Date(date);\n          if (isNaN(dateObj.getTime())) {\n            console.error('æ— æ•ˆæ—¥æœŸå­—ç¬¦ä¸²', date);\n            dateObj = new Date(); // ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºå›é€€\n          }\n        }\n      \n        // ä½¿ç”¨ç›´æ¥è·å–å¹´æœˆæ—¥æ—¶åˆ†çš„æ–¹å¼ï¼Œä¸æ¶‰åŠæ—¶åŒºè½¬æ¢\n        const year = dateObj.getFullYear();\n        const month = (dateObj.getMonth() + 1).toString().padStart(2, '0');\n        const day = dateObj.getDate().toString().padStart(2, '0');\n        const hours = dateObj.getHours().toString().padStart(2, '0');\n        const minutes = dateObj.getMinutes().toString().padStart(2, '0');\n        \n        const formatted = `${year}-${month}-${day} ${hours}:${minutes}`;\n        return formatted;\n      } catch (error) {\n        console.error('æ—¥æœŸæ ¼å¼åŒ–é”™è¯¯:', error);\n        // è¿”å›å½“å‰æ—¶é—´ä½œä¸ºå›é€€é€‰é¡¹\n        const now = new Date();\n        return `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;\n      }\n    };\n\n    return {\n      input, \n      messages, \n      sendMsg, \n      chatBody, \n      fileInput,\n      triggerFileInput, \n      handleFileUpload, \n      selectedFiles, \n      removeFile, \n      UploadFilled, \n      Document, \n      Close, \n      Check,\n      loading, \n      processingFiles,\n      clearChat,\n      showContextBar,\n      chatId,\n      userAvatarUrl,\n      handleAvatarError,\n      searchMethod,\n      chatMode,\n      retrievalScope,\n      // å³ä¾§é¢æ¿ç›¸å…³\n      rightPanelCollapsed,\n      chatSessions,\n      switchChatSession,\n      formatTime,\n      navigateTo,\n      navigateToModule,\n      // å›¾æ ‡ç»„ä»¶\n      Calendar, \n      ChatDotRound, \n      Collection, \n      DocumentCopy,\n      Grid,\n      Connection,\n      deleteSession,\n      confirmClearAllHistory,\n      clearAllHistory,\n      getCardClass,\n      getCardIcon,\n      getCardTitle,\n      editEvent,\n      deleteEventFromCard,\n      editEventDialogVisible,\n      editingEvent,\n      saveEditEvent,\n      // æ·»åŠ è¿™ä¸¤ä¸ªå‡½æ•°ä»¥è§£å†³ESLintè­¦å‘Š\n      updateCardDisplay,\n      formatDateForPicker,\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.dashboard-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.openwebui-chat-root {\n  width: 100%;\n  height: 100%;\n  min-height: 0;\n  min-width: 0;\n  background: var(--bg-color);\n  display: flex;\n  align-items: stretch;\n  justify-content: stretch;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n}\n\n.openwebui-chat-window {\n  width: 100%;\n  height: 100%;\n  min-height: 0;\n  background: var(--bg-color);\n  border-radius: 0;\n  box-shadow: none;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  margin: 0;\n}\n\n.openwebui-chat-header {\n  height: 56px;\n  background: var(--bg-color-secondary);\n  display: flex;\n  align-items: center;\n  padding: 0 24px;\n  font-size: 18px;\n  font-weight: 600;\n  border-bottom: 1px solid var(--border-color);\n  flex-shrink: 0;\n  justify-content: space-between;\n  color: var(--text-color);\n}\n\n.header-center-controls {\n  display: flex;\n  gap: 16px;\n  align-items: center;\n}\n\n.openwebui-title {\n  color: var(--primary-color);\n}\n\n.clear-chat-btn {\n  color: var(--text-color-secondary);\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 14px;\n  font-weight: normal;\n}\n\n.clear-chat-btn:hover {\n  color: var(--primary-color);\n}\n\n.openwebui-file-preview-bar {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  gap: 12px;\n  padding: 12px 0 8px 0;\n  background: transparent;\n  border-bottom: none;\n  overflow-x: auto;\n  min-height: 64px;\n  z-index: 3;\n}\n\n.openwebui-file-card {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  background: var(--bg-color-secondary);\n  border-radius: 14px;\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.04);\n  padding: 8px 16px 8px 8px;\n  min-width: 160px;\n  max-width: 240px;\n  position: relative;\n  color: var(--text-color);\n}\n\n.openwebui-file-thumb {\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  background: var(--bg-color-tertiary);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  margin-right: 10px;\n}\n\n.openwebui-file-img {\n  width: 40px;\n  height: 40px;\n  object-fit: cover;\n  border-radius: 8px;\n}\n\n.openwebui-file-icon {\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #fff;\n  font-size: 22px;\n}\n\n.openwebui-file-info {\n  flex: 1;\n  min-width: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.openwebui-file-name {\n  font-size: 14px;\n  color: var(--text-color);\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 120px;\n}\n\n.openwebui-file-meta {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n  margin-top: 2px;\n}\n\n.openwebui-file-progress {\n  margin-top: 4px;\n  width: 100%;\n}\n\n.openwebui-file-status.completed {\n  color: var(--success-color);\n}\n\n.openwebui-file-remove {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  color: var(--text-color-tertiary);\n  font-size: 16px;\n  cursor: pointer;\n  transition: color 0.2s;\n}\n\n.openwebui-file-remove:hover {\n  color: var(--error-color);\n}\n\n.openwebui-chat-container {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  position: relative;\n}\n\n.openwebui-chat-body {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0 16px 12px 16px;\n  background: var(--bg-color);\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  max-height: calc(100vh - 200px);\n  height: calc(100vh - 200px);\n  flex-shrink: 1;\n  scrollbar-width: thin;\n  width: auto;\n  transition: all 0.3s ease;\n}\n\n.openwebui-msg {\n  display: flex;\n  align-items: flex-end;\n  margin-bottom: 16px;\n  flex-direction: row;\n  justify-content: flex-start;\n}\n\n.openwebui-msg.user {\n  flex-direction: row-reverse;\n  justify-content: flex-end;\n  align-items: flex-end;\n  margin-left: auto;\n  margin-right: 0;\n}\n\n.openwebui-msg.assistant {\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: flex-end;\n  margin-right: auto;\n  margin-left: 0;\n}\n\n.openwebui-msg-bubble {\n  position: relative;\n  max-width: 90%;\n  padding: 12px 18px;\n  border-radius: 20px;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  box-shadow: 0 1px 2px rgba(0,0,0,0.05);\n  line-height: 1.6;\n}\n\n.openwebui-msg.user .openwebui-msg-bubble {\n  background: var(--primary-color);\n  color: #fff;\n  border-bottom-right-radius: 4px;\n  margin-right: 8px;\n  margin-left: auto;\n}\n\n.openwebui-msg.assistant .openwebui-msg-bubble {\n  background: var(--bg-color-secondary);\n  color: var(--text-color);\n  border-bottom-left-radius: 4px;\n  margin-left: 8px;\n  margin-right: auto;\n}\n\n.openwebui-avatar {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  margin-bottom: auto;\n}\n\n.left-avatar {\n  margin-right: 8px;\n}\n\n.right-avatar {\n  margin-left: 8px;\n}\n\n.user-avatar-img {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  object-fit: cover;\n  overflow: hidden;\n  display: block;\n  background-color: #f0f2f5;\n}\n\n.openwebui-user-label {\n  font-weight: bold;\n  margin-right: 4px;\n}\n\n.openwebui-ai-label {\n  font-weight: bold;\n  color: #2f54eb;\n  margin-right: 4px;\n}\n\n.openwebui-chat-footer {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  padding: 0 16px 12px 16px;\n  background: var(--bg-color);\n  border-top: 1px solid var(--border-color);\n  margin: 0;\n  flex-shrink: 0;\n  box-shadow: 0 -2px 16px 0 rgba(var(--primary-color-rgb),0.03);\n  z-index: 2;\n}\n\n.openwebui-input-area {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.openwebui-input {\n  flex: 1;\n  margin-right: 12px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n}\n\n.openwebui-send-btn {\n  min-width: 72px;\n  height: 40px;\n  font-size: 16px;\n  font-weight: 500;\n  border-radius: 8px;\n}\n\n.openwebui-upload-btn {\n  margin-right: 8px;\n  font-size: 20px;\n  background: var(--bg-color-tertiary);\n  border: 1px solid var(--border-color);\n  color: var(--primary-color);\n  cursor: pointer;\n  border-radius: 8px;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: border 0.2s, box-shadow 0.2s;\n}\n\n.openwebui-upload-btn:hover {\n  border: 1.5px solid var(--primary-color);\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.08);\n}\n\n.openwebui-img-preview {\n  max-width: 180px;\n  max-height: 120px;\n  border-radius: 8px;\n  display: block;\n  margin: 4px 0;\n  box-shadow: 0 2px 8px rgba(47,84,235,0.08);\n}\n\n.openwebui-file-link {\n  color: var(--primary-color);\n  text-decoration: underline;\n  word-break: break-all;\n}\n\n.openwebui-cursor {\n  display: inline-block;\n  width: 8px;\n  height: 16px;\n  background: var(--primary-color);\n  margin-left: 2px;\n  vertical-align: middle;\n  animation: blink 0.8s infinite;\n}\n\n@keyframes blink {\n  0% { opacity: 1; }\n  50% { opacity: 0; }\n  100% { opacity: 1; }\n}\n\n.file-bubble-nest {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n\n.file-bubble-vertical {\n  justify-content: flex-start;\n  align-items: flex-start;\n}\n\n.file-message-card {\n  display: flex;\n  align-items: center;\n  background: var(--bg-color-secondary);\n  border-radius: 12px;\n  padding: 8px 16px;\n  margin-bottom: 0;\n  min-width: 180px;\n  max-width: 320px;\n  box-shadow: 0 2px 8px rgba(var(--primary-color-rgb),0.04);\n  color: var(--text-color);\n}\n\n.file-icon-area {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 12px;\n}\n\n.file-icon-img {\n  width: 32px;\n  height: 32px;\n}\n\n.file-info-area {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.file-name {\n  font-size: 15px;\n  font-weight: 500;\n  color: var(--text-color);\n  margin-bottom: 2px;\n  word-break: break-all;\n}\n\n.file-meta {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n}\n\n.file-desc-text {\n  margin-top: 8px;\n  font-size: 15px;\n  color: var(--text-color);\n  background: transparent;\n  border-radius: 8px;\n  padding: 0 2px;\n  display: inline-block;\n  word-break: break-all;\n}\n\n.openwebui-context-bar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 24px;\n  background-color: var(--bg-color-tertiary);\n  border-bottom: 1px solid var(--border-color);\n  font-size: 14px;\n  color: var(--text-color-secondary);\n}\n\n.context-info {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.context-icon {\n  color: var(--primary-color);\n  font-size: 16px;\n}\n\n.source-tag {\n  font-size: 10px;\n  color: #888;\n  margin-top: 8px;\n  display: inline-flex;\n  align-items: center;\n  padding: 2px 6px;\n  border-radius: 4px;\n  .el-icon {\n    margin-right: 4px;\n  }\n}\n\n.knowledge-base-tag {\n  background-color: #e8f5e9; /* Light green */\n  color: #2e7d32;\n}\n\n.general-ai-tag {\n  background-color: #e3f2fd; /* Light blue */\n  color: #1565c0;\n}\n\n/* å³ä¾§é¢æ¿æ ·å¼ */\n.openwebui-right-panel {\n  width: 320px;\n  height: 100%;\n  background: var(--el-bg-color-page);\n  border-left: 1px solid var(--el-border-color);\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s ease;\n  overflow: hidden;\n}\n\n.openwebui-right-panel.collapsed {\n  width: 50px;\n}\n\n.right-panel-header {\n  padding: 12px 16px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid var(--el-border-color);\n  background-color: var(--el-bg-color);\n}\n\n.right-panel-mode-controls {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  overflow: hidden;\n  transition: opacity 0.3s;\n}\n\n.collapsed .right-panel-mode-controls {\n  opacity: 0;\n  width: 0;\n  pointer-events: none;\n}\n\n.collapse-button {\n  margin-left: 8px;\n  background-color: var(--bg-color);\n  border: 1px solid var(--border-color);\n  color: var(--text-color);\n  transition: all 0.2s ease;\n}\n\n.collapse-button:hover {\n  border-color: var(--primary-color);\n  color: var(--primary-color);\n  transform: scale(1.1);\n  box-shadow: 0 0 8px rgba(var(--primary-color-rgb), 0.2);\n}\n\n.collapsed .collapse-button {\n  margin-left: 0;\n}\n\n.history-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0 16px 16px;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  background-color: var(--el-bg-color-page);\n}\n\n.history-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n  padding: 16px 0 8px;\n  border-bottom: none;\n}\n\n.history-title {\n  font-size: 15px;\n  margin: 0;\n  color: var(--el-text-color-regular);\n  transition: opacity 0.2s;\n  line-height: 1.2;\n  font-weight: 500;\n}\n\n.clear-all-btn {\n  padding: 4px 12px;\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  border-radius: 4px;\n}\n\n.clear-all-btn:hover {\n  background-color: var(--el-color-danger-light-9);\n  color: var(--el-color-danger);\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  padding: 0 4px;\n}\n\n.history-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-radius: 18px;\n  background: var(--el-bg-color);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  overflow: hidden;\n  margin-bottom: 8px;\n  border: 1px solid var(--el-border-color-lighter);\n  box-shadow: none;\n}\n\n.history-item:hover {\n  background: var(--el-bg-color-page);\n  border-color: var(--el-border-color);\n  box-shadow: var(--el-box-shadow-light);\n}\n\n.history-item.active {\n  background: var(--el-color-primary);\n  color: white;\n  border-color: var(--el-color-primary);\n}\n\n.history-item-content {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  overflow: hidden;\n  min-width: 0;\n}\n\n.history-item-icon {\n  min-width: 28px;\n  height: 28px;\n  border-radius: 50%;\n  background-color: var(--el-color-primary-light-9);\n  margin-right: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--el-color-primary);\n  font-size: 14px;\n}\n\n.history-item.active .history-item-icon {\n  background-color: rgba(255, 255, 255, 0.2);\n  color: white;\n}\n\n.history-item-info {\n  flex: 1;\n  min-width: 0;\n  overflow: hidden;\n}\n\n.history-item-title {\n  font-size: 14.5px;\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 4px;\n  color: var(--el-text-color-primary);\n}\n\n.history-item-time {\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n}\n\n.history-item.active .history-item-time {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.history-item-actions {\n  opacity: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: 8px;\n}\n\n.delete-btn-wrapper {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background-color: rgba(245, 108, 108, 0.08);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  border: none;\n}\n\n.delete-btn-wrapper:hover {\n  background-color: rgba(245, 108, 108, 0.15);\n}\n\n.delete-icon {\n  font-size: 17px;\n  color: var(--el-color-danger);\n  transition: all 0.2s ease;\n}\n\n.history-empty {\n  text-align: center;\n  padding: 30px 0;\n  color: var(--el-text-color-secondary);\n  font-size: 14px;\n  font-style: normal;\n}\n\n.collapsed .history-item {\n  justify-content: center;\n  padding: 10px 0;\n}\n\n.collapsed .history-item-icon {\n  margin-right: 0;\n}\n\n.collapsed .history-item-info,\n.collapsed .history-item-actions {\n  display: none;\n}\n\n.collapsed .history-title {\n  opacity: 0;\n  height: 0;\n  margin: 0;\n  padding: 0;\n}\n\n.collapsed .history-container {\n  display: none;\n}\n\n.collapsed .right-panel-header {\n  justify-content: center;\n  padding-left: 0;\n  padding-right: 0;\n  border-bottom-color: transparent;\n}\n\n/* æ–°å¢å¡ç‰‡æ¶ˆæ¯æ ·å¼ */\n.openwebui-card-message {\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  padding: 8px; /* å‡å°å†…è¾¹è·ï¼Œè®©å¡ç‰‡æ›´ç´§å‡‘ */\n  width: 100%; /* ç¡®ä¿å¡ç‰‡å¡«æ»¡æ°”æ³¡ */\n}\n\n.card-icon-wrapper {\n  font-size: 24px;\n  margin-top: 2px;\n}\n\n.card-content-wrapper {\n  flex: 1;\n  text-align: left;\n}\n\n.card-title {\n  font-weight: bold;\n  font-size: 16px;\n  margin-bottom: 4px;\n}\n\n.card-body {\n  font-size: 14px;\n  line-height: 1.5;\n  // ç¡®ä¿æ¢è¡Œç¬¦ç”Ÿæ•ˆ\n  white-space: pre-wrap;\n  :deep(p) {\n    margin: 0;\n  }\n}\n\n/* æ–°å¢ï¼šå¡ç‰‡æ“ä½œåŒºåŸŸæ ·å¼ */\n.card-actions {\n  margin-top: 12px;\n  padding-top: 10px;\n  border-top: 1px solid var(--border-color);\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n/* æ ¹æ®çŠ¶æ€è®¾ç½®ä¸åŒé¢œè‰² */\n.success-card .card-icon-wrapper {\n  color: #67c23a; /* Element Plus æˆåŠŸè‰² */\n}\n.success-card .card-title {\n  color: #67c23a;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .success-card {\n  border-left: 4px solid #67c23a;\n}\n\n.clarification-card .card-icon-wrapper {\n  color: #e6a23c; /* Element Plus è­¦å‘Šè‰² */\n}\n.clarification-card .card-title {\n  color: #e6a23c;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .clarification-card {\n  border-left: 4px solid #e6a23c;\n}\n\n.error-card .card-icon-wrapper {\n  color: #f56c6c; /* Element Plus å±é™©è‰² */\n}\n.error-card .card-title {\n  color: #f56c6c;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .error-card {\n  border-left: 4px solid #f56c6c;\n}\n\n.deleted-card .card-icon-wrapper {\n  color: #909399; /* Element Plus ç°è‰² */\n}\n.deleted-card .card-title {\n  color: #909399;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .deleted-card {\n  border-left: 4px solid #909399;\n}\n</style>\n\n<style>\n.openwebui-md-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin: 8px 0;\n  background: var(--bg-color-secondary);\n  font-size: 15px;\n}\n.openwebui-md-table th, .openwebui-md-table td {\n  border: 1px solid var(--border-color);\n  padding: 6px 12px;\n  text-align: left;\n  color: var(--text-color);\n  background: var(--bg-color-secondary);\n}\n.openwebui-md-table th {\n  background: var(--bg-color-tertiary);\n  font-weight: 600;\n  color: var(--text-color-secondary);\n}\n/* ä»£ç å—ç¾åŒ–å’Œå¤åˆ¶æŒ‰é’® */\n.openwebui-md-code-block-beauty {\n  position: relative;\n  background: var(--bg-color-tertiary);\n  border-radius: 12px;\n  margin: 18px 0;\n  box-shadow: 0 4px 16px var(--shadow-color);\n  overflow: hidden;\n  border: 1px solid var(--border-color);\n}\n.openwebui-md-code-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: var(--bg-color-secondary);\n  border-bottom: 1px solid var(--border-color);\n  height: 36px;\n  padding: 0 14px;\n}\n.openwebui-md-code-lang {\n  font-size: 13px;\n  color: var(--text-color-tertiary);\n  font-family: 'JetBrains Mono', 'Fira Mono', 'Consolas', monospace;\n  user-select: none;\n}\n.openwebui-copy-btn {\n  background: var(--bg-color-tertiary);\n  border: 1px solid var(--border-color);\n  color: var(--primary-color);\n  border-radius: 6px;\n  font-size: 13px;\n  padding: 2px 12px;\n  cursor: pointer;\n  z-index: 2;\n  transition: background 0.2s, border 0.2s, color 0.2s;\n  outline: none;\n  margin-left: 8px;\n}\n.openwebui-copy-btn:hover {\n  background: var(--primary-color);\n  color: #fff;\n  border: 1px solid var(--primary-color);\n}\n.openwebui-md-pre {\n  margin: 0;\n  padding: 16px 18px;\n  background: var(--bg-color-tertiary);\n  border-radius: 0 0 12px 12px;\n  overflow-x: auto;\n  font-family: 'JetBrains Mono', 'Fira Mono', 'Consolas', monospace;\n  font-size: 15px;\n  line-height: 1.7;\n  color: var(--text-color);\n  min-height: 40px;\n}\n@media (max-width: 600px) {\n  .openwebui-md-pre {\n    font-size: 13px;\n    padding: 12px 6px;\n  }\n  .openwebui-md-code-block-beauty {\n    margin: 12px 0;\n  }\n}\n</style>\n\n<style>\n.openwebui-footer-hint {\n  font-size: 12px;\n  color: var(--text-color-secondary);\n  text-align: center;\n  padding-top: 8px;\n  user-select: none;\n  width: 100%;\n}\n</style>\n\n<style>\n.openwebui-upload-tooltip {\n  max-width: 300px !important;\n  background: var(--bg-color-secondary) !important;\n  color: var(--text-color) !important;\n  border: 1px solid var(--primary-color) !important;\n  border-radius: 8px !important;\n  box-shadow: 0 4px 12px rgba(var(--primary-color-rgb), 0.2) !important;\n  padding: 10px 14px !important;\n  font-size: 13px !important;\n  line-height: 1.6 !important;\n  white-space: pre-wrap; /* For newline in content */\n}\n\n.openwebui-upload-tooltip .el-popper__arrow::before {\n  border-color: var(--primary-color) !important;\n  background: var(--bg-color-secondary) !important;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.openwebui-options-area {\n  display: flex;\n  justify-content: center;\n  padding-top: 8px;\n}\n</style>\n\n<style>\n/* å¯¼èˆªå¡ç‰‡æ ·å¼ */\n.welcome-message {\n  margin-bottom: 24px;\n  padding: 8px;\n  border-radius: 12px;\n  background-color: var(--el-bg-color);\n}\n\n.welcome-message h3 {\n  margin-bottom: 12px;\n  font-size: 22px;\n  font-weight: 600;\n  color: var(--el-text-color-primary);\n  text-align: center;\n}\n\n.platform-intro {\n  background-color: var(--el-bg-color-page);\n  border-radius: 8px;\n  padding: 12px 16px;\n  margin-bottom: 18px;\n  border-left: 4px solid var(--el-color-primary);\n}\n\n.platform-intro p {\n  margin: 0;\n  color: var(--el-text-color-regular);\n  font-size: 14.5px;\n  line-height: 1.6;\n  text-align: left;\n}\n\n.welcome-message p {\n  margin-bottom: 22px;\n  color: var(--el-text-color-regular);\n  font-size: 15px;\n  text-align: center;\n}\n\n.quick-nav-cards {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 16px;\n  margin-top: 15px;\n}\n\n.nav-card {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 16px;\n  background-color: var(--el-bg-color-overlay);\n  border-radius: 12px;\n  border: 1px solid var(--el-border-color-lighter);\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\n  box-shadow: var(--el-box-shadow-lighter);\n  position: relative;\n  overflow: hidden;\n}\n\n.nav-card:hover {\n  background-color: var(--el-color-primary-light-9);\n  border-color: var(--el-color-primary-light-5);\n  transform: translateY(-3px);\n  box-shadow: var(--el-box-shadow-light);\n}\n\nbody[data-theme=\"dark\"] .nav-card:hover {\n  background-color: var(--el-color-primary-dark-2);\n}\n\n.nav-card:hover .nav-card-arrow {\n  opacity: 1;\n  transform: translateX(0);\n}\n\n.nav-card-icon {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 46px;\n  height: 46px;\n  font-size: 22px;\n  margin-right: 12px;\n  color: #ffffff;\n  background-color: var(--el-color-primary);\n  border-radius: 10px;\n  box-shadow: 0 2px 6px rgba(64, 158, 255, 0.25);\n  transition: all 0.3s ease;\n}\n\n.nav-card:hover .nav-card-icon {\n  transform: scale(1.1);\n}\n\n.nav-card-icon .el-icon,\n.nav-card-icon .bi {\n  font-size: 22px;\n}\n\n.nav-card:nth-child(2) .nav-card-icon {\n  background-color: #67C23A;\n  box-shadow: 0 2px 6px rgba(103, 194, 58, 0.25);\n}\n\n.nav-card:nth-child(3) .nav-card-icon {\n  background-color: #E6A23C;\n  box-shadow: 0 2px 6px rgba(230, 162, 60, 0.25);\n}\n\n.nav-card:nth-child(4) .nav-card-icon {\n  background-color: #F56C6C;\n  box-shadow: 0 2px 6px rgba(245, 108, 108, 0.25);\n}\n\n.nav-card:nth-child(5) .nav-card-icon {\n  background-color: #909399;\n  box-shadow: 0 2px 6px rgba(144, 147, 153, 0.25);\n}\n\n.nav-card:nth-child(6) .nav-card-icon {\n  background-color: #9c27b0;\n  box-shadow: 0 2px 6px rgba(156, 39, 176, 0.25);\n}\n\n.nav-card-content {\n  flex: 1;\n}\n\n.nav-card-title {\n  font-weight: 600;\n  font-size: 15px;\n  margin-bottom: 4px;\n  color: var(--el-text-color-primary);\n}\n\n.nav-card-desc {\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n  line-height: 1.4;\n}\n\n.nav-card-arrow {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transform: translateX(10px);\n  transition: all 0.3s ease;\n  color: var(--el-color-primary);\n  font-weight: bold;\n  font-size: 18px;\n  margin-left: 5px;\n}\n\n.nav-arrow-icon {\n  font-style: normal;\n}\n\n/* å“åº”å¼å¸ƒå±€ */\n@media (max-width: 768px) {\n  .quick-nav-cards {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 12px;\n  }\n  \n  .nav-card {\n    padding: 12px;\n    flex-direction: column;\n    text-align: center;\n  }\n  \n  .nav-card-icon {\n    margin-right: 0;\n    margin-bottom: 10px;\n    width: 42px;\n    height: 42px;\n  }\n  \n  .nav-card-title {\n    margin-bottom: 4px;\n  }\n  \n  .nav-card-arrow {\n    position: absolute;\n    top: 8px;\n    right: 8px;\n    font-size: 14px;\n  }\n}\n\n@media (max-width: 480px) {\n  .welcome-message h3 {\n    font-size: 18px;\n  }\n  \n  .welcome-message p {\n    font-size: 14px;\n    margin-bottom: 16px;\n  }\n  \n  .quick-nav-cards {\n    grid-template-columns: 1fr;\n    gap: 10px;\n  }\n  \n  .nav-card {\n    flex-direction: row;\n    text-align: left;\n    padding: 12px;\n  }\n  \n  .nav-card-icon {\n    margin-right: 12px;\n    margin-bottom: 0;\n  }\n}\n\n/* æ›´æ–°å¹³å°ä»‹ç»æ ·å¼ */\n.platform-intro {\n  background-color: var(--el-bg-color-page);\n  border-radius: 12px;\n  padding: 16px 20px;\n  margin-bottom: 22px;\n  border-left: 4px solid var(--el-color-primary);\n  box-shadow: var(--el-box-shadow-lighter);\n}\n\n.platform-intro p {\n  margin: 0 0 12px;\n  color: var(--el-text-color-regular);\n  font-size: 14.5px;\n  line-height: 1.6;\n}\n\n.platform-intro p:last-child {\n  margin-bottom: 0;\n  font-style: italic;\n  color: #606266;\n}\n\n.platform-features {\n  padding-left: 18px;\n  margin: 12px 0 14px;\n  list-style-type: none;\n}\n\n.platform-features li {\n  position: relative;\n  padding-left: 8px;\n  margin-bottom: 10px;\n  font-size: 14px;\n  color: #454b54;\n  line-height: 1.5;\n}\n\n.platform-features li::before {\n  content: \"â€¢\";\n  position: absolute;\n  left: -12px;\n  color: #409EFF;\n  font-weight: bold;\n}\n\n.feature-highlight {\n  font-weight: 600;\n  color: #303133;\n}\n\n/* ä¿®æ”¹ä¸€ä¸‹welcome-messageæ ·å¼ */\n.welcome-message h3 {\n  margin-bottom: 16px;\n  font-size: 22px;\n  font-weight: 600;\n  color: #303133;\n  text-align: center;\n}\n\n.welcome-message > p {\n  margin-bottom: 22px;\n  color: #606266;\n  font-size: 15px;\n  text-align: center;\n}\n</style> \n\n<!-- æ·»åŠ äº‹ä»¶ç¼–è¾‘è¡¨å•æ ·å¼ -->\n<style>\n.event-edit-dialog .el-message-box__input {\n  padding: 0;\n}\n\n.event-edit-dialog .el-message-box__input input {\n  display: none;\n}\n\n.event-edit-form {\n  padding: 10px 0;\n}\n\n.event-edit-form .form-group {\n  margin-bottom: 15px;\n}\n\n.event-edit-form label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: 500;\n  color: var(--text-color);\n}\n\n.event-edit-form .form-control {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  background-color: var(--bg-color);\n  color: var(--text-color);\n  font-size: 14px;\n  transition: border-color 0.2s;\n}\n\n.event-edit-form .form-control:focus {\n  border-color: var(--primary-color);\n  outline: none;\n}\n\n.event-edit-form textarea.form-control {\n  min-height: 80px;\n  resize: vertical;\n}\n\n.event-edit-form select.form-control {\n  appearance: auto;\n  height: 38px;\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\");\n  background-position: right 0.5rem center;\n  background-repeat: no-repeat;\n  background-size: 1.5em 1.5em;\n  padding-right: 2.5rem;\n  -webkit-print-color-adjust: exact;\n  print-color-adjust: exact;\n}\n\n/* å¢åŠ å¯¹è¯æ¡†å®½åº¦ */\n.event-edit-dialog .el-message-box {\n  width: 400px;\n  max-width: 95vw;\n}\n\n/* æš—è‰²ä¸»é¢˜é€‚é… */\nbody[data-theme=\"dark\"] .event-edit-form .form-control {\n  background-color: var(--bg-color-secondary);\n  border-color: var(--border-color);\n  color: var(--text-color);\n}\n\nbody[data-theme=\"dark\"] .event-edit-form label {\n  color: var(--text-color-secondary);\n}\n\n/* ä¿®å¤datetime-localè¾“å…¥æ¡†æ ·å¼ */\n.event-edit-form input[type=\"datetime-local\"] {\n  padding-right: 0.75rem;\n}\n\n/* ç¡®ä¿è¡¨å•åœ¨ä¸åŒæµè§ˆå™¨ä¸­æ­£å¸¸æ˜¾ç¤º */\n@supports (-moz-appearance: none) {\n  .event-edit-form select.form-control {\n    padding-right: 2rem;\n    background-image: none;\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n// ... existing code ...\n\n/* å¡ç‰‡æ¶ˆæ¯æ ·å¼ */\n.openwebui-card-message {\n  padding: 12px;\n  border-radius: 8px;\n  background-color: var(--bg-color-secondary);\n  display: flex;\n  align-items: flex-start;\n  margin-bottom: 8px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n  transition: all 0.3s ease;\n}\n\n.openwebui-card-message:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n.card-icon-wrapper {\n  margin-right: 12px;\n  font-size: 20px;\n  padding-top: 2px;\n}\n\n.card-content-wrapper {\n  flex: 1;\n}\n\n.card-title {\n  font-size: 16px;\n  font-weight: 500;\n  margin-bottom: 8px;\n}\n\n.card-body {\n  font-size: 14px;\n  color: var(--text-color);\n  line-height: 1.5;\n}\n\n.card-actions {\n  margin-top: 12px;\n  display: flex;\n  gap: 8px;\n}\n\n/* æ ¹æ®çŠ¶æ€è®¾ç½®ä¸åŒé¢œè‰² */\n.success-card .card-icon-wrapper {\n  color: #67c23a; /* Element Plus æˆåŠŸè‰² */\n}\n.success-card .card-title {\n  color: #67c23a;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .success-card {\n  border-left: 4px solid #67c23a;\n}\n\n.clarification-card .card-icon-wrapper {\n  color: #e6a23c; /* Element Plus è­¦å‘Šè‰² */\n}\n.clarification-card .card-title {\n  color: #e6a23c;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .clarification-card {\n  border-left: 4px solid #e6a23c;\n}\n\n.error-card .card-icon-wrapper {\n  color: #f56c6c; /* Element Plus å±é™©è‰² */\n}\n.error-card .card-title {\n  color: #f56c6c;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .error-card {\n  border-left: 4px solid #f56c6c;\n}\n\n.deleted-card .card-icon-wrapper {\n  color: #909399; /* Element Plus ç°è‰² */\n}\n.deleted-card .card-title {\n  color: #909399;\n}\n.openwebui-msg.assistant .openwebui-msg-bubble .deleted-card {\n  border-left: 4px solid #909399;\n}\n</style>\n\n<!-- æ·»åŠ äº‹ä»¶ç¼–è¾‘è¡¨å•æ ·å¼ -->\n<style>\n.event-edit-dialog .el-message-box__input {\n  padding: 0;\n}\n\n.event-edit-dialog .el-message-box__input input {\n  display: none;\n}\n\n.event-edit-form {\n  padding: 10px 0;\n}\n\n.event-edit-form .form-group {\n  margin-bottom: 15px;\n}\n\n.event-edit-form label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: 500;\n  color: var(--text-color);\n}\n\n.event-edit-form .form-control {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  background-color: var(--bg-color);\n  color: var(--text-color);\n  font-size: 14px;\n  transition: border-color 0.2s;\n}\n\n.event-edit-form .form-control:focus {\n  border-color: var(--primary-color);\n  outline: none;\n}\n\n.event-edit-form textarea.form-control {\n  min-height: 80px;\n  resize: vertical;\n}\n\n.event-edit-form select.form-control {\n  appearance: auto;\n}\n</style>\n\n<style>\n/* ç¡®ä¿ el-dialog åœ¨æš—é»‘æ¨¡å¼ä¸‹æ ·å¼æ­£ç¡® */\n.calendar-dialog .el-dialog {\n  background-color: var(--bg-color);\n}\n.calendar-dialog .el-dialog__title {\n  color: var(--text-color);\n}\n.calendar-dialog .el-dialog__header {\n  border-bottom: 1px solid var(--border-color);\n}\n.calendar-dialog .el-dialog__body {\n  background-color: var(--bg-color);\n  color: var(--text-color);\n}\n.calendar-dialog .el-dialog__footer {\n  border-top: 1px solid var(--border-color);\n}\n.calendar-dialog .el-form-item__label {\n  color: var(--text-color);\n}\n.calendar-dialog .el-input__wrapper,\n.calendar-dialog .el-textarea__inner {\n  background-color: var(--bg-color-secondary) !important;\n  box-shadow: none !important;\n  border: 1px solid var(--border-color);\n  color: var(--text-color);\n}\n.calendar-dialog .el-input__inner {\n  color: var(--text-color) !important;\n}\n\n/* ç§»é™¤æ—§çš„ã€ä¸å†éœ€è¦çš„CSS */\n.event-edit-dialog .el-message-box__input {\n  display: none;\n}\n.event-edit-form {\n  display: none;\n}\n</style>"]}]}