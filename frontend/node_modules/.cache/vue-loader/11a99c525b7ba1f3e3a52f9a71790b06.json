{"remainingRequest":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\SmartDocManagement.vue?vue&type=style&index=0&id=f26a7f68&scoped=true&lang=scss","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\SmartDocManagement.vue","mtime":1750314659846},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1746431217000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1747194135644},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218000},{"path":"C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICcuL3NoYXJlZC1zdHlsZXMuY3NzJzsNCg0KLnNtYXJ0LWRvYy1tYW5hZ2VtZW50LWNvbnRhaW5lciB7DQogIHBhZGRpbmc6IDIwcHg7DQp9DQoNCi5jYXJkLWhlYWRlciB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGZvbnQtd2VpZ2h0OiA1MDA7DQogIC5oZWFkZXItaWNvbiB7DQogICAgbWFyZ2luLXJpZ2h0OiAxMHB4Ow0KICB9DQp9DQoNCi50YWJsZS1jb250YWluZXIgew0KICBtYXJnaW4tdG9wOiAxNXB4Ow0KfQ0KDQouZG9jLXRpdGxlIHsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBjb2xvcjogdmFyKC0tZWwtY29sb3ItcHJpbWFyeSk7DQogICY6aG92ZXIgew0KICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOw0KICB9DQp9DQoNCi5wYWdpbmF0aW9uLWNvbnRhaW5lciB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7DQogIG1hcmdpbi10b3A6IDIwcHg7DQp9DQoNCi5wcmV2aWV3LWRpYWxvZyAuZWwtZGlhbG9nX19ib2R5IHsNCiAgcGFkZGluZzogMTBweCAyMHB4Ow0KfQ0KDQoucHJldmlldy1jb250ZW50IHsNCiAgbGluZS1oZWlnaHQ6IDEuODsNCn0NCg0KLmRvYy1jb250ZW50LWJvZHkgew0KICBwYWRkaW5nLXJpZ2h0OiAxNXB4Ow0KICAvKiBBZGQgbW9yZSBzdHlsaW5nIGZvciByZW5kZXJlZCBIVE1MIGNvbnRlbnQgaWYgbmVlZGVkICovDQp9DQo="},{"version":3,"sources":["C:\\Users\\18083\\Desktop\\CCIT\\office\\smart-office\\frontend\\src\\views\\admin\\SmartDocManagement.vue"],"names":[],"mappings":"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","file":"C:/Users/18083/Desktop/CCIT/office/smart-office/frontend/src/views/admin/SmartDocManagement.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div class=\"smart-doc-management-container\">\r\n    <el-card class=\"box-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <el-icon :size=\"20\" class=\"header-icon\"><Files /></el-icon>\r\n          <span>智能文档管理</span>\r\n        </div>\r\n      </template>\r\n      <div class=\"table-container\">\r\n        <el-table :data=\"documents\" v-loading=\"loading\" style=\"width: 100%\">\r\n          <el-table-column type=\"index\" label=\"序号\" width=\"60\" />\r\n          <el-table-column prop=\"title\" label=\"文档标题\" sortable>\r\n            <template #default=\"scope\">\r\n              <span class=\"doc-title\">{{ scope.row.title }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"company_name\" label=\"所属公司\" width=\"180\" sortable />\r\n          <el-table-column prop=\"creator_name\" label=\"创建人\" width=\"150\" sortable />\r\n          <el-table-column prop=\"doc_type\" label=\"文档类型\" width=\"120\">\r\n            <template #default=\"scope\">\r\n              <el-tag :type=\"getDocTypeTag(scope.row.doc_type)\" size=\"small\">{{ scope.row.doc_type }}</el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"is_shared\" label=\"是否共享\" width=\"100\" align=\"center\">\r\n            <template #default=\"scope\">\r\n              <el-tag :type=\"scope.row.is_shared ? 'success' : 'info'\" size=\"small\">\r\n                {{ scope.row.is_shared ? '是' : '否' }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"updated_at\" label=\"最后更新\" width=\"180\" sortable>\r\n            <template #default=\"scope\">\r\n              <span>{{ formatDateTime(scope.row.updated_at) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" width=\"150\" fixed=\"right\">\r\n            <template #default=\"scope\">\r\n              <el-button type=\"primary\" text size=\"small\" @click=\"handleView(scope.row)\">\r\n                查看\r\n              </el-button>\r\n              <el-button type=\"danger\" text size=\"small\" @click=\"handleDelete(scope.row)\">\r\n                删除\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          v-model:current-page=\"pagination.page\"\r\n          v-model:page-size=\"pagination.pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 文档预览对话框 -->\r\n    <el-dialog\r\n      v-model=\"previewDialogVisible\"\r\n      :title=\"selectedDocument.title\"\r\n      width=\"60%\"\r\n      top=\"5vh\"\r\n      class=\"preview-dialog\"\r\n    >\r\n      <div class=\"preview-content\" v-loading=\"previewLoading\">\r\n        <el-scrollbar max-height=\"65vh\">\r\n          <div v-if=\"selectedDocument.content\" v-html=\"selectedDocument.content\" class=\"doc-content-body\"></div>\r\n          <el-empty v-else description=\"文档内容为空\" />\r\n        </el-scrollbar>\r\n      </div>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"previewDialogVisible = false\">关闭</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport adminApi from '@/api/admin';\r\nimport { ElMessage, ElMessageBox } from 'element-plus';\r\nimport { Files } from '@element-plus/icons-vue';\r\n\r\nconst router = useRouter();\r\nconst documents = ref([]);\r\nconst loading = ref(true);\r\nconst total = ref(0);\r\nconst pagination = reactive({\r\n  page: 1,\r\n  pageSize: 10,\r\n});\r\n\r\n// 预览相关\r\nconst previewDialogVisible = ref(false);\r\nconst previewLoading = ref(false);\r\nconst selectedDocument = reactive({\r\n  id: null,\r\n  title: '文档预览',\r\n  content: ''\r\n});\r\n\r\nconst fetchDocuments = async () => {\r\n  loading.value = true;\r\n  try {\r\n    const params = {\r\n      page: pagination.page,\r\n      page_size: pagination.pageSize,\r\n    };\r\n    const res = await adminApi.getSmartDocs(params);\r\n    if (res.data && res.data.results) {\r\n      documents.value = res.data.results;\r\n      total.value = res.data.count;\r\n    } else {\r\n      ElMessage.error('获取文档列表失败');\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching documents:', error);\r\n    ElMessage.error('加载文档数据时出错，请稍后重试');\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst handleSizeChange = (val) => {\r\n  pagination.pageSize = val;\r\n  fetchDocuments();\r\n};\r\n\r\nconst handleCurrentChange = (val) => {\r\n  pagination.page = val;\r\n  fetchDocuments();\r\n};\r\n\r\nconst formatDateTime = (dateTime) => {\r\n  if (!dateTime) return 'N/A';\r\n  return new Date(dateTime).toLocaleString('zh-CN');\r\n};\r\n\r\nconst getDocTypeTag = (docType) => {\r\n  const types = {\r\n    '通用': 'primary',\r\n    '会议纪要': 'success',\r\n    '项目计划': 'warning',\r\n    '技术文档': 'danger',\r\n  };\r\n  return types[docType] || 'info';\r\n};\r\n\r\nconst handleView = async (row) => {\r\n  previewDialogVisible.value = true;\r\n  previewLoading.value = true;\r\n  selectedDocument.title = row.title;\r\n  selectedDocument.content = ''; // Clear previous content\r\n  try {\r\n    const res = await adminApi.getSmartDocDetail(row.id);\r\n    if (res.data) {\r\n      selectedDocument.content = res.data.content;\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching document detail:', error);\r\n    ElMessage.error('获取文档详情失败');\r\n    previewDialogVisible.value = false;\r\n  } finally {\r\n    previewLoading.value = false;\r\n  }\r\n};\r\n\r\nconst handleDelete = (row) => {\r\n  ElMessageBox.confirm(\r\n    `确定要删除文档《${row.title}》吗？此操作不可撤销。`,\r\n    '警告',\r\n    {\r\n      confirmButtonText: '确定删除',\r\n      cancelButtonText: '取消',\r\n      type: 'warning',\r\n    }\r\n  ).then(async () => {\r\n    try {\r\n      await adminApi.deleteSmartDoc(row.id);\r\n      ElMessage.success('文档删除成功');\r\n      // 刷新列表\r\n      fetchDocuments();\r\n    } catch (error) {\r\n      console.error('Error deleting document:', error);\r\n      ElMessage.error('删除文档失败');\r\n    }\r\n  }).catch(() => {\r\n    // User cancelled\r\n  });\r\n};\r\n\r\nonMounted(() => {\r\n  fetchDocuments();\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import './shared-styles.css';\r\n\r\n.smart-doc-management-container {\r\n  padding: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  align-items: center;\r\n  font-weight: 500;\r\n  .header-icon {\r\n    margin-right: 10px;\r\n  }\r\n}\r\n\r\n.table-container {\r\n  margin-top: 15px;\r\n}\r\n\r\n.doc-title {\r\n  cursor: pointer;\r\n  color: var(--el-color-primary);\r\n  &:hover {\r\n    text-decoration: underline;\r\n  }\r\n}\r\n\r\n.pagination-container {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin-top: 20px;\r\n}\r\n\r\n.preview-dialog .el-dialog__body {\r\n  padding: 10px 20px;\r\n}\r\n\r\n.preview-content {\r\n  line-height: 1.8;\r\n}\r\n\r\n.doc-content-body {\r\n  padding-right: 15px;\r\n  /* Add more styling for rendered HTML content if needed */\r\n}\r\n</style> "]}]}