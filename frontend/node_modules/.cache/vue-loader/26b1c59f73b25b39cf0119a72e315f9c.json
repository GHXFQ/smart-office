{"remainingRequest":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\src\\views\\auth\\Register.vue?vue&type=style&index=0&id=17c846a0&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\src\\views\\auth\\Register.vue","mtime":1746845877210},{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1746431217446},{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1746431218792},{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1746431217377},{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1746431218359},{"path":"C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1746431218786}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5yZWdpc3Rlci1jb250YWluZXIgewogIGhlaWdodDogMTAwdmg7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2NjdlZWEgMCUsICM3NjRiYTIgMTAwJSk7Cn0KCi5yZWdpc3Rlci1ib3ggewogIHdpZHRoOiA0NTBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgwLCAwLCAwLCAwLjEpOwogIHBhZGRpbmc6IDQwcHg7Cn0KCi5yZWdpc3Rlci1oZWFkZXIgewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBtYXJnaW4tYm90dG9tOiAzMHB4Owp9CgoucmVnaXN0ZXItaGVhZGVyIGltZyB7CiAgd2lkdGg6IDYwcHg7CiAgbWFyZ2luLWJvdHRvbTogMTVweDsKfQoKLnJlZ2lzdGVyLWhlYWRlciBoNCB7CiAgZm9udC13ZWlnaHQ6IDYwMDsKICBjb2xvcjogIzMzMzsKICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgZm9udC1zaXplOiAyMHB4Owp9CgoucmVnaXN0ZXItaGVhZGVyIHAgewogIGNvbG9yOiAjNmM3NTdkOwogIGZvbnQtc2l6ZTogMTRweDsKfQoKLnJlZ2lzdGVyLWZvcm0gewogIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCi5yZWdpc3Rlci1idXR0b24gewogIHdpZHRoOiAxMDAlOwogIG1hcmdpbjogMjBweCAwOwogIGhlaWdodDogNDBweDsKICBmb250LXNpemU6IDE2cHg7Cn0KCi5sb2dpbi1saW5rIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgZm9udC1zaXplOiAxNHB4OwogIGNvbG9yOiAjNmM3NTdkOwp9CgoubG9naW4tbGluayBhIHsKICBjb2xvcjogIzE4OTBmZjsKICB0ZXh0LWRlY29yYXRpb246IG5vbmU7Cn0KCi5sb2dpbi1saW5rIGE6aG92ZXIgewogIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOwp9CgouZm9ybS10ZXh0IHsKICBmb250LXNpemU6IDEycHg7CiAgY29sb3I6ICM2Yzc1N2Q7CiAgbWFyZ2luLXRvcDogNHB4Owp9Cg=="},{"version":3,"sources":["C:\\Users\\18083\\Desktop\\offic_ai\\office\\smart-office\\frontend\\src\\views\\auth\\Register.vue"],"names":[],"mappings":";AAoPA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AAC/D;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACvC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACf;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;EACnB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;EACjB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACvB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5B;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACjB","file":"C:/Users/18083/Desktop/offic_ai/office/smart-office/frontend/src/views/auth/Register.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"register-container\">\n    <div class=\"register-box\">\n      <div class=\"register-header\">\n        <img src=\"https://cdn-icons-png.flaticon.com/512/2891/2891491.png\" alt=\"Logo\">\n        <h4>创建您的账户</h4>\n        <p>欢迎加入智能办公系统</p>\n      </div>\n\n      <el-form ref=\"registerFormRef\" :model=\"registerForm\" :rules=\"registerRules\" class=\"register-form\">\n        <el-form-item prop=\"username\">\n          <el-input \n            v-model=\"registerForm.username\" \n            placeholder=\"请输入您的用户名 (例如：user123)\"\n          >\n            <template #prefix>\n              <el-icon><User /></el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n        \n        <el-form-item prop=\"email\">\n          <el-input \n            v-model=\"registerForm.email\" \n            placeholder=\"请输入您的邮箱地址\"\n          >\n            <template #prefix>\n              <el-icon><Message /></el-icon>\n            </template>\n          </el-input>\n          <div class=\"form-text\">我们将发送验证邮件到此邮箱，也可用于密码找回。</div>\n        </el-form-item>\n\n        <el-form-item prop=\"company\">\n          <el-select \n            v-model=\"registerForm.company\" \n            placeholder=\"请选择您的企业\"\n            style=\"width: 100%\"\n          >\n            <el-option\n              v-for=\"item in companies\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            />\n          </el-select>\n          <div class=\"form-text\">选择您所属的企业，没有找到您的企业请联系管理员添加。</div>\n        </el-form-item>\n\n        <el-form-item prop=\"password\">\n          <el-input \n            v-model=\"registerForm.password\" \n            type=\"password\" \n            placeholder=\"请输入密码 (至少6位)\"\n            show-password\n          >\n            <template #prefix>\n              <el-icon><Lock /></el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n\n        <el-form-item prop=\"confirmPassword\">\n          <el-input \n            v-model=\"registerForm.confirmPassword\" \n            type=\"password\" \n            placeholder=\"请再次输入密码\"\n            show-password\n          >\n            <template #prefix>\n              <el-icon><Lock /></el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n\n        <el-button type=\"primary\" class=\"register-button\" @click=\"handleRegister\" :loading=\"loading\">\n          注册\n        </el-button>\n      </el-form>\n\n      <div class=\"login-link\">\n        <p>已有账号？<router-link to=\"/login\">立即登录</router-link></p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\nimport { ElMessage } from 'element-plus'\nimport { User, Lock, Message } from '@element-plus/icons-vue'\nimport { getSimpleCompanyList } from '@/api/company'\n\nexport default {\n  name: 'Register',\n  setup() {\n    const router = useRouter();\n    const store = useStore();\n    const registerFormRef = ref(null);\n    const loading = computed(() => store.getters['user/loading']);\n    const error = computed(() => store.getters['user/error']);\n    const companies = ref([]);\n\n    // 注册表单数据\n    const registerForm = reactive({\n      username: '',\n      email: '',\n      password: '',\n      confirmPassword: '',\n      company: null\n    });\n\n    // 注册表单验证规则\n    const registerRules = {\n      username: [\n        { required: true, message: '请输入用户名', trigger: 'blur' },\n        { min: 4, message: '用户名长度至少4个字符', trigger: 'blur' }\n      ],\n      email: [\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\n      ],\n      company: [\n        { required: true, message: '请选择企业', trigger: 'change' }\n      ],\n      password: [\n        { required: true, message: '请输入密码', trigger: 'blur' },\n        { min: 6, message: '密码长度至少6个字符', trigger: 'blur' }\n      ],\n      confirmPassword: [\n        { required: true, message: '请确认密码', trigger: 'blur' },\n        { \n          validator: (rule, value, callback) => {\n            if (value !== registerForm.password) {\n              callback(new Error('两次输入密码不一致'));\n            } else {\n              callback();\n            }\n          }, \n          trigger: 'blur' \n        }\n      ]\n    };\n\n    // 获取企业列表\n    const fetchCompanies = async () => {\n      try {\n        const response = await getSimpleCompanyList();\n        if (response.success) {\n          companies.value = response.data;\n        } else {\n          console.error('获取企业列表失败:', response);\n          ElMessage.error('获取企业列表失败，请刷新重试');\n        }\n      } catch (error) {\n        console.error('获取企业列表失败:', error);\n        ElMessage.error('获取企业列表失败，请刷新重试');\n      }\n    };\n\n    // 处理注册\n    const handleRegister = async () => {\n      if (!registerFormRef.value) return;\n      \n      // 清除之前的错误\n      store.dispatch('user/clearError');\n      \n      try {\n        // 表单验证\n        await registerFormRef.value.validate();\n      } catch (error) {\n        ElMessage.warning('请填写所有必填项');\n        return;\n      }\n      \n      try {\n        // 创建注册数据对象，添加必要的可选字段\n        const registerData = {\n          username: registerForm.username,\n          email: registerForm.email,\n          password: registerForm.password,\n          confirmPassword: registerForm.confirmPassword,\n          company: registerForm.company,\n          // 添加空值的可选字段，避免后端验证问题\n          first_name: '',\n          last_name: '',\n          phone: ''\n        };\n        \n        // 调用注册API\n        const response = await store.dispatch('user/register', registerData);\n        ElMessage.success(response.message || '注册成功！');\n        \n        // 注册成功后自动登录\n        const loginData = {\n          username: registerForm.username,\n          password: registerForm.password\n        };\n        \n        try {\n          // 调用登录API\n          await store.dispatch('user/login', loginData);\n          ElMessage.success('自动登录成功！');\n          \n          // 登录成功后跳转到仪表板\n          router.push('/dashboard');\n        } catch (loginError) {\n          console.error('自动登录失败:', loginError);\n          ElMessage.warning('自动登录失败，请手动登录');\n          router.push('/login');\n        }\n      } catch (err) {\n        // 错误已在store中处理，这里可以显示额外提示\n        if (error.value) {\n          ElMessage.error(error.value);\n        } else {\n          console.error('注册失败:', err);\n          ElMessage.error('注册失败，请稍后重试');\n        }\n      }\n    };\n\n    onMounted(() => {\n      fetchCompanies();\n    });\n\n    return {\n      registerFormRef,\n      registerForm,\n      registerRules,\n      loading,\n      companies,\n      handleRegister,\n      User,\n      Lock,\n      Message\n    };\n  }\n}\n</script>\n\n<style scoped>\n.register-container {\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n.register-box {\n  width: 450px;\n  background-color: #ffffff;\n  border-radius: 10px;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);\n  padding: 40px;\n}\n\n.register-header {\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.register-header img {\n  width: 60px;\n  margin-bottom: 15px;\n}\n\n.register-header h4 {\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 8px;\n  font-size: 20px;\n}\n\n.register-header p {\n  color: #6c757d;\n  font-size: 14px;\n}\n\n.register-form {\n  margin-bottom: 20px;\n}\n\n.register-button {\n  width: 100%;\n  margin: 20px 0;\n  height: 40px;\n  font-size: 16px;\n}\n\n.login-link {\n  text-align: center;\n  font-size: 14px;\n  color: #6c757d;\n}\n\n.login-link a {\n  color: #1890ff;\n  text-decoration: none;\n}\n\n.login-link a:hover {\n  text-decoration: underline;\n}\n\n.form-text {\n  font-size: 12px;\n  color: #6c757d;\n  margin-top: 4px;\n}\n</style> "]}]}