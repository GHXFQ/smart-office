{"version":3,"sources":["webpack:///./src/views/knowledge/Index.vue?0354","webpack:///./node_modules/core-js/modules/es.set.symmetric-difference.v2.js","webpack:///./node_modules/core-js/modules/es.set.difference.v2.js","webpack:///./node_modules/core-js/modules/web.url-search-params.has.js","webpack:///./node_modules/core-js/internals/set-iterate.js","webpack:///./node_modules/core-js/internals/set-is-superset-of.js","webpack:///./src/views/knowledge/Index.vue","webpack:///./src/components/KnowledgeBuilder.vue","webpack:///./src/components/KnowledgeBuilder.vue?c015","webpack:///./src/views/knowledge/Index.vue?1ae1","webpack:///./node_modules/core-js/internals/iterate-simple.js","webpack:///./node_modules/core-js/modules/web.url-search-params.size.js","webpack:///./src/components/KnowledgeBuilder.vue?5ca3","webpack:///./node_modules/core-js/internals/set-is-subset-of.js","webpack:///./node_modules/core-js/modules/es.set.union.v2.js","webpack:///./node_modules/core-js/modules/es.set.intersection.v2.js","webpack:///./node_modules/core-js/internals/get-set-record.js","webpack:///./node_modules/core-js/internals/set-clone.js","webpack:///./node_modules/core-js/modules/web.url-search-params.delete.js","webpack:///./node_modules/core-js/modules/es.set.is-subset-of.v2.js","webpack:///./node_modules/core-js/internals/set-size.js","webpack:///./node_modules/core-js/modules/es.iterator.filter.js","webpack:///./node_modules/core-js/internals/set-intersection.js","webpack:///./node_modules/core-js/internals/set-symmetric-difference.js","webpack:///./node_modules/core-js/modules/es.set.is-superset-of.v2.js","webpack:///./node_modules/core-js/internals/set-difference.js","webpack:///./node_modules/core-js/internals/set-is-disjoint-from.js","webpack:///./node_modules/core-js/modules/es.set.is-disjoint-from.v2.js","webpack:///./node_modules/core-js/internals/set-helpers.js","webpack:///./node_modules/core-js/internals/validate-arguments-length.js","webpack:///./node_modules/core-js/internals/set-method-accept-set-like.js","webpack:///./src/api/knowledge.js","webpack:///./node_modules/core-js/internals/a-set.js","webpack:///./node_modules/core-js/internals/set-union.js","webpack:///./node_modules/core-js/modules/es.iterator.find.js"],"names":["$","symmetricDifference","setMethodAcceptSetLike","target","proto","real","forced","difference","INCORRECT","result","size","defineBuiltIn","uncurryThis","toString","validateArgumentsLength","$URLSearchParams","URLSearchParams","URLSearchParamsPrototype","prototype","getAll","$has","has","params","undefined","name","length","arguments","$value","this","values","value","index","enumerable","unsafe","iterateSimple","SetHelpers","Set","SetPrototype","forEach","keys","next","module","exports","set","fn","interruptible","iterator","aSet","getSetRecord","iteratorClose","other","O","otherRec","getIterator","e","class","_createElementBlock","key","$setup","internalRefreshKey","_createVNode","_component_el_alert","title","type","closable","show-icon","style","default","_withCtx","_cache","_createElementVNode","_hoisted_1","_hoisted_2","_component_el_card","_hoisted_3","_component_el_input","searchQuery","$event","placeholder","clearable","prefix-icon","Search","onInput","handleSearch","_hoisted_4","_Fragment","_renderList","categories","category","id","_normalizeClass","selectedCategory","onClick","selectCategory","_normalizeStyle","color","_component_el_icon","_createBlock","_resolveDynamicComponent","icon","_hoisted_6","_toDisplayString","_hoisted_7","document_count","_hoisted_8","_hoisted_9","_hoisted_10","_component_el_checkbox","filters","types","pdf","onChange","applyFilters","doc","xls","ppt","img","txt","md","_hoisted_11","_hoisted_12","_hoisted_13","currentCategoryName","_hoisted_14","_component_el_button","text","bg","forceRefresh","_component_Refresh","shadow","documents","_hoisted_15","_hoisted_16","_component_InfoFilled","_hoisted_17","body-style","_hoisted_18","file_type","getFileIcon","_hoisted_19","_hoisted_21","_hoisted_22","_hoisted_23","description","_hoisted_24","_hoisted_25","_component_Clock","formatDate","date","_hoisted_26","Download","_withModifiers","downloadDocument","_hoisted_27","_component_el_pagination","background","layout","total","totalDocs","page-size","pageSize","page-sizes","current-page","currentPage","onCurrentChange","handlePageChange","onSizeChange","handleSizeChange","_component_el_dialog","uploadVisible","width","before-close","handleCloseUploadDialog","footer","_hoisted_28","handleCancelUpload","submitUpload","loading","uploading","_component_el_form","ref","model","uploadForm","rules","uploadRules","_component_el_form_item","label","prop","rows","_component_el_select","filter","c","cat","idx","_component_el_option","_component_el_upload","drag","action","auto-upload","on-change","handleFileChange","on-remove","handleRemove","limit","before-upload","beforeUpload","on-error","handleUploadError","tip","_component_upload_filled","showCategoryDialog","_hoisted_29","_hoisted_30","categoryLoading","_hoisted_31","_component_Loading","_hoisted_32","_component_el_empty","_hoisted_33","_hoisted_34","backgroundColor","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","plain","editCategory","_component_Edit","handleDeleteCategory","_component_Delete","showAddCategoryForm","_hoisted_41","_hoisted_42","editingCategory","cancelCategoryForm","categoryForm","label-width","required","_hoisted_43","_component_Document","_hoisted_44","_component_Files","_hoisted_45","_component_Tickets","_hoisted_46","_component_DataAnalysis","_hoisted_47","_component_PictureFilled","_component_el_color_picker","show-alpha","formatColorValue","_hoisted_48","saveCategoryForm","_component_KnowledgeBuilder","buildingVisible","onBuildCompleted","handleBuildCompleted","onBuildFailed","handleBuildFailed","editDialogVisible","handleCloseEditDialog","_hoisted_49","handleCancelEditDialog","handleUpdateDocument","editForm","visible","close-on-click-modal","show-close","buildingStatus","close","startBuild","_component_CircleCheckFilled","_component_CircleCloseFilled","buildingMessage","_component_el_progress","percentage","buildingProgress","format","p","_hoisted_5","components","Loading","CircleCheckFilled","CircleCloseFilled","props","modelValue","Boolean","emits","setup","emit","computed","get","val","buildingOutput","fullOutput","buildingStats","pollTimer","buildingRetryCount","clearPollTimer","clearTimeout","console","log","async","response","buildKnowledgeBase","setTimeout","pollBuildStatus","error","_error$response","_error$response$data","data","message","getKnowledgeBaseStatus","JSON","stringify","statusData","status","progress","full_output","graphrag_output","nextTick","outputElem","document","querySelector","scrollTop","scrollHeight","startTime","started_at","Date","endTime","finished_at","duration","calculateDuration","total_docs","totalChunks","total_chunks","ElMessage","success","detail","error_detail","pollInterval","warn","start","end","diff","Math","abs","minutes","floor","seconds","toFixed","formatBuildTime","dateObj","dayjs","onMounted","onBeforeUnmount","watch","newVal","__exports__","KnowledgeBuilder","route","useRoute","now","showChunksDialog","viewMode","sortOrder","chunksLoading","isAdmin","selectedDocument","documentChunks","uploadFormRef","uploadRef","reactive","creator","file","tags","chunk_size","chunk_overlap","is_public","trigger","find","processingCount","fetchCategories","getCategories","categoryList","results","Array","isArray","possibleArrayFields","field","grandTotalAllDocuments","allDocsResponse","getDocuments","page","page_size","Object","hasOwnProperty","call","count","docError","allCategory","warning","includes","fetchDocuments","ordering","search","selectedTypes","typeMapping","selected","entries","push","uniqueSelectedTypes","join","possibleDocuments","item","fetchDocumentChunks","getDocumentChunks","documentId","categoryId","raw","maxSizeInBytes","fileName","ext","slice","lastIndexOf","toLowerCase","allowedFileTypes","split","clearFiles","_uploadForm$file","_uploadForm$file$name","fileNameWithoutExt","validate","valid","formData","FormData","append","fileInFormData","uploadDocument","uploadedFileTitle","resetUploadForm","attempts","maxAttempts","poll","setInterval","documentsResponse","foundDoc","clearInterval","info","pollError","errorMsg","substring","showDocumentChunks","ElMessageBox","confirm","confirmButtonText","cancelButtonText","deleteCategory","updateCategory","addCategory","newCategoryId","resetCategoryForm","resetFields","done","openUploadDialog","previewDocument","original_file","fetch","ok","blob","url","window","URL","createObjectURL","open","revokeObjectURL","downloadDocumentFile","Blob","headers","apiError","file_url","urlError","fileUrlParts","originalFilename","uuid","uuidMatch","match","possiblePaths","path","pathError","Error","filename","original_filename","link","createElement","href","setAttribute","body","appendChild","click","removeChild","pop","shareDocument","editDocument","updateDocument","messages","map","errors","deleteDocument","apiDeleteDocument","_error$response2","_error$response2$data","errorMessage","fileType","extension","iconMap","Document","docx","DataAnalysis","xlsx","Tickets","pptx","png","PictureFilled","jpg","jpeg","gif","svg","Files","dateString","toLocaleDateString","year","month","day","formatFileSize","sizeInKB","getTagsList","tag","trim","startsWith","hexColor","replace","r","g","b","toHex","hex","parseInt","overlays","querySelectorAll","el","parentNode","overflow","classList","remove","pointerEvents","dropdowns","interactiveElements","hasAttribute","contains","removeAttribute","parent","opacity","visibility","display","card","cursor","zIndex","position","dropdown","catch","err","fullPath","newPath","onActivated","Upload","FolderAdd","View","More","Share","Edit","EditPen","FolderOpened","Star","Delete","UploadFilled","List","Grid","Crop","Plus","InfoFilled","Clock","User","Refresh","render","record","ITERATOR_INSTEAD_OF_RECORD","step","DESCRIPTORS","defineBuiltInAccessor","configurable","iterate","union","fails","intersection","String","from","aCallable","anObject","toIntegerOrInfinity","getIteratorDirect","INVALID_SIZE","$RangeError","RangeError","$TypeError","TypeError","max","SetRecord","intSize","it","obj","numSize","add","$delete","v","k","entry","dindex","found","entriesLength","isSubsetOf","uncurryThisAccessor","createIteratorProxy","callWithSafeIterationClosing","IS_PURE","iteratorHelperWithoutClosingOnEarlyError","filterWithoutClosingOnEarlyError","IteratorProxy","predicate","counter","iterateSet","clone","keysIter","isSupersetOf","isDisjointFrom","passed","getBuiltIn","createSetLike","createSetLikeWithInfinitySize","callback","error2","Infinity","baseURL","request","method","then","Promise","reject","lastModified","timeout","onUploadProgress","progressEvent","percentCompleted","round","loaded","code","requestConfig","responseType","getKnowledgeList","findWithoutClosingOnEarlyError","stop","IS_RECORD","INTERRUPTED"],"mappings":"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","file":"js/chunk-67b19ef6.bff0928b.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Index.vue?vue&type=style&index=0&id=64d34e3b&lang=scss&scoped=true\"","'use strict';\nvar $ = require('../internals/export');\nvar symmetricDifference = require('../internals/set-symmetric-difference');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.symmetricDifference` method\n// https://tc39.es/ecma262/#sec-set.prototype.symmetricdifference\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('symmetricDifference') }, {\n  symmetricDifference: symmetricDifference\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar difference = require('../internals/set-difference');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('difference', function (result) {\n  return result.size === 0;\n});\n\n// `Set.prototype.difference` method\n// https://tc39.es/ecma262/#sec-set.prototype.difference\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  difference: difference\n});\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar getAll = uncurryThis(URLSearchParamsPrototype.getAll);\nvar $has = uncurryThis(URLSearchParamsPrototype.has);\nvar params = new $URLSearchParams('a=1');\n\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nif (params.has('a', 2) || !params.has('a', undefined)) {\n  defineBuiltIn(URLSearchParamsPrototype, 'has', function has(name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $has(this, name);\n    var values = getAll(this, name); // also validates `this`\n    validateArgumentsLength(length, 1);\n    var value = toString($value);\n    var index = 0;\n    while (index < values.length) {\n      if (values[index++] === value) return true;\n    } return false;\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar iterateSimple = require('../internals/iterate-simple');\nvar SetHelpers = require('../internals/set-helpers');\n\nvar Set = SetHelpers.Set;\nvar SetPrototype = SetHelpers.proto;\nvar forEach = uncurryThis(SetPrototype.forEach);\nvar keys = uncurryThis(SetPrototype.keys);\nvar next = keys(new Set()).next;\n\nmodule.exports = function (set, fn, interruptible) {\n  return interruptible ? iterateSimple({ iterator: keys(set), next: next }, fn) : forEach(set, fn);\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar has = require('../internals/set-helpers').has;\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\nvar iteratorClose = require('../internals/iterator-close');\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSupersetOf\nmodule.exports = function isSupersetOf(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) < otherRec.size) return false;\n  var iterator = otherRec.getIterator();\n  return iterateSimple(iterator, function (e) {\n    if (!has(O, e)) return iteratorClose(iterator, 'normal', false);\n  }) !== false;\n};\n","<template>\n  <div class=\"knowledge-container\" :key=\"internalRefreshKey\">\n    <el-alert\n      title=\"知识库使用说明\"\n      type=\"info\"\n      :closable=\"false\"\n      show-icon\n      style=\"margin-bottom: 20px;\"\n    >\n      <template #default>\n        <div>\n          知识库的<b>【上传文档】</b>、<b>【构建知识库】</b>及<b>【分类管理】</b>等核心功能，主要由企业所有者（老板角色）在后台进行统一管理和构建。\n          <br>\n          普通员工此页面进行已有知识的<b>查阅和检索</b>。\n        </div>\n      </template>\n    </el-alert>\n    <div class=\"row\">\n      <!-- 左侧导航 -->\n      <div class=\"col-lg-3\">\n        <el-card class=\"category-card\">\n          <div class=\"search-box\">\n            <el-input \n              v-model=\"searchQuery\" \n              placeholder=\"搜索文档...\"\n              clearable\n              :prefix-icon=\"Search\"\n              @input=\"handleSearch\"\n            ></el-input>\n          </div>\n          \n          <div class=\"category-list\">\n            <div v-for=\"(category, index) in categories\" :key=\"category.id || index\" \n                 class=\"category-item\" \n                 :class=\"{'active': selectedCategory === (category.id || index)}\"\n                 @click=\"selectCategory(category.id || index)\">\n              <div class=\"category-icon\" :style=\"{'background-color': category.color}\">\n                <el-icon :size=\"20\" color=\"white\">\n                  <component :is=\"category.icon\"></component>\n                </el-icon>\n              </div>\n              <span class=\"category-name\">{{ category.name }}</span>\n              <span class=\"category-count\">{{ category.document_count || 0 }}</span>\n            </div>\n            \n            <!-- <el-button \n              v-if=\"isAdmin\"\n              type=\"primary\" \n              size=\"small\" \n              class=\"add-category-btn\"\n              @click=\"showCategoryDialog = true\">\n              <el-icon><Plus /></el-icon> 添加分类\n            </el-button> -->\n          </div>\n          \n          <div class=\"filter-section\">\n            <h6>筛选条件</h6>\n            <div class=\"filter-group\">\n              <h6>文件类型</h6>\n              <div class=\"filter-options\">\n                <el-checkbox v-model=\"filters.types.pdf\" @change=\"applyFilters\">PDF文档</el-checkbox>\n                <el-checkbox v-model=\"filters.types.doc\" @change=\"applyFilters\">Word文档</el-checkbox>\n                <el-checkbox v-model=\"filters.types.xls\" @change=\"applyFilters\">Excel表格</el-checkbox>\n                <el-checkbox v-model=\"filters.types.ppt\" @change=\"applyFilters\">PPT演示文稿</el-checkbox>\n                <el-checkbox v-model=\"filters.types.img\" @change=\"applyFilters\">图片</el-checkbox>\n                <el-checkbox v-model=\"filters.types.txt\" @change=\"applyFilters\">文本文件</el-checkbox>\n                <el-checkbox v-model=\"filters.types.md\" @change=\"applyFilters\">Markdown文件</el-checkbox>\n              </div>\n            </div>\n          </div>\n        </el-card>\n      </div>\n      \n      <!-- 右侧内容区 -->\n      <div class=\"col-lg-9\">\n        <div class=\"page-header\">\n          <h2 class=\"page-title\">{{ currentCategoryName }}</h2>\n            <div class=\"header-actions\">\n            <!-- <el-button type=\"primary\" size=\"large\" @click=\"openUploadDialog\">\n              <el-icon class=\"el-icon--left\"><Upload /></el-icon> 上传文档\n              </el-button>\n            <el-button type=\"success\" plain size=\"large\" @click=\"buildingVisible = true\">\n              <el-icon class=\"el-icon--left\"><Files /></el-icon> 构建知识库\n              </el-button>\n            <el-button v-if=\"isAdmin\" text bg size=\"large\" @click=\"showCategoryDialog = true\">\n              <el-icon class=\"el-icon--left\"><FolderAdd /></el-icon> 管理分类\n              </el-button> -->\n            <el-button text bg size=\"large\" @click=\"forceRefresh\">\n              <el-icon class=\"el-icon--left\"><Refresh /></el-icon> 刷新\n              </el-button>\n            </div>\n          </div>\n          \n        <el-card class=\"document-container-card\" shadow=\"never\">\n          <div v-if=\"documents.length === 0\" class=\"empty-state\">\n            <div class=\"empty-icon\">\n              <el-icon><InfoFilled /></el-icon>\n            </div>\n            <h3 class=\"empty-title\">当前分类下暂无文档</h3>\n          </div>\n          \n          <div v-else class=\"document-grid\">\n            <el-card \n              v-for=\"doc in documents\" \n              :key=\"doc.id\" \n              class=\"document-item-card\" \n              shadow=\"hover\"\n              body-style=\"padding: 0; height: 100%; display: flex; flex-direction: column;\"\n            >\n              <div class=\"card-header\">\n                <div class=\"file-icon\" :class=\"'file-icon-' + doc.file_type\">\n                  <component :is=\"getFileIcon(doc.file_type)\" />\n              </div>\n                <div class=\"document-title-block\">\n                  <h5 class=\"document-title\" :title=\"doc.title\">\n                    {{ doc.title }}\n                    <span v-if=\"doc.file_type\" class=\"file-extension\">.{{ doc.file_type }}</span>\n                  </h5>\n                  </div>\n                </div>\n              <div class=\"card-body\">\n                <p class=\"document-description\">\n                  {{ doc.description || '暂无描述信息' }}\n                </p>\n              </div>\n              <div class=\"card-footer\">\n                <div class=\"document-meta\">\n                  <el-icon><Clock /></el-icon>\n                  <span>{{ formatDate(doc.date) }}</span>\n                </div>\n                <div class=\"card-actions\">\n                  <el-button type=\"primary\" text bg :icon=\"Download\" @click.stop=\"downloadDocument(doc)\">下载</el-button>\n                   <!-- <el-dropdown trigger=\"click\" @click.stop>\n                    <el-button text bg class=\"more-button\">\n                      <el-icon><MoreFilled /></el-icon>\n                  </el-button>\n                  <template #dropdown>\n                    <el-dropdown-menu>\n                        <el-dropdown-item @click=\"editDocument(doc)\" :icon=\"Edit\">编辑</el-dropdown-item>\n                        <el-dropdown-item @click=\"deleteDocument(doc)\" :icon=\"Delete\" class=\"delete-item\">删除</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown> -->\n              </div>\n            </div>\n            </el-card>\n          </div>\n          \n          <div v-if=\"documents.length > 0\" class=\"pagination-wrapper\">\n            <el-pagination\n              background\n              layout=\"total, sizes, prev, pager, next, jumper\"\n              :total=\"totalDocs\"\n              :page-size=\"pageSize\"\n              :page-sizes=\"[12, 24, 48, 96]\"\n              :current-page=\"currentPage\"\n              @current-change=\"handlePageChange\"\n              @size-change=\"handleSizeChange\"\n            />\n          </div>\n        </el-card>\n      </div>\n    </div>\n    \n    <!-- 文件上传对话框 -->\n    <el-dialog\n      v-model=\"uploadVisible\"\n      title=\"上传文档\"\n      width=\"500px\"\n      :before-close=\"handleCloseUploadDialog\"\n    >\n      <el-form ref=\"uploadFormRef\" :model=\"uploadForm\" :rules=\"uploadRules\">\n        <el-form-item label=\"文档标题\" prop=\"title\">\n          <el-input v-model=\"uploadForm.title\" placeholder=\"请输入文档标题\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"文档描述\">\n          <el-input v-model=\"uploadForm.description\" type=\"textarea\" :rows=\"3\" placeholder=\"请输入文档描述\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"选择分类\">\n          <el-select v-model=\"uploadForm.category\" placeholder=\"请选择分类\" style=\"width: 100%\">\n            <el-option\n              v-for=\"(cat, idx) in categories.filter(c => c.id !== 'all')\"\n              :key=\"idx\"\n              :label=\"cat.name\"\n              :value=\"cat.id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"文档文件\" prop=\"file\">\n          <el-upload\n            class=\"upload-demo\"\n            drag\n            action=\"javascript:void(0);\"\n            :auto-upload=\"false\"\n            :on-change=\"handleFileChange\"\n            :on-remove=\"handleRemove\"\n            :limit=\"1\"\n            :before-upload=\"beforeUpload\"\n            :on-error=\"handleUploadError\"\n            ref=\"uploadRef\"\n          >\n            <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\n            <div class=\"el-upload__text\">\n              拖拽文件到此处或<em>点击上传</em>\n            </div>\n            <template #tip>\n              <div class=\"el-upload__tip\">\n                <strong>仅支持</strong>上传 txt, pdf, doc, docx, md, ppt, pptx, xls, xlsx 格式文件，单个文件不超过10MB\n              </div>\n            </template>\n          </el-upload>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"handleCancelUpload\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitUpload\" :loading=\"uploading\">上传</el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 分类管理对话框 -->\n    <el-dialog\n      v-model=\"showCategoryDialog\"\n      title=\"分类管理\"\n      width=\"850px\"\n    >\n      <div class=\"category-dialog-content\">\n        <div class=\"category-list-section\">\n          <div class=\"section-header\">\n            <h5>已有分类</h5>\n            <!-- <el-button \n              type=\"primary\" \n              size=\"small\" \n              @click=\"resetCategoryForm\">\n              <el-icon><Plus /></el-icon> 新增分类\n            </el-button> -->\n          </div>\n          \n          <div v-if=\"categoryLoading\" class=\"text-center p-4\">\n            <el-icon class=\"is-loading\"><Loading /></el-icon> 加载中...\n          </div>\n          \n          <div v-else-if=\"categories.length <= 1\" class=\"empty-categories\">\n            <el-empty description=\"\" />\n          </div>\n          \n          <div v-else class=\"category-items\">\n            <div v-for=\"(category, index) in categories.filter(c => c.id !== 'all')\" :key=\"index\" class=\"category-list-item\">\n              <div class=\"category-info\">\n                <div class=\"category-color\" :style=\"{ backgroundColor: category.color }\"></div>\n                <div class=\"category-name-section\">\n                  <div class=\"category-name\" :title=\"category.name\">{{ category.name }}</div>\n                  <div class=\"category-desc\" :title=\"category.description\">{{ category.description || '无描述' }}</div>\n                </div>\n              </div>\n              \n              <div class=\"category-details\">\n                <span class=\"category-count\">{{ category.document_count || 0 }}个文档</span>\n                <div class=\"category-actions\">\n                    <el-button type=\"primary\" size=\"small\" plain @click=\"editCategory(category)\">\n                      <el-icon><Edit /></el-icon>\n                    </el-button>\n                    <el-button type=\"danger\" size=\"small\" plain @click=\"handleDeleteCategory(category)\">\n                      <el-icon><Delete /></el-icon>\n                    </el-button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div v-if=\"showAddCategoryForm\" class=\"category-form-section\">\n          <div class=\"section-header\">\n            <h5>{{ editingCategory ? '编辑分类' : '新增分类' }}</h5>\n            <el-button size=\"small\" @click=\"cancelCategoryForm\">\n              取消\n            </el-button>\n          </div>\n          \n          <el-form :model=\"categoryForm\" label-width=\"80px\">\n            <el-form-item label=\"分类名称\" required>\n              <el-input v-model=\"categoryForm.name\" placeholder=\"请输入分类名称\"></el-input>\n            </el-form-item>\n            \n            <el-form-item label=\"分类描述\">\n              <el-input type=\"textarea\" v-model=\"categoryForm.description\" :rows=\"2\" placeholder=\"请输入分类描述\"></el-input>\n            </el-form-item>\n            \n            <el-form-item label=\"图标\">\n              <el-select v-model=\"categoryForm.icon\" placeholder=\"选择图标\" style=\"width: 100%\">\n                <el-option value=\"Document\" label=\"文档\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Document /></el-icon> <span class=\"ml-2\">文档</span>\n                  </div>\n                </el-option>\n                <el-option value=\"Files\" label=\"文件夹\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Files /></el-icon> <span class=\"ml-2\">文件夹</span>\n                  </div>\n                </el-option>\n                <el-option value=\"Tickets\" label=\"票据\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><Tickets /></el-icon> <span class=\"ml-2\">票据</span>\n                  </div>\n                </el-option>\n                <el-option value=\"DataAnalysis\" label=\"数据分析\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><DataAnalysis /></el-icon> <span class=\"ml-2\">数据分析</span>\n                  </div>\n                </el-option>\n                <el-option value=\"PictureFilled\" label=\"图片\">\n                  <div class=\"d-flex align-items-center\">\n                    <el-icon><PictureFilled /></el-icon> <span class=\"ml-2\">图片</span>\n                  </div>\n                </el-option>\n              </el-select>\n            </el-form-item>\n            \n            <el-form-item label=\"颜色\">\n              <el-color-picker v-model=\"categoryForm.color\" show-alpha @change=\"formatColorValue\"></el-color-picker>\n              <span class=\"ml-2\">{{ categoryForm.color }}</span>\n            </el-form-item>\n            \n            <el-form-item>\n              <el-button type=\"primary\" @click=\"saveCategoryForm\">保存</el-button>\n              <el-button @click=\"cancelCategoryForm\">取消</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </el-dialog>\n\n    <!-- 知识库构建对话框组件 -->\n    <KnowledgeBuilder \n      v-model=\"buildingVisible\"\n      @build-completed=\"handleBuildCompleted\"\n      @build-failed=\"handleBuildFailed\"\n    />\n\n    <!-- 编辑文档对话框 -->\n    <el-dialog\n      v-model=\"editDialogVisible\"\n      title=\"编辑文档\"\n      width=\"500px\"\n      :before-close=\"handleCloseEditDialog\"\n    >\n      <el-form :model=\"editForm\" label-width=\"80px\">\n        <el-form-item label=\"文档标题\">\n          <el-input v-model=\"editForm.title\" placeholder=\"请输入文档标题\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"文档描述\">\n          <el-input v-model=\"editForm.description\" type=\"textarea\" :rows=\"3\" placeholder=\"请输入文档描述\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"选择分类\">\n          <el-select v-model=\"editForm.category\" placeholder=\"请选择分类\" style=\"width: 100%\">\n            <el-option\n              v-for=\"(cat, idx) in categories.filter(c => c.id !== 'all')\"\n              :key=\"idx\"\n              :label=\"cat.name\"\n              :value=\"cat.id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"handleCancelEditDialog\">取消</el-button>\n          <el-button type=\"primary\" @click=\"handleUpdateDocument\">保存</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, onMounted, onBeforeUnmount, onActivated, nextTick, watch } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { \n  Search, Upload, FolderAdd, View, Download, More, Share, \n  Edit, EditPen, FolderOpened, Star, Delete, Document, \n  Files, Tickets, DataAnalysis, PictureFilled, UploadFilled,\n  Loading, List, Grid, Crop, Plus, InfoFilled, Clock, User,\n  Refresh\n} from '@element-plus/icons-vue'\nimport { getCategories, getDocuments, getDocumentChunks, uploadDocument, updateDocument, deleteDocument as apiDeleteDocument, deleteCategory, updateCategory, addCategory, downloadDocumentFile } from '@/api/knowledge'\nimport KnowledgeBuilder from '@/components/KnowledgeBuilder.vue'\n\nexport default {\n  name: 'Knowledge',\n  components: {\n    KnowledgeBuilder\n  },\n  setup() {\n    // 路由相关\n    const route = useRoute();\n    \n    // 内部刷新标识\n    const internalRefreshKey = ref(Date.now());\n    \n    // 状态变量\n    const searchQuery = ref('')\n    const selectedCategory = ref('all')\n    const currentPage = ref(1)\n    const pageSize = ref(10)\n    const uploadVisible = ref(false)\n    const editDialogVisible = ref(false)\n    const showCategoryDialog = ref(false)\n    const showAddCategoryForm = ref(false)\n    const showChunksDialog = ref(false)\n    const editingCategory = ref(null)\n    const viewMode = ref('list')\n    const sortOrder = ref('-created_at')\n    const categoryLoading = ref(false)\n    const loading = ref(false)\n    const uploading = ref(false)\n    const chunksLoading = ref(false)\n    const isAdmin = ref(true) // 实际应用中从用户会话获取\n    const selectedDocument = ref(null)\n    const documentChunks = ref([])\n    const uploadFormRef = ref(null)\n    const uploadRef = ref(null)\n    const totalDocs = ref(0)\n    \n    // 编辑表单\n    const editForm = reactive({\n      id: null,\n      title: '',\n      description: '',\n      category: null,\n      creator: null,\n    })\n    \n    // 上传表单\n    const uploadForm = reactive({\n      title: '',\n      description: '',\n      file: null,\n      category: null,\n      tags: '',\n      chunk_size: 500,\n      chunk_overlap: 50,\n      is_public: true\n    })\n    \n    // 上传表单验证规则\n    const uploadRules = {\n      title: [\n        { required: true, message: '请输入文档标题', trigger: 'blur' }\n      ],\n      file: [\n        { required: true, message: '请上传文件', trigger: 'change' }\n      ]\n    }\n    \n    // 分类表单\n    const categoryForm = reactive({\n      id: null,\n      name: '',\n      description: '',\n      icon: 'Document',\n      color: '#409EFF'\n    })\n    \n    // 筛选条件\n    const filters = ref({\n      types: {\n        pdf: false,\n        doc: false,\n        xls: false,\n        ppt: false,\n        img: false,\n        txt: false,\n        md: false,\n      },\n    })\n    \n    // 知识分类\n    const categories = ref([\n      { id: 'all', name: '全部文档', icon: 'Files', color: '#007bff', document_count: 0 }\n    ])\n    \n    // 文档列表\n    const documents = ref([])\n    \n    // 计算属性\n    const currentCategoryName = computed(() => {\n      const category = categories.value.find(cat => cat.id === selectedCategory.value)\n      return category ? category.name : '全部文档'\n    })\n    \n    const processingCount = computed(() => {\n      return documents.value.filter(doc => doc.status === 'processing').length\n    })\n    \n    // 知识库构建相关状态\n    const buildingVisible = ref(false)\n    \n    // 方法\n    const fetchCategories = async () => {\n      categoryLoading.value = true\n      console.log('开始获取知识库分类...')\n      try {\n        // console.log('请求URL:', `${API_URL}/categories/`) // 已被实际API调用取代\n        const response = await getCategories() // API call for specific categories\n        console.log('获取分类响应:', response)\n        \n        let categoryList = []\n        \n        // 处理不同格式的响应 (for specific categories)\n        if (response) {\n          if (response.results && Array.isArray(response.results)) {\n            categoryList = response.results\n          } \n          else if (Array.isArray(response)) {\n            categoryList = response\n          } \n          else if (typeof response === 'object') {\n            const possibleArrayFields = ['data', 'categories', 'items'];\n            for (const field of possibleArrayFields) {\n              if (response[field] && Array.isArray(response[field])) {\n                categoryList = response[field];\n                break;\n              }\n            }\n          }\n        }\n\n        // Fetch the grand total of all documents\n        let grandTotalAllDocuments = 0;\n        try {\n          // Lightweight request to get the total count of all documents\n          const allDocsResponse = await getDocuments({ page: 1, page_size: 1 }); \n          if (allDocsResponse && Object.prototype.hasOwnProperty.call(allDocsResponse, 'count')) {\n            grandTotalAllDocuments = allDocsResponse.count;\n            console.log('获取到全部文档总数:', grandTotalAllDocuments);\n          } else {\n            console.warn('未能从 getDocuments 响应中获取总数 count:', allDocsResponse);\n          }\n        } catch (docError) {\n          console.error('获取全部文档总数失败:', docError);\n          // 保留 grandTotalAllDocuments = 0 或根据需要处理错误\n        }\n        \n        // 创建 \"全部文档\" 分类\n        const allCategory = { \n          id: 'all', \n          name: '全部文档', \n          icon: 'Files', \n          color: '#007bff', \n          document_count: grandTotalAllDocuments // 使用获取到的真实总数\n        }\n        \n        if (categoryList && categoryList.length > 0) {\n          console.log('找到分类数据，数量:', categoryList.length);\n          // 不再通过累加其他分类来计算 allCategory.document_count\n          categories.value = [allCategory, ...categoryList]\n        } else {\n          console.warn('未找到有效的分类数据');\n          if (response && response.message) {\n            ElMessage.warning(response.message);\n          } else if (!response && !categoryList.length) { // Only show if response was truly empty and no list was parsed\n             // 删除警告消息\n          }\n          categories.value = [allCategory]; // 至少显示\"全部文档\"分类\n        }\n      } catch (error) {\n        console.error('获取分类失败:', error)\n        if (error.response) {\n          console.error('错误响应状态:', error.response.status)\n          console.error('错误响应数据:', error.response.data)\n        } else if (error.message && error.message.includes('message channel closed')) {\n          console.warn('通信通道关闭：', error.message);\n          // 静默处理此类错误，不向用户显示\n        } else {\n          ElMessage.error('无法加载知识库分类，请检查网络连接或联系管理员')\n        }\n        // 确保至少有\"全部\"分类可显示\n        categories.value = [{ \n          id: 'all', \n          name: '全部文档', \n          icon: 'Files', \n          color: '#007bff', \n          document_count: 0 \n        }];\n      } finally {\n        categoryLoading.value = false\n      }\n    }\n    \n    const fetchDocuments = async () => {\n      loading.value = true\n      try {\n        // 构建参数对象\n        const params = {\n          page: currentPage.value,\n          page_size: pageSize.value,\n          ordering: sortOrder.value\n        }\n        \n        // 添加筛选条件\n        if (selectedCategory.value && selectedCategory.value !== 'all') {\n          params.category = selectedCategory.value\n        }\n        \n        // 添加搜索查询\n        if (searchQuery.value) {\n          params.search = searchQuery.value\n        }\n        \n        // 添加文件类型筛选\n        const selectedTypes = []\n        const typeMapping = {\n          doc: ['doc', 'docx'],\n          xls: ['xls', 'xlsx'],\n          ppt: ['ppt', 'pptx'],\n        };\n\n        for (const [type, selected] of Object.entries(filters.value.types)) {\n          if (selected) {\n            if (typeMapping[type]) {\n              selectedTypes.push(...typeMapping[type]);\n            } else {\n              selectedTypes.push(type);\n            }\n          }\n        }\n        \n        // 使用Set去重，以防将来可能的逻辑重叠\n        const uniqueSelectedTypes = [...new Set(selectedTypes)];\n\n        if (uniqueSelectedTypes.length > 0) {\n          params.file_type = uniqueSelectedTypes.join(',')\n        }\n        \n        const response = await getDocuments(params)\n        if (response) {\n          console.log('获取文档响应:', response)\n          \n          // 处理不同格式的响应\n          if (response.results && Array.isArray(response.results)) {\n            // 分页格式的响应\n            documents.value = response.results\n            totalDocs.value = response.count || response.total || documents.value.length\n          } else if (Array.isArray(response)) {\n            // 数组格式的响应\n            documents.value = response\n            totalDocs.value = response.length\n          } else if (response.data && Array.isArray(response.data)) {\n            // 另一种常见的对象包装格式\n            documents.value = response.data\n            totalDocs.value = response.total || response.count || documents.value.length\n          } else if (typeof response === 'object') {\n            // 尝试提取可能的文档列表\n            const possibleDocuments = Object.values(response).filter(item => \n              item && typeof item === 'object' && ('title' in item || 'file' in item)\n            )\n            if (possibleDocuments.length > 0) {\n              documents.value = possibleDocuments\n              totalDocs.value = possibleDocuments.length\n            } else {\n              console.error('无法从响应中提取文档列表:', response)\n              documents.value = []\n              totalDocs.value = 0\n              ElMessage.warning('获取文档列表格式异常')\n            }\n          } else {\n            console.error('文档响应格式不支持:', typeof response, response)\n            documents.value = []\n            totalDocs.value = 0\n            ElMessage.warning('获取文档列表格式不支持')\n          }\n        } else {\n          documents.value = []\n          totalDocs.value = 0\n        }\n      } catch (error) {\n        console.error('获取文档失败:', error)\n        ElMessage.error('无法加载知识库文档')\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    const fetchDocumentChunks = async (documentId) => {\n      chunksLoading.value = true\n      try {\n        const response = await getDocumentChunks(documentId)\n        documentChunks.value = response\n      } catch (error) {\n        console.error('获取文档分块失败:', error)\n        ElMessage.error('无法加载文档分块数据')\n      } finally {\n        chunksLoading.value = false\n      }\n    }\n    \n    const handlePageChange = (page) => {\n      currentPage.value = page\n      fetchDocuments()\n    }\n    \n    const handleSizeChange = (size) => {\n      pageSize.value = size\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const selectCategory = (categoryId) => {\n      selectedCategory.value = categoryId\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const handleSearch = () => {\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const applyFilters = () => {\n      currentPage.value = 1\n      fetchDocuments()\n    }\n    \n    const handleFileChange = (file) => {\n      console.log(\">>> handleFileChange: Received file object from el-upload:\", file);\n      if (file && file.raw) {\n        console.log(\">>> handleFileChange: file.raw (the actual File object):\", file.raw);\n        \n        // 检查文件大小是否为0，这会导致上传失败\n        if (file.raw.size === 0) {\n          ElMessage.error('文件大小为0，请选择有效文件');\n          return false;\n        }\n        \n        // 检查文件是否过大（例如超过10MB）\n        const maxSizeInBytes = 10 * 1024 * 1024; // 10MB\n        if (file.raw.size > maxSizeInBytes) {\n          ElMessage.error(`文件过大，最大支持${maxSizeInBytes / (1024 * 1024)}MB`);\n          return false;\n        }\n        \n        // 严格检查文件扩展名是否支持\n        const fileName = file.raw.name;\n        const ext = fileName.slice(fileName.lastIndexOf('.') + 1).toLowerCase();\n        const allowedFileTypes = ['txt', 'pdf', 'doc', 'docx', 'md', 'ppt', 'pptx', 'xls', 'xlsx'];\n        \n        if (!allowedFileTypes.includes(ext)) {\n          ElMessage.error(`不支持的文件类型: ${ext}。仅支持 ${allowedFileTypes.join(', ')} 格式。`);\n          // 不支持的文件类型不应该更新uploadForm.file\n          uploadForm.file = null;\n          // 清除上传组件中显示的文件\n          if (uploadRef.value) {\n            uploadRef.value.clearFiles();\n          }\n          return false;\n        }\n        \n        // 仅在验证通过后设置文件\n        uploadForm.file = file.raw\n        console.log(\">>> handleFileChange: uploadForm.file after assignment:\", uploadForm.file, uploadForm.file ? `Name: ${uploadForm.file.name}, Size: ${uploadForm.file.size} bytes, Type: ${uploadForm.file.type}` : 'No file');\n        uploadForm.title = uploadForm.title || file.name.split('.')[0];\n        \n        // 返回true表示验证通过\n        return true;\n      } else {\n        console.warn(\">>> handleFileChange: file.raw is not available. File:\", file);\n        return false;\n      }\n    }\n    \n    const handleRemove = () => {\n      console.log(\">>> handleRemove: File removed by user. Setting uploadForm.file to null.\");\n      uploadForm.file = null;\n      \n      // 如果标题是自动从文件名生成的，也清除标题\n      if (uploadForm.title && uploadForm.title.includes('.')) {\n        const fileNameWithoutExt = uploadForm.file?.name?.split('.')[0];\n        if (uploadForm.title === fileNameWithoutExt) {\n          uploadForm.title = '';\n        }\n      }\n    }\n    \n    const beforeUpload = (file) => {\n      // 获取文件扩展名\n      const fileName = file.name;\n      const ext = fileName.slice(fileName.lastIndexOf('.') + 1).toLowerCase();\n      \n      // 允许的文件类型列表\n      const allowedFileTypes = ['txt', 'pdf', 'doc', 'docx', 'md', 'ppt', 'pptx', 'xls', 'xlsx'];\n      \n      // 严格检查文件类型\n      if (!allowedFileTypes.includes(ext)) {\n        ElMessage.error(`不支持的文件类型: ${ext}。仅支持 ${allowedFileTypes.join(', ')} 格式。`);\n        return false;\n      }\n      \n      // 检查文件大小\n      const maxSizeInBytes = 10 * 1024 * 1024; // 10MB\n      if (file.size > maxSizeInBytes) {\n        ElMessage.error(`文件大小超过限制，最大支持 ${maxSizeInBytes / (1024 * 1024)}MB`);\n        return false;\n      }\n      \n      // 检查文件是否为空\n      if (file.size === 0) {\n        ElMessage.error('文件为空，请选择有效文件');\n        return false;\n      }\n      \n      return true;\n    }\n    \n    const handleUploadError = (error) => {\n      console.error('上传错误:', error);\n      ElMessage.error('上传错误，请检查文件格式或网络连接');\n      // 移除错误文件\n      uploadForm.file = null;\n    }\n    \n    const submitUpload = async () => {\n      if (!uploadFormRef.value) return\n      \n      await uploadFormRef.value.validate(async (valid) => {\n        if (valid) {\n          uploading.value = true\n          \n          console.log(\">>> submitUpload: Current uploadForm.file before appending to FormData:\", uploadForm.file);\n          if (!uploadForm.file) {\n            console.warn(\">>> submitUpload: uploadForm.file is null or undefined before appending.\");\n            uploading.value = false;\n            ElMessage.warning(\"请先选择文件再上传\");\n            return;\n          }\n          \n          // 再次检查文件大小，确保不是空文件或损坏文件\n          if (uploadForm.file.size === 0) {\n            console.error(\">>> submitUpload: 文件大小为0，无法上传\");\n            uploading.value = false;\n            ElMessage.error(\"文件大小为0，请选择有效文件\");\n            return;\n          }\n          \n          console.log(`>>> submitUpload: uploadForm.file details - Name: ${uploadForm.file.name}, Size: ${uploadForm.file.size} bytes, Type: ${uploadForm.file.type}`);\n          \n          // 创建formData对象，并添加文件和其他参数\n          const formData = new FormData()\n          formData.append('title', uploadForm.title)\n          formData.append('description', uploadForm.description)\n          formData.append('file', uploadForm.file) // Appending the file\n          \n          if (uploadForm.category) {\n            formData.append('category', uploadForm.category)\n            console.log(`>>> submitUpload: Attaching category to FormData: ${uploadForm.category}`)\n          } else {\n            console.log(\">>> submitUpload: No category selected (uploadForm.category is null/empty). Not attaching to FormData.\")\n          }\n          \n          formData.append('tags', JSON.stringify(uploadForm.tags))\n          formData.append('chunk_size', uploadForm.chunk_size.toString())\n          formData.append('chunk_overlap', uploadForm.chunk_overlap.toString())\n          formData.append('is_public', uploadForm.is_public.toString())\n          \n          // 再次检查formData中的文件是否正确\n          const fileInFormData = formData.get('file');\n          if (!fileInFormData || fileInFormData.size === 0) {\n            console.error(\">>> submitUpload: FormData中的文件无效或大小为0\");\n            uploading.value = false;\n            ElMessage.error(\"FormData处理文件失败，请重试\");\n            return;\n          }\n\n          try {\n            const response = await uploadDocument(formData) // Assuming uploadDocument returns the new document object or its ID\n            console.log(\">>> submitUpload: API Response from uploadDocument:\", response);\n\n            ElMessage.success('文档上传请求已发送，后台正在处理...')\n            uploading.value = false // 确保上传状态被重置\n            uploadVisible.value = false\n            const uploadedFileTitle = uploadForm.title; // Store title for polling check\n            resetUploadForm()\n\n            // Start polling for document status if response contains an ID or enough info\n            // For simplicity, we'll poll fetchDocuments and look for the title, assuming titles are reasonably unique for recent uploads.\n            // A more robust way is if backend returns the new document ID, and we poll a getDocumentById(id) endpoint.\n            // Or if the document object in fetchDocuments has a clear 'status' field (e.g., 'processing', 'completed').\n            \n            let attempts = 0;\n            const maxAttempts = 10; // Poll for max 30 seconds (10 attempts * 3s interval)\n            const pollInterval = 3000; // 3 seconds\n\n            const poll = setInterval(async () => {\n              attempts++;\n              console.log(`>>> Polling for document status (attempt ${attempts}/${maxAttempts})...`);\n              try {\n                // Fetch the list of documents, usually sorted by creation date descending\n                const documentsResponse = await getDocuments({ \n                  page: 1, \n                  page_size: 10, // Check recent documents\n                  ordering: '-created_at', \n                  category: selectedCategory.value || undefined, // Use current category or all if 'all'\n                  // search: uploadedFileTitle // Optionally, if backend supports search by title for recent items\n                });\n\n                let foundDoc = null;\n                if (documentsResponse && documentsResponse.results && documentsResponse.results.length > 0) {\n                  // Attempt to find the document by title. This is a simplification.\n                  // Ideally, backend returns ID and we poll for that ID, or a status field directly.\n                  foundDoc = documentsResponse.results.find(doc => doc.title === uploadedFileTitle);\n                  \n                  // MORE ROBUST CHECK: Assume doc object has a 'status' field from backend\n                  // Example: if (doc.status === 'completed') { ... }\n                  // For now, if we find it by title recently, we assume it might be processed or soon.\n                }\n\n                if (foundDoc) {\n                  // Let's assume if found by title, it's processed enough for a refresh.\n                  // Replace this with actual status check if backend provides 'status' field.\n                  console.log(`>>> Polling: Document \"${uploadedFileTitle}\" found (or assumed processed). Refreshing lists.`);\n                  clearInterval(poll);\n                  fetchDocuments();\n                  fetchCategories();\n                  ElMessage.success(`文档 \"${uploadedFileTitle}\" 处理完毕并已刷新列表!`);\n                  // 确保所有状态正确重置\n                  uploading.value = false;\n                } else if (attempts >= maxAttempts) {\n                  console.log(\">>> Polling: Max attempts reached. Refreshing lists anyway.\");\n                  clearInterval(poll);\n                  fetchDocuments();\n                  fetchCategories();\n                  ElMessage.info(`文档 \"${uploadedFileTitle}\" 可能仍在后台处理中，列表已刷新。`);\n                  // 确保所有状态正确重置\n                  uploading.value = false;\n                }\n              } catch (pollError) {\n                console.error(\">>> Polling error:\", pollError);\n                clearInterval(poll);\n                // Still refresh, as the document might be there despite polling error\n                fetchDocuments();\n                fetchCategories();\n                ElMessage.error('检查文档状态时出错，列表已刷新。');\n                // 确保所有状态正确重置\n                uploading.value = false;\n              }\n            }, pollInterval);\n\n          } catch (error) {\n            console.error('上传文档失败:', error)\n            uploading.value = false;\n            // 在上传失败时清除文件选择状态\n            if (uploadRef.value) {\n              uploadRef.value.clearFiles();\n            }\n            let errorMsg = '文档上传失败'\n            if (error.response && error.response.data) {\n              const data = error.response.data;\n              if (typeof data === 'string') errorMsg += ': ' + data;\n              else if (data.detail) errorMsg += ': ' + data.detail;\n              else if (data.message) errorMsg += ': ' + data.message;\n              else if (data.file && Array.isArray(data.file)) errorMsg += ': ' + data.file.join(', ');\n              // 处理特定的文件类型错误\n              else if (data.status === 'error' && data.message && data.message.includes('不支持的文件类型')) {\n                errorMsg = data.message; // 直接使用后端的错误消息\n              }\n              else if (typeof data === 'object') errorMsg += ': ' + JSON.stringify(data).substring(0, 100);\n            }\n            ElMessage.error(errorMsg);\n          }\n        } else {\n          console.log('error submit!! Form validation failed.');\n          uploading.value = false; // Ensure uploading is reset if validation fails\n          return false;\n        }\n      })\n    }\n    \n    const showDocumentChunks = async (doc) => {\n      selectedDocument.value = doc\n      showChunksDialog.value = true\n      await fetchDocumentChunks(doc.id)\n    }\n    \n    const editCategory = (category) => {\n      editingCategory.value = category\n      categoryForm.id = category.id\n      categoryForm.name = category.name\n      categoryForm.description = category.description || ''\n      categoryForm.icon = category.icon || 'Document'\n      \n      // 确保颜色值不超过20个字符\n      if (category.color && category.color.length > 20) {\n        categoryForm.color = category.color.substring(0, 20);\n        console.log(`编辑分类时截断颜色值: ${category.color} -> ${categoryForm.color}`);\n      } else {\n        categoryForm.color = category.color || '#409EFF'\n      }\n      \n      showAddCategoryForm.value = true // 显示编辑表单\n    }\n    \n    const handleDeleteCategory = async (category) => {\n      try {\n        await ElMessageBox.confirm(`确定要删除分类 \"${category.name}\" 吗？`, '删除确认', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n        \n        await deleteCategory(category.id)\n        ElMessage.success('分类删除成功')\n        fetchCategories()\n      } catch (error) {\n        if (error !== 'cancel') {\n          console.error('删除分类失败:', error)\n          ElMessage.error('删除分类失败: ' + (error.response?.data?.detail || error.message || '未知错误'))\n        }\n      }\n    }\n    \n    const saveCategoryForm = async () => {\n      console.log('保存分类表单被调用，模式:', editingCategory.value ? 'edit' : 'add')\n      \n      // 确保颜色值不超过20个字符\n      formatColorValue(categoryForm.color);\n      \n      showAddCategoryForm.value = false\n      if (editingCategory.value) {\n        console.log('尝试更新分类:', categoryForm)\n        if (!editingCategory.value.id) {\n            ElMessage.error('无法更新分类，未找到当前编辑的分类ID');\n            return;\n        }\n        try {\n          const response = await updateCategory(editingCategory.value.id, categoryForm)\n          console.log('更新分类响应:', response)\n          if (response && (response.id || (response.data && response.data.id))) {\n            ElMessage.success('分类更新成功')\n            await fetchCategories() // 刷新分类列表\n            // 如果当前编辑的分类就是选中的分类，可能需要刷新文档列表\n            if (selectedCategory.value === (response.id || response.data.id)) {\n              await fetchDocuments();\n            }\n          } else if (response && response.error) {\n            ElMessage.error(`更新分类失败: ${response.error.message || '未知错误'}`)\n          } else if (response && response.detail) {\n             ElMessage.error(`更新分类失败: ${response.detail}`)\n          }\n          else {\n            ElMessage.error('更新分类失败，响应格式不符合预期或无ID返回')\n          }\n        } catch (error) {\n          console.error('更新分类失败:', error)\n          ElMessage.error('更新分类失败，请检查网络或联系管理员')\n        }\n      } else {\n        console.log('尝试添加新分类:', categoryForm)\n        try {\n          const response = await addCategory(categoryForm)\n          console.log('添加分类响应:', response)\n          if (response && (response.id || (response.data && response.data.id))) {\n            ElMessage.success('分类添加成功')\n            await fetchCategories() // 刷新分类列表\n            // 自动选中新创建的分类并刷新文档列表\n            const newCategoryId = response.id || response.data.id;\n            if (newCategoryId) {\n              selectedCategory.value = newCategoryId;\n              console.log(`新分类创建成功，自动选中新分类 ID: ${newCategoryId}`);\n              await fetchDocuments(); // 刷新文档列表以显示新选中的分类（初始为空）\n            } else {\n              console.warn(\"新创建的分类ID未找到，无法自动选中。\");\n            }\n          } else if (response && response.error) {\n            ElMessage.error(`添加分类失败: ${response.error.message || '未知错误'}`)\n          } else if (response && response.detail) {\n             ElMessage.error(`添加分类失败: ${response.detail}`)\n          }\n           else {\n            ElMessage.error('添加分类失败，响应格式不符合预期或无ID返回')\n            console.error(\"添加分类失败，响应:\", response);\n          }\n        } catch (error) {\n          console.error('添加分类失败:', error)\n          ElMessage.error('添加分类失败，请检查网络或联系管理员')\n        }\n      }\n      resetCategoryForm()\n    }\n    \n    const cancelCategoryForm = () => {\n      showAddCategoryForm.value = false\n      editingCategory.value = null\n      categoryForm.id = null\n      categoryForm.name = ''\n      categoryForm.description = ''\n      categoryForm.icon = 'Document'\n      categoryForm.color = '#409EFF' // 确保默认颜色值不超过20个字符\n    }\n    \n    const resetCategoryForm = () => {\n      editingCategory.value = null\n      categoryForm.id = null\n      categoryForm.name = ''\n      categoryForm.description = ''\n      categoryForm.icon = 'Document'\n      categoryForm.color = '#409EFF' // 确保默认颜色值不超过20个字符\n      showAddCategoryForm.value = true\n    }\n    \n    const resetUploadForm = () => {\n      if (uploadFormRef.value) {\n        // 使用el-form的resetFields方法重置表单\n        uploadFormRef.value.resetFields(); \n      }\n      \n      // 手动重置所有uploadForm字段，确保全部清空\n      uploadForm.title = ''\n      uploadForm.description = ''\n      uploadForm.file = null\n      uploadForm.category = null // Explicitly reset category\n      uploadForm.tags = ''\n      uploadForm.is_public = true\n      uploadForm.chunk_size = 500 // 重置为初始默认值\n      uploadForm.chunk_overlap = 50 // 重置为初始默认值\n      \n      // 清除上传组件中的文件\n      if (uploadRef.value) {\n        uploadRef.value.clearFiles();\n      }\n      \n      console.log(\">>> resetUploadForm: uploadForm和上传组件已完全重置\");\n    }\n    \n    const handleCancelUpload = () => {\n      // 如果正在上传，不允许关闭\n      if (uploading.value) {\n        ElMessage.warning('文件正在上传中，请等待上传完成');\n        return;\n      }\n      resetUploadForm();\n      uploadVisible.value = false;\n    }\n    \n    const handleCloseUploadDialog = (done) => {\n      handleCancelUpload();\n      done(); // 允许关闭对话框\n    }\n    \n    const openUploadDialog = () => {\n      resetUploadForm(); // Reset form first for a clean state\n      if (selectedCategory.value && selectedCategory.value !== 'all') {\n        uploadForm.category = selectedCategory.value;\n        console.log(`>>> openUploadDialog: Auto-selecting current category: ${selectedCategory.value}`);\n      } else {\n        uploadForm.category = null; // If 'all' or no category is selected, let user choose in dialog\n        console.log(\">>> openUploadDialog: No category auto-selected (current is 'all' or none).\");\n      }\n      uploadVisible.value = true;\n    };\n    \n    // 文件操作函数\n    const previewDocument = async (doc) => {\n      try {\n        // 记录文档对象，便于调试\n        console.log('预览文档对象:', doc);\n        \n        // 检查是否有 original_file 字段\n        if (doc.original_file) {\n          try {\n            const response = await fetch(doc.original_file);\n            if (response.ok) {\n              const blob = await response.blob();\n              const url = window.URL.createObjectURL(blob);\n              window.open(url, '_blank');\n              setTimeout(() => window.URL.revokeObjectURL(url), 100);\n              return;\n            }\n          } catch (error) {\n            console.warn('通过 original_file 访问失败，尝试其他方式:', error);\n          }\n        }\n        \n        // 首先尝试通过API获取文件\n        try {\n          const response = await downloadDocumentFile(doc.id);\n        const blob = new Blob([response.data], { type: response.headers['content-type'] || 'application/octet-stream' });\n        const url = window.URL.createObjectURL(blob);\n        window.open(url, '_blank');\n        setTimeout(() => window.URL.revokeObjectURL(url), 100);\n          return;\n        } catch (apiError) {\n          console.warn('通过API获取文件失败，尝试直接访问文件URL:', apiError);\n        }\n        \n        // 如果API调用失败，尝试直接访问文件URL\n        if (doc.file_url) {\n          // 尝试直接访问原始URL\n          try {\n            const response = await fetch(doc.file_url);\n            if (response.ok) {\n              const blob = await response.blob();\n              const url = window.URL.createObjectURL(blob);\n              window.open(url, '_blank');\n              setTimeout(() => window.URL.revokeObjectURL(url), 100);\n              return;\n            }\n          } catch (urlError) {\n            console.warn('直接访问文件URL失败:', urlError);\n          }\n          \n          // 尝试修正的URL路径\n          // 从file_url中提取文件名\n          const fileUrlParts = doc.file_url.split('/');\n          const originalFilename = fileUrlParts[fileUrlParts.length - 1];\n          \n          // 尝试从file_url中提取可能的UUID\n          let uuid = null;\n          const uuidMatch = doc.file_url.match(/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/);\n          if (uuidMatch && uuidMatch[1]) {\n            uuid = uuidMatch[1];\n            console.log('从URL中提取的UUID:', uuid);\n          }\n          \n          // 构造可能的替代路径\n          const possiblePaths = [\n            `/media/original_files/${originalFilename}`,\n            `/media/original_files/company_1/${originalFilename}`,\n            `/backend/media/original_files/${originalFilename}`,\n            `/backend/media/original_files/company_1/${originalFilename}`,\n            `/media/documents/1/${originalFilename}`,\n            `/backend/media/documents/1/${originalFilename}`\n          ];\n          \n          // 如果文件名不是UUID格式，尝试在documents目录下查找可能匹配的文件\n          if (!originalFilename.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\.[a-z]+$/)) {\n            // 尝试使用文档ID作为文件名的一部分\n            if (doc.id) {\n              possiblePaths.push(`/media/documents/1/${doc.id}.${doc.file_type}`);\n              possiblePaths.push(`/backend/media/documents/1/${doc.id}.${doc.file_type}`);\n            }\n          }\n          \n          // 如果从URL中提取到了UUID，尝试使用UUID构造路径\n          if (uuid) {\n            possiblePaths.push(`/media/documents/1/${uuid}.${doc.file_type}`);\n            possiblePaths.push(`/backend/media/documents/1/${uuid}.${doc.file_type}`);\n          }\n          \n          // 尝试所有可能的路径\n          for (const path of possiblePaths) {\n            try {\n              const response = await fetch(path);\n              if (response.ok) {\n                const blob = await response.blob();\n                const url = window.URL.createObjectURL(blob);\n                window.open(url, '_blank');\n                setTimeout(() => window.URL.revokeObjectURL(url), 100);\n                return;\n              }\n            } catch (pathError) {\n              console.warn(`尝试路径 ${path} 失败:`, pathError);\n            }\n          }\n        }\n        \n        // 所有尝试都失败，显示错误消息\n        throw new Error('无法找到有效的文件路径');\n      } catch (error) {\n        console.error('预览文档失败:', error);\n        ElMessage.error('预览文档失败: 无法找到或访问文件。请联系管理员检查文件路径配置。');\n      }\n    }\n    \n    const downloadDocument = async (doc) => {\n      try {\n        // 记录文档对象，便于调试\n        console.log('下载文档对象:', doc);\n        \n        // 检查是否有 original_file 字段\n        if (doc.original_file) {\n          try {\n            const response = await fetch(doc.original_file);\n            if (response.ok) {\n              const blob = await response.blob();\n              const filename = doc.original_filename || doc.title + '.' + doc.file_type;\n              \n              const url = window.URL.createObjectURL(blob);\n              const link = document.createElement('a');\n              link.href = url;\n              link.setAttribute('download', filename);\n              document.body.appendChild(link);\n              link.click();\n              document.body.removeChild(link);\n              window.URL.revokeObjectURL(url);\n              \n              ElMessage.success(`文档 \"${filename}\" 下载成功`);\n              return;\n            }\n          } catch (error) {\n            console.warn('通过 original_file 下载失败，尝试其他方式:', error);\n          }\n        }\n        \n        // 首先尝试通过API获取文件\n        try {\n          const response = await downloadDocumentFile(doc.id);\n          const filename = doc.title ? `${doc.title}.${doc.file_type}` : \n                          (doc.file_url ? doc.file_url.split('/').pop() : `document.${doc.file_type}`);\n          \n          const url = window.URL.createObjectURL(new Blob([response.data], { type: response.headers['content-type'] || 'application/octet-stream' }));\n          const link = document.createElement('a');\n          link.href = url;\n          link.setAttribute('download', filename);\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link);\n          window.URL.revokeObjectURL(url);\n          \n          ElMessage.success(`文档 \"${filename}\" 下载成功`);\n          return;\n        } catch (apiError) {\n          console.warn('通过API获取文件失败，尝试直接访问文件URL:', apiError);\n        }\n        \n        // 如果API调用失败，尝试直接访问文件URL\n        if (doc.file_url) {\n          // 尝试直接访问原始URL\n          try {\n            const response = await fetch(doc.file_url);\n            if (response.ok) {\n              const blob = await response.blob();\n              const filename = doc.title ? `${doc.title}.${doc.file_type}` : doc.file_url.split('/').pop();\n              \n              const url = window.URL.createObjectURL(blob);\n              const link = document.createElement('a');\n              link.href = url;\n              link.setAttribute('download', filename);\n              document.body.appendChild(link);\n              link.click();\n              document.body.removeChild(link);\n              window.URL.revokeObjectURL(url);\n              \n              ElMessage.success(`文档 \"${filename}\" 下载成功`);\n              return;\n            }\n          } catch (urlError) {\n            console.warn('直接访问文件URL失败:', urlError);\n          }\n          \n          // 尝试修正的URL路径\n          const fileUrlParts = doc.file_url.split('/');\n          const originalFilename = fileUrlParts[fileUrlParts.length - 1];\n          \n          // 尝试从file_url中提取可能的UUID\n          let uuid = null;\n          const uuidMatch = doc.file_url.match(/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/);\n          if (uuidMatch && uuidMatch[1]) {\n            uuid = uuidMatch[1];\n            console.log('从URL中提取的UUID:', uuid);\n          }\n          \n          // 构造可能的替代路径\n          const possiblePaths = [\n            `/media/original_files/${originalFilename}`,\n            `/media/original_files/company_1/${originalFilename}`,\n            `/backend/media/original_files/${originalFilename}`,\n            `/backend/media/original_files/company_1/${originalFilename}`,\n            `/media/documents/1/${originalFilename}`,\n            `/backend/media/documents/1/${originalFilename}`\n          ];\n          \n          // 如果文件名不是UUID格式，尝试在documents目录下查找可能匹配的文件\n          if (!originalFilename.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\.[a-z]+$/)) {\n            // 尝试使用文档ID作为文件名的一部分\n            if (doc.id) {\n              possiblePaths.push(`/media/documents/1/${doc.id}.${doc.file_type}`);\n              possiblePaths.push(`/backend/media/documents/1/${doc.id}.${doc.file_type}`);\n            }\n          }\n          \n          // 如果从URL中提取到了UUID，尝试使用UUID构造路径\n          if (uuid) {\n            possiblePaths.push(`/media/documents/1/${uuid}.${doc.file_type}`);\n            possiblePaths.push(`/backend/media/documents/1/${uuid}.${doc.file_type}`);\n          }\n          \n          // 尝试所有可能的路径\n          for (const path of possiblePaths) {\n            try {\n              const response = await fetch(path);\n              if (response.ok) {\n                const blob = await response.blob();\n                const filename = doc.title ? `${doc.title}.${doc.file_type}` : originalFilename;\n                \n                const url = window.URL.createObjectURL(blob);\n                const link = document.createElement('a');\n                link.href = url;\n                link.setAttribute('download', filename);\n                document.body.appendChild(link);\n                link.click();\n                document.body.removeChild(link);\n                window.URL.revokeObjectURL(url);\n                \n                ElMessage.success(`文档 \"${filename}\" 下载成功`);\n                return;\n              }\n            } catch (pathError) {\n              console.warn(`尝试路径 ${path} 失败:`, pathError);\n            }\n          }\n        }\n        \n        // 所有尝试都失败，显示错误消息\n        throw new Error('无法找到有效的文件路径');\n      } catch (error) {\n        console.error('下载文档失败:', error);\n        ElMessage.error('下载文档失败: 无法找到或访问文件。请联系管理员检查文件路径配置。');\n      }\n    }\n    \n    const shareDocument = (doc) => {\n      // 实现文档分享功能\n      console.log('准备分享文档:', doc.title)\n      ElMessage.info(`文档\"${doc.title}\"的分享功能即将上线`)\n    }\n    \n    const editDocument = (doc) => {\n      editForm.id = doc.id;\n      editForm.title = doc.title;\n      editForm.description = doc.description;\n      editForm.category = doc.category;\n      editForm.creator = doc.creator;\n      editDialogVisible.value = true;\n    }\n\n    const handleUpdateDocument = async () => {\n      if (!editForm.id) return;\n      try {\n        await updateDocument(editForm.id, {\n          title: editForm.title,\n          description: editForm.description,\n          category: editForm.category,\n          creator: editForm.creator,\n        });\n        ElMessage.success('文档更新成功');\n        editDialogVisible.value = false;\n        fetchDocuments(); // 刷新列表\n      } catch (error) {\n        console.error('更新文档失败:', error);\n        let errorMsg = '更新文档失败';\n        if (error.response && error.response.data) {\n          const data = error.response.data;\n          if (typeof data === 'object' && data !== null) {\n            const messages = Object.entries(data).map(([field, errors]) => {\n              return `${field}: ${Array.isArray(errors) ? errors.join(' ') : errors}`;\n            }).join('; ');\n\n            if (messages) {\n              errorMsg += `: ${messages}`;\n            } else {\n              errorMsg += `: 请求失败，无详细信息。`;\n            }\n          } else {\n            errorMsg += `: ${data}`;\n          }\n        } else if (error.message) {\n          errorMsg += `: ${error.message}`;\n        } else {\n          errorMsg += ': 未知错误';\n        }\n        ElMessage.error(errorMsg);\n      }\n    };\n    \n    const handleCloseEditDialog = (done) => {\n      editDialogVisible.value = false;\n      done();\n    }\n\n    const handleCancelEditDialog = () => {\n      editDialogVisible.value = false;\n    }\n\n    const deleteDocument = async (doc) => {\n      console.log('>>> Vue component: Attempting to delete document (local method):', doc); // Log entry\n      try {\n        await ElMessageBox.confirm(`确定要删除文档 \"${doc.title}\" 吗？此操作不可撤销。`, '删除确认', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n        \n        console.log('>>> Vue component: Calling apiDeleteDocument for ID:', doc.id); // Log before API call\n        await apiDeleteDocument(doc.id) // MODIFIED: Use imported and renamed apiDeleteDocument\n        \n        ElMessage.success('文档删除成功')\n        fetchDocuments()\n        fetchCategories() // 更新分类文档计数\n      } catch (error) {\n        if (error !== 'cancel') {\n          console.error('删除文档失败:', error)\n          // 使用更安全的错误消息提取\n          const errorMessage = error?.response?.data?.detail || error?.message || '未知错误';\n          ElMessage.error('删除文档失败: ' + errorMessage);\n        }\n      }\n    }\n    \n    // 获取文件图标\n    const getFileIcon = (fileType) => {\n      const extension = fileType ? fileType.toLowerCase() : '';\n      const iconMap = {\n        pdf: Document,\n        doc: Document,\n        docx: Document,\n        xls: DataAnalysis,\n        xlsx: DataAnalysis,\n        ppt: Tickets,\n        pptx: Tickets,\n        png: PictureFilled,\n        jpg: PictureFilled,\n        jpeg: PictureFilled,\n        gif: PictureFilled,\n        svg: PictureFilled,\n        img: PictureFilled,\n        txt: Files,\n        md: Files,\n        other: Files\n      };\n      return iconMap[extension] || Files;\n    };\n    \n    // 格式化日期\n    const formatDate = (dateString) => {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      })\n    }\n    \n    // 格式化文件大小\n    const formatFileSize = (sizeInKB) => {\n      if (!sizeInKB) return '0 KB'\n      \n      if (sizeInKB < 1024) {\n        return `${sizeInKB} KB`\n      } else {\n        return `${(sizeInKB / 1024).toFixed(2)} MB`\n      }\n    }\n    \n    // 获取标签列表\n    const getTagsList = (tags) => {\n      if (!tags) return []\n      if (Array.isArray(tags)) return tags\n      return tags.split(',').map(tag => tag.trim()).filter(tag => tag)\n    }\n    \n    // 处理构建完成\n    const handleBuildCompleted = () => {\n      // 刷新文档列表\n      fetchDocuments()\n      fetchCategories()\n      ElMessage.success('知识库构建完成，现在可以使用智能问答功能了！')\n    }\n\n    // 处理构建失败\n    const handleBuildFailed = (error) => {\n      console.error('知识库构建失败:', error)\n      ElMessage.error('知识库构建失败，请检查日志或联系管理员')\n    }\n    \n    // 格式化颜色值，确保不超过20个字符\n    const formatColorValue = (color) => {\n      if (color && color.length > 20) {\n        // 如果是带透明度的颜色值(rgba)，则去除透明度，转为hex格式\n        if (color.startsWith('rgba')) {\n          const hexColor = color.replace(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),[^)]+\\)/, (match, r, g, b) => {\n            const toHex = (c) => {\n              const hex = parseInt(c).toString(16);\n              return hex.length === 1 ? '0' + hex : hex;\n            };\n            return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n          });\n          categoryForm.color = hexColor.substring(0, 20);\n        } else {\n          // 如果是其他格式，直接截断\n          categoryForm.color = color.substring(0, 20);\n        }\n        console.log(`颜色值已格式化: ${color} -> ${categoryForm.color}`);\n      }\n    };\n    \n    // 添加一个强制刷新函数\n    const forceRefresh = async () => {\n      console.log('强制刷新知识库组件');\n      \n      // 更新内部刷新标识，触发视图更新\n      internalRefreshKey.value = Date.now();\n      \n      // 重置所有状态\n      currentPage.value = 1;\n      \n      // 第一步：清除所有可能的DOM副作用\n      try {\n        // 清除所有浮层和遮罩\n        const overlays = document.querySelectorAll('.el-overlay, .el-overlay-dialog, .el-overlay-message-box, .el-popup-parent--hidden');\n        overlays.forEach(el => {\n          if (el && el.parentNode) {\n            try {\n              el.parentNode.removeChild(el);\n            } catch (e) {\n              console.error('清理浮层元素失败:', e);\n            }\n          }\n        });\n        \n        // 恢复body样式\n        if (document && document.body) {\n          document.body.style.overflow = '';\n          document.body.classList.remove('el-popup-parent--hidden');\n          document.body.style.pointerEvents = 'auto';\n        }\n        \n        // 处理所有可能的下拉菜单\n        const dropdowns = document.querySelectorAll('.el-dropdown-menu, .el-select-dropdown');\n        dropdowns.forEach(el => {\n          if (el && el.parentNode) {\n            try {\n              el.parentNode.removeChild(el);\n            } catch (e) {\n              console.error('清理下拉菜单失败:', e);\n            }\n          }\n        });\n      } catch (error) {\n        console.error('清理DOM元素失败:', error);\n      }\n      \n      // 第二步：重新绑定所有事件\n      await nextTick();\n      try {\n        // 确保所有按钮和交互元素可点击\n        const interactiveElements = document.querySelectorAll(\n          '.knowledge-container button, ' +\n          '.el-dropdown-menu__item, ' +\n          '.document-item-card, ' +\n          '.card-actions button, ' +\n          '.card-footer button, ' +\n          '.el-dropdown, ' +\n          '.category-item'\n        );\n        \n        interactiveElements.forEach(el => {\n          if (el) {\n            // 恢复所有交互元素的点击能力\n            el.style.pointerEvents = 'auto';\n            if (el.hasAttribute('disabled') && !el.classList.contains('is-disabled')) {\n              el.removeAttribute('disabled');\n            }\n            \n            // 为了确保事件能正确触发，我们尝试复制并替换元素\n            // 这会清除旧的事件监听器并保持Vue的绑定\n            try {\n              const parent = el.parentNode;\n              if (parent) {\n                // 使用克隆节点的方式可能会丢失Vue的绑定，所以我们只重置样式\n                el.style.opacity = '1';\n                el.style.visibility = 'visible';\n                el.style.display = '';\n              }\n            } catch (e) {\n              console.error('重置元素样式失败:', e);\n            }\n          }\n        });\n        \n        // 重置上传组件\n        if (uploadRef.value) {\n          uploadRef.value.clearFiles();\n          uploadForm.file = null;\n          uploadForm.title = '';\n          uploadForm.description = '';\n        }\n        \n        // 确保文档卡片可点击\n        document.querySelectorAll('.document-item-card').forEach(card => {\n          if (card) {\n            card.style.pointerEvents = 'auto';\n            card.style.cursor = 'pointer';\n            // 重置z-index确保没有被覆盖\n            card.style.zIndex = '1';\n            card.style.position = 'relative';\n          }\n        });\n        \n        // 特别处理下拉菜单\n        document.querySelectorAll('.el-dropdown').forEach(dropdown => {\n          if (dropdown) {\n            dropdown.style.pointerEvents = 'auto';\n          }\n        });\n      } catch (error) {\n        console.error('重置交互元素失败:', error);\n      }\n      \n      // 第三步：强制重新获取数据\n      try {\n        console.log('重新加载所有数据...');\n        loading.value = true;\n        \n        // 先获取分类数据\n        await fetchCategories().catch(err => {\n          console.error('强制刷新分类失败:', err);\n          return [];\n        });\n        \n        // 然后获取文档数据\n        await fetchDocuments().catch(err => {\n          console.error('强制刷新文档失败:', err);\n          return [];\n        });\n        \n        console.log('数据刷新完成');\n      } catch (error) {\n        console.error('强制刷新数据失败:', error);\n      } finally {\n        loading.value = false;\n      }\n      \n      // 第四步：再次确保DOM更新完成后的交互性\n      await nextTick();\n      setTimeout(() => {\n        try {\n          // 最后一次确保所有元素可交互\n          document.querySelectorAll('.knowledge-container button, .el-dropdown, .document-item-card').forEach(el => {\n            if (el) {\n              el.style.pointerEvents = 'auto';\n            }\n          });\n        } catch (error) {\n          console.error('最终DOM修复失败:', error);\n        }\n      }, 300);\n    };\n    \n    // 监听路由变化，确保每次进入页面都刷新\n    watch(() => route.fullPath, (newPath) => {\n      if (newPath === '/knowledge') {\n        console.log('检测到路由变化到知识库页面，强制刷新');\n        // 延迟执行，确保DOM已经渲染\n        setTimeout(() => {\n          forceRefresh();\n        }, 100);\n      }\n    });\n    \n    // 生命周期钩子\n    onMounted(() => {\n      console.log('Knowledge组件挂载');\n      // 组件挂载时强制刷新\n      forceRefresh();\n      });\n    \n    // 添加keep-alive激活事件处理\n    onActivated(() => {\n      console.log('Knowledge组件被激活');\n      // 组件激活时强制刷新\n      forceRefresh();\n    });\n    \n    onBeforeUnmount(() => {\n      // 无需清除，因为没有设置轮询\n      // if (pollingInterval) {\n      //   clearInterval(pollingInterval)\n      // }\n    })\n    \n    return {\n      searchQuery,\n      selectedCategory,\n      categories,\n      documents,\n      filters,\n      currentPage,\n      pageSize,\n      totalDocs,\n      uploadVisible,\n      uploadForm,\n      uploadFormRef,\n      uploadRef,\n      uploadRules,\n      uploading,\n      loading,\n      viewMode,\n      sortOrder,\n      showCategoryDialog,\n      showAddCategoryForm,\n      editingCategory,\n      categoryForm,\n      categoryLoading,\n      showChunksDialog,\n      selectedDocument,\n      documentChunks,\n      chunksLoading,\n      isAdmin,\n      currentCategoryName,\n      processingCount,\n      forceRefresh,\n      internalRefreshKey,\n      \n      // 图标\n      Search,\n      Upload,\n      FolderAdd,\n      View,\n      Download,\n      More,\n      Share,\n      Edit,\n      EditPen,\n      FolderOpened,\n      Star,\n      Delete,\n      Document,\n      Files,\n      Tickets,\n      DataAnalysis,\n      PictureFilled,\n      UploadFilled,\n      Loading,\n      List,\n      Grid,\n      Crop,\n      Plus,\n      InfoFilled,\n      Clock,\n      User,\n      Refresh,\n      \n      // 方法\n      selectCategory,\n      handleSearch,\n      applyFilters,\n      getFileIcon,\n      formatDate,\n      formatFileSize,\n      getTagsList,\n      previewDocument,\n      downloadDocument,\n      shareDocument,\n      editDocument,\n      handleUpdateDocument,\n      handleCloseEditDialog,\n      handleCancelEditDialog,\n      deleteDocument,\n      handleFileChange,\n      handleRemove,\n      beforeUpload,\n      handleUploadError,\n      submitUpload,\n      handlePageChange,\n      handleSizeChange,\n      showDocumentChunks,\n      editCategory,\n      handleDeleteCategory,\n      saveCategoryForm,\n      cancelCategoryForm,\n      resetCategoryForm,\n      buildingVisible,\n      handleBuildCompleted,\n      handleBuildFailed,\n      resetUploadForm,\n      handleCloseUploadDialog,\n      openUploadDialog,\n      handleCancelUpload,\n      formatColorValue,\n      editDialogVisible,\n      editForm\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.knowledge-container {\n  padding: 20px;\n  height: 100%;\n  width: 100%;\n  background-color: var(--el-bg-color-page) !important;\n}\n\n/* 确保所有交互元素可点击 */\n.knowledge-container button,\n.knowledge-container .el-dropdown,\n.knowledge-container .document-item-card,\n.knowledge-container .category-item {\n  pointer-events: auto !important;\n  cursor: pointer !important;\n}\n\n/* 强制知识库页面的所有元素使用深色背景 */\n.knowledge-container .row,\n.knowledge-container .col-lg-3,\n.knowledge-container .col-lg-9,\n.knowledge-container .page-header,\n.knowledge-container .document-grid {\n  background-color: var(--el-bg-color-page) !important;\n}\n\n/* 确保下拉菜单项可点击 */\n:deep(.el-dropdown-menu__item) {\n  pointer-events: auto !important;\n  cursor: pointer !important;\n}\n\n.row {\n  display: flex;\n  gap: 20px;\n}\n\n.col-lg-3 {\n  flex: 0 0 280px;\n  width: 280px;\n}\n\n.col-lg-9 {\n  flex: 1;\n  min-width: 0;\n}\n\n.category-card {\n  border: none;\n  border-radius: 8px;\n  padding: 16px;\n  background-color: var(--el-bg-color);\n  height: 100%;\n}\n\n.search-box {\n  margin-bottom: 20px;\n}\n\n.category-list .category-item {\n  display: flex;\n  align-items: center;\n  padding: 12px;\n  cursor: pointer;\n  border-radius: 6px;\n  margin-bottom: 5px;\n  transition: background-color 0.2s ease-in-out;\n  \n  &.active {\n    background-color: var(--el-color-primary-light-9);\n    .category-name {\n      font-weight: 600;\n      color: var(--el-color-primary);\n    }\n  }\n  \n  &:hover {\n    background-color: var(--el-fill-color-light);\n  }\n  \n  .category-icon {\n    width: 32px;\n    height: 32px;\n    border-radius: 6px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-right: 12px;\n    .el-icon {\n      color: white !important;\n    }\n  }\n\n  .category-name {\n    flex-grow: 1;\n    font-weight: 500;\n  }\n\n  .category-count {\n    font-size: 12px;\n    color: #909399;\n    background-color: #e9e9eb;\n    padding: 2px 6px;\n    border-radius: 10px;\n  }\n}\n\n.add-category-btn {\n  width: 100%;\n  margin-top: 10px;\n}\n\n.filter-section {\n  margin-top: 20px;\n  h6 {\n    font-size: 14px;\n    color: var(--el-text-color-secondary);\n    margin-bottom: 10px;\n  }\n  .filter-group {\n    margin-bottom: 15px;\n  }\n  .filter-options {\n    display: flex;\n    flex-direction: column;\n  }\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  .page-title {\n    font-size: 28px;\n    font-weight: 600;\n    color: var(--el-text-color-primary);\n  }\n  .header-actions {\n  display: flex;\n    gap: 12px;\n  }\n}\n\n.document-container-card {\n  border: none;\n  border-radius: 8px;\n  background-color: var(--el-bg-color-overlay);\n  padding: 24px;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 60px 0;\n  .empty-icon {\n    font-size: 64px;\n    color: var(--el-text-color-placeholder);\n    margin-bottom: 20px;\n}\n  .empty-title {\n    font-size: 20px;\n    color: var(--el-text-color-primary);\n  margin-bottom: 10px;\n}\n  .empty-description {\n  color: var(--el-text-color-secondary);\n  margin-bottom: 20px;\n}\n}\n\n.document-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 24px;\n}\n\n.document-item-card {\n  border-radius: 12px;\n  border: 1px solid var(--el-border-color-lighter);\n  transition: all 0.3s ease;\n  background-color: var(--el-bg-color-overlay);\n\n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: var(--el-box-shadow-light);\n}\n\n  .card-header {\n  display: flex;\n  align-items: center;\n    gap: 12px;\n    padding: 16px;\n    border-bottom: 1px solid var(--el-border-color-lighter);\n}\n\n  .file-icon {\n    flex-shrink: 0;\n    width: 40px;\n    height: 40px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n    font-size: 20px;\n    color: #fff;\n\n    &.file-icon-pdf { background-color: #f56c6c; }\n    &.file-icon-doc, &.file-icon-docx { background-color: #409eff; }\n    &.file-icon-xls, &.file-icon-xlsx { background-color: #67c23a; }\n    &.file-icon-ppt, &.file-icon-pptx { background-color: #e6a23c; }\n    &.file-icon-img, &.file-icon-jpg, &.file-icon-jpeg, &.file-icon-png, &.file-icon-gif, &.file-icon-svg { background-color: #909399; }\n    &.file-icon-txt, &.file-icon-md { background-color: #b1b3b8; }\n}\n\n  .document-title-block {\n    flex-grow: 1;\n    overflow: hidden;\n}\n\n  .document-title {\n    font-size: 16px;\n    font-weight: 600;\n    color: var(--el-text-color-primary);\n    margin: 0;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;  \n  overflow: hidden;\n    text-overflow: ellipsis;\n    line-height: 1.4;\n}\n\n  .file-extension {\n    font-weight: 400;\n    color: var(--el-text-color-placeholder);\n    font-size: 14px;\n    margin-left: 2px;\n}\n\n  .card-body {\n    padding: 16px;\n    flex-grow: 1;\n    min-height: 85px;\n  }\n  \n  .document-description {\n    font-size: 14px;\n    color: var(--el-text-color-regular);\n  line-height: 1.6;\n    margin: 0;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;  \n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n  .card-footer {\n    margin-top: auto;\n    border-top: 1px solid var(--el-border-color-lighter);\n    padding: 10px 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n    background-color: var(--el-fill-color-lighter);\n}\n\n  .document-meta {\n    font-size: 13px;\n    color: var(--el-text-color-secondary);\n  display: flex;\n  align-items: center;\n    gap: 6px;\n}\n\n  .card-actions {\n  display: flex;\n  align-items: center;\n    gap: 4px;\n  }\n}\n\n.pagination-wrapper {\n  margin-top: 24px;\n  display: flex;\n  justify-content: center;\n  :deep(.el-pagination.is-background .el-pager li) {\n    background-color: var(--el-fill-color);\n  }\n   :deep(.el-pagination.is-background .el-pager li:not(.is-disabled):hover) {\n    color: var(--el-color-primary);\n  }\n  :deep(.el-pagination.is-background .btn-next),\n  :deep(.el-pagination.is-background .btn-prev) {\n    background-color: var(--el-fill-color);\n  }\n}\n\n.category-dialog-content {\n  display: flex;\n  gap: 24px;\n\n  .category-list-section {\n    flex: 2;\n    border-right: 1px solid var(--el-border-color-light);\n    padding-right: 24px;\n    min-width: 0;\n  }\n\n  .category-form-section {\n    flex: 3;\n    min-width: 0;\n  }\n\n  .section-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n\n    h5 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n    }\n  }\n\n  .category-items {\n    max-height: 400px;\n    overflow-y: auto;\n    padding-right: 8px; /* for scrollbar */\n  }\n\n  .category-list-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 10px 8px;\n    border-radius: 6px;\n    margin-bottom: 8px;\n    transition: background-color 0.2s ease;\n\n    &:hover {\n      background-color: var(--el-fill-color-light);\n    }\n\n    .category-info {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      flex-grow: 1;\n      min-width: 0;\n\n      .category-color {\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        flex-shrink: 0;\n      }\n\n      .category-name-section {\n        flex-grow: 1;\n        min-width: 0;\n\n        .category-name {\n          font-weight: 500;\n          color: var(--el-text-color-primary);\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          display: block; // Ensures it takes its own line\n        }\n\n        .category-desc {\n          font-size: 12px;\n          color: var(--el-text-color-secondary);\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          display: block; // Ensures it takes its own line\n        }\n      }\n    }\n    \n    .category-details {\n        display: flex;\n        align-items: center;\n        gap: 16px;\n        flex-shrink: 0;\n        margin-left: 16px;\n    }\n\n    .category-count {\n      font-size: 13px;\n      color: var(--el-text-color-regular);\n      white-space: nowrap;\n      flex-shrink: 0;\n    }\n\n    .category-actions {\n      display: flex;\n      gap: 8px;\n      flex-shrink: 0;\n    }\n  }\n\n  .empty-categories {\n    text-align: center;\n    padding: 20px;\n  }\n}\n\n.category-form-section .el-form {\n  margin-top: 10px;\n}\n\n/* 分页容器样式 */\n.pagination-container {\n  display: flex;\n  justify-content: center;\n  margin-top: 20px;\n  padding-top: 20px;\n  border-top: 1px solid var(--el-border-color);\n}\n\n// ===========================================\n// 深色模式\n// ===========================================\n:deep(.dark .knowledge-container) {\n  background-color: #141414;\n}\n:deep(.dark .page-header .page-title) {\n  color: #ffffff;\n}\n:deep(.dark .document-container-card) {\n  background-color: #1d1d1d;\n  border-color: #424242;\n}\n:deep(.dark .document-item-card) {\n  background-color: #262626;\n  border-color: #424242;\n  &:hover {\n    border-color: #589ef8;\n  }\n}\n:deep(.dark .document-title) {\n  color: #e0e0e0;\n}\n:deep(.dark .file-extension) {\n  color: #8c8c8c;\n}\n:deep(.dark .document-description) {\n  color: #a6a6a6;\n}\n:deep(.dark .card-footer) {\n  background-color: #2c2c2c;\n  border-top-color: #424242;\n}\n:deep(.dark .document-meta) {\n  color: #8c8c8c;\n}\n:deep(.dark .category-card) {\n  background-color: #1d1d1d;\n  border-color: #424242;\n}\n:deep(.dark .category-name) {\n  color: #e0e0e0;\n}\n:deep(.dark .category-count) {\n  color: #8c8c8c;\n}\n:deep(.dark .filter-section h6) {\n  color: #e0e0e0;\n}\n:deep(.dark .el-checkbox__label) {\n  color: #a6a6a6;\n}\n:deep(.dark .el-checkbox__input .el-checkbox__inner) {\n  background-color: #333;\n  border-color: #555;\n}\n:deep(.dark .category-item.active) {\n  background-color: #2c2c2c;\n}\n:deep(.dark .category-item:hover) {\n  background-color: #262626;\n}\n</style> ","<template>\n  <div class=\"knowledge-builder\">\n    <!-- 知识库构建对话框 -->\n    <el-dialog\n      v-model=\"visible\"\n      title=\"构建知识库\"\n      width=\"650px\"\n      :close-on-click-modal=\"false\"\n      :show-close=\"buildingStatus !== 'processing'\"\n      class=\"builder-dialog\"\n    >\n      <div class=\"building-status\" :key=\"buildingStatus\">\n        <div class=\"status-icon\">\n          <el-icon v-if=\"buildingStatus === 'processing'\" class=\"spinning\"><Loading /></el-icon>\n          <el-icon v-else-if=\"buildingStatus === 'completed'\" class=\"success\"><CircleCheckFilled /></el-icon>\n          <el-icon v-else-if=\"buildingStatus === 'failed'\" class=\"error\"><CircleCloseFilled /></el-icon>\n        </div>\n        <div class=\"status-text\">\n          <h3>{{ buildingStatus === 'pending' ? '准备构建知识库' : \n                buildingStatus === 'processing' ? '正在构建知识库' : \n                buildingStatus === 'completed' ? '知识库构建完成' : '知识库构建失败' }}</h3>\n          <p>{{ buildingMessage }}</p>\n          \n          <div v-if=\"buildingStatus === 'processing'\" class=\"progress-container\">\n            <el-progress :percentage=\"buildingProgress\" :format=\"p => `${p}%`\"></el-progress>\n          </div>\n          \n          <div v-if=\"buildingStatus === 'pending'\" class=\"info-container\">\n            <el-alert\n              title=\"构建知识库将处理所有已上传的文档，并将它们整合到一个统一的知识库中\"\n              type=\"info\"\n              :closable=\"false\"\n              show-icon\n            >\n              <p>这个过程可能需要一些时间，取决于文档数量和大小。</p>\n              <p>构建完成后，您将能够使用智能问答功能对知识库进行提问。</p>\n            </el-alert>\n          </div>\n          \n          <div v-if=\"buildingStatus === 'completed'\" class=\"success-container\">\n            <el-alert\n              title=\"知识库已成功构建！\"\n              type=\"success\"\n              :closable=\"false\"\n              show-icon\n            >\n              <p>所有文档已被处理并整合到知识库中，您现在可以使用智能问答功能。</p>\n            </el-alert>\n          </div>\n          \n          <div v-if=\"buildingStatus === 'failed'\" class=\"error-container\">\n            <el-alert\n              title=\"知识库构建失败\"\n              type=\"error\"\n              :closable=\"false\"\n              show-icon\n            >\n              <p>{{ buildingMessage }}</p>\n              <p>请检查日志或联系管理员解决问题。</p>\n            </el-alert>\n          </div>\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button v-if=\"buildingStatus !== 'processing'\" @click=\"close\">关闭</el-button>\n          <el-button \n            v-if=\"buildingStatus === 'pending'\" \n            type=\"primary\" \n            @click=\"startBuild\">开始构建</el-button>\n          <el-button \n            v-if=\"buildingStatus === 'failed'\" \n            type=\"primary\" \n            @click=\"startBuild\">重试</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, onBeforeUnmount, nextTick, watch } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport dayjs from 'dayjs'\nimport { buildKnowledgeBase, getKnowledgeBaseStatus } from '@/api/knowledge'\nimport { \n  Loading, \n  CircleCheckFilled, \n  CircleCloseFilled \n} from '@element-plus/icons-vue'\n\nexport default {\n  name: 'KnowledgeBuilder',\n  components: {\n    Loading,\n    CircleCheckFilled,\n    CircleCloseFilled\n  },\n  props: {\n    modelValue: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['update:modelValue', 'build-completed', 'build-failed'],\n  setup(props, { emit }) {\n    // 构建相关状态\n    const visible = computed({\n      get: () => props.modelValue,\n      set: (val) => emit('update:modelValue', val)\n    })\n    const buildingStatus = ref('pending') // pending, processing, completed, failed\n    const buildingProgress = ref(0)\n    const buildingMessage = ref('正在初始化...') // 初始化消息\n    const buildingOutput = ref('') // GraphRAG命令输出\n    const fullOutput = ref('') // 完整GraphRAG命令输出 (备用)\n    const buildingStats = ref(null) // 构建统计信息\n    \n    // 定时器ID\n    let pollTimer = null\n    // 重试计数器\n    let buildingRetryCount = 0\n\n    // 清除轮询定时器\n    const clearPollTimer = () => {\n      if (pollTimer) {\n        clearTimeout(pollTimer)\n        pollTimer = null\n        console.log('Polling timer cleared.');\n      }\n    }\n\n    // 启动知识库构建\n    const startBuild = async () => {\n      console.log('startBuild called');\n      try {\n        buildingStatus.value = 'processing'\n        buildingMessage.value = '正在启动知识库构建，请稍候...' // 更明确的启动消息\n        buildingProgress.value = 0\n        buildingOutput.value = '' // 清空旧输出\n        fullOutput.value = ''   // 清空旧输出\n        buildingStats.value = null\n        buildingRetryCount = 0 // 重置重试计数器\n        \n        clearPollTimer(); // 开始构建前先清除旧的定时器\n        console.log('Calling buildKnowledgeBase API...');\n        const response = await buildKnowledgeBase()\n        console.log('buildKnowledgeBase API response:', response)\n        \n        // API调用成功后立即开始轮询，初始延迟短一点\n        pollTimer = setTimeout(pollBuildStatus, 100); \n        console.log('Initial pollBuildStatus scheduled.');\n\n      } catch (error) {\n        console.error('启动知识库构建时出错:', error)\n        buildingStatus.value = 'failed'\n        buildingMessage.value = error.response?.data?.message || error.message || '启动构建失败'\n        emit('build-failed', error)\n        clearPollTimer();\n      }\n    }\n\n    // 轮询构建状态\n    const pollBuildStatus = async () => {\n      console.log('pollBuildStatus called. Current status:', buildingStatus.value);\n      // 如果已经是完成或失败状态，或者对话框不可见，则不应再轮询\n      if ((buildingStatus.value === 'completed' || buildingStatus.value === 'failed') && pollTimer) {\n          console.log('Build already completed or failed, clearing timer from pollBuildStatus.')\n          clearPollTimer();\n          return;\n      }\n      if (!visible.value && pollTimer) {\n          console.log('Dialog not visible, clearing timer from pollBuildStatus.');\n          clearPollTimer();\n          return;\n      }\n\n      try {\n        console.log('Calling getKnowledgeBaseStatus API...');\n        const response = await getKnowledgeBaseStatus()\n        console.log('getKnowledgeBaseStatus API response:', JSON.stringify(response, null, 2));\n\n        // 直接从响应中获取状态数据，不额外嵌套data属性\n        const statusData = response || {};\n        \n        if (statusData && typeof statusData === 'object') { \n          console.log('Status object received:', statusData);\n          \n          // 获取状态，确保使用正确的字段名\n          const status = statusData.status || 'pending';\n          buildingStatus.value = status;\n          buildingMessage.value = statusData.message || (status === 'processing' ? '正在处理中，请稍候...' : '等待状态更新...');\n          buildingProgress.value = statusData.progress || buildingProgress.value;\n          \n          console.log('Updated frontend status:', buildingStatus.value, 'Progress:', buildingProgress.value, 'Message:', buildingMessage.value);\n\n          // 处理GraphRAG命令输出\n          if (statusData.full_output) {\n            buildingOutput.value = statusData.full_output;\n            fullOutput.value = statusData.full_output;\n          } else if (statusData.graphrag_output) {\n            buildingOutput.value = statusData.graphrag_output;\n          }\n          \n          // 滚动输出框到底部\n          nextTick(() => {\n            const outputElem = document.querySelector('.output-content pre')\n            if (outputElem) {\n              outputElem.scrollTop = outputElem.scrollHeight\n            }\n          });\n          \n          // 根据状态决定下一步操作\n          if (status === 'completed' || status === 'failed') {\n            console.log(`Build ended with status: ${status}. Stopping poll.`);\n            clearPollTimer();\n\n            if (status === 'completed') {\n              buildingProgress.value = 100; // 确保完成时进度为100%\n              // 构建完成，处理统计数据\n              const startTime = statusData.started_at ? new Date(statusData.started_at) : null;\n              const endTime = statusData.finished_at ? new Date(statusData.finished_at) : new Date();\n            \n              buildingStats.value = {\n                startTime: startTime,\n                endTime: endTime,\n                duration: startTime && endTime ? calculateDuration(startTime, endTime) : '未知',\n                totalDocs: statusData.total_docs || 0,\n                totalChunks: statusData.total_chunks || 0\n              };\n            \n              ElMessage.success(statusData.message || '知识库构建完成！');\n              emit('build-completed');\n            } else { // failed\n              ElMessage.error(statusData.message || '知识库构建失败，请查看输出或日志。');\n              emit('build-failed', { message: statusData.message, detail: statusData.error_detail });\n            }\n          } else if (status === 'processing') {\n            const pollInterval = 1000; // 统一轮询间隔为1秒\n            console.log(`Status is 'processing'. Scheduling next poll in ${pollInterval}ms.`);\n            clearPollTimer(); // 清除旧的，避免重复\n            pollTimer = setTimeout(pollBuildStatus, pollInterval);\n          } else if (status === 'pending') {\n            // 对于pending状态，也需要继续轮询，但可以间隔长一些\n            const pollInterval = 2000;\n            console.log(`Status is 'pending'. Scheduling next poll in ${pollInterval}ms.`);\n            clearPollTimer();\n            pollTimer = setTimeout(pollBuildStatus, pollInterval);\n          } else {\n            console.warn('Unknown status from backend:', status, 'Stopping poll.');\n            clearPollTimer(); // 未知状态，停止轮询以防意外\n          }\n\n        } else {\n          console.warn('Invalid or empty response object from getKnowledgeBaseStatus. Response:', JSON.stringify(response));\n          buildingMessage.value = '获取状态响应格式无效...';\n          \n          if (buildingStatus.value === 'processing') {\n             const pollInterval = 3000; \n             clearPollTimer();\n             pollTimer = setTimeout(pollBuildStatus, pollInterval);\n          } else {\n            buildingStatus.value = 'failed';\n            buildingMessage.value = '获取状态失败，响应无效。';\n            emit('build-failed', { message: '获取状态失败，响应无效。'});\n            clearPollTimer();\n          }\n        }\n      } catch (error) {\n        console.error('获取构建状态时出错 (pollBuildStatus catch):', error)\n        buildingMessage.value = '获取构建状态失败: ' + (error.message || '未知错误') + '. 将尝试再次轮询。'\n        \n        // 在错误情况下，如果当前是processing状态，尝试再次轮询几次\n        if (buildingStatus.value === 'processing') {\n            // 增加重试计数器，避免无限轮询\n            buildingRetryCount = (buildingRetryCount || 0) + 1;\n            \n            if (buildingRetryCount <= 5) { // 最多重试5次\n                const pollInterval = 3000; // 错误后延长轮询间隔\n                clearPollTimer();\n                pollTimer = setTimeout(pollBuildStatus, pollInterval);\n                console.log(`轮询错误，第${buildingRetryCount}次重试，${pollInterval}ms后重试`);\n            } else {\n                console.error('轮询重试次数已达上限，停止轮询');\n                buildingStatus.value = 'failed';\n                buildingMessage.value = '获取构建状态失败，已达重试上限。';\n                emit('build-failed', error);\n                clearPollTimer();\n            }\n        } else {\n            buildingStatus.value = 'failed';\n            buildingMessage.value = '获取构建状态失败。';\n            emit('build-failed', error);\n            clearPollTimer();\n        }\n      }\n    }\n    \n    // 计算持续时间\n    const calculateDuration = (start, end) => {\n      const diff = Math.abs(end - start)\n      const minutes = Math.floor(diff / 60000)\n      const seconds = ((diff % 60000) / 1000).toFixed(0)\n      return `${minutes}分${seconds}秒`\n    }\n    \n    // 格式化构建时间\n    const formatBuildTime = (dateObj) => {\n      if (!dateObj) return '未知'\n      return dayjs(dateObj).format('YYYY-MM-DD HH:mm:ss')\n    }\n    \n    // 关闭对话框\n    const close = () => {\n      visible.value = false\n    }\n    \n    // 组件挂载时\n    onMounted(() => {\n      console.log('KnowledgeBuilder onMounted. Initial modelValue:', props.modelValue);\n      // 不自动开始轮询，等待startBuild被调用\n    })\n    \n    // 组件销毁前清理\n    onBeforeUnmount(() => {\n      console.log('KnowledgeBuilder onBeforeUnmount. Clearing poll timer.');\n      clearPollTimer()\n    })\n\n    watch(visible, (newVal) => {\n      if (newVal) {\n        // 当对话框打开时\n        console.log('Dialog became visible. Current status:', buildingStatus.value);\n        if (buildingStatus.value !== 'processing') {\n          // 如果不是正在处理中 (例如是 completed, failed, 或初始的 pending)，\n          // 则重置为初始待构建状态，以便用户可以开始新的构建。\n          console.log('Resetting status to pending for new build session.');\n          buildingStatus.value = 'pending';\n          buildingMessage.value = '准备开始新的知识库构建。'; // 或者更合适的初始消息\n          buildingProgress.value = 0;\n          buildingOutput.value = '';\n          fullOutput.value = '';\n          buildingStats.value = null;\n          buildingRetryCount = 0; // 重置重试计数器\n          clearPollTimer(); // 确保没有意外的轮询\n        }\n        // 如果是 processing，则什么都不做，让它继续处理或轮询\n      } else {\n        // 当对话框关闭时\n        console.log('Dialog closed. Current status:', buildingStatus.value);\n        // 如果正在处理中，用户关闭了对话框，最好停止轮询，避免后台继续请求\n        if (buildingStatus.value === 'processing') {\n            console.log('Dialog closed during processing, stopping poll timer.');\n            clearPollTimer();\n        }\n      }\n    });\n\n    return {\n      visible,\n      buildingStatus,\n      buildingProgress,\n      buildingMessage,\n      buildingOutput,\n      fullOutput,\n      buildingStats,\n      startBuild,\n      formatBuildTime,\n      close\n    }\n  }\n}\n</script>\n\n<style scoped>\n.builder-dialog {\n  max-width: 90vw;\n}\n\n.building-status {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n}\n\n.status-icon {\n  margin-bottom: 20px;\n  font-size: 48px;\n  display: flex;\n  justify-content: center;\n  color: #6c757d;\n}\n\n.status-icon .spinning {\n  animation: spin 2s linear infinite;\n}\n\n.status-icon .success {\n  color: #67C23A;\n}\n\n.status-icon .error {\n  color: #F56C6C;\n}\n\n.status-text {\n  text-align: center;\n  width: 100%;\n}\n\n.status-text h3 {\n  margin-bottom: 15px;\n  font-size: 20px;\n  font-weight: 600;\n}\n\n.status-text p {\n  margin: 5px 0;\n}\n\n.progress-container {\n  margin: 20px 0;\n  width: 100%;\n}\n\n.info-container, .success-container, .error-container {\n  margin: 20px 0;\n  width: 100%;\n}\n\n.dialog-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 10px;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n</style> ","import { render } from \"./KnowledgeBuilder.vue?vue&type=template&id=17b2f24e&scoped=true\"\nimport script from \"./KnowledgeBuilder.vue?vue&type=script&lang=js\"\nexport * from \"./KnowledgeBuilder.vue?vue&type=script&lang=js\"\n\nimport \"./KnowledgeBuilder.vue?vue&type=style&index=0&id=17b2f24e&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\18083\\\\Desktop\\\\CCIT\\\\office\\\\smart-office\\\\frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-17b2f24e\"]])\n\nexport default __exports__","import { render } from \"./Index.vue?vue&type=template&id=64d34e3b&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=64d34e3b&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\18083\\\\Desktop\\\\CCIT\\\\office\\\\smart-office\\\\frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-64d34e3b\"]])\n\nexport default __exports__","'use strict';\nvar call = require('../internals/function-call');\n\nmodule.exports = function (record, fn, ITERATOR_INSTEAD_OF_RECORD) {\n  var iterator = ITERATOR_INSTEAD_OF_RECORD ? record : record.iterator;\n  var next = record.next;\n  var step, result;\n  while (!(step = call(next, iterator)).done) {\n    result = fn(step.value);\n    if (result !== undefined) return result;\n  }\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\n\nvar URLSearchParamsPrototype = URLSearchParams.prototype;\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\n\n// `URLSearchParams.prototype.size` getter\n// https://github.com/whatwg/url/pull/734\nif (DESCRIPTORS && !('size' in URLSearchParamsPrototype)) {\n  defineBuiltInAccessor(URLSearchParamsPrototype, 'size', {\n    get: function size() {\n      var count = 0;\n      forEach(this, function () { count++; });\n      return count;\n    },\n    configurable: true,\n    enumerable: true\n  });\n}\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./KnowledgeBuilder.vue?vue&type=style&index=0&id=17b2f24e&scoped=true&lang=css\"","'use strict';\nvar aSet = require('../internals/a-set');\nvar size = require('../internals/set-size');\nvar iterate = require('../internals/set-iterate');\nvar getSetRecord = require('../internals/get-set-record');\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSubsetOf\nmodule.exports = function isSubsetOf(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) > otherRec.size) return false;\n  return iterate(O, function (e) {\n    if (!otherRec.includes(e)) return false;\n  }, true) !== false;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar union = require('../internals/set-union');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.union` method\n// https://tc39.es/ecma262/#sec-set.prototype.union\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('union') }, {\n  union: union\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar intersection = require('../internals/set-intersection');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('intersection', function (result) {\n  return result.size === 2 && result.has(1) && result.has(2);\n}) || fails(function () {\n  // eslint-disable-next-line es/no-array-from, es/no-set, es/no-set-prototype-intersection -- testing\n  return String(Array.from(new Set([1, 2, 3]).intersection(new Set([3, 2])))) !== '3,2';\n});\n\n// `Set.prototype.intersection` method\n// https://tc39.es/ecma262/#sec-set.prototype.intersection\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  intersection: intersection\n});\n","'use strict';\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar call = require('../internals/function-call');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\n\nvar INVALID_SIZE = 'Invalid size';\nvar $RangeError = RangeError;\nvar $TypeError = TypeError;\nvar max = Math.max;\n\nvar SetRecord = function (set, intSize) {\n  this.set = set;\n  this.size = max(intSize, 0);\n  this.has = aCallable(set.has);\n  this.keys = aCallable(set.keys);\n};\n\nSetRecord.prototype = {\n  getIterator: function () {\n    return getIteratorDirect(anObject(call(this.keys, this.set)));\n  },\n  includes: function (it) {\n    return call(this.has, this.set, it);\n  }\n};\n\n// `GetSetRecord` abstract operation\n// https://tc39.es/proposal-set-methods/#sec-getsetrecord\nmodule.exports = function (obj) {\n  anObject(obj);\n  var numSize = +obj.size;\n  // NOTE: If size is undefined, then numSize will be NaN\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (numSize !== numSize) throw new $TypeError(INVALID_SIZE);\n  var intSize = toIntegerOrInfinity(numSize);\n  if (intSize < 0) throw new $RangeError(INVALID_SIZE);\n  return new SetRecord(obj, intSize);\n};\n","'use strict';\nvar SetHelpers = require('../internals/set-helpers');\nvar iterate = require('../internals/set-iterate');\n\nvar Set = SetHelpers.Set;\nvar add = SetHelpers.add;\n\nmodule.exports = function (set) {\n  var result = new Set();\n  iterate(set, function (it) {\n    add(result, it);\n  });\n  return result;\n};\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar append = uncurryThis(URLSearchParamsPrototype.append);\nvar $delete = uncurryThis(URLSearchParamsPrototype['delete']);\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\nvar push = uncurryThis([].push);\nvar params = new $URLSearchParams('a=1&a=2&b=3');\n\nparams['delete']('a', 1);\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nparams['delete']('b', undefined);\n\nif (params + '' !== 'a=2') {\n  defineBuiltIn(URLSearchParamsPrototype, 'delete', function (name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $delete(this, name);\n    var entries = [];\n    forEach(this, function (v, k) { // also validates `this`\n      push(entries, { key: k, value: v });\n    });\n    validateArgumentsLength(length, 1);\n    var key = toString(name);\n    var value = toString($value);\n    var index = 0;\n    var dindex = 0;\n    var found = false;\n    var entriesLength = entries.length;\n    var entry;\n    while (index < entriesLength) {\n      entry = entries[index++];\n      if (found || entry.key === key) {\n        found = true;\n        $delete(this, entry.key);\n      } else dindex++;\n    }\n    while (dindex < entriesLength) {\n      entry = entries[dindex++];\n      if (!(entry.key === key && entry.value === value)) append(this, entry.key, entry.value);\n    }\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar isSubsetOf = require('../internals/set-is-subset-of');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('isSubsetOf', function (result) {\n  return result;\n});\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.es/ecma262/#sec-set.prototype.issubsetof\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  isSubsetOf: isSubsetOf\n});\n","'use strict';\nvar uncurryThisAccessor = require('../internals/function-uncurry-this-accessor');\nvar SetHelpers = require('../internals/set-helpers');\n\nmodule.exports = uncurryThisAccessor(SetHelpers.proto, 'size', 'get') || function (set) {\n  return set.size;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar createIteratorProxy = require('../internals/iterator-create-proxy');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar IS_PURE = require('../internals/is-pure');\nvar iteratorClose = require('../internals/iterator-close');\nvar iteratorHelperWithoutClosingOnEarlyError = require('../internals/iterator-helper-without-closing-on-early-error');\n\nvar filterWithoutClosingOnEarlyError = !IS_PURE && iteratorHelperWithoutClosingOnEarlyError('filter', TypeError);\n\nvar IteratorProxy = createIteratorProxy(function () {\n  var iterator = this.iterator;\n  var predicate = this.predicate;\n  var next = this.next;\n  var result, done, value;\n  while (true) {\n    result = anObject(call(next, iterator));\n    done = this.done = !!result.done;\n    if (done) return;\n    value = result.value;\n    if (callWithSafeIterationClosing(iterator, predicate, [value, this.counter++], true)) return value;\n  }\n});\n\n// `Iterator.prototype.filter` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.filter\n$({ target: 'Iterator', proto: true, real: true, forced: IS_PURE || filterWithoutClosingOnEarlyError }, {\n  filter: function filter(predicate) {\n    anObject(this);\n    try {\n      aCallable(predicate);\n    } catch (error) {\n      iteratorClose(this, 'throw', error);\n    }\n\n    if (filterWithoutClosingOnEarlyError) return call(filterWithoutClosingOnEarlyError, this, predicate);\n\n    return new IteratorProxy(getIteratorDirect(this), {\n      predicate: predicate\n    });\n  }\n});\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar Set = SetHelpers.Set;\nvar add = SetHelpers.add;\nvar has = SetHelpers.has;\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function intersection(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  var result = new Set();\n\n  if (size(O) > otherRec.size) {\n    iterateSimple(otherRec.getIterator(), function (e) {\n      if (has(O, e)) add(result, e);\n    });\n  } else {\n    iterateSet(O, function (e) {\n      if (otherRec.includes(e)) add(result, e);\n    });\n  }\n\n  return result;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar clone = require('../internals/set-clone');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar add = SetHelpers.add;\nvar has = SetHelpers.has;\nvar remove = SetHelpers.remove;\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function symmetricDifference(other) {\n  var O = aSet(this);\n  var keysIter = getSetRecord(other).getIterator();\n  var result = clone(O);\n  iterateSimple(keysIter, function (e) {\n    if (has(O, e)) remove(result, e);\n    else add(result, e);\n  });\n  return result;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar isSupersetOf = require('../internals/set-is-superset-of');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('isSupersetOf', function (result) {\n  return !result;\n});\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.es/ecma262/#sec-set.prototype.issupersetof\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  isSupersetOf: isSupersetOf\n});\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar clone = require('../internals/set-clone');\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar has = SetHelpers.has;\nvar remove = SetHelpers.remove;\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function difference(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  var result = clone(O);\n  if (size(O) <= otherRec.size) iterateSet(O, function (e) {\n    if (otherRec.includes(e)) remove(result, e);\n  });\n  else iterateSimple(otherRec.getIterator(), function (e) {\n    if (has(O, e)) remove(result, e);\n  });\n  return result;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar has = require('../internals/set-helpers').has;\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\nvar iteratorClose = require('../internals/iterator-close');\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isDisjointFrom\nmodule.exports = function isDisjointFrom(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) <= otherRec.size) return iterateSet(O, function (e) {\n    if (otherRec.includes(e)) return false;\n  }, true) !== false;\n  var iterator = otherRec.getIterator();\n  return iterateSimple(iterator, function (e) {\n    if (has(O, e)) return iteratorClose(iterator, 'normal', false);\n  }) !== false;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar isDisjointFrom = require('../internals/set-is-disjoint-from');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('isDisjointFrom', function (result) {\n  return !result;\n});\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.es/ecma262/#sec-set.prototype.isdisjointfrom\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  isDisjointFrom: isDisjointFrom\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\n// eslint-disable-next-line es/no-set -- safe\nvar SetPrototype = Set.prototype;\n\nmodule.exports = {\n  // eslint-disable-next-line es/no-set -- safe\n  Set: Set,\n  add: uncurryThis(SetPrototype.add),\n  has: uncurryThis(SetPrototype.has),\n  remove: uncurryThis(SetPrototype['delete']),\n  proto: SetPrototype\n};\n","'use strict';\nvar $TypeError = TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw new $TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\n\nvar createSetLike = function (size) {\n  return {\n    size: size,\n    has: function () {\n      return false;\n    },\n    keys: function () {\n      return {\n        next: function () {\n          return { done: true };\n        }\n      };\n    }\n  };\n};\n\nvar createSetLikeWithInfinitySize = function (size) {\n  return {\n    size: size,\n    has: function () {\n      return true;\n    },\n    keys: function () {\n      throw new Error('e');\n    }\n  };\n};\n\nmodule.exports = function (name, callback) {\n  var Set = getBuiltIn('Set');\n  try {\n    new Set()[name](createSetLike(0));\n    try {\n      // late spec change, early WebKit ~ Safari 17 implementation does not pass it\n      // https://github.com/tc39/proposal-set-methods/pull/88\n      // also covered engines with\n      // https://bugs.webkit.org/show_bug.cgi?id=272679\n      new Set()[name](createSetLike(-1));\n      return false;\n    } catch (error2) {\n      if (!callback) return true;\n      // early V8 implementation bug\n      // https://issues.chromium.org/issues/351332634\n      try {\n        new Set()[name](createSetLikeWithInfinitySize(-Infinity));\n        return false;\n      } catch (error) {\n        var set = new Set();\n        set.add(1);\n        set.add(2);\n        return callback(set[name](createSetLikeWithInfinitySize(Infinity)));\n      }\n    }\n  } catch (error) {\n    return false;\n  }\n};\n","/**\n * 知识库API服务\n */\nimport request from '@/utils/request'\n\nconst baseURL = '/api/knowledge'  // 确保这个路径与后端实际部署的路径一致\n\n// 分类相关API\nexport function getCategories() {\n  console.log('调用getCategories API函数')\n  return request({\n    url: `${baseURL}/categories/`,\n    method: 'get'\n  }).then(response => {\n    console.log('getCategories API响应成功:', response)\n    \n    // 确保返回有效的数据，即使后端返回空或格式不一致\n    if (!response) {\n      console.warn('getCategories响应为空，返回空数组')\n      return []\n    }\n    \n    // 根据不同的数据格式返回正确的结果\n    if (Array.isArray(response)) {\n      return response\n    } else if (response.results && Array.isArray(response.results)) {\n      return response.results\n    } else if (response.data && Array.isArray(response.data)) {\n      return response.data\n    } else if (typeof response === 'object') {\n      // 尝试查找可能的数组字段\n      for (const key of ['items', 'categories', 'list']) {\n        if (response[key] && Array.isArray(response[key])) {\n          return response[key]\n        }\n      }\n    }\n    \n    // 所有尝试都失败时，返回空数组而不是错误\n    console.warn('无法从响应中提取分类数据，返回空数组:', response)\n    return []\n  }).catch(error => {\n    console.error('getCategories API请求失败:', error)\n    if (error.response) {\n      console.error('错误状态码:', error.response.status)\n      console.error('错误数据:', error.response.data)\n    }\n    // 返回空数组而不是抛出错误，使调用代码更健壮\n    return []\n  })\n}\n\nexport function addCategory(data) {\n  return request({\n    url: `${baseURL}/categories/`,\n    method: 'post',\n    data\n  })\n}\n\nexport function updateCategory(id, data) {\n  return request({\n    url: `${baseURL}/categories/${id}/`,\n    method: 'put',\n    data\n  })\n}\n\nexport function deleteCategory(id) {\n  return request({\n    url: `${baseURL}/categories/${id}/`,\n    method: 'delete'\n  })\n}\n\n// 知识库文档相关API\nexport function getDocuments(params) {\n  console.log('调用getDocuments API:', `${baseURL}/documents/`, '参数:', params)\n  return request({\n    url: `${baseURL}/documents/`,\n    method: 'get',\n    params\n  }).then(response => {\n    console.log('getDocuments API响应成功:', response)\n    return response\n  }).catch(error => {\n    console.error('getDocuments API请求失败:', error)\n    if (error.response) {\n      console.error('错误状态码:', error.response.status)\n      console.error('错误数据:', error.response.data)\n    }\n    throw error\n  })\n}\n\nexport function getDocument(id) {\n  return request({\n    url: `${baseURL}/documents/${id}/`,\n    method: 'get'\n  })\n}\n\nexport function uploadDocument(data) {\n  console.log('开始上传文件...', data);\n  \n  // 检查FormData中是否包含文件及其大小\n  if (data instanceof FormData) {\n    const file = data.get('file');\n    if (file) {\n      console.log('FormData中的文件信息:', {\n        name: file.name,\n        size: file.size,\n        type: file.type,\n        lastModified: file.lastModified\n      });\n      \n      // 验证文件有效性\n      if (!file.size || file.size === 0) {\n        return Promise.reject(new Error('文件大小为0，无法上传'));\n      }\n    } else {\n      console.warn('FormData中未找到文件!');\n      return Promise.reject(new Error('未找到有效文件'));\n    }\n  }\n  \n  return request({\n    url: `${baseURL}/documents/`,\n    method: 'post',\n    data,\n    timeout: 120000, // 增加超时时间到120秒，大文件上传需要更长时间\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n      console.log(`上传进度: ${percentCompleted}%`);\n    }\n  }).then(response => {\n    console.log('文件上传成功响应:', response);\n    return response;\n  }).catch(error => {\n    console.error('文件上传失败:', error);\n    \n    // 处理不同的错误情况\n    if (error.response) {\n      console.error('上传错误状态码:', error.response.status);\n      console.error('上传错误数据:', error.response.data);\n      \n      // 处理特定的错误代码\n      if (error.response.status === 413) {\n        error.message = '文件太大，超出服务器允许的上传限制';\n      } else if (error.response.status === 400) {\n        error.message = `上传参数错误: ${JSON.stringify(error.response.data)}`;\n      } else if (error.response.status === 401) {\n        error.message = '未授权，请重新登录后再尝试上传';\n      } else if (error.response.status === 500) {\n        error.message = '服务器处理上传时发生错误';\n      }\n    } else if (error.request) {\n      // 请求已发送但没有收到响应\n      console.error('没有收到上传响应:', error.request);\n      if (error.code === 'ECONNABORTED') {\n        error.message = '上传超时，请检查网络或尝试上传较小的文件';\n      } else {\n        error.message = '网络错误，未收到服务器响应';\n      }\n    }\n    \n    throw error;\n  });\n}\n\nexport function updateDocument(id, data) {\n  return request({\n    url: `${baseURL}/documents/${id}/`,\n    method: 'put',\n    data\n  })\n}\n\nexport function deleteDocument(id) {\n  console.log('>>> deleteDocument function entered for ID:', id);\n  const requestConfig = {\n    url: `${baseURL}/documents/${id}/`,\n    method: 'delete'\n  };\n  console.log('>>> deleteDocument - Request config prepared:', requestConfig);\n  return request(requestConfig).then(response => {\n    console.log('deleteDocument API响应成功:', response);\n    return response;\n  }).catch(error => {\n    console.error('deleteDocument API请求失败:', error);\n    if (error.response) {\n      console.error('错误状态码:', error.response.status);\n      console.error('错误数据:', error.response.data);\n    }\n    throw error;\n  });\n}\n\nexport function downloadDocumentFile(id) {\n  return request({\n    url: `${baseURL}/documents/${id}/`,\n    method: 'get',\n    responseType: 'blob'\n  })\n}\n\nexport function reprocessDocument(id) {\n  return request({\n    url: `${baseURL}/documents/${id}/reprocess/`,\n    method: 'post'\n  })\n}\n\n// 文档块相关API\nexport function getDocumentChunks(documentId) {\n  return request({\n    url: `${baseURL}/documents/${documentId}/chunks/`,\n    method: 'get'\n  })\n}\n\nexport function searchKnowledge(query) {\n  return request({\n    url: `${baseURL}/search/`,\n    method: 'get',\n    params: { query }\n  })\n}\n\nexport function getDocumentStatistics() {\n  return request({\n    url: `${baseURL}/statistics/`,\n    method: 'get'\n  })\n}\n\n// 知识库构建相关API\nexport function buildKnowledgeBase() {\n  console.log('调用buildKnowledgeBase API')\n  return request({\n    url: `${baseURL}/build/`,\n    method: 'post'\n  }).then(response => {\n    console.log('buildKnowledgeBase API响应成功:', response)\n    return response\n  }).catch(error => {\n    console.error('buildKnowledgeBase API请求失败:', error)\n    if (error.response) {\n      console.error('错误状态码:', error.response.status)\n      console.error('错误数据:', error.response.data)\n    }\n    throw error\n  })\n}\n\nexport function getKnowledgeBaseStatus() {\n  return request({\n    url: `${baseURL}/build/status/`,\n    method: 'get'\n  })\n} \n\n// 知识库列表API\nexport function getKnowledgeList() {\n  return request({\n    url: `${baseURL}/list/`,\n    method: 'get'\n  })\n} ","'use strict';\nvar has = require('../internals/set-helpers').has;\n\n// Perform ? RequireInternalSlot(M, [[SetData]])\nmodule.exports = function (it) {\n  has(it);\n  return it;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar add = require('../internals/set-helpers').add;\nvar clone = require('../internals/set-clone');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function union(other) {\n  var O = aSet(this);\n  var keysIter = getSetRecord(other).getIterator();\n  var result = clone(O);\n  iterateSimple(keysIter, function (it) {\n    add(result, it);\n  });\n  return result;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar iteratorClose = require('../internals/iterator-close');\nvar iteratorHelperWithoutClosingOnEarlyError = require('../internals/iterator-helper-without-closing-on-early-error');\n\nvar findWithoutClosingOnEarlyError = iteratorHelperWithoutClosingOnEarlyError('find', TypeError);\n\n// `Iterator.prototype.find` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.find\n$({ target: 'Iterator', proto: true, real: true, forced: findWithoutClosingOnEarlyError }, {\n  find: function find(predicate) {\n    anObject(this);\n    try {\n      aCallable(predicate);\n    } catch (error) {\n      iteratorClose(this, 'throw', error);\n    }\n\n    if (findWithoutClosingOnEarlyError) return call(findWithoutClosingOnEarlyError, this, predicate);\n\n    var record = getIteratorDirect(this);\n    var counter = 0;\n    return iterate(record, function (value, stop) {\n      if (predicate(value, counter++)) return stop(value);\n    }, { IS_RECORD: true, INTERRUPTED: true }).result;\n  }\n});\n"],"sourceRoot":""}