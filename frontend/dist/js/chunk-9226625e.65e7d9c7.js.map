{"version":3,"sources":["webpack:///./src/views/admin/Dashboard.vue","webpack:///./src/views/admin/Dashboard.vue?f206","webpack:///./src/views/admin/Dashboard.vue?fa5f","webpack:///./src/api/admin.js"],"names":["class","ref","style","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","$setup","stats","user_count","_hoisted_6","_hoisted_7","_hoisted_8","company_count","_hoisted_9","_hoisted_10","_hoisted_11","department_count","_hoisted_12","_hoisted_13","_hoisted_14","onClick","_cache","$event","fetchAnalysis","disabled","analysisLoading","userGrowth","_hoisted_16","_hoisted_17","analysis","innerHTML","formatAnalysis","_hoisted_19","_hoisted_20","systemLoad","_hoisted_22","_hoisted_23","_hoisted_25","_hoisted_26","companyUser","_hoisted_28","_hoisted_29","name","setup","userGrowthChartRef","systemLoadChartRef","companyUserChartRef","chartData","userGrowthChartInstance","systemLoadChartInstance","companyUserChartInstance","refreshInterval","text","marked","async","titles","value","chartName","response","adminApi","getDashboardAnalysis","data","error","console","initUserGrowthChart","echarts","series","map","s","smooth","areaStyle","opacity","animationDuration","setOption","tooltip","trigger","legend","bottom","type","grid","left","right","top","containLabel","xAxis","dates","yAxis","initSystemLoadChart","formatter","icon","color","radius","avoidLabelOverlap","itemStyle","borderRadius","borderColor","borderWidth","label","show","position","length","item","replace","trim","join","fontSize","fontWeight","lineHeight","emphasis","shadowBlur","shadowOffsetX","shadowColor","labelLine","animationType","animationEasing","animationDelay","Math","random","initCompanyUserChart","totals","params","total","dataIndex","axisPointer","labels","axisLabel","interval","rotate","updateSystemLoadChart","getDashboardData","system_load","fetchDashboardData","nextTick","user_growth","clearInterval","setInterval","company_user_distribution","resizeCharts","_userGrowthChartInsta","_systemLoadChartInsta","_companyUserChartInst","resize","onMounted","window","addEventListener","onBeforeUnmount","_userGrowthChartInsta2","_systemLoadChartInsta2","_companyUserChartInst2","dispose","removeEventListener","__exports__","render","api","axios","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","Promise","reject","get","chartTitle","post","chart_title","chart_data","getUsers","createUser","updateUser","id","patch","deleteUser","delete","getCompanies","createCompany","updateCompany","deleteCompany","getDepartments","createDepartment","updateDepartment","deleteDepartment","getSmartDocs","getSmartDocDetail","deleteSmartDoc","getContracts","getContractDetail","deleteContract","getContractTemplates","getContractTemplate","createContractTemplate","updateContractTemplate","deleteContractTemplate","getKnowledgeCategories","createKnowledgeCategory","updateKnowledgeCategory","deleteKnowledgeCategory","getKnowledgeBases","getKnowledgeBaseDetail","createKnowledgeBase","formData","FormData","key","undefined","append","updateKnowledgeBase","original_file","File","deleteKnowledgeBase","getKnowledgeBuildStatus","buildKnowledgeForCompanies","companyIds","company_ids"],"mappings":"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","file":"js/chunk-9226625e.65e7d9c7.js","sourcesContent":["<template>\n  <div class=\"dashboard-container\">\n    <div class=\"stats-cards\">\n      <div class=\"card\">\n        <div class=\"card-icon\" style=\"background-color: #e6f7ff;\">\n          <i class=\"bi bi-people-fill\" style=\"color: #1890ff;\"></i>\n        </div>\n        <div class=\"card-info\">\n          <span class=\"label\">总员工数</span>\n          <span class=\"value\">{{ stats.user_count }}</span>\n        </div>\n      </div>\n      <div class=\"card\">\n        <div class=\"card-icon\" style=\"background-color: #f6ffed;\">\n          <i class=\"bi bi-building\" style=\"color: #52c41a;\"></i>\n        </div>\n        <div class=\"card-info\">\n          <span class=\"label\">公司总数</span>\n          <span class=\"value\">{{ stats.company_count }}</span>\n        </div>\n      </div>\n      <div class=\"card\">\n        <div class=\"card-icon\" style=\"background-color: #fffbe6;\">\n          <i class=\"bi bi-diagram-3-fill\" style=\"color: #faad14;\"></i>\n        </div>\n        <div class=\"card-info\">\n          <span class=\"label\">部门总数</span>\n          <span class=\"value\">{{ stats.department_count }}</span>\n        </div>\n      </div>\n    </div>\n    <div class=\"main-charts-grid\">\n      <div class=\"chart-card user-growth-card\">\n        <div class=\"chart-header\">\n          <h4>员工增长趋势</h4>\n          <button @click=\"fetchAnalysis('userGrowth')\" class=\"ai-button\" :disabled=\"analysisLoading.userGrowth\">\n            <i class=\"bi bi-robot\"></i>\n            {{ analysisLoading.userGrowth ? '分析中...' : 'AI智能分析' }}\n          </button>\n        </div>\n        <div ref=\"userGrowthChartRef\" style=\"height: 300px;\"></div>\n        <div v-if=\"analysisLoading.userGrowth\" class=\"analysis-loader\"></div>\n        <div v-if=\"analysis.userGrowth\" class=\"analysis-result\" v-html=\"formatAnalysis(analysis.userGrowth)\"></div>\n      </div>\n      <div class=\"chart-card system-load-card\">\n        <div class=\"chart-header\">\n          <h4>系统资源使用情况</h4>\n          <button @click=\"fetchAnalysis('systemLoad')\" class=\"ai-button\" :disabled=\"analysisLoading.systemLoad\">\n            <i class=\"bi bi-robot\"></i>\n            {{ analysisLoading.systemLoad ? '分析中...' : 'AI智能分析' }}\n          </button>\n        </div>\n        <div ref=\"systemLoadChartRef\" style=\"height: 300px;\"></div>\n        <div v-if=\"analysisLoading.systemLoad\" class=\"analysis-loader\"></div>\n        <div v-if=\"analysis.systemLoad\" class=\"analysis-result\" v-html=\"formatAnalysis(analysis.systemLoad)\"></div>\n      </div>\n      <div class=\"chart-card company-user-card\">\n        <div class=\"chart-header\">\n          <h4>各公司员工数量</h4>\n          <button @click=\"fetchAnalysis('companyUser')\" class=\"ai-button\" :disabled=\"analysisLoading.companyUser\">\n            <i class=\"bi bi-robot\"></i>\n            {{ analysisLoading.companyUser ? '分析中...' : 'AI智能分析' }}\n          </button>\n        </div>\n        <div ref=\"companyUserChartRef\" style=\"height: 400px;\"></div>\n        <div v-if=\"analysisLoading.companyUser\" class=\"analysis-loader\"></div>\n        <div v-if=\"analysis.companyUser\" class=\"analysis-result\" v-html=\"formatAnalysis(analysis.companyUser)\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onBeforeUnmount, nextTick } from 'vue';\nimport * as echarts from 'echarts';\nimport adminApi from '@/api/admin';\nimport { marked } from 'marked';\n\nexport default {\n  name: 'AdminDashboard',\n  setup() {\n    const stats = ref({\n      user_count: 0,\n      company_count: 0,\n      department_count: 0,\n    });\n    const userGrowthChartRef = ref(null);\n    const systemLoadChartRef = ref(null);\n    const companyUserChartRef = ref(null);\n\n    const chartData = ref({\n      userGrowth: null,\n      systemLoad: null,\n      companyUser: null,\n    });\n\n    const analysis = ref({\n      userGrowth: '',\n      systemLoad: '',\n      companyUser: '',\n    });\n\n    const analysisLoading = ref({\n      userGrowth: false,\n      systemLoad: false,\n      companyUser: false,\n    });\n\n    let userGrowthChartInstance = null;\n    let systemLoadChartInstance = null;\n    let companyUserChartInstance = null;\n    let refreshInterval = null;\n\n    const formatAnalysis = (text) => {\n      if (!text) return '';\n      // 使用 marked 将 Markdown 格式的文本转换为 HTML\n      return marked(text);\n    };\n\n    const fetchAnalysis = async (chartName) => {\n      const titles = {\n        userGrowth: '员工增长趋势',\n        systemLoad: '系统资源使用情况',\n        companyUser: '各公司员工数量',\n      };\n\n      if (!chartData.value[chartName]) {\n        console.error('图表数据尚未加载');\n        return;\n      }\n\n      analysisLoading.value[chartName] = true;\n      analysis.value[chartName] = '';\n\n      try {\n        const response = await adminApi.getDashboardAnalysis(\n          titles[chartName],\n          chartData.value[chartName]\n        );\n        analysis.value[chartName] = response.data.analysis;\n      } catch (error) {\n        console.error(`获取 ${titles[chartName]} AI分析失败:`, error);\n        analysis.value[chartName] = '<p style=\"color: red;\">获取AI分析失败，请稍后重试。</p>';\n      } finally {\n        analysisLoading.value[chartName] = false;\n      }\n    };\n\n    const initUserGrowthChart = (data) => {\n      chartData.value.userGrowth = data;\n      userGrowthChartInstance = echarts.init(userGrowthChartRef.value);\n\n      const series = data.series.map(s => ({\n        ...s,\n        smooth: true,\n        areaStyle: {\n          opacity: 0.25\n        },\n        animationDuration: 1000\n      }));\n\n      userGrowthChartInstance.setOption({\n        tooltip: { trigger: 'axis' },\n        legend: {\n          data: data.series.map(s => s.name),\n          bottom: 10,\n          type: 'scroll'\n        },\n        grid: { left: '3%', right: '4%', top: '10%', bottom: '15%', containLabel: true },\n        xAxis: { type: 'category', data: data.dates },\n        yAxis: { type: 'value' },\n        series: series\n      });\n    };\n\n    const initSystemLoadChart = (data) => {\n      chartData.value.systemLoad = data;\n      systemLoadChartInstance = echarts.init(systemLoadChartRef.value);\n      systemLoadChartInstance.setOption({\n        tooltip: {\n          trigger: 'item',\n          formatter: '{b}: {c}%'\n        },\n        legend: { top: 'bottom', icon: 'circle' },\n        color: ['#5470c6', '#91cc75', '#fac858'],\n        series: [\n          {\n            name: '系统资源',\n            type: 'pie',\n            radius: ['45%', '70%'],\n            avoidLabelOverlap: false,\n            itemStyle: {\n              borderRadius: 10,\n              borderColor: '#fff',\n              borderWidth: 2\n            },\n            label: {\n              show: true,\n              position: 'center',\n              formatter: () => {\n                if (!chartData.value.systemLoad || chartData.value.systemLoad.length === 0) {\n                  return '加载中...';\n                }\n                return chartData.value.systemLoad.map(item => {\n                  const name = item.name.replace('使用率 (%)', '').trim();\n                  return `${name}: ${item.value}%`;\n                }).join('\\n');\n              },\n              fontSize: '14',\n              fontWeight: '600',\n              color: '#495057',\n              lineHeight: 22,\n            },\n            emphasis: {\n              label: { \n                show: false,\n              },\n              itemStyle: {\n                shadowBlur: 10,\n                shadowOffsetX: 0,\n                shadowColor: 'rgba(0, 0, 0, 0.2)'\n              }\n            },\n            labelLine: { show: false },\n            data: data,\n            animationType: 'scale',\n            animationEasing: 'elasticOut',\n            animationDelay: () => Math.random() * 200\n          }\n        ]\n      });\n    };\n\n    const initCompanyUserChart = (data) => {\n      chartData.value.companyUser = data;\n      companyUserChartInstance = echarts.init(companyUserChartRef.value);\n\n      const series = data.series || [];\n      const totals = data.totals || [];\n\n      if (series.length > 0) {\n        series[series.length - 1].label = {\n          show: true,\n          position: 'top',\n          formatter: (params) => {\n            const total = totals[params.dataIndex];\n            return total > 0 ? total : '';\n          },\n          color: '#464646',\n          fontSize: 14,\n          fontWeight: 'bold',\n        };\n      }\n\n      companyUserChartInstance.setOption({\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: { type: 'shadow' }\n        },\n        legend: {\n          show: true,\n          bottom: 10,\n          type: 'scroll'\n        },\n        grid: { left: '3%', right: '4%', top: '10%', bottom: '15%', containLabel: true },\n        xAxis: {\n          type: 'category',\n          data: data.labels,\n          axisLabel: { interval: 0, rotate: 30 }\n        },\n        yAxis: { type: 'value' },\n        series: series\n      });\n    };\n\n    const updateSystemLoadChart = async () => {\n      try {\n        const response = await adminApi.getDashboardData();\n        chartData.value.systemLoad = response.data.system_load;\n        if (systemLoadChartInstance) {\n          systemLoadChartInstance.setOption({\n            series: [{\n              data: response.data.system_load\n            }]\n          });\n        }\n      } catch (error) {\n        console.error(\"更新系统资源图表失败:\", error);\n      }\n    };\n\n    const fetchDashboardData = async () => {\n      try {\n        const response = await adminApi.getDashboardData();\n        const data = response.data;\n        stats.value = data.stats;\n\n        await nextTick();\n\n        if (userGrowthChartRef.value && !userGrowthChartInstance) {\n          initUserGrowthChart(data.user_growth);\n        }\n        if (systemLoadChartRef.value && !systemLoadChartInstance) {\n          initSystemLoadChart(data.system_load);\n          if (refreshInterval) clearInterval(refreshInterval);\n          refreshInterval = setInterval(updateSystemLoadChart, 5000);\n        }\n        if (companyUserChartRef.value && !companyUserChartInstance) {\n          initCompanyUserChart(data.company_user_distribution);\n        }\n      } catch (error) {\n        console.error(\"获取仪表盘数据失败:\", error);\n      }\n    };\n\n    const resizeCharts = () => {\n      userGrowthChartInstance?.resize();\n      systemLoadChartInstance?.resize();\n      companyUserChartInstance?.resize();\n    };\n\n    onMounted(() => {\n      fetchDashboardData();\n      window.addEventListener('resize', resizeCharts);\n    });\n\n    onBeforeUnmount(() => {\n      clearInterval(refreshInterval);\n      userGrowthChartInstance?.dispose();\n      systemLoadChartInstance?.dispose();\n      companyUserChartInstance?.dispose();\n      window.removeEventListener('resize', resizeCharts);\n    });\n\n    return {\n      stats,\n      userGrowthChartRef,\n      systemLoadChartRef,\n      companyUserChartRef,\n      analysis,\n      analysisLoading,\n      fetchAnalysis,\n      formatAnalysis,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.dashboard-container {\n  padding: 24px;\n  background-color: #f0f2f5;\n}\n\n.stats-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n.card {\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  padding: 24px;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.09);\n  transition: all 0.3s ease;\n}\n\n.card:hover {\n  box-shadow: 0 4px 12px rgba(0,0,0,0.12);\n  transform: translateY(-4px);\n}\n\n.card-icon {\n  width: 54px;\n  height: 54px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 20px;\n}\n\n.card-icon i {\n  font-size: 28px;\n}\n\n.card-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.card-info .label {\n  color: #8c8c8c;\n  font-size: 14px;\n  margin-bottom: 8px;\n}\n\n.card-info .value {\n  color: #333;\n  font-size: 26px;\n  font-weight: 600;\n}\n\n.main-charts-grid {\n  display: grid;\n  grid-template-columns: 1fr;\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n@media (min-width: 992px) {\n  .main-charts-grid {\n    grid-template-columns: repeat(3, 1fr);\n  }\n  .user-growth-card {\n    grid-column: span 2;\n  }\n  .system-load-card {\n    grid-column: span 1;\n  }\n  .company-user-card {\n    grid-column: span 3;\n  }\n}\n\n.charts-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n.charts-container-full {\n  display: grid;\n  grid-template-columns: 1fr;\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n.chart-card {\n  background-color: #fff;\n  padding: 24px;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.09);\n}\n\n.chart-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.chart-header h4 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.ai-button {\n  background-color: #e6f7ff;\n  color: #1890ff;\n  border: 1px solid #91d5ff;\n  padding: 6px 12px;\n  border-radius: 16px;\n  cursor: pointer;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  transition: all 0.3s ease;\n}\n\n.ai-button:hover:not(:disabled) {\n  background-color: #dcf1ff;\n  border-color: #69c0ff;\n}\n\n.ai-button:disabled {\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.analysis-loader {\n  width: 40px;\n  height: 40px;\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #1890ff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin: 20px auto;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.analysis-result {\n  margin-top: 20px;\n  padding: 16px;\n  background-color: #fafafa;\n  border-radius: 6px;\n  border: 1px solid #e8e8e8;\n  font-size: 14px;\n  line-height: 1.8;\n  white-space: pre-wrap;\n}\n\n.analysis-result :deep(h1),\n.analysis-result :deep(h2),\n.analysis-result :deep(h3) {\n  margin-top: 1em;\n  margin-bottom: 0.5em;\n  font-weight: 600;\n}\n.analysis-result :deep(p) {\n  margin-bottom: 1em;\n}\n.analysis-result :deep(ul),\n.analysis-result :deep(ol) {\n  padding-left: 20px;\n}\n</style> ","import { render } from \"./Dashboard.vue?vue&type=template&id=39c4d944&scoped=true\"\nimport script from \"./Dashboard.vue?vue&type=script&lang=js\"\nexport * from \"./Dashboard.vue?vue&type=script&lang=js\"\n\nimport \"./Dashboard.vue?vue&type=style&index=0&id=39c4d944&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\18083\\\\Desktop\\\\CCIT\\\\office\\\\smart-office\\\\frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-39c4d944\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Dashboard.vue?vue&type=style&index=0&id=39c4d944&scoped=true&lang=css\"","import axios from 'axios';\n\n// 确保使用与 auth.js 中相同的 axios 实例或配置\nconst api = axios.create({\n  baseURL: 'http://localhost:8000/api/admin',\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// 添加请求拦截器以附加JWT令牌\napi.interceptors.request.use(\n  config => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  error => {\n    return Promise.reject(error);\n  }\n);\n\n// 管理员相关API\nexport default {\n  // 获取仪表盘所有数据\n  getDashboardData() {\n    return api.get('/dashboard/');\n  },\n\n  // 获取仪表盘图表的AI分析\n  getDashboardAnalysis(chartTitle, chartData) {\n    return api.post('/dashboard/analysis/', {\n      chart_title: chartTitle,\n      chart_data: chartData,\n    });\n  },\n\n  // 获取用户列表 (支持分页和搜索)\n  getUsers(params) {\n    return api.get('/users/', { params });\n  },\n\n  // 创建新用户\n  createUser(data) {\n    return api.post('/users/', data);\n  },\n\n  // 更新用户信息\n  updateUser(id, data) {\n    return api.patch(`/users/${id}/`, data);\n  },\n\n  // 删除用户\n  deleteUser(id) {\n    return api.delete(`/users/${id}/`);\n  },\n\n  // 公司管理\n  getCompanies(params) {\n    return api.get('/companies/', { params });\n  },\n  createCompany(data) {\n    return api.post('/companies/', data);\n  },\n  updateCompany(id, data) {\n    return api.patch(`/companies/${id}/`, data);\n  },\n  deleteCompany(id) {\n    return api.delete(`/companies/${id}/`);\n  },\n\n  // 部门管理\n  getDepartments(params) {\n    return api.get('/departments/', { params });\n  },\n  createDepartment(data) {\n    return api.post('/departments/', data);\n  },\n  updateDepartment(id, data) {\n    return api.patch(`/departments/${id}/`, data);\n  },\n  deleteDepartment(id) {\n    return api.delete(`/departments/${id}/`);\n  },\n\n  // 获取智能文档\n  getSmartDocs(params) {\n    return api.get('/smart-docs/', { params });\n  },\n\n  // 获取智能文档详情\n  getSmartDocDetail(id) {\n    return api.get(`/smart-docs/${id}/`);\n  },\n\n  // 删除智能文档\n  deleteSmartDoc(id) {\n    return api.delete(`/smart-docs/${id}/`);\n  },\n\n  // 获取合同列表\n  getContracts(params) {\n    return api.get('/contracts/', { params });\n  },\n\n  // 获取合同详情\n  getContractDetail(id) {\n    return api.get(`/contracts/${id}/`);\n  },\n\n  // 删除合同\n  deleteContract(id) {\n    return api.delete(`/contracts/${id}/`);\n  },\n\n  // Contract Templates\n  getContractTemplates() {\n    return api.get('/contract-templates/');\n  },\n  getContractTemplate(id) {\n    return api.get(`/contract-templates/${id}/`);\n  },\n  createContractTemplate(data) {\n    return api.post('/contract-templates/', data);\n  },\n  updateContractTemplate(id, data) {\n    return api.patch(`/contract-templates/${id}/`, data);\n  },\n  deleteContractTemplate(id) {\n    return api.delete(`/contract-templates/${id}/`);\n  },\n\n  // Knowledge Base Categories\n  getKnowledgeCategories(params) {\n    return api.get('/knowledge-categories/', { params });\n  },\n  createKnowledgeCategory(data) {\n    return api.post('/knowledge-categories/', data);\n  },\n  updateKnowledgeCategory(id, data) {\n    return api.patch(`/knowledge-categories/${id}/`, data);\n  },\n  deleteKnowledgeCategory(id) {\n    return api.delete(`/knowledge-categories/${id}/`);\n  },\n\n  // Knowledge Base Articles\n  getKnowledgeBases(params) {\n    return api.get('/knowledge-bases/', { params });\n  },\n  getKnowledgeBaseDetail(id) {\n    return api.get(`/knowledge-bases/${id}/`);\n  },\n  createKnowledgeBase(data) {\n    const formData = new FormData();\n    for (const key in data) {\n      if (data[key] !== null && data[key] !== undefined) {\n        formData.append(key, data[key]);\n      }\n    }\n    return api.post('/knowledge-bases/', formData, {\n      headers: { 'Content-Type': 'multipart/form-data' },\n    });\n  },\n  updateKnowledgeBase(id, data) {\n    const formData = new FormData();\n    for (const key in data) {\n      // 避免将文件对象作为普通字段附加\n      if (key !== 'original_file' && data[key] !== null && data[key] !== undefined) {\n        formData.append(key, data[key]);\n      }\n    }\n    // 仅当存在新文件时才附加文件\n    if (data.original_file instanceof File) {\n      formData.append('original_file', data.original_file);\n    }\n    return api.patch(`/knowledge-bases/${id}/`, formData, {\n      headers: { 'Content-Type': 'multipart/form-data' },\n    });\n  },\n  deleteKnowledgeBase(id) {\n    return api.delete(`/knowledge-bases/${id}/`);\n  },\n  \n  // Knowledge Base Building\n  getKnowledgeBuildStatus() {\n    return api.get('/knowledge/build/');\n  },\n  buildKnowledgeForCompanies(companyIds) {\n    return api.post('/knowledge/build/', { company_ids: companyIds });\n  },\n};"],"sourceRoot":""}