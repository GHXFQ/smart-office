(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80328ba4"],{"36e1":function(e,t,a){"use strict";a("8dd0")},"50fc":function(e,t,a){"use strict";var r=a("cee4");const c=r["a"].create({baseURL:"http://localhost:8000/api/admin",timeout:1e4,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e},e=>Promise.reject(e)),t["a"]={getDashboardData(){return c.get("/dashboard/")},getDashboardAnalysis(e,t){return c.post("/dashboard/analysis/",{chart_title:e,chart_data:t})},getUsers(e){return c.get("/users/",{params:e})},createUser(e){return c.post("/users/",e)},updateUser(e,t){return c.patch(`/users/${e}/`,t)},deleteUser(e){return c.delete(`/users/${e}/`)},getCompanies(e){return c.get("/companies/",{params:e})},createCompany(e){return c.post("/companies/",e)},updateCompany(e,t){return c.patch(`/companies/${e}/`,t)},deleteCompany(e){return c.delete(`/companies/${e}/`)},getDepartments(e){return c.get("/departments/",{params:e})},createDepartment(e){return c.post("/departments/",e)},updateDepartment(e,t){return c.patch(`/departments/${e}/`,t)},deleteDepartment(e){return c.delete(`/departments/${e}/`)},getSmartDocs(e){return c.get("/smart-docs/",{params:e})},getSmartDocDetail(e){return c.get(`/smart-docs/${e}/`)},deleteSmartDoc(e){return c.delete(`/smart-docs/${e}/`)},getContracts(e){return c.get("/contracts/",{params:e})},getContractDetail(e){return c.get(`/contracts/${e}/`)},deleteContract(e){return c.delete(`/contracts/${e}/`)},getContractTemplates(){return c.get("/contract-templates/")},getContractTemplate(e){return c.get(`/contract-templates/${e}/`)},createContractTemplate(e){return c.post("/contract-templates/",e)},updateContractTemplate(e,t){return c.patch(`/contract-templates/${e}/`,t)},deleteContractTemplate(e){return c.delete(`/contract-templates/${e}/`)},getKnowledgeCategories(e){return c.get("/knowledge-categories/",{params:e})},createKnowledgeCategory(e){return c.post("/knowledge-categories/",e)},updateKnowledgeCategory(e,t){return c.patch(`/knowledge-categories/${e}/`,t)},deleteKnowledgeCategory(e){return c.delete(`/knowledge-categories/${e}/`)},getKnowledgeBases(e){return c.get("/knowledge-bases/",{params:e})},getKnowledgeBaseDetail(e){return c.get(`/knowledge-bases/${e}/`)},createKnowledgeBase(e){const t=new FormData;for(const a in e)null!==e[a]&&void 0!==e[a]&&t.append(a,e[a]);return c.post("/knowledge-bases/",t,{headers:{"Content-Type":"multipart/form-data"}})},updateKnowledgeBase(e,t){const a=new FormData;for(const r in t)"original_file"!==r&&null!==t[r]&&void 0!==t[r]&&a.append(r,t[r]);return t.original_file instanceof File&&a.append("original_file",t.original_file),c.patch(`/knowledge-bases/${e}/`,a,{headers:{"Content-Type":"multipart/form-data"}})},deleteKnowledgeBase(e){return c.delete(`/knowledge-bases/${e}/`)},getKnowledgeBuildStatus(){return c.get("/knowledge/build/")},buildKnowledgeForCompanies(e){return c.post("/knowledge/build/",{company_ids:e})}}},"8dd0":function(e,t,a){},ab09:function(e,t,a){"use strict";a.r(t);var r=a("7a23"),c=a("50fc"),l=a("3ef4"),n=a("c9a1"),o=a("4c02"),d=a("54bb"),u=a("c349"),s=a("cf2e"),i=a("1e49"),b=a("7faf"),p=a("db9d"),m=a("d8e8"),j=a("f6f2");const O={class:"management-container"},g={class:"card-header"},f={class:"header-left"},h={class:"header-right"},w={class:"table-container"},V={class:"pagination-container"},v={class:"dialog-footer"};var C={__name:"CompanyManagement",setup(e){const t=Object(r["ref"])([]),a=Object(r["ref"])(!0),C=Object(r["ref"])(""),N=Object(r["ref"])(0),y=Object(r["reactive"])({page:1,pageSize:10}),x=Object(r["ref"])(!1),_=Object(r["ref"])({}),k=Object(r["ref"])(null);let z=null;const $=async()=>{a.value=!0;try{const e={search:C.value,page:y.page,page_size:y.pageSize},r=await c["a"].getCompanies(e);t.value=r.data.results,N.value=r.data.count}catch(e){console.error("获取公司列表失败:",e),l["a"].error("获取公司列表失败")}finally{a.value=!1}},D=()=>{clearTimeout(z),z=setTimeout(()=>{y.page=1,$()},300)},T=(e={})=>{e&&e.id?_.value={...e}:_.value={name:"",industry:"",size:"",address:"",website:"",phone:""},x.value=!0},U=()=>{var e;x.value=!1,null===(e=k.value)||void 0===e||e.resetFields()},B=async()=>{k.value&&await k.value.validate(async e=>{if(e)try{_.value.id?await c["a"].updateCompany(_.value.id,_.value):await c["a"].createCompany(_.value),U(),$(),l["a"].success("公司信息保存成功！")}catch(t){console.error("保存公司失败:",t),l["a"].error("保存公司失败，请稍后重试")}})},S=e=>{n["a"].confirm(`确定要删除公司【${e.name}】吗？删除后，该公司下的所有用户和部门信息都将丢失，此操作不可恢复。`,"严重警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"error",center:!0}).then(async()=>{try{await c["a"].deleteCompany(e.id),l["a"].success("公司删除成功"),$()}catch(t){l["a"].error("删除失败，请稍后重试"),console.error("删除公司失败:",t)}}).catch(()=>{l["a"].info("已取消删除")})},K=e=>{y.pageSize=e,$()},E=e=>{y.page=e,$()};return Object(r["onMounted"])($),(e,c)=>{const l=Object(r["resolveDirective"])("loading");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",O,[Object(r["createVNode"])(Object(r["unref"])(o["a"]),{class:"box-card"},{header:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",g,[Object(r["createElementVNode"])("div",f,[Object(r["createVNode"])(Object(r["unref"])(d["a"]),{class:"header-icon"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(j["OfficeBuilding"]))]),_:1}),c[11]||(c[11]=Object(r["createElementVNode"])("span",null,"公司管理",-1))]),Object(r["createElementVNode"])("div",h,[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:C.value,"onUpdate:modelValue":c[0]||(c[0]=e=>C.value=e),placeholder:"搜索公司...",clearable:"",onClear:$,onInput:D,class:"search-input"},{append:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(s["a"]),{icon:Object(r["unref"])(j["Search"])},null,8,["icon"])]),_:1},8,["modelValue"]),Object(r["createVNode"])(Object(r["unref"])(s["a"]),{type:"primary",icon:Object(r["unref"])(j["Plus"]),onClick:c[1]||(c[1]=e=>T())},{default:Object(r["withCtx"])(()=>c[12]||(c[12]=[Object(r["createTextVNode"])("添加公司")])),_:1},8,["icon"])])])]),default:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",w,[Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["unref"])(i["a"]),{data:t.value,style:{width:"100%"}},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(i["b"]),{type:"index",label:"序号",width:"60"}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"name",label:"公司名称",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"industry",label:"行业",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"size",label:"规模",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"address",label:"地址","min-width":"150"}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{label:"操作",width:"120"},{default:Object(r["withCtx"])(e=>[Object(r["createVNode"])(Object(r["unref"])(s["a"]),{text:"",type:"primary",size:"small",onClick:t=>T(e.row)},{default:Object(r["withCtx"])(()=>c[13]||(c[13]=[Object(r["createTextVNode"])("编辑")])),_:2},1032,["onClick"]),Object(r["createVNode"])(Object(r["unref"])(s["a"]),{text:"",type:"danger",size:"small",onClick:t=>S(e.row)},{default:Object(r["withCtx"])(()=>c[14]||(c[14]=[Object(r["createTextVNode"])("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[l,a.value]])]),Object(r["createElementVNode"])("div",V,[Object(r["createVNode"])(Object(r["unref"])(b["a"]),{"current-page":y.page,"onUpdate:currentPage":c[2]||(c[2]=e=>y.page=e),"page-size":y.pageSize,"onUpdate:pageSize":c[3]||(c[3]=e=>y.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:K,onCurrentChange:E},null,8,["current-page","page-size","total"])]),Object(r["createVNode"])(Object(r["unref"])(p["a"]),{modelValue:x.value,"onUpdate:modelValue":c[10]||(c[10]=e=>x.value=e),title:_.value.id?"编辑公司":"添加公司",width:"500px"},{footer:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("span",v,[Object(r["createVNode"])(Object(r["unref"])(s["a"]),{onClick:U},{default:Object(r["withCtx"])(()=>c[15]||(c[15]=[Object(r["createTextVNode"])("取消")])),_:1}),Object(r["createVNode"])(Object(r["unref"])(s["a"]),{type:"primary",onClick:B},{default:Object(r["withCtx"])(()=>c[16]||(c[16]=[Object(r["createTextVNode"])("保存")])),_:1})])]),default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(m["a"]),{model:_.value,ref_key:"itemForm",ref:k,"label-width":"80px"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"公司名称",prop:"name",rules:[{required:!0,message:"请输入公司名称"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.name,"onUpdate:modelValue":c[4]||(c[4]=e=>_.value.name=e)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"行业",prop:"industry",rules:[{required:!0,message:"请输入行业"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.industry,"onUpdate:modelValue":c[5]||(c[5]=e=>_.value.industry=e)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"规模",prop:"size",rules:[{required:!0,message:"请输入公司规模"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.size,"onUpdate:modelValue":c[6]||(c[6]=e=>_.value.size=e)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"地址",prop:"address",rules:[{required:!0,message:"请输入地址"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.address,"onUpdate:modelValue":c[7]||(c[7]=e=>_.value.address=e)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"网站",prop:"website",rules:[{required:!0,message:"请输入网站"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.website,"onUpdate:modelValue":c[8]||(c[8]=e=>_.value.website=e)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(m["b"]),{label:"联系电话",prop:"phone",rules:[{required:!0,message:"请输入联系电话"}]},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{modelValue:_.value.phone,"onUpdate:modelValue":c[9]||(c[9]=e=>_.value.phone=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})])}}},N=(a("36e1"),a("6b0d")),y=a.n(N);const x=y()(C,[["__scopeId","data-v-e5d105f8"]]);t["default"]=x}}]);
//# sourceMappingURL=chunk-80328ba4.56ce618f.js.map