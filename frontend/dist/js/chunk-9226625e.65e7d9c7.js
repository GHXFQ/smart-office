(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9226625e"],{"0a6e":function(e,t,a){"use strict";a.r(t);var s=a("7a23");const r={class:"dashboard-container"},o={class:"stats-cards"},n={class:"card"},l={class:"card-info"},c={class:"value"},i={class:"card"},d={class:"card-info"},m={class:"value"},u={class:"card"},b={class:"card-info"},p={class:"value"},y={class:"main-charts-grid"},g={class:"chart-card user-growth-card"},h={class:"chart-header"},O=["disabled"],j={ref:"userGrowthChartRef",style:{height:"300px"}},f={key:0,class:"analysis-loader"},v=["innerHTML"],w={class:"chart-card system-load-card"},E={class:"chart-header"},N=["disabled"],V={ref:"systemLoadChartRef",style:{height:"300px"}},k={key:0,class:"analysis-loader"},L=["innerHTML"],C={class:"chart-card company-user-card"},D={class:"chart-header"},B=["disabled"],A={ref:"companyUserChartRef",style:{height:"400px"}},$={key:0,class:"analysis-loader"},_=["innerHTML"];function T(e,t,a,T,U,x){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",r,[Object(s["createElementVNode"])("div",o,[Object(s["createElementVNode"])("div",n,[t[4]||(t[4]=Object(s["createElementVNode"])("div",{class:"card-icon",style:{"background-color":"#e6f7ff"}},[Object(s["createElementVNode"])("i",{class:"bi bi-people-fill",style:{color:"#1890ff"}})],-1)),Object(s["createElementVNode"])("div",l,[t[3]||(t[3]=Object(s["createElementVNode"])("span",{class:"label"},"总员工数",-1)),Object(s["createElementVNode"])("span",c,Object(s["toDisplayString"])(T.stats.user_count),1)])]),Object(s["createElementVNode"])("div",i,[t[6]||(t[6]=Object(s["createElementVNode"])("div",{class:"card-icon",style:{"background-color":"#f6ffed"}},[Object(s["createElementVNode"])("i",{class:"bi bi-building",style:{color:"#52c41a"}})],-1)),Object(s["createElementVNode"])("div",d,[t[5]||(t[5]=Object(s["createElementVNode"])("span",{class:"label"},"公司总数",-1)),Object(s["createElementVNode"])("span",m,Object(s["toDisplayString"])(T.stats.company_count),1)])]),Object(s["createElementVNode"])("div",u,[t[8]||(t[8]=Object(s["createElementVNode"])("div",{class:"card-icon",style:{"background-color":"#fffbe6"}},[Object(s["createElementVNode"])("i",{class:"bi bi-diagram-3-fill",style:{color:"#faad14"}})],-1)),Object(s["createElementVNode"])("div",b,[t[7]||(t[7]=Object(s["createElementVNode"])("span",{class:"label"},"部门总数",-1)),Object(s["createElementVNode"])("span",p,Object(s["toDisplayString"])(T.stats.department_count),1)])])]),Object(s["createElementVNode"])("div",y,[Object(s["createElementVNode"])("div",g,[Object(s["createElementVNode"])("div",h,[t[10]||(t[10]=Object(s["createElementVNode"])("h4",null,"员工增长趋势",-1)),Object(s["createElementVNode"])("button",{onClick:t[0]||(t[0]=e=>T.fetchAnalysis("userGrowth")),class:"ai-button",disabled:T.analysisLoading.userGrowth},[t[9]||(t[9]=Object(s["createElementVNode"])("i",{class:"bi bi-robot"},null,-1)),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(T.analysisLoading.userGrowth?"分析中...":"AI智能分析"),1)],8,O)]),Object(s["createElementVNode"])("div",j,null,512),T.analysisLoading.userGrowth?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",f)):Object(s["createCommentVNode"])("",!0),T.analysis.userGrowth?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:1,class:"analysis-result",innerHTML:T.formatAnalysis(T.analysis.userGrowth)},null,8,v)):Object(s["createCommentVNode"])("",!0)]),Object(s["createElementVNode"])("div",w,[Object(s["createElementVNode"])("div",E,[t[12]||(t[12]=Object(s["createElementVNode"])("h4",null,"系统资源使用情况",-1)),Object(s["createElementVNode"])("button",{onClick:t[1]||(t[1]=e=>T.fetchAnalysis("systemLoad")),class:"ai-button",disabled:T.analysisLoading.systemLoad},[t[11]||(t[11]=Object(s["createElementVNode"])("i",{class:"bi bi-robot"},null,-1)),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(T.analysisLoading.systemLoad?"分析中...":"AI智能分析"),1)],8,N)]),Object(s["createElementVNode"])("div",V,null,512),T.analysisLoading.systemLoad?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",k)):Object(s["createCommentVNode"])("",!0),T.analysis.systemLoad?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:1,class:"analysis-result",innerHTML:T.formatAnalysis(T.analysis.systemLoad)},null,8,L)):Object(s["createCommentVNode"])("",!0)]),Object(s["createElementVNode"])("div",C,[Object(s["createElementVNode"])("div",D,[t[14]||(t[14]=Object(s["createElementVNode"])("h4",null,"各公司员工数量",-1)),Object(s["createElementVNode"])("button",{onClick:t[2]||(t[2]=e=>T.fetchAnalysis("companyUser")),class:"ai-button",disabled:T.analysisLoading.companyUser},[t[13]||(t[13]=Object(s["createElementVNode"])("i",{class:"bi bi-robot"},null,-1)),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(T.analysisLoading.companyUser?"分析中...":"AI智能分析"),1)],8,B)]),Object(s["createElementVNode"])("div",A,null,512),T.analysisLoading.companyUser?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",$)):Object(s["createCommentVNode"])("",!0),T.analysis.companyUser?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:1,class:"analysis-result",innerHTML:T.formatAnalysis(T.analysis.companyUser)},null,8,_)):Object(s["createCommentVNode"])("",!0)])])])}a("e9f5"),a("ab43");var U=a("313e"),x=a("50fc"),S=a("7c5c"),G={name:"AdminDashboard",setup(){const e=Object(s["ref"])({user_count:0,company_count:0,department_count:0}),t=Object(s["ref"])(null),a=Object(s["ref"])(null),r=Object(s["ref"])(null),o=Object(s["ref"])({userGrowth:null,systemLoad:null,companyUser:null}),n=Object(s["ref"])({userGrowth:"",systemLoad:"",companyUser:""}),l=Object(s["ref"])({userGrowth:!1,systemLoad:!1,companyUser:!1});let c=null,i=null,d=null,m=null;const u=e=>e?Object(S["marked"])(e):"",b=async e=>{const t={userGrowth:"员工增长趋势",systemLoad:"系统资源使用情况",companyUser:"各公司员工数量"};if(o.value[e]){l.value[e]=!0,n.value[e]="";try{const a=await x["a"].getDashboardAnalysis(t[e],o.value[e]);n.value[e]=a.data.analysis}catch(a){console.error(`获取 ${t[e]} AI分析失败:`,a),n.value[e]='<p style="color: red;">获取AI分析失败，请稍后重试。</p>'}finally{l.value[e]=!1}}else console.error("图表数据尚未加载")},p=e=>{o.value.userGrowth=e,c=U["a"](t.value);const a=e.series.map(e=>({...e,smooth:!0,areaStyle:{opacity:.25},animationDuration:1e3}));c.setOption({tooltip:{trigger:"axis"},legend:{data:e.series.map(e=>e.name),bottom:10,type:"scroll"},grid:{left:"3%",right:"4%",top:"10%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:e.dates},yAxis:{type:"value"},series:a})},y=e=>{o.value.systemLoad=e,i=U["a"](a.value),i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c}%"},legend:{top:"bottom",icon:"circle"},color:["#5470c6","#91cc75","#fac858"],series:[{name:"系统资源",type:"pie",radius:["45%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"center",formatter:()=>o.value.systemLoad&&0!==o.value.systemLoad.length?o.value.systemLoad.map(e=>{const t=e.name.replace("使用率 (%)","").trim();return`${t}: ${e.value}%`}).join("\n"):"加载中...",fontSize:"14",fontWeight:"600",color:"#495057",lineHeight:22},emphasis:{label:{show:!1},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.2)"}},labelLine:{show:!1},data:e,animationType:"scale",animationEasing:"elasticOut",animationDelay:()=>200*Math.random()}]})},g=e=>{o.value.companyUser=e,d=U["a"](r.value);const t=e.series||[],a=e.totals||[];t.length>0&&(t[t.length-1].label={show:!0,position:"top",formatter:e=>{const t=a[e.dataIndex];return t>0?t:""},color:"#464646",fontSize:14,fontWeight:"bold"}),d.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!0,bottom:10,type:"scroll"},grid:{left:"3%",right:"4%",top:"10%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:e.labels,axisLabel:{interval:0,rotate:30}},yAxis:{type:"value"},series:t})},h=async()=>{try{const e=await x["a"].getDashboardData();o.value.systemLoad=e.data.system_load,i&&i.setOption({series:[{data:e.data.system_load}]})}catch(e){console.error("更新系统资源图表失败:",e)}},O=async()=>{try{const o=await x["a"].getDashboardData(),n=o.data;e.value=n.stats,await Object(s["nextTick"])(),t.value&&!c&&p(n.user_growth),a.value&&!i&&(y(n.system_load),m&&clearInterval(m),m=setInterval(h,5e3)),r.value&&!d&&g(n.company_user_distribution)}catch(o){console.error("获取仪表盘数据失败:",o)}},j=()=>{var e,t,a;null===(e=c)||void 0===e||e.resize(),null===(t=i)||void 0===t||t.resize(),null===(a=d)||void 0===a||a.resize()};return Object(s["onMounted"])(()=>{O(),window.addEventListener("resize",j)}),Object(s["onBeforeUnmount"])(()=>{var e,t,a;clearInterval(m),null===(e=c)||void 0===e||e.dispose(),null===(t=i)||void 0===t||t.dispose(),null===(a=d)||void 0===a||a.dispose(),window.removeEventListener("resize",j)}),{stats:e,userGrowthChartRef:t,systemLoadChartRef:a,companyUserChartRef:r,analysis:n,analysisLoading:l,fetchAnalysis:b,formatAnalysis:u}}},I=(a("4ce5"),a("6b0d")),K=a.n(I);const z=K()(G,[["render",T],["__scopeId","data-v-39c4d944"]]);t["default"]=z},"4ce5":function(e,t,a){"use strict";a("aa4f")},"50fc":function(e,t,a){"use strict";var s=a("cee4");const r=s["a"].create({baseURL:"http://localhost:8000/api/admin",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e},e=>Promise.reject(e)),t["a"]={getDashboardData(){return r.get("/dashboard/")},getDashboardAnalysis(e,t){return r.post("/dashboard/analysis/",{chart_title:e,chart_data:t})},getUsers(e){return r.get("/users/",{params:e})},createUser(e){return r.post("/users/",e)},updateUser(e,t){return r.patch(`/users/${e}/`,t)},deleteUser(e){return r.delete(`/users/${e}/`)},getCompanies(e){return r.get("/companies/",{params:e})},createCompany(e){return r.post("/companies/",e)},updateCompany(e,t){return r.patch(`/companies/${e}/`,t)},deleteCompany(e){return r.delete(`/companies/${e}/`)},getDepartments(e){return r.get("/departments/",{params:e})},createDepartment(e){return r.post("/departments/",e)},updateDepartment(e,t){return r.patch(`/departments/${e}/`,t)},deleteDepartment(e){return r.delete(`/departments/${e}/`)},getSmartDocs(e){return r.get("/smart-docs/",{params:e})},getSmartDocDetail(e){return r.get(`/smart-docs/${e}/`)},deleteSmartDoc(e){return r.delete(`/smart-docs/${e}/`)},getContracts(e){return r.get("/contracts/",{params:e})},getContractDetail(e){return r.get(`/contracts/${e}/`)},deleteContract(e){return r.delete(`/contracts/${e}/`)},getContractTemplates(){return r.get("/contract-templates/")},getContractTemplate(e){return r.get(`/contract-templates/${e}/`)},createContractTemplate(e){return r.post("/contract-templates/",e)},updateContractTemplate(e,t){return r.patch(`/contract-templates/${e}/`,t)},deleteContractTemplate(e){return r.delete(`/contract-templates/${e}/`)},getKnowledgeCategories(e){return r.get("/knowledge-categories/",{params:e})},createKnowledgeCategory(e){return r.post("/knowledge-categories/",e)},updateKnowledgeCategory(e,t){return r.patch(`/knowledge-categories/${e}/`,t)},deleteKnowledgeCategory(e){return r.delete(`/knowledge-categories/${e}/`)},getKnowledgeBases(e){return r.get("/knowledge-bases/",{params:e})},getKnowledgeBaseDetail(e){return r.get(`/knowledge-bases/${e}/`)},createKnowledgeBase(e){const t=new FormData;for(const a in e)null!==e[a]&&void 0!==e[a]&&t.append(a,e[a]);return r.post("/knowledge-bases/",t,{headers:{"Content-Type":"multipart/form-data"}})},updateKnowledgeBase(e,t){const a=new FormData;for(const s in t)"original_file"!==s&&null!==t[s]&&void 0!==t[s]&&a.append(s,t[s]);return t.original_file instanceof File&&a.append("original_file",t.original_file),r.patch(`/knowledge-bases/${e}/`,a,{headers:{"Content-Type":"multipart/form-data"}})},deleteKnowledgeBase(e){return r.delete(`/knowledge-bases/${e}/`)},getKnowledgeBuildStatus(){return r.get("/knowledge/build/")},buildKnowledgeForCompanies(e){return r.post("/knowledge/build/",{company_ids:e})}}},aa4f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-9226625e.65e7d9c7.js.map