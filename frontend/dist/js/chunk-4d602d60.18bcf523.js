(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d602d60"],{"07af":function(e,t,a){},5123:function(e,t,a){"use strict";a("07af")},"935e":function(e,t,a){"use strict";a.r(t);var r=a("7a23");const c={class:"register-page"},o={class:"main-container"},l={class:"register-container"},s={class:"mb-3"},i={class:"mb-3"},n={class:"mb-3"},d={class:"mb-3"},b={class:"mb-3"},m={class:"login-link"};function u(e,t,a,u,p,O){const j=Object(r["resolveComponent"])("User"),f=Object(r["resolveComponent"])("el-icon"),g=Object(r["resolveComponent"])("el-input"),v=Object(r["resolveComponent"])("el-form-item"),w=Object(r["resolveComponent"])("Message"),V=Object(r["resolveComponent"])("OfficeBuilding"),h=Object(r["resolveComponent"])("el-option"),N=Object(r["resolveComponent"])("el-select"),C=Object(r["resolveComponent"])("Lock"),x=Object(r["resolveComponent"])("el-button"),y=Object(r["resolveComponent"])("el-form"),_=Object(r["resolveComponent"])("router-link");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",c,[t[17]||(t[17]=Object(r["createStaticVNode"])('<div class="bg-animation" data-v-504bbceb><div class="bg-particle" data-v-504bbceb></div><div class="bg-particle" data-v-504bbceb></div><div class="bg-particle" data-v-504bbceb></div><div class="bg-particle" data-v-504bbceb></div><div class="bg-particle" data-v-504bbceb></div></div>',1)),Object(r["createElementVNode"])("div",o,[t[16]||(t[16]=Object(r["createStaticVNode"])('<div class="left-section" data-v-504bbceb><div class="decoration" data-v-504bbceb><div class="decoration-circle" data-v-504bbceb></div><div class="decoration-circle" data-v-504bbceb></div><div class="decoration-circle" data-v-504bbceb></div></div><div class="animation-container" id="lottieAnimation" data-v-504bbceb></div><div class="left-content" data-v-504bbceb><h2 data-v-504bbceb>欢迎加入我们</h2><p data-v-504bbceb>加入智能办公系统，提升工作效率，实现智能协作</p></div></div>',1)),Object(r["createElementVNode"])("div",l,[t[15]||(t[15]=Object(r["createElementVNode"])("div",{class:"register-header"},[Object(r["createElementVNode"])("i",{class:"bi bi-briefcase"}),Object(r["createElementVNode"])("h4",null,"创建您的账户"),Object(r["createElementVNode"])("p",null,"开始您的智能办公之旅")],-1)),Object(r["createVNode"])(y,{ref:"registerFormRef",model:u.registerForm,rules:u.registerRules,class:"register-form"},{default:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",s,[t[5]||(t[5]=Object(r["createElementVNode"])("label",{for:"username",class:"form-label"},"账号",-1)),Object(r["createVNode"])(v,{prop:"username"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(g,{modelValue:u.registerForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>u.registerForm.username=e),placeholder:"请输入您的账号 (例如：user123)",id:"username"},{prefix:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(j)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Object(r["createElementVNode"])("div",i,[t[7]||(t[7]=Object(r["createElementVNode"])("label",{for:"email",class:"form-label"},"邮箱",-1)),Object(r["createVNode"])(v,{prop:"email"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(g,{modelValue:u.registerForm.email,"onUpdate:modelValue":t[1]||(t[1]=e=>u.registerForm.email=e),placeholder:"请输入您的邮箱地址",id:"email"},{prefix:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(w)]),_:1})]),_:1},8,["modelValue"]),t[6]||(t[6]=Object(r["createElementVNode"])("div",{id:"emailHelp",class:"form-text"},"我们将发送验证邮件到此邮箱，也可用于密码找回。",-1))]),_:1})]),Object(r["createElementVNode"])("div",n,[t[9]||(t[9]=Object(r["createElementVNode"])("label",{for:"company",class:"form-label"},"企业名称",-1)),Object(r["createVNode"])(v,{prop:"company"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(N,{modelValue:u.registerForm.company,"onUpdate:modelValue":t[2]||(t[2]=e=>u.registerForm.company=e),placeholder:"请选择您的企业",style:{width:"100%"},id:"company"},{prefix:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(V)]),_:1})]),default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(u.companies,e=>(Object(r["openBlock"])(),Object(r["createBlock"])(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t[8]||(t[8]=Object(r["createElementVNode"])("div",{id:"companyHelp",class:"form-text"},"您所属的企业或组织名称，有助于系统为您提供更精准的服务。",-1))]),_:1})]),Object(r["createElementVNode"])("div",d,[t[10]||(t[10]=Object(r["createElementVNode"])("label",{for:"password",class:"form-label"},"密码",-1)),Object(r["createVNode"])(v,{prop:"password"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(g,{modelValue:u.registerForm.password,"onUpdate:modelValue":t[3]||(t[3]=e=>u.registerForm.password=e),type:"password",placeholder:"请输入密码 (至少6位)","show-password":"",id:"password"},{prefix:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(C)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Object(r["createElementVNode"])("div",b,[t[11]||(t[11]=Object(r["createElementVNode"])("label",{for:"confirmPassword",class:"form-label"},"确认密码",-1)),Object(r["createVNode"])(v,{prop:"confirmPassword"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(g,{modelValue:u.registerForm.confirmPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>u.registerForm.confirmPassword=e),type:"password",placeholder:"请再次输入密码","show-password":"",id:"confirmPassword"},{prefix:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(C)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Object(r["createVNode"])(x,{type:"primary",class:"btn btn-primary w-100",onClick:u.handleRegister,loading:u.loading},{default:Object(r["withCtx"])(()=>t[12]||(t[12]=[Object(r["createTextVNode"])(" 注册 ")])),_:1},8,["onClick","loading"])]),_:1},8,["model","rules"]),Object(r["createElementVNode"])("div",m,[Object(r["createElementVNode"])("p",null,[t[14]||(t[14]=Object(r["createTextVNode"])("已有账号? ")),Object(r["createVNode"])(_,{to:"/login"},{default:Object(r["withCtx"])(()=>t[13]||(t[13]=[Object(r["createTextVNode"])("立即登录")])),_:1})])])])])])}a("d9e2"),a("14d9");var p=a("6605"),O=a("5502"),j=a("3ef4"),f=a("f6f2"),g=a("fcac"),v={name:"Register",setup(){const e=Object(p["d"])(),t=Object(O["b"])(),a=Object(r["ref"])(null),c=Object(r["computed"])(()=>t.getters["user/loading"]),o=Object(r["computed"])(()=>t.getters["user/error"]),l=Object(r["ref"])([]),s=Object(r["reactive"])({username:"",email:"",password:"",confirmPassword:"",company:null}),i={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,message:"用户名长度至少4个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],company:[{required:!0,message:"请选择企业",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(e,t,a)=>{t!==s.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}]},n=async()=>{try{const e=await Object(g["d"])();console.log("获取企业列表响应:",e),e&&e.data?l.value=e.data:e&&e.success&&Array.isArray(e)?l.value=e:(console.error("获取企业列表失败:",e),l.value=[{id:1,name:"默认企业"}],j["a"].warning("获取企业列表失败，已设置默认选项"))}catch(o){console.error("获取企业列表失败:",o),l.value=[{id:1,name:"默认企业"}],j["a"].warning("获取企业列表失败，已设置默认选项")}},d=async()=>{if(a.value){t.dispatch("user/clearError");try{await a.value.validate()}catch(o){return void j["a"].warning("请填写所有必填项")}try{const a={username:s.username,email:s.email,password:s.password,confirmPassword:s.confirmPassword,company:s.company,first_name:"",last_name:"",phone:""},c=await t.dispatch("user/register",a);j["a"].success(c.message||"注册成功！");const o={username:s.username,password:s.password};try{await t.dispatch("user/login",o),j["a"].success("自动登录成功！"),e.push("/dashboard")}catch(r){console.error("自动登录失败:",r),j["a"].warning("自动登录失败，请手动登录"),e.push("/login")}}catch(c){o.value?j["a"].error(o.value):(console.error("注册失败:",c),j["a"].error("注册失败，请稍后重试"))}}};return Object(r["onMounted"])(()=>{n();const e=document.getElementById("lottieAnimation");e&&window.lottie&&window.lottie.loadAnimation({container:e,renderer:"svg",loop:!0,autoplay:!0,path:"https://assets2.lottiefiles.com/packages/lf20_jcikwtux.json"})}),{registerFormRef:a,registerForm:s,registerRules:i,loading:c,companies:l,handleRegister:d,User:f["User"],Lock:f["Lock"],Message:f["Message"],OfficeBuilding:f["OfficeBuilding"]}}},w=(a("5123"),a("6b0d")),V=a.n(w);const h=V()(v,[["render",u],["__scopeId","data-v-504bbceb"]]);t["default"]=h},fcac:function(e,t,a){"use strict";a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n}));var r=a("b775");function c(){return Object(r["a"])({url:"/api/auth/companies/simple_list/",method:"get",auth:!1})}function o(e,t){return Object(r["a"])({url:`/api/auth/companies/${e}/`,method:"put",data:t})}function l(e){return Object(r["a"])({url:"/api/auth/departments/",method:"post",data:e})}function s(e,t){return Object(r["a"])({url:`/api/auth/departments/${e}/`,method:"put",data:t})}function i(e){return Object(r["a"])({url:`/api/auth/departments/${e}/`,method:"delete"})}function n(){return Object(r["a"])({url:"/api/auth/companies/current_user_company/",method:"get"})}}}]);
//# sourceMappingURL=chunk-4d602d60.18bcf523.js.map