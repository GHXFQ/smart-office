(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3112d588"],{"19ea":function(e,t,a){},"50fc":function(e,t,a){"use strict";var r=a("cee4");const c=r["a"].create({baseURL:"http://localhost:8000/api/admin",timeout:1e4,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e},e=>Promise.reject(e)),t["a"]={getDashboardData(){return c.get("/dashboard/")},getDashboardAnalysis(e,t){return c.post("/dashboard/analysis/",{chart_title:e,chart_data:t})},getUsers(e){return c.get("/users/",{params:e})},createUser(e){return c.post("/users/",e)},updateUser(e,t){return c.patch(`/users/${e}/`,t)},deleteUser(e){return c.delete(`/users/${e}/`)},getCompanies(e){return c.get("/companies/",{params:e})},createCompany(e){return c.post("/companies/",e)},updateCompany(e,t){return c.patch(`/companies/${e}/`,t)},deleteCompany(e){return c.delete(`/companies/${e}/`)},getDepartments(e){return c.get("/departments/",{params:e})},createDepartment(e){return c.post("/departments/",e)},updateDepartment(e,t){return c.patch(`/departments/${e}/`,t)},deleteDepartment(e){return c.delete(`/departments/${e}/`)},getSmartDocs(e){return c.get("/smart-docs/",{params:e})},getSmartDocDetail(e){return c.get(`/smart-docs/${e}/`)},deleteSmartDoc(e){return c.delete(`/smart-docs/${e}/`)},getContracts(e){return c.get("/contracts/",{params:e})},getContractDetail(e){return c.get(`/contracts/${e}/`)},deleteContract(e){return c.delete(`/contracts/${e}/`)},getContractTemplates(){return c.get("/contract-templates/")},getContractTemplate(e){return c.get(`/contract-templates/${e}/`)},createContractTemplate(e){return c.post("/contract-templates/",e)},updateContractTemplate(e,t){return c.patch(`/contract-templates/${e}/`,t)},deleteContractTemplate(e){return c.delete(`/contract-templates/${e}/`)},getKnowledgeCategories(e){return c.get("/knowledge-categories/",{params:e})},createKnowledgeCategory(e){return c.post("/knowledge-categories/",e)},updateKnowledgeCategory(e,t){return c.patch(`/knowledge-categories/${e}/`,t)},deleteKnowledgeCategory(e){return c.delete(`/knowledge-categories/${e}/`)},getKnowledgeBases(e){return c.get("/knowledge-bases/",{params:e})},getKnowledgeBaseDetail(e){return c.get(`/knowledge-bases/${e}/`)},createKnowledgeBase(e){const t=new FormData;for(const a in e)null!==e[a]&&void 0!==e[a]&&t.append(a,e[a]);return c.post("/knowledge-bases/",t,{headers:{"Content-Type":"multipart/form-data"}})},updateKnowledgeBase(e,t){const a=new FormData;for(const r in t)"original_file"!==r&&null!==t[r]&&void 0!==t[r]&&a.append(r,t[r]);return t.original_file instanceof File&&a.append("original_file",t.original_file),c.patch(`/knowledge-bases/${e}/`,a,{headers:{"Content-Type":"multipart/form-data"}})},deleteKnowledgeBase(e){return c.delete(`/knowledge-bases/${e}/`)},getKnowledgeBuildStatus(){return c.get("/knowledge/build/")},buildKnowledgeForCompanies(e){return c.post("/knowledge/build/",{company_ids:e})}}},5116:function(e,t,a){"use strict";a("19ea")},"77ce":function(e,t,a){"use strict";a.r(t);a("14d9");var r=a("7a23"),c=a("50fc"),n=a("3ef4"),o=a("c9a1"),l=a("4c02"),s=a("54bb"),d=a("c349"),u=a("cf2e"),i=a("1e49"),b=a("ae7b"),p=a("7faf"),j=a("db9d"),O=a("f6f2"),g=a("6605");const m={class:"management-container"},f={class:"card-header d-flex justify-content-between align-items-center"},h={class:"header-left"},w={class:"header-right"},V={class:"table-container"},C={class:"pagination-container"},N={key:0,class:"preview-content"},v={class:"preview-header"},y=["innerHTML"],x={class:"dialog-footer"};var _={__name:"ContractManagement",setup(e){const t=Object(r["ref"])([]),a=Object(r["ref"])(!0),_=Object(r["ref"])(""),k=Object(r["ref"])(0),D=Object(r["reactive"])({page:1,pageSize:10}),T=Object(r["ref"])(!1),E=Object(r["ref"])({});let S=null;const $=Object(g["d"])(),z=async()=>{a.value=!0;try{const e={search:_.value,page:D.page,page_size:D.pageSize},r=await c["a"].getContracts(e);t.value=r.data.results,k.value=r.data.count}catch(e){console.error("获取合同列表失败:",e),n["a"].error("获取合同列表失败")}finally{a.value=!1}},B=()=>{clearTimeout(S),S=setTimeout(()=>{D.page=1,z()},300)},K=async e=>{try{const t=await c["a"].getContractDetail(e.id);E.value=t.data,T.value=!0}catch(t){n["a"].error("获取合同详情失败"),console.error("获取合同详情失败:",t)}},U=()=>{T.value=!1,E.value={}},M=e=>{o["a"].confirm(`确定要删除合同【${e.title}】吗？此操作不可恢复。`,"警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await c["a"].deleteContract(e.id),n["a"].success("合同删除成功"),z()}catch(t){n["a"].error("删除失败，请稍后重试"),console.error("删除合同失败:",t)}}).catch(()=>{n["a"].info("已取消删除")})},F=e=>{switch(e){case"草稿":return"info";case"审核中":return"warning";case"已生效":return"success";case"已归档":return"info";case"已作废":return"danger";default:return""}},L=e=>{D.pageSize=e,z()},A=e=>{D.page=e,z()},I=()=>{$.push({name:"AdminContractTemplateManagement"})};return Object(r["onMounted"])(z),(e,c)=>{const n=Object(r["resolveDirective"])("loading");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",m,[Object(r["createVNode"])(Object(r["unref"])(l["a"]),{class:"box-card"},{header:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",f,[Object(r["createElementVNode"])("div",h,[Object(r["createVNode"])(Object(r["unref"])(s["a"]),{class:"header-icon"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(O["DocumentChecked"]))]),_:1}),c[5]||(c[5]=Object(r["createElementVNode"])("span",null,"合同管理",-1))]),Object(r["createElementVNode"])("div",w,[Object(r["createVNode"])(Object(r["unref"])(d["a"]),{modelValue:_.value,"onUpdate:modelValue":c[0]||(c[0]=e=>_.value=e),placeholder:"搜索合同...",clearable:"",onClear:z,onInput:B,class:"search-input"},{append:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{icon:Object(r["unref"])(O["Search"])},null,8,["icon"])]),_:1},8,["modelValue"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{type:"primary",onClick:I,icon:Object(r["unref"])(O["DocumentChecked"])},{default:Object(r["withCtx"])(()=>c[6]||(c[6]=[Object(r["createTextVNode"])("管理模板")])),_:1},8,["icon"]),Object(r["createVNode"])(Object(r["unref"])(u["a"]),{type:"primary",onClick:c[1]||(c[1]=t=>e.openModal()),icon:Object(r["unref"])(O["DocumentChecked"])},{default:Object(r["withCtx"])(()=>c[7]||(c[7]=[Object(r["createTextVNode"])("新建合同")])),_:1},8,["icon"])])])]),default:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",V,[Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["unref"])(i["a"]),{data:t.value,style:{width:"100%"}},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(Object(r["unref"])(i["b"]),{type:"index",label:"序号",width:"60"}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"title",label:"合同标题",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"company_name",label:"所属公司",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"creator_name",label:"创建者",sortable:""}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"created_at",label:"创建时间",sortable:""},{default:Object(r["withCtx"])(e=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(new Date(e.row.created_at).toLocaleString()),1)]),_:1}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{prop:"status",label:"状态",width:"100",sortable:""},{default:Object(r["withCtx"])(e=>[Object(r["createVNode"])(Object(r["unref"])(b["a"]),{type:F(e.row.status)},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.row.status),1)]),_:2},1032,["type"])]),_:1}),Object(r["createVNode"])(Object(r["unref"])(i["b"]),{label:"操作",width:"120"},{default:Object(r["withCtx"])(e=>[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{text:"",type:"primary",size:"small",onClick:t=>K(e.row)},{default:Object(r["withCtx"])(()=>c[8]||(c[8]=[Object(r["createTextVNode"])("查看")])),_:2},1032,["onClick"]),Object(r["createVNode"])(Object(r["unref"])(u["a"]),{text:"",type:"danger",size:"small",onClick:t=>M(e.row)},{default:Object(r["withCtx"])(()=>c[9]||(c[9]=[Object(r["createTextVNode"])("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[n,a.value]])]),Object(r["createElementVNode"])("div",C,[Object(r["createVNode"])(Object(r["unref"])(p["a"]),{"current-page":D.page,"onUpdate:currentPage":c[2]||(c[2]=e=>D.page=e),"page-size":D.pageSize,"onUpdate:pageSize":c[3]||(c[3]=e=>D.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:L,onCurrentChange:A},null,8,["current-page","page-size","total"])]),Object(r["createVNode"])(Object(r["unref"])(j["a"]),{modelValue:T.value,"onUpdate:modelValue":c[4]||(c[4]=e=>T.value=e),title:E.value.title,width:"60%"},{footer:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("span",x,[Object(r["createVNode"])(Object(r["unref"])(u["a"]),{onClick:U},{default:Object(r["withCtx"])(()=>c[16]||(c[16]=[Object(r["createTextVNode"])("关闭")])),_:1})])]),default:Object(r["withCtx"])(()=>[E.value.id?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",N,[Object(r["createElementVNode"])("div",v,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(E.value.title),1),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",null,[c[10]||(c[10]=Object(r["createElementVNode"])("strong",null,"公司:",-1)),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(E.value.company_name),1)]),c[14]||(c[14]=Object(r["createTextVNode"])(" | ")),Object(r["createElementVNode"])("span",null,[c[11]||(c[11]=Object(r["createElementVNode"])("strong",null,"创建者:",-1)),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(E.value.creator_name),1)]),c[15]||(c[15]=Object(r["createTextVNode"])(" | ")),Object(r["createElementVNode"])("span",null,[c[12]||(c[12]=Object(r["createElementVNode"])("strong",null,"状态:",-1)),c[13]||(c[13]=Object(r["createTextVNode"])()),Object(r["createVNode"])(Object(r["unref"])(b["a"]),{type:F(E.value.status)},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(E.value.status),1)]),_:1},8,["type"])])])]),Object(r["createElementVNode"])("div",{class:"content-body",innerHTML:E.value.content},null,8,y)])):Object(r["createCommentVNode"])("",!0)]),_:1},8,["modelValue","title"])]),_:1})])}}},k=(a("5116"),a("6b0d")),D=a.n(k);const T=D()(_,[["__scopeId","data-v-35fe95dc"]]);t["default"]=T}}]);
//# sourceMappingURL=chunk-3112d588.bddb68ea.js.map